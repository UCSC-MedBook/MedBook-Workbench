(function(f,e){"function"===typeof define&&define.amd?define("bloodhound",["jquery"],function(d){return f.Bloodhound=e(d)}):"object"===typeof exports?module.exports=e(require("jquery")):f.Bloodhound=e(jQuery)})(this,function(f){var e=function(){return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(a){return!a||/^\s*$/.test(a)},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,
"\\$&")},isString:function(a){return"string"===typeof a},isNumber:function(a){return"number"===typeof a},isArray:f.isArray,isFunction:f.isFunction,isObject:f.isPlainObject,isUndefined:function(a){return"undefined"===typeof a},isElement:function(a){return!(!a||1!==a.nodeType)},isJQuery:function(a){return a instanceof f},toStr:function(a){return e.isUndefined(a)||null===a?"":a+""},bind:f.proxy,each:function(a,b){f.each(a,function(a,e){return b(e,a)})},map:f.map,filter:f.grep,every:function(a,b){var e=
!0;if(!a)return e;f.each(a,function(d,g){if(!(e=b.call(null,g,d,a)))return!1});return!!e},some:function(a,b){var e=!1;if(!a)return e;f.each(a,function(d,g){if(e=b.call(null,g,d,a))return!1});return!!e},mixin:f.extend,identity:function(a){return a},clone:function(a){return f.extend(!0,{},a)},getIdGenerator:function(){var a=0;return function(){return a++}},templatify:function(a){function b(){return String(a)}return f.isFunction(a)?a:b},defer:function(a){setTimeout(a,0)},debounce:function(a,b,e){var d,
g;return function(){var f=this,k=arguments,l;l=e&&!d;clearTimeout(d);d=setTimeout(function(){d=null;e||(g=a.apply(f,k))},b);l&&(g=a.apply(f,k));return g}},throttle:function(a,b){var e,d,g,f,k,l;k=0;l=function(){k=new Date;g=null;f=a.apply(e,d)};return function(){var m=new Date,n=b-(m-k);e=this;d=arguments;0>=n?(clearTimeout(g),g=null,k=m,f=a.apply(e,d)):g||(g=setTimeout(l,n));return f}},stringify:function(a){return e.isString(a)?a:JSON.stringify(a)},noop:function(){}}}(),d=function(){function a(b){return(b=
e.toStr(b))?b.split(/\s+/):[]}function b(a){return(a=e.toStr(a))?a.split(/\W+/):[]}function d(a){return function(b){b=e.isArray(b)?b:[].slice.call(arguments,0);return function(d){var g=[];e.each(b,function(b){g=g.concat(a(e.toStr(d[b])))});return g}}}return{nonword:b,whitespace:a,obj:{nonword:d(b),whitespace:d(a)}}}(),b=function(){function a(b){this.maxSize=e.isNumber(b)?b:100;this.reset();0>=this.maxSize&&(this.set=this.get=f.noop)}function b(){this.head=this.tail=null}function d(a,b){this.key=a;
this.val=b;this.prev=this.next=null}e.mixin(a.prototype,{set:function(a,b){var e=this.list.tail;this.size>=this.maxSize&&(this.list.remove(e),delete this.hash[e.key],this.size--);(e=this.hash[a])?(e.val=b,this.list.moveToFront(e)):(e=new d(a,b),this.list.add(e),this.hash[a]=e,this.size++)},get:function(a){if(a=this.hash[a])return this.list.moveToFront(a),a.val},reset:function(){this.size=0;this.hash={};this.list=new b}});e.mixin(b.prototype,{add:function(a){this.head&&(a.next=this.head,this.head.prev=
a);this.head=a;this.tail=this.tail||a},remove:function(a){a.prev?a.prev.next=a.next:this.head=a.next;a.next?a.next.prev=a.prev:this.tail=a.prev},moveToFront:function(a){this.remove(a);this.add(a)}});return a}(),a=function(){function a(b,g){this.prefix=["__",b,"__"].join("");this.ttlKey="__ttl__";this.keyMatcher=new RegExp("^"+e.escapeRegExChars(this.prefix));this.ls=g||d;!this.ls&&this._noop()}function b(a){return JSON.stringify(e.isUndefined(a)?null:a)}var d;try{d=window.localStorage,d.setItem("~~~",
"!"),d.removeItem("~~~")}catch(g){d=null}e.mixin(a.prototype,{_prefix:function(a){return this.prefix+a},_ttlKey:function(a){return this._prefix(a)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=e.noop},_safeSet:function(a,b){try{this.ls.setItem(a,b)}catch(e){"QuotaExceededError"===e.name&&(this.clear(),this._noop())}},get:function(a){this.isExpired(a)&&this.remove(a);a=this.ls.getItem(this._prefix(a));return f.parseJSON(a)},set:function(a,d,g){e.isNumber(g)?
this._safeSet(this._ttlKey(a),b((new Date).getTime()+g)):this.ls.removeItem(this._ttlKey(a));return this._safeSet(this._prefix(a),b(d))},remove:function(a){this.ls.removeItem(this._ttlKey(a));this.ls.removeItem(this._prefix(a));return this},clear:function(){var a;a=this.keyMatcher;var b,e,g=[],f=d.length;for(b=0;b<f;b++)(e=d.key(b)).match(a)&&g.push(e.replace(a,""));for(a=g.length;a--;)this.remove(g[a]);return this},isExpired:function(a){a=this.ls.getItem(this._ttlKey(a));a=f.parseJSON(a);return e.isNumber(a)&&
(new Date).getTime()>a?!0:!1}});return a}(),g=function(){function a(e){e=e||{};this.cancelled=!1;this.lastReq=null;this._send=e.transport;this._get=e.limiter?e.limiter(this._get):this._get;this._cache=!1===e.cache?new b(0):l}var d=0,g={},k=6,l=new b(10);a.setMaxPendingRequests=function(a){k=a};a.resetCache=function(){l.reset()};e.mixin(a.prototype,{_fingerprint:function(a){a=a||{};return a.url+a.type+f.param(a.data||{})},_get:function(a,b){function e(a){b(null,a);m._cache.set(n,a)}function f(){b(!0)}
function l(){d--;delete g[n];m.onDeckRequestArgs&&(m._get.apply(m,m.onDeckRequestArgs),m.onDeckRequestArgs=null)}var m=this,n,w;n=this._fingerprint(a);this.cancelled||n!==this.lastReq||((w=g[n])?w.done(e).fail(f):d<k?(d++,g[n]=this._send(a).done(e).fail(f).always(l)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(a,b){var d,g;b=b||f.noop;a=e.isString(a)?{url:a}:a||{};g=this._fingerprint(a);this.cancelled=!1;this.lastReq=g;(d=this._cache.get(g))?b(null,d):this._get(a,b)},cancel:function(){this.cancelled=
!0}});return a}(),k=window.SearchIndex=function(){function a(b){b=b||{};b.datumTokenizer&&b.queryTokenizer||f.error("datumTokenizer and queryTokenizer are both required");this.identify=b.identify||e.stringify;this.datumTokenizer=b.datumTokenizer;this.queryTokenizer=b.queryTokenizer;this.reset()}function b(a){a=e.filter(a,function(a){return!!a});return a=e.map(a,function(a){return a.toLowerCase()})}function d(a){for(var b={},e=[],g=0,f=a.length;g<f;g++)b[a[g]]||(b[a[g]]=!0,e.push(a[g]));return e}e.mixin(a.prototype,
{bootstrap:function(a){this.datums=a.datums;this.trie=a.trie},add:function(a){var d=this;a=e.isArray(a)?a:[a];e.each(a,function(a){var g;d.datums[g=d.identify(a)]=a;a=b(d.datumTokenizer(a));e.each(a,function(a){var b,e;b=d.trie;for(a=a.split("");e=a.shift();)b=b.c[e]||(b.c[e]={i:[],c:{}}),b.i.push(g)})})},get:function(a){var b=this;return e.map(a,function(a){return b.datums[a]})},search:function(a){var g=this,f;a=b(this.queryTokenizer(a));e.each(a,function(a){var b,e;if(f&&0===f.length)return!1;b=
g.trie;for(a=a.split("");b&&(e=a.shift());)b=b.c[e];if(b&&0===a.length){e=b.i.slice(0);if(f){b=f;var d=a=0,k=[];b=b.sort();e=e.sort();for(var l=b.length,m=e.length;a<l&&d<m;)b[a]<e[d]?a++:(b[a]>e[d]||(k.push(b[a]),a++),d++);b=k}else b=e;f=b}else return f=[],!1});return f?e.map(d(f),function(a){return g.datums[a]}):[]},all:function(){var a=[],b;for(b in this.datums)a.push(this.datums[b]);return a},reset:function(){this.datums={};this.trie={i:[],c:{}}},serialize:function(){return{datums:this.datums,
trie:this.trie}}});return a}(),l=function(){function b(e){this.url=e.url;this.ttl=e.ttl;this.cache=e.cache;this.prepare=e.prepare;this.transform=e.transform;this.transport=e.transport;this.thumbprint=e.thumbprint;this.storage=new a(e.cacheKey)}e.mixin(b.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(a){this.cache&&(this.storage.set("data",a,this.ttl),this.storage.set("protocol",location.protocol,this.ttl),this.storage.set("thumbprint",this.thumbprint,
this.ttl))},fromCache:function(){var a,b;if(!this.cache)return null;a=this.storage.get("data");b=this.storage.get("protocol");b=this.storage.get("thumbprint")!==this.thumbprint||b!==location.protocol;return a&&!b?a:null},fromNetwork:function(a){function b(){a(!0)}function e(b){a(null,d.transform(b))}var d=this,g;a&&(g=this.prepare(this._settings()),this.transport(g).fail(b).done(e))},clear:function(){this.storage.clear();return this}});return b}(),m=function(){function a(b){this.url=b.url;this.prepare=
b.prepare;this.transform=b.transform;this.transport=new g({cache:b.cache,limiter:b.limiter,transport:b.transport})}e.mixin(a.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(a,b){function e(a,g){a?b([]):b(d.transform(g))}var d=this,g;if(b)return g=this.prepare(a||"",this._settings()),this.transport.get(g,e)},cancelLastRequest:function(){this.transport.cancel()}});return a}(),n=function(){function a(b){var d;if(!b)return null;d={url:null,ttl:864E5,cache:!0,
cacheKey:null,thumbprint:"",prepare:e.identity,transform:e.identity,transport:null};b=e.isString(b)?{url:b}:b;b=e.mixin(d,b);!b.url&&f.error("prefetch requires url to be set");b.transform=b.filter||b.transform;b.cacheKey=b.cacheKey||b.url;b.thumbprint="0.11.1"+b.thumbprint;b.transport=b.transport?k(b.transport):f.ajax;return b}function b(a){var l;if(a)return l={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:e.identity,transport:null},
a=e.isString(a)?{url:a}:a,a=e.mixin(l,a),!a.url&&f.error("remote requires url to be set"),a.transform=a.filter||a.transform,a.prepare=d(a),a.limiter=g(a),a.transport=a.transport?k(a.transport):f.ajax,delete a.replace,delete a.wildcard,delete a.rateLimitBy,delete a.rateLimitWait,a}function d(a){function b(a,e){e.url=k(e.url,a);return e}function e(a,b){b.url=b.url.replace(l,encodeURIComponent(a));return b}function g(a,b){return b}var f,k,l;f=a.prepare;k=a.replace;l=a.wildcard;return f?f:f=k?b:a.wildcard?
e:g}function g(a){function b(a){return function(b){return e.debounce(b,a)}}function d(a){return function(b){return e.throttle(b,a)}}var f,k;f=a.limiter;k=a.rateLimitBy;a=a.rateLimitWait;f||(f=/^throttle$/i.test(k)?d(a):b(a));return f}function k(a){return function(b){var d=f.Deferred();a(b,function(a){e.defer(function(){d.resolve(a)})},function(a){e.defer(function(){d.reject(a)})});return d}}return function(d){var g;d=e.mixin({initialize:!0,identify:e.stringify,datumTokenizer:null,queryTokenizer:null,
sufficient:5,sorter:null,local:[],prefetch:null,remote:null},d||{});!d.datumTokenizer&&f.error("datumTokenizer is required");!d.queryTokenizer&&f.error("queryTokenizer is required");g=d.sorter;d.sorter=g?function(a){return a.sort(g)}:e.identity;d.local=e.isFunction(d.local)?d.local():d.local;d.prefetch=a(d.prefetch);d.remote=b(d.remote);return d}}();return function(){function a(b){b=n(b);this.sorter=b.sorter;this.identify=b.identify;this.sufficient=b.sufficient;this.local=b.local;this.remote=b.remote?
new m(b.remote):null;this.prefetch=b.prefetch?new l(b.prefetch):null;this.index=new k({identify:this.identify,datumTokenizer:b.datumTokenizer,queryTokenizer:b.queryTokenizer});!1!==b.initialize&&this.initialize()}var b;b=window&&window.Bloodhound;a.noConflict=function(){window&&(window.Bloodhound=b);return a};a.tokenizers=d;e.mixin(a.prototype,{__ttAdapter:function(){function a(b,d,g){return e.search(b,d,g)}function b(a,d){return e.search(a,d)}var e=this;return this.remote?a:b},_loadPrefetch:function(){function a(d,
g){if(d)return e.reject();b.add(g);b.prefetch.store(b.index.serialize());e.resolve()}var b=this,e,d;e=f.Deferred();this.prefetch?(d=this.prefetch.fromCache())?(this.index.bootstrap(d),e.resolve()):this.prefetch.fromNetwork(a):e.resolve();return e.promise()},_initialize:function(){var a=this;this.clear();(this.initPromise=this._loadPrefetch()).done(function(){a.add(a.local)});return this.initPromise},initialize:function(a){return!this.initPromise||a?this._initialize():this.initPromise},add:function(a){this.index.add(a);
return this},get:function(a){a=e.isArray(a)?a:[].slice.call(arguments);return this.index.get(a)},search:function(a,b,d){function g(a){var b=[];e.each(a,function(a){!e.some(k,function(b){return f.identify(a)===f.identify(b)})&&b.push(a)});d&&d(b)}var f=this,k;k=this.sorter(this.index.search(a));b(this.remote?k.slice():k);this.remote&&k.length<this.sufficient?this.remote.get(a,g):this.remote&&this.remote.cancelLastRequest();return this},all:function(){return this.index.all()},clear:function(){this.index.reset();
return this},clearPrefetchCache:function(){this.prefetch&&this.prefetch.clear();return this},clearRemoteCache:function(){g.resetCache();return this},ttAdapter:function(){return this.__ttAdapter()}});return a}()});
(function(f,e){"function"===typeof define&&define.amd?define("typeahead.js",["jquery"],function(d){return e(d)}):"object"===typeof exports?module.exports=e(require("jquery")):e(jQuery)})(this,function(f){var e=function(){return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(a){return!a||/^\s*$/.test(a)},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},
isString:function(a){return"string"===typeof a},isNumber:function(a){return"number"===typeof a},isArray:f.isArray,isFunction:f.isFunction,isObject:f.isPlainObject,isUndefined:function(a){return"undefined"===typeof a},isElement:function(a){return!(!a||1!==a.nodeType)},isJQuery:function(a){return a instanceof f},toStr:function(a){return e.isUndefined(a)||null===a?"":a+""},bind:f.proxy,each:function(a,b){f.each(a,function(a,e){return b(e,a)})},map:f.map,filter:f.grep,every:function(a,b){var e=!0;if(!a)return e;
f.each(a,function(d,g){if(!(e=b.call(null,g,d,a)))return!1});return!!e},some:function(a,b){var e=!1;if(!a)return e;f.each(a,function(d,g){if(e=b.call(null,g,d,a))return!1});return!!e},mixin:f.extend,identity:function(a){return a},clone:function(a){return f.extend(!0,{},a)},getIdGenerator:function(){var a=0;return function(){return a++}},templatify:function(a){function b(){return String(a)}return f.isFunction(a)?a:b},defer:function(a){setTimeout(a,0)},debounce:function(a,b,e){var d,g;return function(){var f=
this,k=arguments,l;l=e&&!d;clearTimeout(d);d=setTimeout(function(){d=null;e||(g=a.apply(f,k))},b);l&&(g=a.apply(f,k));return g}},throttle:function(a,b){var e,d,g,f,k,l;k=0;l=function(){k=new Date;g=null;f=a.apply(e,d)};return function(){var m=new Date,n=b-(m-k);e=this;d=arguments;0>=n?(clearTimeout(g),g=null,k=m,f=a.apply(e,d)):g||(g=setTimeout(l,n));return f}},stringify:function(a){return e.isString(a)?a:JSON.stringify(a)},noop:function(){}}}(),d=function(){function a(b){var d={};e.each(b,function(a,
b){d[b]="."+a});return d}function b(){var a={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};e.isMsie()&&e.mixin(a.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"});
return a}var d={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return function(g){var f;g=e.mixin({},d,g);f={css:b(),classes:g,html:{wrapper:'<span class="'+g.wrapper+'"></span>',menu:'<div class="'+g.menu+'"></div>'},selectors:a(g)};return{css:f.css,html:f.html,classes:f.classes,selectors:f.selectors,mixin:function(a){e.mixin(a,
f)}}}}(),b=function(){function a(b){b&&b.el||f.error("EventBus initialized without el");this.$el=f(b.el)}var b;b={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"};e.mixin(a.prototype,{_trigger:function(a,b){var e;e=f.Event("typeahead:"+a);(b=b||[]).unshift(e);this.$el.trigger.apply(this.$el,b);return e},before:function(a){var b;b=[].slice.call(arguments,1);return this._trigger("before"+a,b).isDefaultPrevented()},trigger:function(a){var e;this._trigger(a,
[].slice.call(arguments,1));(e=b[a])&&this._trigger(e,[].slice.call(arguments,1))}});return a}(),a=function(){function a(b,g,f,k){if(!f)return this;g=g.split(d);f=k?e(f,k):f;for(this._callbacks=this._callbacks||{};k=g.shift();)this._callbacks[k]=this._callbacks[k]||{sync:[],async:[]},this._callbacks[k][b].push(f);return this}function b(a,e,d){return function(){for(var b,g=0,f=a.length;!b&&g<f;g+=1)b=!1===a[g].apply(e,d);return!b}}function e(a,b){return a.bind?a.bind(b):function(){a.apply(b,[].slice.call(arguments,
0))}}var d=/\s+/,g=function(){return window.setImmediate?function(a){setImmediate(function(){a()})}:function(a){setTimeout(function(){a()},0)}}();return{onSync:function(b,e,d){return a.call(this,"sync",b,e,d)},onAsync:function(b,e,d){return a.call(this,"async",b,e,d)},off:function(a){var b;if(!this._callbacks)return this;for(a=a.split(d);b=a.shift();)delete this._callbacks[b];return this},trigger:function(a){var e,f,k,l,m;if(!this._callbacks)return this;a=a.split(d);for(k=[].slice.call(arguments,
1);(e=a.shift())&&(f=this._callbacks[e]);)l=b(f.sync,this,[e].concat(k)),m=b(f.async,this,[e].concat(k)),l()&&g(m);return this}}}(),g=function(a){function b(a,d,g){for(var f=[],k=0,l=a.length;k<l;k++)f.push(e.escapeRegExChars(a[k]));a=g?"\\b("+f.join("|")+")\\b":"("+f.join("|")+")";return d?new RegExp(a):new RegExp(a,"i")}var d={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(g){function f(b){var e,d,k;if(e=l.exec(b.data))k=a.createElement(g.tagName),
g.className&&(k.className=g.className),d=b.splitText(e.index),d.splitText(e[0].length),k.appendChild(d.cloneNode(!0)),b.parentNode.replaceChild(k,d);return!!e}function k(a,b){for(var e,d=0;d<a.childNodes.length;d++)e=a.childNodes[d],3===e.nodeType?d+=b(e)?1:0:k(e,b)}var l;g=e.mixin({},d,g);g.node&&g.pattern&&(g.pattern=e.isArray(g.pattern)?g.pattern:[g.pattern],l=b(g.pattern,g.caseSensitive,g.wordsOnly),k(g.node,f))}}(window.document),k=function(){function b(a,d){a=a||{};a.input||f.error("input is missing");
d.mixin(this);this.$hint=f(a.hint);this.$input=f(a.input);this.query=this.$input.val();this.queryWhenFocused=this.hasFocus()?this.query:null;var g=this.$input;this.$overflowHelper=f('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:g.css("font-family"),fontSize:g.css("font-size"),fontStyle:g.css("font-style"),fontVariant:g.css("font-variant"),fontWeight:g.css("font-weight"),wordSpacing:g.css("word-spacing"),letterSpacing:g.css("letter-spacing"),
textIndent:g.css("text-indent"),textRendering:g.css("text-rendering"),textTransform:g.css("text-transform")}).insertAfter(g);this._checkLanguageDirection();0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=e.noop)}var d;d={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"};b.normalizeQuery=function(a){return e.toStr(a).replace(/^\s*/g,"").replace(/\s{2,}/g," ")};e.mixin(b.prototype,a,{_onBlur:function(){this.resetInputValue();this.trigger("blurred")},
_onFocus:function(){this.queryWhenFocused=this.query;this.trigger("focused")},_onKeydown:function(a){var b=d[a.which||a.keyCode];this._managePreventDefault(b,a);b&&this._shouldTrigger(b,a)&&this.trigger(b+"Keyed",a)},_onInput:function(){this._setQuery(this.getInputValue());this.clearHintIfInvalid();this._checkLanguageDirection()},_managePreventDefault:function(a,b){var e;switch(a){case "up":case "down":e=!(b.altKey||b.ctrlKey||b.metaKey||b.shiftKey);break;default:e=!1}e&&b.preventDefault()},_shouldTrigger:function(a,
b){var e;switch(a){case "tab":e=!(b.altKey||b.ctrlKey||b.metaKey||b.shiftKey);break;default:e=!0}return e},_checkLanguageDirection:function(){var a=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==a&&(this.dir=a,this.$hint.attr("dir",a),this.trigger("langDirChanged",a))},_setQuery:function(a,e){var d,g;d=this.query;g=(d=b.normalizeQuery(a)===b.normalizeQuery(d))?this.query.length!==a.length:!1;this.query=a;e||d?!e&&g&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",
this.query)},bind:function(){var a=this,b,g,f,k;b=e.bind(this._onBlur,this);g=e.bind(this._onFocus,this);f=e.bind(this._onKeydown,this);k=e.bind(this._onInput,this);this.$input.on("blur.tt",b).on("focus.tt",g).on("keydown.tt",f);if(!e.isMsie()||9<e.isMsie())this.$input.on("input.tt",k);else this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(b){d[b.which||b.keyCode]||e.defer(e.bind(a._onInput,a,b))});return this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},
getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(a,b){this.setInputValue(a);this._setQuery(a,b)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(a){this.$input.val(a);this.clearHintIfInvalid();this._checkLanguageDirection()},resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(a){this.$hint.val(a)},
clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var a,b;a=this.getInputValue();b=this.getHint();b=a!==b&&0===b.indexOf(a);""!==a&&b&&!this.hasOverflow()||this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var a=this.$input.width()-2;this.$overflowHelper.text(this.getInputValue());return this.$overflowHelper.width()>=a},isCursorAtEnd:function(){var a,b;a=this.$input.val().length;b=this.$input[0].selectionStart;return e.isNumber(b)?b===
a:document.selection?(b=document.selection.createRange(),b.moveStart("character",-a),a===b.text.length):!0},destroy:function(){this.$hint.off(".tt");this.$input.off(".tt");this.$overflowHelper.remove();this.$hint=this.$input=this.$overflowHelper=f("<div>")}});return b}(),l=function(){function b(a,g){a=a||{};a.templates=a.templates||{};a.templates.notFound=a.templates.notFound||a.templates.empty;a.source||f.error("missing source");a.node||f.error("missing node");a.name&&!/^[_a-zA-Z0-9-]+$/.test(a.name)&&
f.error("invalid dataset name: "+a.name);g.mixin(this);this.highlight=!!a.highlight;this.name=a.name||l();this.limit=a.limit||5;this.displayFn=d(a.display||a.displayKey);this.templates=k(a.templates,this.displayFn);this.source=a.source.__ttAdapter?a.source.__ttAdapter():a.source;this.async=e.isUndefined(a.async)?2<this.source.length:!!a.async;this._resetLastSuggestion();this.$el=f(a.node).addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}function d(a){function b(e){return e[a]}
a=a||e.stringify;return e.isFunction(a)?a:b}function k(a,b){function d(a){return f("<div>").text(b(a))}return{notFound:a.notFound&&e.templatify(a.notFound),pending:a.pending&&e.templatify(a.pending),header:a.header&&e.templatify(a.header),footer:a.footer&&e.templatify(a.footer),suggestion:a.suggestion||d}}var l;l=e.getIdGenerator();b.extractData=function(a){a=f(a);return a.data("tt-selectable-object")?{val:a.data("tt-selectable-display")||"",obj:a.data("tt-selectable-object")||null}:null};e.mixin(b.prototype,
a,{_overwrite:function(a,b){b=b||[];b.length?this._renderSuggestions(a,b):this.async&&this.templates.pending?this._renderPending(a):!this.async&&this.templates.notFound?this._renderNotFound(a):this._empty();this.trigger("rendered",this.name,b,!1)},_append:function(a,b){b=b||[];b.length&&this.$lastSuggestion.length?this._appendSuggestions(a,b):b.length?this._renderSuggestions(a,b):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(a);this.trigger("rendered",this.name,b,!0)},
_renderSuggestions:function(a,b){var e;e=this._getSuggestionsFragment(a,b);this.$lastSuggestion=e.children().last();this.$el.html(e).prepend(this._getHeader(a,b)).append(this._getFooter(a,b))},_appendSuggestions:function(a,b){var e,d;e=this._getSuggestionsFragment(a,b);d=e.children().last();this.$lastSuggestion.after(e);this.$lastSuggestion=d},_renderPending:function(a){var b=this.templates.pending;this._resetLastSuggestion();b&&this.$el.html(b({query:a,dataset:this.name}))},_renderNotFound:function(a){var b=
this.templates.notFound;this._resetLastSuggestion();b&&this.$el.html(b({query:a,dataset:this.name}))},_empty:function(){this.$el.empty();this._resetLastSuggestion()},_getSuggestionsFragment:function(a,b){var d=this,k;k=document.createDocumentFragment();e.each(b,function(b){var e;e=d._injectQuery(a,b);b=f(d.templates.suggestion(e)).data("tt-selectable-object",b).data("tt-selectable-display",d.displayFn(b)).addClass(d.classes.suggestion+" "+d.classes.selectable);k.appendChild(b[0])});this.highlight&&
g({className:this.classes.highlight,node:k,pattern:a});return f(k)},_getFooter:function(a,b){return this.templates.footer?this.templates.footer({query:a,suggestions:b,dataset:this.name}):null},_getHeader:function(a,b){return this.templates.header?this.templates.header({query:a,suggestions:b,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=f()},_injectQuery:function(a,b){return e.isObject(b)?e.mixin({_query:a},b):b},update:function(a){function b(d){g||(g=!0,d=(d||[]).slice(0,
e.limit),k=d.length,e._overwrite(a,d),k<e.limit&&e.async&&e.trigger("asyncRequested",a))}var e=this,d=!1,g=!1,k=0;this.cancel();this.cancel=function(){d=!0;e.cancel=f.noop;e.async&&e.trigger("asyncCanceled",a)};this.source(a,b,function(b){b=b||[];!d&&k<e.limit&&(e.cancel=f.noop,k+=b.length,e._append(a,b.slice(0,e.limit-k)),e.async&&e.trigger("asyncReceived",a))});!g&&b([])},cancel:f.noop,clear:function(){this._empty();this.cancel();this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},
destroy:function(){this.$el=f("<div>")}});return b}(),m=function(){function b(a,d){var g=this;a=a||{};a.node||f.error("node is required");d.mixin(this);this.$node=f(a.node);this.query=null;this.datasets=e.map(a.datasets,function(a){var b=g.$node.find(a.node).first();a.node=b.length?b:f("<div>").appendTo(g.$node);return new l(a,d)})}e.mixin(b.prototype,a,{_onSelectableClick:function(a){this.trigger("selectableClicked",f(a.currentTarget))},_onRendered:function(a,b,e,d){this.$node.toggleClass(this.classes.empty,
this._allDatasetsEmpty());this.trigger("datasetRendered",b,e,d)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty());this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){return e.every(this.datasets,function(a){return a.isEmpty()})},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},_removeCursor:function(){var a=this.getActiveSelectable();a&&a.removeClass(this.classes.cursor)},
_ensureVisible:function(a){var b,e,d;b=a.position().top;a=b+a.outerHeight(!0);e=this.$node.scrollTop();d=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10);0>b?this.$node.scrollTop(e+b):d<a&&this.$node.scrollTop(e+(a-d))},bind:function(){var a=this,b;b=e.bind(this._onSelectableClick,this);this.$node.on("click.tt",this.selectors.selectable,b);e.each(this.datasets,function(b){b.onSync("asyncRequested",a._propagate,a).onSync("asyncCanceled",a._propagate,
a).onSync("asyncReceived",a._propagate,a).onSync("rendered",a._onRendered,a).onSync("cleared",a._onCleared,a)});return this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.addClass(this.classes.open)},close:function(){this.$node.removeClass(this.classes.open);this._removeCursor()},setLanguageDirection:function(a){this.$node.attr("dir",a)},selectableRelativeToCursor:function(a){var b,e;e=this.getActiveSelectable();b=this._getSelectables();a=(e?b.index(e):
-1)+a;a=(a+1)%(b.length+1)-1;a=-1>a?b.length-1:a;return-1===a?null:b.eq(a)},setCursor:function(a){this._removeCursor();if(a=a&&a.first())a.addClass(this.classes.cursor),this._ensureVisible(a)},getSelectableData:function(a){return a&&a.length?l.extractData(a):null},getActiveSelectable:function(){var a=this._getSelectables().filter(this.selectors.cursor).first();return a.length?a:null},getTopSelectable:function(){var a=this._getSelectables().first();return a.length?a:null},update:function(a){function b(e){e.update(a)}
var d=a!==this.query;d&&(this.query=a,e.each(this.datasets,b));return d},empty:function(){e.each(this.datasets,function(a){a.clear()});this.query=null;this.$node.addClass(this.classes.empty)},destroy:function(){this.$node.off(".tt");this.$node=f("<div>");e.each(this.datasets,function(a){a.destroy()})}});return b}(),n=function(){function a(){m.apply(this,[].slice.call(arguments,0))}var b=m.prototype;e.mixin(a.prototype,m.prototype,{open:function(){!this._allDatasetsEmpty()&&this._show();return b.open.apply(this,
[].slice.call(arguments,0))},close:function(){this._hide();return b.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show();return b._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show();return b._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(a){this.$node.css("ltr"===a?this.css.ltr:this.css.rtl);return b.setLanguageDirection.apply(this,
[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}});return a}(),p=function(){function a(d,g){var k,l,m,n,p,q,T,da,ma,W,vb;d=d||{};d.input||f.error("missing input");d.menu||f.error("missing menu");d.eventBus||f.error("missing event bus");g.mixin(this);this.eventBus=d.eventBus;this.minLength=e.isNumber(d.minLength)?d.minLength:1;this.input=d.input;this.menu=d.menu;this.enabled=!0;this.active=!1;this.input.hasFocus()&&this.activate();
this.dir=this.input.getLangDir();this._hacks();this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this);k=b(this,"activate","open","_onFocused");l=b(this,"deactivate","_onBlurred");m=b(this,"isActive","isOpen","_onEnterKeyed");
n=b(this,"isActive","isOpen","_onTabKeyed");p=b(this,"isActive","_onEscKeyed");q=b(this,"isActive","open","_onUpKeyed");T=b(this,"isActive","open","_onDownKeyed");da=b(this,"isActive","isOpen","_onLeftKeyed");ma=b(this,"isActive","isOpen","_onRightKeyed");W=b(this,"_openIfActive","_onQueryChanged");vb=b(this,"_openIfActive","_onWhitespaceChanged");this.input.bind().onSync("focused",k,this).onSync("blurred",l,this).onSync("enterKeyed",m,this).onSync("tabKeyed",n,this).onSync("escKeyed",p,this).onSync("upKeyed",
q,this).onSync("downKeyed",T,this).onSync("leftKeyed",da,this).onSync("rightKeyed",ma,this).onSync("queryChanged",W,this).onSync("whitespaceChanged",vb,this).onSync("langDirChanged",this._onLangDirChanged,this)}function b(a){var d=[].slice.call(arguments,1);return function(){var b=[].slice.call(arguments);e.each(d,function(e){return a[e].apply(a,b)})}}e.mixin(a.prototype,{_hacks:function(){var a,b;a=this.input.$input||f("<div>");b=this.menu.$node||f("<div>");a.on("blur.tt",function(d){var g,f;g=document.activeElement;
f=b.is(g);g=0<b.has(g).length;e.isMsie()&&(f||g)&&(d.preventDefault(),d.stopImmediatePropagation(),e.defer(function(){a.focus()}))});b.on("mousedown.tt",function(a){a.preventDefault()})},_onSelectableClicked:function(a,b){this.select(b)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(a,b,e,d){this._updateHint();this.eventBus.trigger("render",e,d,b)},_onAsyncRequested:function(a,b,e){this.eventBus.trigger("asyncrequest",e,b)},_onAsyncCanceled:function(a,b,e){this.eventBus.trigger("asynccancel",
e,b)},_onAsyncReceived:function(a,b,e){this.eventBus.trigger("asyncreceive",e,b)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(a,b){var e;(e=this.menu.getActiveSelectable())&&this.select(e)&&b.preventDefault()},_onTabKeyed:function(a,b){var e;(e=this.menu.getActiveSelectable())?this.select(e)&&b.preventDefault():(e=
this.menu.getTopSelectable())&&this.autocomplete(e)&&b.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onQueryChanged:function(a,b){this._minLengthMet(b)?this.menu.update(b):
this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(a,b){this.dir!==b&&(this.dir=b,this.menu.setLanguageDirection(b))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(a){a=e.isString(a)?a:this.input.getQuery()||"";return a.length>=this.minLength},_updateHint:function(){var a,b,d;a=this.menu.getTopSelectable();b=this.menu.getSelectableData(a);a=this.input.getInputValue();!b||e.isBlankString(a)||this.input.hasOverflow()?this.input.clearHint():
(d=k.normalizeQuery(a),d=e.escapeRegExChars(d),d=new RegExp("^(?:"+d+")(.+$)","i"),(b=d.exec(b.val))&&this.input.setHint(a+b[1]))},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){if(this.isActive())return!0;if(!this.isEnabled()||this.eventBus.before("active"))return!1;this.active=!0;this.eventBus.trigger("active");return!0},deactivate:function(){if(this.isActive()){if(this.eventBus.before("idle"))return!1;
this.active=!1;this.close();this.eventBus.trigger("idle")}return!0},isOpen:function(){return this.menu.isOpen()},open:function(){this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open"));return this.isOpen()},close:function(){this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close"));return!this.isOpen()},setVal:function(a){this.input.setQuery(e.toStr(a))},
getVal:function(){return this.input.getQuery()},select:function(a){return(a=this.menu.getSelectableData(a))&&!this.eventBus.before("select",a.obj)?(this.input.setQuery(a.val,!0),this.eventBus.trigger("select",a.obj),this.close(),!0):!1},autocomplete:function(a){var b;b=this.input.getQuery();return(a=this.menu.getSelectableData(a))&&b!==a.val&&!this.eventBus.before("autocomplete",a.obj)?(this.input.setQuery(a.val),this.eventBus.trigger("autocomplete",a.obj),!0):!1},moveCursor:function(a){var b,e,d;
b=this.input.getQuery();a=this.menu.selectableRelativeToCursor(a);d=(e=this.menu.getSelectableData(a))?e.obj:null;return this._minLengthMet()&&this.menu.update(b)||this.eventBus.before("cursorchange",d)?!1:(this.menu.setCursor(a),e?this.input.setInputValue(e.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",d),!0)},destroy:function(){this.input.destroy();this.menu.destroy()}});return a}();(function(){function a(b,e){b.each(function(){var a=f(this),b;(b=a.data(A.typeahead))&&
e(b,a)})}function g(a,b){return a.clone().addClass(b.classes.hint).removeData().css(b.css.hint).css(w(a)).prop("readonly",!0).removeAttr("id name placeholder required").attr({autocomplete:"off",spellcheck:"false",tabindex:-1})}function l(a,b){a.data(A.attrs,{dir:a.attr("dir"),autocomplete:a.attr("autocomplete"),spellcheck:a.attr("spellcheck"),style:a.attr("style")});a.addClass(b.classes.input).attr({autocomplete:"off",spellcheck:!1});try{!a.attr("dir")&&a.attr("dir","auto")}catch(e){}return a}function w(a){return{backgroundAttachment:a.css("background-attachment"),
backgroundClip:a.css("background-clip"),backgroundColor:a.css("background-color"),backgroundImage:a.css("background-image"),backgroundOrigin:a.css("background-origin"),backgroundPosition:a.css("background-position"),backgroundRepeat:a.css("background-repeat"),backgroundSize:a.css("background-size")}}function y(a){var b,d;b=a.data(A.www);d=a.parent().filter(b.selectors.wrapper);e.each(a.data(A.attrs),function(b,d){e.isUndefined(b)?a.removeAttr(d):a.attr(d,b)});a.removeData(A.typeahead).removeData(A.www).removeData(A.attr).removeClass(b.classes.input);
d.length&&(a.detach().insertAfter(d),d.remove())}function K(a){a=e.isJQuery(a)||e.isElement(a)?f(a).first():[];return a.length?a:null}var D,A,z;D=f.fn.typeahead;A={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"};z={initialize:function(a,T){var q;T=e.isArray(T)?T:[].slice.call(arguments,1);a=a||{};q=d(a.classNames);return this.each(function(){var d,w,z,y,D,Qa;e.each(T,function(b){b.highlight=!!a.highlight});d=f(this);w=f(q.html.wrapper);z=K(a.hint);y=K(a.menu);D=!1!==a.hint&&!z;Qa=!1!==a.menu&&
!y;D&&(z=g(d,q));Qa&&(y=f(q.html.menu).css(q.css.menu));z&&z.val("");d=l(d,q);if(D||Qa)w.css(q.css.wrapper),d.css(D?q.css.input:q.css.inputWithNoHint),d.wrap(w).parent().prepend(D?z:null).append(Qa?y:null);D=Qa?n:m;w=new b({el:d});z=new k({hint:z,input:d},q);y=new D({node:y,datasets:T},q);y=new p({input:z,menu:y,eventBus:w,minLength:a.minLength},q);d.data(A.www,q);d.data(A.typeahead,y)})},isEnabled:function(){var b;a(this.first(),function(a){b=a.isEnabled()});return b},enable:function(){a(this,function(a){a.enable()});
return this},disable:function(){a(this,function(a){a.disable()});return this},isActive:function(){var b;a(this.first(),function(a){b=a.isActive()});return b},activate:function(){a(this,function(a){a.activate()});return this},deactivate:function(){a(this,function(a){a.deactivate()});return this},isOpen:function(){var b;a(this.first(),function(a){b=a.isOpen()});return b},open:function(){a(this,function(a){a.open()});return this},close:function(){a(this,function(a){a.close()});return this},select:function(b){var e=
!1,d=f(b);a(this.first(),function(a){e=a.select(d)});return e},autocomplete:function(b){var e=!1,d=f(b);a(this.first(),function(a){e=a.autocomplete(d)});return e},moveCursor:function(b){var e=!1;a(this.first(),function(a){e=a.moveCursor(b)});return e},val:function(b){var e;if(arguments.length)return a(this,function(a){a.setVal(b)}),this;a(this.first(),function(a){e=a.getVal()});return e},destroy:function(){a(this,function(a,b){y(b);a.destroy()});return this}};f.fn.typeahead=function(a){return z[a]?
z[a].apply(this,[].slice.call(arguments,1)):z.initialize.apply(this,arguments)};f.fn.typeahead.noConflict=function(){f.fn.typeahead=D;return this}})()});(function(f,e){function d(a){a=a.split(/\s+/);for(var b=[],e=0,d;d=a[e];e++)d=d.charAt(0).toUpperCase(),b.push(d);return b}function b(a){return a.id&&f('label[for="'+a.id+'"]').val()||a.name}function a(d,g,k){k||(k=0);g.each(function(){var g=f(this),l=this,m=this.nodeName.toLowerCase(),n,p;"label"==m&&g.find("input, textarea, select").length&&(n=g.text(),g=g.children().first(),l=g.get(0),m=l.nodeName.toLowerCase());switch(m){case "menu":p={name:g.attr("label"),items:{}};k=a(p.items,g.children(),k);
break;case "a":case "button":p={name:g.text(),disabled:!!g.attr("disabled"),callback:function(){return function(){g.click()}}()};break;case "menuitem":case "command":switch(g.attr("type")){case e:case "command":case "menuitem":p={name:g.attr("label"),disabled:!!g.attr("disabled"),callback:function(){return function(){g.click()}}()};break;case "checkbox":p={type:"checkbox",disabled:!!g.attr("disabled"),name:g.attr("label"),selected:!!g.attr("checked")};break;case "radio":p={type:"radio",disabled:!!g.attr("disabled"),
name:g.attr("label"),radio:g.attr("radiogroup"),value:g.attr("id"),selected:!!g.attr("checked")};break;default:p=e}break;case "hr":p="-------";break;case "input":switch(g.attr("type")){case "text":p={type:"text",name:n||b(l),disabled:!!g.attr("disabled"),value:g.val()};break;case "checkbox":p={type:"checkbox",name:n||b(l),disabled:!!g.attr("disabled"),selected:!!g.attr("checked")};break;case "radio":p={type:"radio",name:n||b(l),disabled:!!g.attr("disabled"),radio:!!g.attr("name"),value:g.val(),selected:!!g.attr("checked")};
break;default:p=e}break;case "select":p={type:"select",name:n||b(l),disabled:!!g.attr("disabled"),selected:g.val(),options:{}};g.children().each(function(){p.options[this.value]=f(this).text()});break;case "textarea":p={type:"textarea",name:n||b(l),disabled:!!g.attr("disabled"),value:g.val()};break;case "label":break;default:p={type:"html",html:g.clone(!0)}}p&&(k++,d["key"+k]=p)});return k}f.support.htmlMenuitem="HTMLMenuItemElement"in window;f.support.htmlCommand="HTMLCommandElement"in window;f.support.eventSelectstart=
"onselectstart"in document.documentElement;if(!f.ui||!f.ui.widget){var g=f.cleanData;f.cleanData=function(a){for(var b=0,e;null!=(e=a[b]);b++)try{f(e).triggerHandler("remove")}catch(d){}g(a)}}var k=null,l=!1,m=f(window),n=0,p={},q={},t={},v={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,determinePosition:function(a){if(f.ui&&f.ui.position)a.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");
else{var b=this.offset();b.top+=this.outerHeight();b.left+=this.outerWidth()/2-a.outerWidth()/2;a.css(b)}},position:function(a,b,e){if(b||e){b="maintain"===b&&"maintain"===e?a.$menu.position():{top:e,left:b};e=m.scrollTop()+m.height();var d=m.scrollLeft()+m.width(),g=a.$menu.height(),f=a.$menu.width();b.top+g>e&&(b.top-=g);0>b.top&&(b.top=0);b.left+f>d&&(b.left-=f);a.$menu.css(b)}else a.determinePosition.call(this,a.$menu)},positionSubmenu:function(a){if(f.ui&&f.ui.position)a.css("display","block").position({my:"left top",
at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var b={top:0,left:this.outerWidth()};a.css(b)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:f.noop,hide:f.noop},callback:null,items:{}},w=null,y=null,K=null,D,A=function(a){for(var b=0;b=Math.max(b,parseInt(a.css("z-index"),10)||0),a=a.parent(),a&&a.length&&!(-1<"html body".indexOf(a.prop("nodeName").toLowerCase())););return b},z={abortevent:function(a){a.preventDefault();a.stopImmediatePropagation()},
contextmenu:function(a){var b=f(this);"right"==a.data.trigger&&(a.preventDefault(),a.stopImmediatePropagation());if(!("right"!=a.data.trigger&&a.originalEvent||b.hasClass("context-menu-active")||b.hasClass("context-menu-disabled"))){k=b;if(a.data.build){var e=a.data.build(k,a);if(!1===e)return;a.data=f.extend(!0,{},v,a.data,e||{});if(!a.data.items||f.isEmptyObject(a.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),Error("No Items specified");
a.data.$trigger=k;Q.create(a.data)}Q.show.call(b,a.data,a.pageX,a.pageY)}},click:function(a){a.preventDefault();a.stopImmediatePropagation();f(this).trigger(f.Event("contextmenu",{data:a.data,pageX:a.pageX,pageY:a.pageY}))},mousedown:function(a){var b=f(this);k&&k.length&&!k.is(b)&&k.data("contextMenu").$menu.trigger("contextmenu:hide");2==a.button&&(k=b.data("contextMenuActive",!0))},mouseup:function(a){var b=f(this);b.data("contextMenuActive")&&k&&k.length&&k.is(b)&&!b.hasClass("context-menu-disabled")&&
(a.preventDefault(),a.stopImmediatePropagation(),k=b,b.trigger(f.Event("contextmenu",{data:a.data,pageX:a.pageX,pageY:a.pageY})));b.removeData("contextMenuActive")},mouseenter:function(a){var b=f(this),e=f(a.relatedTarget),d=f(document);e.is(".context-menu-list")||e.closest(".context-menu-list").length||k&&k.length||(y=a.pageX,K=a.pageY,D=a.data,d.on("mousemove.contextMenuShow",z.mousemove),w=setTimeout(function(){w=null;d.off("mousemove.contextMenuShow");k=b;b.trigger(f.Event("contextmenu",{data:D,
pageX:y,pageY:K}))},a.data.delay))},mousemove:function(a){y=a.pageX;K=a.pageY},mouseleave:function(a){a=f(a.relatedTarget);if(!a.is(".context-menu-list")&&!a.closest(".context-menu-list").length){try{clearTimeout(w)}catch(b){}w=null}},layerClick:function(a){var b=f(this).data("contextMenuRoot"),e=a.button,d=a.pageX,g=a.pageY,k,l;a.preventDefault();a.stopImmediatePropagation();setTimeout(function(){var n,p="left"==b.trigger&&0===e||"right"==b.trigger&&2===e;document.elementFromPoint&&(b.$layer.hide(),
k=document.elementFromPoint(d-m.scrollLeft(),g-m.scrollTop()),b.$layer.show());if(b.reposition&&p)if(document.elementFromPoint){if(b.$trigger.is(k)||b.$trigger.has(k).length){b.position.call(b.$trigger,b,d,g);return}}else if(l=b.$trigger.offset(),n=f(window),l.top+=n.scrollTop(),l.top<=a.pageY&&(l.left+=n.scrollLeft(),l.left<=a.pageX&&(l.bottom=l.top+b.$trigger.outerHeight(),l.bottom>=a.pageY&&(l.right=l.left+b.$trigger.outerWidth(),l.right>=a.pageX)))){b.position.call(b.$trigger,b,d,g);return}if(k&&
p)b.$trigger.one("contextmenu:hidden",function(){f(k).contextMenu({x:d,y:g})});b.$menu.trigger("contextmenu:hide")},50)},keyStop:function(a,b){b.isInput||a.preventDefault();a.stopPropagation()},key:function(a){var b={};k&&(b=k.data("contextMenu")||{});switch(a.keyCode){case 9:case 38:if(z.keyStop(a,b),b.isInput){if(9==a.keyCode&&a.shiftKey){a.preventDefault();b.$selected&&b.$selected.find("input, textarea, select").blur();b.$menu.trigger("prevcommand");return}if(38==a.keyCode&&"checkbox"==b.$selected.find("input, textarea, select").prop("type")){a.preventDefault();
return}}else if(9!=a.keyCode||a.shiftKey){b.$menu.trigger("prevcommand");return}case 40:z.keyStop(a,b);if(b.isInput){if(9==a.keyCode){a.preventDefault();b.$selected&&b.$selected.find("input, textarea, select").blur();b.$menu.trigger("nextcommand");return}if(40==a.keyCode&&"checkbox"==b.$selected.find("input, textarea, select").prop("type")){a.preventDefault();return}}else{b.$menu.trigger("nextcommand");return}break;case 37:z.keyStop(a,b);if(b.isInput||!b.$selected||!b.$selected.length)break;if(!b.$selected.parent().hasClass("context-menu-root")){a=
b.$selected.parent().parent();b.$selected.trigger("contextmenu:blur");b.$selected=a;return}break;case 39:z.keyStop(a,b);if(b.isInput||!b.$selected||!b.$selected.length)break;var e=b.$selected.data("contextMenu")||{};if(e.$menu&&b.$selected.hasClass("context-menu-submenu")){b.$selected=null;e.$selected=null;e.$menu.trigger("nextcommand");return}break;case 35:case 36:b.$selected&&b.$selected.find("input, textarea, select").length||((b.$selected&&b.$selected.parent()||b.$menu).children(":not(.disabled, .not-selectable)")[36==
a.keyCode?"first":"last"]().trigger("contextmenu:focus"),a.preventDefault());return;case 13:z.keyStop(a,b);if(b.isInput){if(b.$selected&&!b.$selected.is("textarea, select")){a.preventDefault();return}break}b.$selected&&b.$selected.trigger("mouseup");return;case 32:case 33:case 34:z.keyStop(a,b);return;case 27:z.keyStop(a,b);b.$menu.trigger("contextmenu:hide");return;default:if(e=String.fromCharCode(a.keyCode).toUpperCase(),b.accesskeys&&b.accesskeys[e]){b.accesskeys[e].$node.trigger(b.accesskeys[e].$menu?
"contextmenu:focus":"mouseup");return}}a.stopPropagation();b.$selected&&b.$selected.trigger(a)},prevItem:function(a){a.stopPropagation();var b=f(this).data("contextMenu")||{};if(b.$selected){var e=b.$selected,b=b.$selected.parent().data("contextMenu")||{};b.$selected=e}for(var e=b.$menu.children(),d=b.$selected&&b.$selected.prev().length?b.$selected.prev():e.last(),g=d;d.hasClass("disabled")||d.hasClass("not-selectable");)if(d=d.prev().length?d.prev():e.last(),d.is(g))return;b.$selected&&z.itemMouseleave.call(b.$selected.get(0),
a);z.itemMouseenter.call(d.get(0),a);a=d.find("input, textarea, select");a.length&&a.focus()},nextItem:function(a){a.stopPropagation();var b=f(this).data("contextMenu")||{};if(b.$selected){var e=b.$selected,b=b.$selected.parent().data("contextMenu")||{};b.$selected=e}for(var e=b.$menu.children(),d=b.$selected&&b.$selected.next().length?b.$selected.next():e.first(),g=d;d.hasClass("disabled")||d.hasClass("not-selectable");)if(d=d.next().length?d.next():e.first(),d.is(g))return;b.$selected&&z.itemMouseleave.call(b.$selected.get(0),
a);z.itemMouseenter.call(d.get(0),a);a=d.find("input, textarea, select");a.length&&a.focus()},focusInput:function(a){a=f(this).closest(".context-menu-item");var b=a.data(),e=b.contextMenu,b=b.contextMenuRoot;b.$selected=e.$selected=a;b.isInput=e.isInput=!0},blurInput:function(a){a=f(this).closest(".context-menu-item").data();a.contextMenuRoot.isInput=a.contextMenu.isInput=!1},menuMouseenter:function(a){f(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(a){var b=f(this).data().contextMenuRoot;
b.$layer&&b.$layer.is(a.relatedTarget)&&(b.hovering=!1)},itemMouseenter:function(a){var b=f(this),e=b.data(),d=e.contextMenu,e=e.contextMenuRoot;e.hovering=!0;a&&e.$layer&&e.$layer.is(a.relatedTarget)&&(a.preventDefault(),a.stopImmediatePropagation());(d.$menu?d:e).$menu.children(".hover").trigger("contextmenu:blur");b.hasClass("disabled")||b.hasClass("not-selectable")?d.$selected=null:b.trigger("contextmenu:focus")},itemMouseleave:function(a){var b=f(this),e=b.data(),d=e.contextMenu,e=e.contextMenuRoot;
e!==d&&e.$layer&&e.$layer.is(a.relatedTarget)?(e.$selected&&e.$selected.trigger("contextmenu:blur"),a.preventDefault(),a.stopImmediatePropagation(),e.$selected=d.$selected=d.$node):b.trigger("contextmenu:blur")},itemClick:function(a){var b=f(this),e=b.data(),d=e.contextMenuRoot,g=e.contextMenuKey;if(e.contextMenu.items[g]&&!b.is(".disabled, .context-menu-submenu, .context-menu-separator, .not-selectable")){a.preventDefault();a.stopImmediatePropagation();if(f.isFunction(d.callbacks[g])&&Object.prototype.hasOwnProperty.call(d.callbacks,
g))a=d.callbacks[g];else if(f.isFunction(d.callback))a=d.callback;else return;!1!==a.call(d.$trigger,g,d)?d.$menu.trigger("contextmenu:hide"):d.$menu.parent().length&&Q.update.call(d.$trigger,d)}},inputClick:function(a){a.stopImmediatePropagation()},hideMenu:function(a,b){var e=f(this).data("contextMenuRoot");Q.hide.call(e.$trigger,e,b&&b.force)},focusItem:function(a){a.stopPropagation();a=f(this);var b=a.data(),e=b.contextMenu,b=b.contextMenuRoot;a.addClass("hover").siblings(".hover").trigger("contextmenu:blur");
e.$selected=b.$selected=a;e.$node&&b.positionSubmenu.call(e.$node,e.$menu)},blurItem:function(a){a.stopPropagation();a=f(this);var b=a.data().contextMenu;a.removeClass("hover");b.$selected=null}},Q={show:function(a,b,e){var d=f(this),g={};f("#context-menu-layer").trigger("mousedown");a.$trigger=d;if(!1===a.events.show.call(d,a))k=null;else if(Q.update.call(d,a),a.position.call(d,a,b,e),a.zIndex&&(g.zIndex=A(d)+a.zIndex),Q.layer.call(a.$menu,a,g.zIndex),a.$menu.find("ul").css("zIndex",g.zIndex+1),
a.$menu.css(g)[a.animation.show](a.animation.duration,function(){d.trigger("contextmenu:visible")}),d.data("contextMenu",a).addClass("context-menu-active"),f(document).off("keydown.contextMenu").on("keydown.contextMenu",z.key),a.autoHide)f(document).on("mousemove.contextMenuAutoHide",function(b){var e=d.offset();e.right=e.left+d.outerWidth();e.bottom=e.top+d.outerHeight();!a.$layer||a.hovering||b.pageX>=e.left&&b.pageX<=e.right&&b.pageY>=e.top&&b.pageY<=e.bottom||a.$menu.trigger("contextmenu:hide")})},
hide:function(a,b){var d=f(this);a||(a=d.data("contextMenu")||{});if(b||!a.events||!1!==a.events.hide.call(d,a)){d.removeData("contextMenu").removeClass("context-menu-active");if(a.$layer){setTimeout(function(a){return function(){a.remove()}}(a.$layer),10);try{delete a.$layer}catch(g){a.$layer=null}}k=null;a.$menu.find(".hover").trigger("contextmenu:blur");a.$selected=null;f(document).off(".contextMenuAutoHide").off("keydown.contextMenu");a.$menu&&a.$menu[a.animation.hide](a.animation.duration,function(){a.build&&
(a.$menu.remove(),f.each(a,function(b,d){switch(b){case "ns":case "selector":case "build":case "trigger":return!0;default:a[b]=e;try{delete a[b]}catch(g){}return!0}}));setTimeout(function(){d.trigger("contextmenu:hidden")},10)})}},create:function(a,b){b===e&&(b=a);a.$menu=f('<ul class="context-menu-list"></ul>').addClass(a.className||"").data({contextMenu:a,contextMenuRoot:b});f.each(["callbacks","commands","inputs"],function(e,d){a[d]={};b[d]||(b[d]={})});b.accesskeys||(b.accesskeys={});f.each(a.items,
function(e,g){var k=f('<li class="context-menu-item"></li>').addClass(g.className||""),l=null,m=null;k.on("click",f.noop);g.$node=k.data({contextMenu:a,contextMenuRoot:b,contextMenuKey:e});if(g.accesskey)for(var n=d(g.accesskey),p=0,q;q=n[p];p++)if(!b.accesskeys[q]){b.accesskeys[q]=g;g._name=g.name.replace(new RegExp("("+q+")","i"),'<span class="context-menu-accesskey">$1</span>');break}if("string"==typeof g)k.addClass("context-menu-separator not-selectable");else if(g.type&&t[g.type])t[g.type].call(k,
g,a,b),f.each([a,b],function(a,b){b.commands[e]=g;f.isFunction(g.callback)&&(b.callbacks[e]=g.callback)});else{"html"==g.type?k.addClass("context-menu-html not-selectable"):g.type?(l=f("<label></label>").appendTo(k),f("<span></span>").text(g._name||g.name).appendTo(l),k.addClass("context-menu-input"),a.hasTypes=!0,f.each([a,b],function(a,b){b.commands[e]=g;b.inputs[e]=g})):g.items&&(g.type="sub");switch(g.type){case "text":m=f('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+
e).val(g.value||"").appendTo(l);break;case "textarea":m=f('<textarea name=""></textarea>').attr("name","context-menu-input-"+e).val(g.value||"").appendTo(l);g.height&&m.height(g.height);break;case "checkbox":m=f('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+e).val(g.value||"").prop("checked",!!g.selected).prependTo(l);break;case "radio":m=f('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+g.radio).val(g.value||"").prop("checked",
!!g.selected).prependTo(l);break;case "select":m=f('<select name="">').attr("name","context-menu-input-"+e).appendTo(l);g.options&&(f.each(g.options,function(a,b){f("<option></option>").val(a).text(b).appendTo(m)}),m.val(g.selected));break;case "sub":f("<span></span>").text(g._name||g.name).appendTo(k);g.appendTo=g.$node;Q.create(g,b);k.data("contextMenu",g).addClass("context-menu-submenu");g.callback=null;break;case "html":f(g.html).appendTo(k);break;default:f.each([a,b],function(a,b){b.commands[e]=
g;f.isFunction(g.callback)&&(b.callbacks[e]=g.callback)}),f("<span></span>").text(g._name||g.name||"").appendTo(k)}if(g.type&&"sub"!=g.type&&"html"!=g.type&&(m.on("focus",z.focusInput).on("blur",z.blurInput),g.events))m.on(g.events,a);g.icon&&k.addClass("icon icon-"+g.icon)}g.$input=m;g.$label=l;k.appendTo(a.$menu);if(!a.hasTypes&&f.support.eventSelectstart)k.on("selectstart.disableTextSelect",z.abortevent)});a.$node||a.$menu.css("display","none").addClass("context-menu-root");a.$menu.appendTo(a.appendTo||
document.body)},resize:function(a,b){a.css({position:"absolute",display:"block"});a.data("width",Math.ceil(a.width())+1);a.css({position:"static",minWidth:"0px",maxWidth:"100000px"});a.find("> li > ul").each(function(){Q.resize(f(this),!0)});b||a.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).width(function(){return f(this).data("width")})},update:function(a,b){var d=this;b===e&&(b=a,Q.resize(a.$menu));a.$menu.children().each(function(){var e=f(this),g=e.data("contextMenuKey"),
k=a.items[g],g=f.isFunction(k.disabled)&&k.disabled.call(d,g,b)||!0===k.disabled;e[g?"addClass":"removeClass"]("disabled");if(k.type)switch(e.find("input, select, textarea").prop("disabled",g),k.type){case "text":case "textarea":k.$input.val(k.value||"");break;case "checkbox":case "radio":k.$input.val(k.value||"").prop("checked",!!k.selected);break;case "select":k.$input.val(k.selected||"")}k.$menu&&Q.update.call(d,k,b)})},layer:function(a,b){var d=a.$layer=f('<div id="context-menu-layer" style="position:fixed; z-index:'+
b+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:m.height(),width:m.width(),display:"block"}).data("contextMenuRoot",a).insertBefore(this).on("contextmenu",z.abortevent).on("mousedown",z.layerClick);document.body.style.maxWidth===e&&d.css({position:"absolute",height:f(document).height()});return d}};f.fn.contextMenu=function(a){a===e?this.first().trigger("contextmenu"):a.x&&a.y?this.first().trigger(f.Event("contextmenu",{pageX:a.x,pageY:a.y})):
"hide"===a?(a=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null)&&a.trigger("contextmenu:hide"):"destroy"===a?f.contextMenu("destroy",{context:this}):f.isPlainObject(a)?(a.context=this,f.contextMenu("create",a)):a?this.removeClass("context-menu-disabled"):a||this.addClass("context-menu-disabled");return this};f.contextMenu=function(a,b){"string"!=typeof a&&(b=a,a="create");"string"==typeof b?b={selector:b}:b===e&&(b={});var d=f.extend(!0,{},v,b||{}),g=f(document),k=g,m=
!1;d.context&&d.context.length?(k=f(d.context).first(),d.context=k.get(0),m=d.context!==document):d.context=document;switch(a){case "create":if(!d.selector)throw Error("No selector specified");if(d.selector.match(/.context-menu-(list|item|input)($|\s)/))throw Error('Cannot bind to selector "'+d.selector+'" as it contains a reserved className');if(!d.build&&(!d.items||f.isEmptyObject(d.items)))throw Error("No Items specified");n++;d.ns=".contextMenu"+n;m||(p[d.selector]=d.ns);q[d.ns]=d;d.trigger||
(d.trigger="right");l||(g.on({"contextmenu:hide.contextMenu":z.hideMenu,"prevcommand.contextMenu":z.prevItem,"nextcommand.contextMenu":z.nextItem,"contextmenu.contextMenu":z.abortevent,"mouseenter.contextMenu":z.menuMouseenter,"mouseleave.contextMenu":z.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",z.inputClick).on({"mouseup.contextMenu":z.itemClick,"contextmenu:focus.contextMenu":z.focusItem,"contextmenu:blur.contextMenu":z.blurItem,"contextmenu.contextMenu":z.abortevent,
"mouseenter.contextMenu":z.itemMouseenter,"mouseleave.contextMenu":z.itemMouseleave},".context-menu-item"),l=!0);k.on("contextmenu"+d.ns,d.selector,d,z.contextmenu);if(m)k.on("remove"+d.ns,function(){f(this).contextMenu("destroy")});switch(d.trigger){case "hover":k.on("mouseenter"+d.ns,d.selector,d,z.mouseenter).on("mouseleave"+d.ns,d.selector,d,z.mouseleave);break;case "left":k.on("click"+d.ns,d.selector,d,z.click)}d.build||Q.create(d);break;case "destroy":var w;if(m){var t=d.context;f.each(q,function(a,
b){if(b.context!==t)return!0;w=f(".context-menu-list").filter(":visible");w.length&&w.data().contextMenuRoot.$trigger.is(f(b.context).find(b.selector))&&w.trigger("contextmenu:hide",{force:!0});try{q[b.ns].$menu&&q[b.ns].$menu.remove(),delete q[b.ns]}catch(d){q[b.ns]=null}f(b.context).off(b.ns);return!0})}else if(!d.selector)g.off(".contextMenu .contextMenuAutoHide"),f.each(q,function(a,b){f(b.context).off(b.ns)}),p={},q={},n=0,l=!1,f("#context-menu-layer, .context-menu-list").remove();else if(p[d.selector]){w=
f(".context-menu-list").filter(":visible");w.length&&w.data().contextMenuRoot.$trigger.is(d.selector)&&w.trigger("contextmenu:hide",{force:!0});try{q[p[d.selector]].$menu&&q[p[d.selector]].$menu.remove(),delete q[p[d.selector]]}catch(A){q[p[d.selector]]=null}g.off(p[d.selector])}break;case "html5":(!f.support.htmlCommand&&!f.support.htmlMenuitem||"boolean"==typeof b&&b)&&f('menu[type="context"]').each(function(){this.id&&f.contextMenu({selector:"[contextmenu="+this.id+"]",items:f.contextMenu.fromMenu(this)})}).css("display",
"none");break;default:throw Error('Unknown operation "'+a+'"');}return this};f.contextMenu.setInputValues=function(a,b){b===e&&(b={});f.each(a.inputs,function(a,d){switch(d.type){case "text":case "textarea":d.value=b[a]||"";break;case "checkbox":d.selected=b[a]?!0:!1;break;case "radio":d.selected=(b[d.radio]||"")==d.value?!0:!1;break;case "select":d.selected=b[a]||""}})};f.contextMenu.getInputValues=function(a,b){b===e&&(b={});f.each(a.inputs,function(a,d){switch(d.type){case "text":case "textarea":case "select":b[a]=
d.$input.val();break;case "checkbox":b[a]=d.$input.prop("checked");break;case "radio":d.$input.prop("checked")&&(b[d.radio]=d.value)}});return b};f.contextMenu.fromMenu=function(b){b=f(b);var d={};a(d,b.children());return d};f.contextMenu.defaults=v;f.contextMenu.types=t;f.contextMenu.handle=z;f.contextMenu.op=Q;f.contextMenu.menus=q})(jQuery);!function(){function f(h,a){return a>h?-1:h>a?1:h>=a?0:0/0}function e(h){return null===h?0/0:+h}function d(h){return!isNaN(h)}function b(h){return{left:function(a,b,d,e){3>arguments.length&&(d=0);for(4>arguments.length&&(e=a.length);e>d;){var g=d+e>>>1;0>h(a[g],b)?d=g+1:e=g}return d},right:function(a,b,d,e){3>arguments.length&&(d=0);for(4>arguments.length&&(e=a.length);e>d;){var g=d+e>>>1;0<h(a[g],b)?e=g:d=g+1}return d}}}function a(h){return h.length}function g(h,a){for(var b in a)Object.defineProperty(h.prototype,
b,{value:a[b],enumerable:!1})}function k(){this._=Object.create(null)}function l(h){return(h+="")===tg||h[0]===Lc?Lc+h:h}function m(h){return(h+="")[0]===Lc?h.slice(1):h}function n(h){return l(h)in this._}function p(h){return(h=l(h))in this._&&delete this._[h]}function q(){var h=[],a;for(a in this._)h.push(m(a));return h}function t(){var h=0,a;for(a in this._)++h;return h}function v(){for(var h in this._)return!1;return!0}function w(){this._=Object.create(null)}function y(h,a,b){return function(){var d=
b.apply(a,arguments);return d===a?h:d}}function K(h,a){if(a in h)return a;a=a.charAt(0).toUpperCase()+a.slice(1);for(var b=0,d=Wd.length;d>b;++b){var e=Wd[b]+a;if(e in h)return e}}function D(){}function A(){}function z(h){function a(){for(var x,d=b,e=-1,g=d.length;++e<g;)(x=d[e].on)&&x.apply(this,arguments);return h}var b=[],d=new k;return a.on=function(a,x){var e,g=d.get(a);return 2>arguments.length?g&&g.on:(g&&(g.on=null,b=b.slice(0,e=b.indexOf(g)).concat(b.slice(e+1)),d.remove(a)),x&&b.push(d.set(a,
{on:x})),h)},a}function Q(){r.event.preventDefault()}function T(){for(var h,a=r.event;h=a.sourceEvent;)a=h;return a}function da(h){for(var a=new A,b=0,d=arguments.length;++b<d;)a[arguments[b]]=z(a);return a.of=function(b,E){return function(d){try{var e=d.sourceEvent=r.event;d.target=h;r.event=d;a[d.type].apply(b,E)}finally{r.event=e}}},a}function ma(h){return Mb(h,R),h}function W(h){return"function"==typeof h?h:function(){return Mc(h,this)}}function vb(h){return"function"==typeof h?h:function(){return Nc(h,
this)}}function Td(h,a){function b(){this.removeAttribute(h)}function d(){this.removeAttributeNS(h.space,h.local)}function e(){this.setAttribute(h,a)}function g(){this.setAttributeNS(h.space,h.local,a)}function f(){var b=a.apply(this,arguments);null==b?this.removeAttribute(h):this.setAttribute(h,b)}function M(){var b=a.apply(this,arguments);null==b?this.removeAttributeNS(h.space,h.local):this.setAttributeNS(h.space,h.local,b)}return h=r.ns.qualify(h),null==a?h.local?d:b:"function"==typeof a?h.local?
M:f:h.local?g:e}function Ud(h){return h.trim().replace(/\s+/g," ")}function Qa(h){return new RegExp("(?:^|\\s+)"+r.requote(h)+"(?:\\s+|$)","g")}function Vd(h,a){function b(){for(var E=-1;++E<e;)h[E](this,a)}function d(){for(var b=-1,E=a.apply(this,arguments);++b<e;)h[b](this,E)}h=(h+"").trim().split(/^|\s+/).map(Lb);var e=h.length;return"function"==typeof a?d:b}function Lb(h){var a=Qa(h);return function(b,d){if(e=b.classList)return d?e.add(h):e.remove(h);var e=b.getAttribute("class")||"";d?(a.lastIndex=
0,a.test(e)||b.setAttribute("class",Ud(e+" "+h))):b.setAttribute("class",Ud(e.replace(a," ")))}}function wb(h,a,b){function d(){this.style.removeProperty(h)}function e(){this.style.setProperty(h,a,b)}function g(){var d=a.apply(this,arguments);null==d?this.style.removeProperty(h):this.style.setProperty(h,d,b)}return null==a?d:"function"==typeof a?g:e}function Z(h,a){function b(){delete this[h]}function d(){this[h]=a}function e(){var b=a.apply(this,arguments);null==b?delete this[h]:this[h]=b}return null==
a?b:"function"==typeof a?e:d}function Ga(h){return"function"==typeof h?h:(h=r.ns.qualify(h)).local?function(){return this.ownerDocument.createElementNS(h.space,h.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,h)}}function wa(h){return function(){return Yd(this,h)}}function ug(h){return arguments.length||(h=f),function(a,b){return a&&b?h(a.__data__,b.__data__):!a-!b}}function Ha(h,a){for(var b=0,d=h.length;d>b;b++)for(var e,g=h[b],f=0,M=g.length;M>f;f++)(e=g[f])&&a(e,
f,b);return h}function Zd(h){return Mb(h,Ia),h}function vg(h){var a,b;return function(d,e,g){d=h[g].update;var f=d.length;g!=b&&(b=g,a=0);for(e>=a&&(a=e+1);!(e=d[a])&&++a<f;);return e}}function Nb(){var h=this.__transition__;h&&++h.active}function $d(h,a,b){function d(){var a=this[f];a&&(this.removeEventListener(h,a,a.$),delete this[f])}function e(){var g=k(a,Ra(arguments));d.call(this);this.addEventListener(h,this[f]=g,g.$=b);g._=a}function g(){var a,b=new RegExp("^__on([^.]+)"+r.requote(h)+"$"),
x;for(x in this)if(a=x.match(b)){var E=this[x];this.removeEventListener(a[1],E,E.$);delete this[x]}}var f="__on"+h,M=h.indexOf("."),k=ae;0<M&&(h=h.slice(0,M));var l=Oc.get(h);return l&&(h=l,k=wg),M?a?e:d:a?D:g}function ae(h,a){return function(b){var d=r.event;r.event=b;a[0]=this.__data__;try{h.apply(this,a)}finally{r.event=d}}}function wg(h,a){var b=ae(h,a);return function(h){var a=h.relatedTarget;a&&(a===this||8&a.compareDocumentPosition(this))||b.call(this,h)}}function Ob(){var h=".dragsuppress-"+
++xg,a="click"+h,b=r.select(ha).on("touchmove"+h,Q).on("dragstart"+h,Q).on("selectstart"+h,Q);if(xb){var d=Ja.style,e=d[xb];d[xb]="none"}return function(g){function f(){b.on(a,null)}b.on(h,null);xb&&(d[xb]=e);g&&(b.on(a,function(){Q();f()},!0),setTimeout(f,0))}}function Pc(h,a){a.changedTouches&&(a=a.changedTouches[0]);var b=h.ownerSVGElement||h;if(b.createSVGPoint){var d=b.createSVGPoint();if(0>Qc&&(ha.scrollX||ha.scrollY)){var b=r.select("body").append("svg").style({position:"absolute",top:0,left:0,
margin:0,padding:0,border:"none"},"important"),e=b[0][0].getScreenCTM();Qc=!(e.f||e.e);b.remove()}return Qc?(d.x=a.pageX,d.y=a.pageY):(d.x=a.clientX,d.y=a.clientY),d=d.matrixTransform(h.getScreenCTM().inverse()),[d.x,d.y]}b=h.getBoundingClientRect();return[a.clientX-b.left-h.clientLeft,a.clientY-b.top-h.clientTop]}function yg(){return r.event.changedTouches[0].identifier}function zg(){return r.event.target}function Ag(){return ha}function Rc(h,a,b){return(a[0]-h[0])*(b[1]-h[1])-(a[1]-h[1])*(b[0]-
h[0])}function be(h){return 1<h?0:-1>h?I:Math.acos(h)}function ib(h){return 1<h?ea:-1>h?-ea:Math.asin(h)}function ce(h){return((h=Math.exp(h))+1/h)/2}function de(h){return(h=Math.sin(h/2))*h}function Za(){}function Ca(h,a,b){return this instanceof Ca?(this.h=+h,this.s=+a,void(this.l=+b)):2>arguments.length?h instanceof Ca?new Ca(h.h,h.s,h.l):ee(""+h,fe,Ca):new Ca(h,a,b)}function Sc(h,a,b){function d(h){return 360<h?h-=360:0>h&&(h+=360),60>h?e+(g-e)*h/60:180>h?g:240>h?e+(g-e)*(240-h)/60:e}var e,g;
return h=isNaN(h)?0:0>(h%=360)?h+360:h,a=isNaN(a)?0:0>a?0:1<a?1:a,b=0>b?0:1<b?1:b,g=.5>=b?b*(1+a):b+a-b*a,e=2*b-g,new ia(Math.round(255*d(h+120)),Math.round(255*d(h)),Math.round(255*d(h-120)))}function xa(h,a,b){return this instanceof xa?(this.h=+h,this.c=+a,void(this.l=+b)):2>arguments.length?h instanceof xa?new xa(h.h,h.c,h.l):h instanceof ya?ge(h.l,h.a,h.b):ge((h=he((h=r.rgb(h)).r,h.g,h.b)).l,h.a,h.b):new xa(h,a,b)}function Tc(h,a,b){return isNaN(h)&&(h=0),isNaN(a)&&(a=0),new ya(b,Math.cos(h*=
H)*a,Math.sin(h)*a)}function ya(h,a,b){return this instanceof ya?(this.l=+h,this.a=+a,void(this.b=+b)):2>arguments.length?h instanceof ya?new ya(h.l,h.a,h.b):h instanceof xa?Tc(h.h,h.c,h.l):he((h=ia(h)).r,h.g,h.b):new ya(h,a,b)}function ie(h,a,b){h=(h+16)/116;a=h+a/500;b=h-b/200;return a=Uc(a)*je,h=Uc(h)*ke,b=Uc(b)*le,new ia(Vc(3.2404542*a-1.5371385*h-.4985314*b),Vc(-.969266*a+1.8760108*h+.041556*b),Vc(.0556434*a-.2040259*h+1.0572252*b))}function ge(h,a,b){return 0<h?new xa(Math.atan2(b,a)*X,Math.sqrt(a*
a+b*b),h):new xa(0/0,0/0,h)}function Uc(h){return.206893034<h?h*h*h:(h-4/29)/7.787037}function Wc(h){return.008856<h?Math.pow(h,1/3):7.787037*h+4/29}function Vc(h){return Math.round(255*(.00304>=h?12.92*h:1.055*Math.pow(h,1/2.4)-.055))}function ia(h,a,b){return this instanceof ia?(this.r=~~h,this.g=~~a,void(this.b=~~b)):2>arguments.length?h instanceof ia?new ia(h.r,h.g,h.b):ee(""+h,ia,Sc):new ia(h,a,b)}function Pb(h){return new ia(h>>16,255&h>>8,255&h)+""}function jb(h){return 16>h?"0"+Math.max(0,
h).toString(16):Math.min(255,h).toString(16)}function ee(h,a,b){var d,e,g,f=0,M=0,k=0;if(d=/([a-z]+)\((.*)\)/i.exec(h))switch(e=d[2].split(","),d[1]){case "hsl":return b(parseFloat(e[0]),parseFloat(e[1])/100,parseFloat(e[2])/100);case "rgb":return a(Xc(e[0]),Xc(e[1]),Xc(e[2]))}return(g=Qb.get(h))?a(g.r,g.g,g.b):(null==h||"#"!==h.charAt(0)||isNaN(g=parseInt(h.slice(1),16))||(4===h.length?(f=(3840&g)>>4,f|=f>>4,M=240&g,M|=M>>4,k=15&g,k|=k<<4):7===h.length&&(f=(16711680&g)>>16,M=(65280&g)>>8,k=255&g)),
a(f,M,k))}function fe(h,a,b){var d,e,g=Math.min(h/=255,a/=255,b/=255),f=Math.max(h,a,b),M=f-g,k=(f+g)/2;return M?(e=.5>k?M/(f+g):M/(2-f-g),d=h==f?(a-b)/M+(b>a?6:0):a==f?(b-h)/M+2:(h-a)/M+4,d*=60):(d=0/0,e=0<k&&1>k?0:d),new Ca(d,e,k)}function he(h,a,b){h=Yc(h);a=Yc(a);b=Yc(b);var d=Wc((.4124564*h+.3575761*a+.1804375*b)/je),e=Wc((.2126729*h+.7151522*a+.072175*b)/ke);h=Wc((.0193339*h+.119192*a+.9503041*b)/le);return ya(116*e-16,500*(d-e),200*(e-h))}function Yc(h){return.04045>=(h/=255)?h/12.92:Math.pow((h+
.055)/1.055,2.4)}function Xc(h){var a=parseFloat(h);return"%"===h.charAt(h.length-1)?Math.round(2.55*a):a}function V(h){return"function"==typeof h?h:function(){return h}}function ca(h){return h}function Zc(h){return function(a,b,d){return 2===arguments.length&&"function"==typeof b&&(d=b,b=null),Rb(a,b,h,d)}}function Rb(h,a,b,d){function e(){var h,a=k.status,x;if(x=!a)x=(x=k.responseType)&&"text"!==x?k.response:k.responseText;if(x||200<=a&&300>a||304===a){try{h=b.call(g,k)}catch(d){return f.error.call(g,
d),void 0}f.load.call(g,h)}else f.error.call(g,k)}var g={},f=r.dispatch("beforesend","progress","load","error"),M={},k=new XMLHttpRequest,l=null;return!ha.XDomainRequest||"withCredentials"in k||!/^(http(s)?:)?\/\//.test(h)||(k=new XDomainRequest),"onload"in k?k.onload=k.onerror=e:k.onreadystatechange=function(){3<k.readyState&&e()},k.onprogress=function(h){var a=r.event;r.event=h;try{f.progress.call(g,k)}finally{r.event=a}},g.header=function(h,a){return h=(h+"").toLowerCase(),2>arguments.length?M[h]:
(null==a?delete M[h]:M[h]=a+"",g)},g.mimeType=function(h){return arguments.length?(a=null==h?null:h+"",g):a},g.responseType=function(h){return arguments.length?(l=h,g):l},g.response=function(h){return b=h,g},["get","post"].forEach(function(h){g[h]=function(){return g.send.apply(g,[h].concat(Ra(arguments)))}}),g.send=function(b,d,e){if(2===arguments.length&&"function"==typeof d&&(e=d,d=null),k.open(b,h,!0),null==a||"accept"in M||(M.accept=a+",*/*"),k.setRequestHeader)for(var E in M)k.setRequestHeader(E,
M[E]);return null!=a&&k.overrideMimeType&&k.overrideMimeType(a),null!=l&&(k.responseType=l),null!=e&&g.on("error",e).on("load",function(h){e(null,h)}),f.beforesend.call(g,k),k.send(null==d?null:d),g},g.abort=function(){return k.abort(),g},r.rebind(g,f,"on"),null==d?g:g.get(Bg(d))}function Bg(h){return 1===h.length?function(a,b){h(null==a?b:null)}:h}function $c(){var h=me(),h=ne()-h;24<h?(isFinite(h)&&(clearTimeout(Sb),Sb=setTimeout($c,h)),Tb=0):(Tb=1,oe($c))}function me(){var h=Date.now();for(Ka=
Ub;Ka;)h>=Ka.t&&(Ka.f=Ka.c(h-Ka.t)),Ka=Ka.n;return h}function ne(){for(var h,a=Ub,b=1/0;a;)a.f?a=h?h.n=a.n:Ub=a.n:(a.t<b&&(b=a.t),a=(h=a).n);return Vb=h,b}function ad(h,a){return a-(h?Math.ceil(Math.log(h)/Math.LN10):1)}function Cg(h){var a=h.decimal,b=h.thousands,d=h.grouping,e=h.currency,g=d&&b?function(h,a){for(var x=h.length,e=[],g=0,N=d[0],f=0;0<x&&0<N&&(f+N+1>a&&(N=Math.max(1,a-f)),e.push(h.substring(x-=N,x+N)),!((f+=N+1)>a));)N=d[g=(g+1)%d.length];return e.reverse().join(b)}:ca;return function(h){h=
pe.exec(h);var b=h[1]||" ",d=h[2]||">",E=h[3]||"-",J=h[4]||"",f=h[5],k=+h[6],l=h[7],m=h[8],n=h[9],p=1,q="",w="",O=!1,t=!0;switch(m&&(m=+m.substring(1)),(f||"0"===b&&"="===d)&&(f=b="0",d="="),n){case "n":l=!0;n="g";break;case "%":p=100;w="%";n="f";break;case "p":p=100;w="%";n="r";break;case "b":case "o":case "x":case "X":"#"===J&&(q="0"+n.toLowerCase());case "c":t=!1;case "d":O=!0;m=0;break;case "s":p=-1,n="r"}"$"===J&&(q=e[0],w=e[1]);"r"!=n||m||(n="g");null!=m&&("g"==n?m=Math.max(1,Math.min(21,m)):
("e"==n||"f"==n)&&(m=Math.max(0,Math.min(20,m))));var n=Dg.get(n)||Eg,v=f&&l;return function(h){var e=w;if(O&&h%1)return"";var J=0>h||0===h&&0>1/h?(h=-h,"-"):"-"===E?"":E;0>p?(e=r.formatPrefix(h,m),h=e.scale(h),e=e.symbol+w):h*=p;h=n(h,m);var P,fa,aa=h.lastIndexOf(".");0>aa?(aa=t?h.lastIndexOf("e"):-1,0>aa?(P=h,fa=""):(P=h.substring(0,aa),fa=h.substring(aa))):(P=h.substring(0,aa),fa=a+h.substring(aa+1));!f&&l&&(P=g(P,1/0));var aa=q.length+P.length+fa.length+(v?0:J.length),A=k>aa?Array(aa=k-aa+1).join(b):
"";return v&&(P=g(A+P,A.length?k-fa.length:1/0)),J+=q,h=P+fa,("<"===d?J+h+A:">"===d?A+J+h:"^"===d?A.substring(0,aa>>=1)+J+h+A.substring(aa):J+(v?h:A+h))+e}}}function Eg(h){return h+""}function La(){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):arguments[0])}function $a(h,a,b){function d(a){var b=h(a),x=g(b,1);return x-a>a-b?b:x}function e(b){return a(b=h(new ga(b-1)),1),b}function g(h,b){return a(h=new ga(+h),b),h}function f(h,d,g){h=e(h);var J=[];if(1<g)for(;d>h;)b(h)%g||J.push(new Date(+h)),
a(h,1);else for(;d>h;)J.push(new Date(+h)),a(h,1);return J}h.floor=h;h.round=d;h.ceil=e;h.offset=g;h.range=f;var k=h.utc=Yb(h);return k.floor=k,k.round=Yb(d),k.ceil=Yb(e),k.offset=Yb(g),k.range=function(h,a,b){try{ga=La;var x=new La;return x._=h,f(x,a,b)}finally{ga=Date}},h}function Yb(h){return function(a,b){try{ga=La;var d=new La;return d._=a,h(d,b)._}finally{ga=Date}}}function Fg(h){function a(h){function x(a){for(var b,e,E,g=[],J=-1,N=0;++J<d;)37===h.charCodeAt(J)&&(g.push(h.slice(N,J)),null!=
(e=qe[b=h.charAt(++J)])&&(b=h.charAt(++J)),(E=t[b])&&(b=E(a,null==e?"e"===b?" ":"0":e)),g.push(b),N=J+1);return g.push(h.slice(N,J)),g.join("")}var d=h.length;return x.parse=function(a){var x={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(b(x,h,a,0)!=a.length)return null;"p"in x&&(x.H=x.H%12+12*x.p);a=null!=x.Z&&ga!==La;var d=new (a?La:ga);return"j"in x?d.setFullYear(x.y,0,x.j):"w"in x&&("W"in x||"U"in x)?(d.setFullYear(x.y,0,1),d.setFullYear(x.y,0,"W"in x?(x.w+6)%7+7*x.W-(d.getDay()+5)%7:x.w+7*x.U-(d.getDay()+
6)%7)):d.setFullYear(x.y,x.m,x.d),d.setHours(x.H+(0|x.Z/100),x.M+x.Z%100,x.S,x.L),a?d._:d},x.toString=function(){return h},x}function b(h,a,x,d){for(var e,E,g,J=0,N=a.length,f=x.length;N>J;){if(d>=f)return-1;if(e=a.charCodeAt(J++),37===e){if(g=a.charAt(J++),E=v[g in qe?a.charAt(J++):g],!E||0>(d=E(h,x,d)))return-1}else if(e!=x.charCodeAt(d++))return-1}return d}var d=h.dateTime,e=h.date,g=h.time,f=h.periods,k=h.days,l=h.shortDays,na=h.months,m=h.shortMonths;a.utc=function(h){function b(h){try{ga=La;
var a=new ga;return a._=h,d(a)}finally{ga=Date}}var d=a(h);return b.parse=function(h){try{ga=La;var a=d.parse(h);return a&&a._}finally{ga=Date}},b.toString=d.toString,b};a.multi=a.utc.multi=Gg;var n=r.map(),U=Zb(k),p=$b(k),q=Zb(l),sa=$b(l),w=Zb(na),ka=$b(na),L=Zb(m),O=$b(m);f.forEach(function(h,a){n.set(h.toLowerCase(),a)});var t={a:function(h){return l[h.getDay()]},A:function(h){return k[h.getDay()]},b:function(h){return m[h.getMonth()]},B:function(h){return na[h.getMonth()]},c:a(d),d:function(h,
a){return ja(h.getDate(),a,2)},e:function(h,a){return ja(h.getDate(),a,2)},H:function(h,a){return ja(h.getHours(),a,2)},I:function(h,a){return ja(h.getHours()%12||12,a,2)},j:function(h,a){return ja(1+B.dayOfYear(h),a,3)},L:function(h,a){return ja(h.getMilliseconds(),a,3)},m:function(h,a){return ja(h.getMonth()+1,a,2)},M:function(h,a){return ja(h.getMinutes(),a,2)},p:function(h){return f[+(12<=h.getHours())]},S:function(h,a){return ja(h.getSeconds(),a,2)},U:function(h,a){return ja(B.sundayOfYear(h),
a,2)},w:function(h){return h.getDay()},W:function(h,a){return ja(B.mondayOfYear(h),a,2)},x:a(e),X:a(g),y:function(h,a){return ja(h.getFullYear()%100,a,2)},Y:function(h,a){return ja(h.getFullYear()%1E4,a,4)},Z:Hg,"%":function(){return"%"}},v={a:function(h,a,b){q.lastIndex=0;return(a=q.exec(a.slice(b)))?(h.w=sa.get(a[0].toLowerCase()),b+a[0].length):-1},A:function(h,a,b){U.lastIndex=0;return(a=U.exec(a.slice(b)))?(h.w=p.get(a[0].toLowerCase()),b+a[0].length):-1},b:function(h,a,b){L.lastIndex=0;return(a=
L.exec(a.slice(b)))?(h.m=O.get(a[0].toLowerCase()),b+a[0].length):-1},B:function(h,a,b){w.lastIndex=0;return(a=w.exec(a.slice(b)))?(h.m=ka.get(a[0].toLowerCase()),b+a[0].length):-1},c:function(h,a,x){return b(h,t.c.toString(),a,x)},d:re,e:re,H:se,I:se,j:Ig,L:Jg,m:Kg,M:Lg,p:function(h,a,b){a=n.get(a.slice(b,b+=2).toLowerCase());return null==a?-1:(h.p=a,b)},S:Mg,U:Ng,w:Og,W:Pg,x:function(h,a,x){return b(h,t.x.toString(),a,x)},X:function(h,a,x){return b(h,t.X.toString(),a,x)},y:Qg,Y:Rg,Z:Sg,"%":Tg};
return a}function ja(h,a,b){var d=0>h?"-":"";h=(d?-h:h)+"";var e=h.length;return d+(b>e?Array(b-e+1).join(a)+h:h)}function Zb(h){return new RegExp("^(?:"+h.map(r.requote).join("|")+")","i")}function $b(h){for(var a=new k,b=-1,d=h.length;++b<d;)a.set(h[b].toLowerCase(),b);return a}function Og(h,a,b){Y.lastIndex=0;return(a=Y.exec(a.slice(b,b+1)))?(h.w=+a[0],b+a[0].length):-1}function Ng(h,a,b){Y.lastIndex=0;return(a=Y.exec(a.slice(b)))?(h.U=+a[0],b+a[0].length):-1}function Pg(h,a,b){Y.lastIndex=0;return(a=
Y.exec(a.slice(b)))?(h.W=+a[0],b+a[0].length):-1}function Rg(h,a,b){Y.lastIndex=0;return(a=Y.exec(a.slice(b,b+4)))?(h.y=+a[0],b+a[0].length):-1}function Qg(h,a,b){Y.lastIndex=0;if(a=Y.exec(a.slice(b,b+2))){var d=+a[0];h=(h.y=d+(68<d?1900:2E3),b+a[0].length)}else h=-1;return h}function Sg(h,a,b){return/^[+-]\d{4}$/.test(a=a.slice(b,b+5))?(h.Z=-a,b+5):-1}function Kg(h,a,b){Y.lastIndex=0;return(a=Y.exec(a.slice(b,b+2)))?(h.m=a[0]-1,b+a[0].length):-1}function re(h,a,b){Y.lastIndex=0;return(a=Y.exec(a.slice(b,
b+2)))?(h.d=+a[0],b+a[0].length):-1}function Ig(h,a,b){Y.lastIndex=0;return(a=Y.exec(a.slice(b,b+3)))?(h.j=+a[0],b+a[0].length):-1}function se(h,a,b){Y.lastIndex=0;return(a=Y.exec(a.slice(b,b+2)))?(h.H=+a[0],b+a[0].length):-1}function Lg(h,a,b){Y.lastIndex=0;return(a=Y.exec(a.slice(b,b+2)))?(h.M=+a[0],b+a[0].length):-1}function Mg(h,a,b){Y.lastIndex=0;return(a=Y.exec(a.slice(b,b+2)))?(h.S=+a[0],b+a[0].length):-1}function Jg(h,a,b){Y.lastIndex=0;return(a=Y.exec(a.slice(b,b+3)))?(h.L=+a[0],b+a[0].length):
-1}function Hg(h){var a=h.getTimezoneOffset();h=0<a?"-":"+";var b=0|F(a)/60,a=F(a)%60;return h+ja(b,"0",2)+ja(a,"0",2)}function Tg(h,a,b){te.lastIndex=0;return(h=te.exec(a.slice(b,b+1)))?b+h[0].length:-1}function Gg(h){for(var a=h.length,b=-1;++b<a;)h[b][0]=this(h[b][0]);return function(a){for(var b=0,x=h[b];!x[1](a);)x=h[++b];return x[0](a)}}function bd(){}function ue(h,a,b){var d=b.s=h+a,e=d-h;b.t=h-(d-e)+(a-e)}function ac(h,a){h&&ve.hasOwnProperty(h.type)&&ve[h.type](h,a)}function cd(h,a,b){var d=
-1,e=h.length-b;for(a.lineStart();++d<e;)b=h[d],a.point(b[0],b[1],b[2]);a.lineEnd()}function we(h,a){var b=-1,d=h.length;for(a.polygonStart();++b<d;)cd(h[b],a,1);a.polygonEnd()}function Ug(){function h(h,a){h*=H;a=a*H/2+I/4;var b=h-d,x=0<=b?1:-1,E=x*b,b=Math.cos(a),f=Math.sin(a),k=g*f,l=e*b+k*Math.cos(E),x=k*x*Math.sin(E);ab.add(Math.atan2(x,l));d=h;e=b;g=f}var a,b,d,e,g;pa.point=function(f,k){pa.point=h;d=(a=f)*H;e=Math.cos(k=(b=k)*H/2+I/4);g=Math.sin(k)};pa.lineEnd=function(){h(a,b)}}function bb(h){var a=
h[0];h=h[1];var b=Math.cos(h);return[b*Math.cos(a),b*Math.sin(a),Math.sin(h)]}function bc(h,a){return h[0]*a[0]+h[1]*a[1]+h[2]*a[2]}function kb(h,a){return[h[1]*a[2]-h[2]*a[1],h[2]*a[0]-h[0]*a[2],h[0]*a[1]-h[1]*a[0]]}function dd(h,a){h[0]+=a[0];h[1]+=a[1];h[2]+=a[2]}function cc(h,a){return[h[0]*a,h[1]*a,h[2]*a]}function dc(h){var a=Math.sqrt(h[0]*h[0]+h[1]*h[1]+h[2]*h[2]);h[0]/=a;h[1]/=a;h[2]/=a}function ec(h){return[Math.atan2(h[1],h[0]),ib(h[2])]}function fc(h,a){return F(h[0]-a[0])<C&&F(h[1]-a[1])<
C}function ed(h,a){h*=H;var b=Math.cos(a*=H);yb(b*Math.cos(h),b*Math.sin(h),Math.sin(a))}function yb(h,a,b){++zb;Ma+=(h-Ma)/zb;Na+=(a-Na)/zb;Da+=(b-Da)/zb}function xe(){function h(h,e){h*=H;var g=Math.cos(e*=H),f=g*Math.cos(h),g=g*Math.sin(h),k=Math.sin(e),l=Math.atan2(Math.sqrt((l=b*k-d*g)*l+(l=d*f-a*k)*l+(l=a*g-b*f)*l),a*f+b*g+d*k);lb+=l;ta+=l*(a+(a=f));ua+=l*(b+(b=g));la+=l*(d+(d=k));yb(a,b,d)}var a,b,d;za.point=function(e,g){e*=H;var f=Math.cos(g*=H);a=f*Math.cos(e);b=f*Math.sin(e);d=Math.sin(g);
za.point=h;yb(a,b,d)}}function ye(){za.point=ed}function Vg(){function h(h,a){h*=H;var b=Math.cos(a*=H),x=b*Math.cos(h),b=b*Math.sin(h),E=Math.sin(a),f=e*E-g*b,k=g*x-d*E,l=d*b-e*x,m=Math.sqrt(f*f+k*k+l*l),n=d*x+e*b+g*E,p=m&&-be(n)/m,m=Math.atan2(m,n);Ta+=p*f;Ua+=p*k;Ea+=p*l;lb+=m;ta+=m*(d+(d=x));ua+=m*(e+(e=b));la+=m*(g+(g=E));yb(d,e,g)}var a,b,d,e,g;za.point=function(f,k){a=f;b=k;za.point=h;f*=H;var l=Math.cos(k*=H);d=l*Math.cos(f);e=l*Math.sin(f);g=Math.sin(k);yb(d,e,g)};za.lineEnd=function(){h(a,
b);za.lineEnd=ye;za.point=ed}}function mb(){return!0}function ze(h,a,b,d,e){var g=[],f=[];if(h.forEach(function(h){if(!(0>=(a=h.length-1))){var a,b=h[0],x=h[a];if(fc(b,x)){e.lineStart();for(x=0;a>x;++x)e.point((b=h[x])[0],b[1]);return e.lineEnd(),void 0}a=new gc(b,h,null,!0);b=new gc(b,null,a,!1);a.o=b;g.push(a);f.push(b);a=new gc(x,h,null,!1);b=new gc(x,null,a,!0);a.o=b;g.push(a);f.push(b)}}),f.sort(a),Ae(g),Ae(f),g.length){h=0;a=b;for(b=f.length;b>h;++h)f[h].e=a=!a;for(var k,l=g[0];;){for(var m=
l,n=!0;m.v;)if((m=m.n)===l)return;a=m.z;e.lineStart();do{if(m.v=m.o.v=!0,m.e){if(n)for(h=0,b=a.length;b>h;++h)e.point((k=a[h])[0],k[1]);else d(m.x,m.n.x,1,e);m=m.n}else{if(n)for(a=m.p.z,h=a.length-1;0<=h;--h)e.point((k=a[h])[0],k[1]);else d(m.x,m.p.x,-1,e);m=m.p}m=m.o;a=m.z;n=!n}while(!m.v);e.lineEnd()}}}function Ae(h){if(a=h.length){for(var a,b,d=0,e=h[0];++d<a;)e.n=b=h[d],b.p=e,e=b;e.n=b=h[0];b.p=e}}function gc(h,a,b,d){this.x=h;this.z=a;this.o=b;this.e=d;this.v=!1;this.n=this.p=null}function Be(h,
a,b,d){return function(e,g){function f(a,b){var d=e(a,b);h(a=d[0],b=d[1])&&g.point(a,b)}function k(h,a){var b=e(h,a);t.point(b[0],b[1])}function l(){L.point=k;t.lineStart()}function m(){L.point=f;t.lineEnd()}function n(h,a){sa.push([h,a]);var b=e(h,a);v.point(b[0],b[1])}function p(){v.lineStart();sa=[]}function U(){n(sa[0][0],sa[0][1]);v.lineEnd();var h;h=v.clean();var a=O.buffer(),b=a.length;if(sa.pop(),w.push(sa),sa=null,b)if(1&h){h=a[0];var d,b=h.length-1,a=-1;if(0<b){G||(g.polygonStart(),G=!0);
for(g.lineStart();++a<b;)g.point((d=h[a])[0],d[1]);g.lineEnd()}}else 1<b&&2&h&&a.push(a.pop().concat(a.shift())),q.push(a.filter(Wg))}var q,w,sa,t=a(g),ka=e.invert(d[0],d[1]),L={point:f,lineStart:l,lineEnd:m,polygonStart:function(){L.point=n;L.lineStart=p;L.lineEnd=U;q=[];w=[]},polygonEnd:function(){L.point=f;L.lineStart=l;L.lineEnd=m;q=r.merge(q);var h,a=ka;h=w;var d=a[0],x=a[1],e=[Math.sin(d),-Math.cos(d),0],J=0,P=0;ab.reset();for(var k=0,M=h.length;M>k;++k){var n=h[k],aa=n.length;if(aa)for(var p=
n[0],U=p[0],a=p[1]/2+I/4,Sa=Math.sin(a),sa=Math.cos(a),O=1;;){O===aa&&(O=0);var a=n[O],t=a[0],v=a[1]/2+I/4,oa=Math.sin(v),v=Math.cos(v),S=t-U,A=0<=S?1:-1,z=A*S,y=z>I,Sa=Sa*oa;if(ab.add(Math.atan2(Sa*A*Math.sin(z),sa*v+Sa*Math.cos(z))),J+=y?S+A*qa:S,y^U>=d^t>=d)p=kb(bb(p),bb(a)),dc(p),U=kb(e,p),dc(U),U=(y^0<=S?-1:1)*ib(U[2]),(x>U||x===U&&(p[0]||p[1]))&&(P+=y^0<=S?1:-1);if(!O++)break;U=t;Sa=oa;sa=v;p=a}}h=(-C>J||C>J&&0>ab)^1&P;q.length?(G||(g.polygonStart(),G=!0),ze(q,Xg,h,b,g)):h&&(G||(g.polygonStart(),
G=!0),g.lineStart(),b(null,null,1,g),g.lineEnd());G&&(g.polygonEnd(),G=!1);q=w=null},sphere:function(){g.polygonStart();g.lineStart();b(null,null,1,g);g.lineEnd();g.polygonEnd()}},O=Ce(),v=a(O),G=!1;return L}}function Wg(h){return 1<h.length}function Ce(){var h,a=[];return{lineStart:function(){a.push(h=[])},point:function(a,b){h.push([a,b])},lineEnd:D,buffer:function(){var b=a;return a=[],h=null,b},rejoin:function(){1<a.length&&a.push(a.pop().concat(a.shift()))}}}function Xg(h,a){return(0>(h=h.x)[0]?
h[1]-ea-C:ea-h[1])-(0>(a=a.x)[0]?a[1]-ea-C:ea-a[1])}function Yg(h){function a(h,b){return Math.cos(h)*Math.cos(b)>e}function b(h,a,d){var x=bb(h),g=bb(a),E=[1,0,0],g=kb(x,g),J=bc(g,g),x=g[0],f=J-x*x;if(!f)return!d&&h;J=e*J/f;f=-e*x/f;x=kb(E,g);E=cc(E,J);g=cc(g,f);dd(E,g);g=bc(E,x);J=bc(x,x);f=g*g-J*(bc(E,E)-1);if(!(0>f)){var N=Math.sqrt(f),f=cc(x,(-g-N)/J);if(dd(f,E),f=ec(f),!d)return f;var k;d=h[0];var M=a[0];h=h[1];a=a[1];d>M&&(k=d,d=M,M=k);var l=M-d,m=F(l-I)<C,fa=m||C>l;if(!m&&h>a&&(k=h,h=a,a=
k),fa?m?0<h+a^f[1]<(F(f[0]-d)<C?h:a):h<=f[1]&&f[1]<=a:l>I^(d<=f[0]&&f[0]<=M))return k=cc(x,(-g+N)/J),dd(k,E),[f,ec(k)]}}function d(a,b){var x=g?h:I-h,e=0;return-x>a?e|=1:a>x&&(e|=2),-x>b?e|=4:b>x&&(e|=8),e}var e=Math.cos(h),g=0<e,f=F(e)>C,k=fd(h,6*H);return Be(a,function(h){var e,P,k,M,l;return{lineStart:function(){M=k=!1;l=1},point:function(m,n){var p,q=[m,n],r=a(m,n),w=g?r?0:d(m,n):r?d(m+(0>m?I:-I),n):0;if(!e&&(M=k=r)&&h.lineStart(),r!==k&&(p=b(e,q),(fc(e,p)||fc(q,p))&&(q[0]+=C,q[1]+=C,r=a(q[0],
q[1]))),r!==k)l=0,r?(h.lineStart(),p=b(q,e),h.point(p[0],p[1])):(p=b(e,q),h.point(p[0],p[1]),h.lineEnd()),e=p;else if(f&&e&&g^r){var t;w&P||!(t=b(q,e,!0))||(l=0,g?(h.lineStart(),h.point(t[0][0],t[0][1]),h.point(t[1][0],t[1][1]),h.lineEnd()):(h.point(t[1][0],t[1][1]),h.lineEnd(),h.lineStart(),h.point(t[0][0],t[0][1])))}!r||e&&fc(e,q)||h.point(q[0],q[1]);e=q;k=r;P=w},lineEnd:function(){k&&h.lineEnd();e=null},clean:function(){return l|(M&&k)<<1}}},k,g?[0,-h]:[-I,h-I])}function De(h,a,b,d){return function(e){var g,
f=e.a,k=e.b,l=f.x,f=f.y,m=0,n=1,p=k.x-l,k=k.y-f;if(g=h-l,p||!(0<g)){if(g/=p,0>p){if(m>g)return;n>g&&(n=g)}else if(0<p){if(g>n)return;g>m&&(m=g)}if(g=b-l,p||!(0>g)){if(g/=p,0>p){if(g>n)return;g>m&&(m=g)}else if(0<p){if(m>g)return;n>g&&(n=g)}if(g=a-f,k||!(0<g)){if(g/=k,0>k){if(m>g)return;n>g&&(n=g)}else if(0<k){if(g>n)return;g>m&&(m=g)}if(g=d-f,k||!(0>g)){if(g/=k,0>k){if(g>n)return;g>m&&(m=g)}else if(0<k){if(m>g)return;n>g&&(n=g)}return 0<m&&(e.a={x:l+m*p,y:f+m*k}),1>n&&(e.b={x:l+n*p,y:f+n*k}),e}}}}}}
function Ee(h,a,b,d){function e(d,g){return F(d[0]-h)<C?0<g?0:3:F(d[0]-b)<C?0<g?2:1:F(d[1]-a)<C?0<g?1:0:0<g?3:2}function g(h,a){return f(h.x,a.x)}function f(h,a){var b=e(h,1),d=e(a,1);return b!==d?b-d:0===b?a[1]-h[1]:1===b?h[0]-a[0]:2===b?h[1]-a[1]:a[0]-h[0]}return function(k){function l(g,k,N,M){var m=0,n=0;if(null==g||(m=e(g,N))!==(n=e(k,N))||0>f(g,k)^0<N){do M.point(0===m||3===m?h:b,1<m?d:a);while((m=(m+N+4)%4)!==n)}else M.point(k[0],k[1])}function m(e,g){e>=h&&b>=e&&g>=a&&d>=g&&k.point(e,g)}function n(e,
g){e=Math.max(-hc,Math.min(hc,e));g=Math.max(-hc,Math.min(hc,g));var f=e>=h&&b>=e&&g>=a&&d>=g;if(U&&q.push([e,g]),S)w=e,t=g,v=f,S=!1,f&&(k.lineStart(),k.point(e,g));else if(f&&O)k.point(e,g);else{var N={a:{x:ka,y:L},b:{x:e,y:g}};y(N)?(O||(k.lineStart(),k.point(N.a.x,N.a.y)),k.point(N.b.x,N.b.y),f||k.lineEnd(),G=!1):f&&(k.lineStart(),k.point(e,g),G=!1)}ka=e;L=g;O=f}var p,U,q,w,t,v,ka,L,O,S,G,A=k,z=Ce(),y=De(h,a,b,d),Q={point:m,lineStart:function(){Q.point=n;U&&U.push(q=[]);S=!0;O=!1;ka=L=0/0},lineEnd:function(){p&&
(n(w,t),v&&O&&z.rejoin(),p.push(z.buffer()));Q.point=m;O&&k.lineEnd()},polygonStart:function(){k=z;p=[];U=[];G=!0},polygonEnd:function(){k=A;p=r.merge(p);var a;a=[h,d];for(var b=0,x=U.length,e=a[1],E=0;x>E;++E)for(var f,P=1,m=U[E],fa=m.length,n=m[0];fa>P;++P)f=m[P],n[1]<=e?f[1]>e&&0<Rc(n,f,a)&&++b:f[1]<=e&&0>Rc(n,f,a)&&--b,n=f;a=0!==b;b=G&&a;x=p.length;(b||x)&&(k.polygonStart(),b&&(k.lineStart(),l(null,null,1,k),k.lineEnd()),x&&ze(p,g,a,l,k),k.polygonEnd());p=U=q=null}};return Q}}function Fe(h,a){function b(d,
e){return d=h(d,e),a(d[0],d[1])}return h.invert&&a.invert&&(b.invert=function(b,d){return b=a.invert(b,d),b&&h.invert(b[0],b[1])}),b}function gd(h){var a=0,b=I/3,d=hd(h);h=d(a,b);return h.parallels=function(h){return arguments.length?d(a=h[0]*I/180,b=h[1]*I/180):[a/I*180,b/I*180]},h}function Ge(h,a){function b(h,a){var d=Math.sqrt(g-2*e*Math.sin(a))/e;return[d*Math.sin(h*=e),f-d*Math.cos(h)]}var d=Math.sin(h),e=(d+Math.sin(a))/2,g=1+d*(2*e-d),f=Math.sqrt(g)/e;return b.invert=function(h,a){var b=f-
a;return[Math.atan2(h,b)/e,ib((g-(h*h+b*b)*e*e)/(2*e))]},b}function Zg(){function h(h,a){ic+=e*h-d*a;d=h;e=a}var a,b,d,e;Va.point=function(g,f){Va.point=h;a=d=g;b=e=f};Va.lineEnd=function(){h(a,b)}}function $g(){function h(h,a){f.push("M",h,",",a,g)}function a(h,d){f.push("M",h,",",d);k.point=b}function b(h,a){f.push("L",h,",",a)}function d(){k.point=h}function e(){f.push("Z")}var g=He(4.5),f=[],k={point:h,lineStart:function(){k.point=a},lineEnd:d,polygonStart:function(){k.lineEnd=e},polygonEnd:function(){k.lineEnd=
d;k.point=h},pointRadius:function(h){return g=He(h),k},result:function(){if(f.length){var h=f.join("");return f=[],h}}};return k}function He(h){return"m0,"+h+"a"+h+","+h+" 0 1,1 0,"+-2*h+"a"+h+","+h+" 0 1,1 0,"+2*h+"z"}function cb(h,a){Ma+=h;Na+=a;++Da}function Ie(){function h(h,d){var e=h-a,g=d-b,e=Math.sqrt(e*e+g*g);ta+=e*(a+h)/2;ua+=e*(b+d)/2;la+=e;cb(a=h,b=d)}var a,b;Aa.point=function(d,e){Aa.point=h;cb(a=d,b=e)}}function Je(){Aa.point=cb}function ah(){function h(h,a){var b=h-d,x=a-e,b=Math.sqrt(b*
b+x*x);ta+=b*(d+h)/2;ua+=b*(e+a)/2;la+=b;b=e*h-d*a;Ta+=b*(d+h);Ua+=b*(e+a);Ea+=3*b;cb(d=h,e=a)}var a,b,d,e;Aa.point=function(g,f){Aa.point=h;cb(a=d=g,b=e=f)};Aa.lineEnd=function(){h(a,b)}}function bh(h){function a(b,d){h.moveTo(b,d);h.arc(b,d,f,0,qa)}function b(a,e){h.moveTo(a,e);k.point=d}function d(a,b){h.lineTo(a,b)}function e(){k.point=a}function g(){h.closePath()}var f=4.5,k={point:a,lineStart:function(){k.point=b},lineEnd:e,polygonStart:function(){k.lineEnd=g},polygonEnd:function(){k.lineEnd=
e;k.point=a},pointRadius:function(h){return f=h,k},result:D};return k}function Ke(h){function a(h){return(k?d:b)(h)}function b(a){return Le(a,function(b,d){b=h(b,d);a.point(b[0],b[1])})}function d(a){function b(d,e){d=h(d,e);a.point(d[0],d[1])}function x(){w=0/0;y.point=g;a.lineStart()}function g(b,d){var x=bb([b,d]),E=h(b,d);e(w,t,r,v,A,z,w=E[0],t=E[1],r=b,v=x[0],A=x[1],z=x[2],k,a);a.point(w,t)}function E(){y.point=b;a.lineEnd()}function f(){x();y.point=J;y.lineEnd=N}function J(h,a){g(l=h,a);m=w;
fa=t;n=v;p=A;q=z;y.point=g}function N(){e(w,t,r,v,A,z,m,fa,l,n,p,q,k,a);y.lineEnd=E;E()}var l,m,fa,n,p,q,r,w,t,v,A,z,y={point:b,lineStart:x,lineEnd:E,polygonStart:function(){a.polygonStart();y.lineStart=f},polygonEnd:function(){a.polygonEnd();y.lineStart=x}};return y}function e(a,b,d,x,E,J,k,l,m,M,n,p,q,r){var w=k-a,t=l-b,v=w*w+t*t;if(v>4*g&&q--){var A=x+M,y=E+n,z=J+p,Q=Math.sqrt(A*A+y*y+z*z),D=Math.asin(z/=Q),K=F(F(z)-1)<C||F(d-m)<C?(d+m)/2:Math.atan2(y,A),B=h(K,D),D=B[0],B=B[1],T=D-a,H=B-b,I=t*
T-w*H;(I*I/v>g||.3<F((w*T+t*H)/v-.5)||f>x*M+E*n+J*p)&&(e(a,b,d,x,E,J,D,B,K,A/=Q,y/=Q,z,q,r),r.point(D,B),e(D,B,K,A,y,z,k,l,m,M,n,p,q,r))}}var g=.5,f=Math.cos(30*H),k=16;return a.precision=function(h){return arguments.length?(k=0<(g=h*h)&&16,a):Math.sqrt(g)},a}function ch(h){var a=Ke(function(a,b){return h([a*X,b*X])});return function(h){return Me(a(h))}}function Ne(h){this.stream=h}function Le(h,a){return{point:a,sphere:function(){h.sphere()},lineStart:function(){h.lineStart()},lineEnd:function(){h.lineEnd()},
polygonStart:function(){h.polygonStart()},polygonEnd:function(){h.polygonEnd()}}}function Wa(h){return hd(function(){return h})()}function hd(h){function a(h){return h=k(h[0]*H,h[1]*H),[h[0]*q+l,m-h[1]*q]}function b(h){return h=k.invert((h[0]-l)/q,(m-h[1])/q),h&&[h[0]*X,h[1]*X]}function d(){k=Fe(f=id(ka,L,O),g);var h=g(v,oa);return l=w-h[0]*q,m=t+h[1]*q,e()}function e(){return n&&(n.valid=!1,n=null),a}var g,f,k,l,m,n,p=Ke(function(h,a){return h=g(h,a),[h[0]*q+l,m-h[1]*q]}),q=150,w=480,t=250,v=0,oa=
0,ka=0,L=0,O=0,S=Oe,A=ca,z=null,y=null;return a.stream=function(h){return n&&(n.valid=!1),n=Me(S(f,p(A(h)))),n.valid=!0,n},a.clipAngle=function(h){return arguments.length?(S=null==h?(z=h,Oe):Yg((z=+h)*H),e()):z},a.clipExtent=function(h){return arguments.length?(y=h,A=h?Ee(h[0][0],h[0][1],h[1][0],h[1][1]):ca,e()):y},a.scale=function(h){return arguments.length?(q=+h,d()):q},a.translate=function(h){return arguments.length?(w=+h[0],t=+h[1],d()):[w,t]},a.center=function(h){return arguments.length?(v=h[0]%
360*H,oa=h[1]%360*H,d()):[v*X,oa*X]},a.rotate=function(h){return arguments.length?(ka=h[0]%360*H,L=h[1]%360*H,O=2<h.length?h[2]%360*H:0,d()):[ka*X,L*X,O*X]},r.rebind(a,p,"precision"),function(){return g=h.apply(this,arguments),a.invert=g.invert&&b,d()}}function Me(h){return Le(h,function(a,b){h.point(a*H,b*H)})}function Ab(h,a){return[h,a]}function Pe(h,a){return[h>I?h-qa:-I>h?h+qa:h,a]}function id(h,a,b){return h?a||b?Fe(Qe(h),Re(a,b)):Qe(h):a||b?Re(a,b):Pe}function Se(h){return function(a,b){return a+=
h,[a>I?a-qa:-I>a?a+qa:a,b]}}function Qe(h){var a=Se(h);return a.invert=Se(-h),a}function Re(h,a){function b(h,a){var x=Math.cos(a),E=Math.cos(h)*x,x=Math.sin(h)*x,k=Math.sin(a),l=k*d+E*e;return[Math.atan2(x*g-l*f,E*d-k*e),ib(l*g+x*f)]}var d=Math.cos(h),e=Math.sin(h),g=Math.cos(a),f=Math.sin(a);return b.invert=function(h,a){var b=Math.cos(a),x=Math.cos(h)*b,b=Math.sin(h)*b,E=Math.sin(a),k=E*g-b*f;return[Math.atan2(b*g+E*f,x*d+k*e),ib(k*d-x*e)]},b}function fd(h,a){var b=Math.cos(h),d=Math.sin(h);return function(e,
g,f,k){var l=f*a;null!=e?(e=Te(b,e),g=Te(b,g),(0<f?g>e:e>g)&&(e+=f*qa)):(e=h+f*qa,g=h-.5*l);for(var m;0<f?e>g:g>e;e-=l)k.point((m=ec([b,-d*Math.cos(e),-d*Math.sin(e)]))[0],m[1])}}function Te(h,a){var b=bb(a);b[0]-=h;dc(b);var d=be(-b[1]);return((0>-b[2]?-d:d)+2*Math.PI-C)%(2*Math.PI)}function Ue(h,a,b){var d=r.range(h,a-C,b).concat(a);return function(h){return d.map(function(a){return[h,a]})}}function Ve(h,a,b){var d=r.range(h,a-C,b).concat(a);return function(h){return d.map(function(a){return[a,
h]})}}function jd(h){return h.source}function kd(h){return h.target}function dh(h,a,b,d){var e=Math.cos(a),g=Math.sin(a),f=Math.cos(d),k=Math.sin(d),l=e*Math.cos(h),m=e*Math.sin(h),n=f*Math.cos(b),p=f*Math.sin(b),q=2*Math.asin(Math.sqrt(de(d-a)+e*f*de(b-h))),r=1/Math.sin(q);b=q?function(h){var a=Math.sin(h*=q)*r,b=Math.sin(q-h)*r;h=b*l+a*n;var d=b*m+a*p,a=b*g+a*k;return[Math.atan2(d,h)*X,Math.atan2(a,Math.sqrt(h*h+d*d))*X]}:function(){return[h*X,a*X]};return b.distance=q,b}function Bb(h,a){function b(a,
d){var e=Math.cos(a),g=Math.cos(d),e=h(e*g);return[e*g*Math.sin(a),e*Math.sin(d)]}return b.invert=function(h,b){var d=Math.sqrt(h*h+b*b),e=a(d),g=Math.sin(e),e=Math.cos(e);return[Math.atan2(h*g,d*e),Math.asin(d&&b*g/d)]},b}function We(h,a){function b(h,a){0<g?-ea+C>a&&(a=-ea+C):a>ea-C&&(a=ea-C);var d=g/Math.pow(Math.tan(I/4+a/2),e);return[d*Math.sin(e*h),g-d*Math.cos(e*h)]}var d=Math.cos(h),e=h===a?Math.sin(h):Math.log(d/Math.cos(a))/Math.log(Math.tan(I/4+a/2)/Math.tan(I/4+h/2)),g=d*Math.pow(Math.tan(I/
4+h/2),e)/e;return e?(b.invert=function(h,a){var b=g-a,d=(0<e?1:0>e?-1:0)*Math.sqrt(h*h+b*b);return[Math.atan2(h,b)/e,2*Math.atan(Math.pow(g/d,1/e))-ea]},b):jc}function Xe(h,a){function b(h,a){var d=g-a;return[d*Math.sin(e*h),g-d*Math.cos(e*h)]}var d=Math.cos(h),e=h===a?Math.sin(h):(d-Math.cos(a))/(a-h),g=d/e+h;return F(e)<C?Ab:(b.invert=function(h,a){var b=g-a;return[Math.atan2(h,b)/e,g-(0<e?1:0>e?-1:0)*Math.sqrt(h*h+b*b)]},b)}function jc(h,a){return[h,Math.log(Math.tan(I/4+a/2))]}function Ye(h){var a,
b=Wa(h),d=b.scale,e=b.translate,g=b.clipExtent;return b.scale=function(){var h=d.apply(b,arguments);return h===b?a?b.clipExtent(null):b:h},b.translate=function(){var h=e.apply(b,arguments);return h===b?a?b.clipExtent(null):b:h},b.clipExtent=function(h){var f=g.apply(b,arguments);if(f===b){if(a=null==h){var k=I*d(),l=e();g([[l[0]-k,l[1]-k],[l[0]+k,l[1]+k]])}}else a&&(f=null);return f},b.clipExtent(null)}function ld(h,a){return[Math.log(Math.tan(I/4+a/2)),-h]}function nb(h){return h[0]}function Cb(h){return h[1]}
function Ze(h){for(var a=h.length,b=[0,1],d=2,e=2;a>e;e++){for(;1<d&&0>=Rc(h[b[d-2]],h[b[d-1]],h[e]);)--d;b[d++]=e}return b.slice(0,d)}function eh(h,a){return h[0]-a[0]||h[1]-a[1]}function md(h,a,b){return(b[0]-a[0])*(h[1]-a[1])<(b[1]-a[1])*(h[0]-a[0])}function $e(h,a,b,d){var e=h[0],g=b[0],f=a[0]-e,k=d[0]-g;h=h[1];b=b[1];a=a[1]-h;d=d[1]-b;g=(k*(h-b)-d*(e-g))/(d*f-k*a);return[e+g*f,h+g*a]}function af(h){var a=h[0];h=h[h.length-1];return!(a[0]-h[0]||a[1]-h[1])}function fh(){kc(this);this.edge=this.site=
this.circle=null}function bf(h){var a=cf.pop()||new fh;return a.site=h,a}function nd(h){ob(h);pb.remove(h);cf.push(h);kc(h)}function df(h,a){var b=h.site,d=b.x,e=b.y,g=e-a;if(!g)return d;var f=h.P;if(!f)return-1/0;var b=f.site,f=b.x,b=b.y,k=b-a;if(!k)return f;var l=f-d,m=1/g-1/k,n=l/k;return m?(-n+Math.sqrt(n*n-2*m*(l*l/(-2*k)-b+k/2+e-g/2)))/m+d:(d+f)/2}function ef(h){this.site=h;this.edges=[]}function ff(h,a){return a.angle-h.angle}function gh(){kc(this);this.x=this.y=this.arc=this.site=this.cy=
null}function qb(h){var a=h.P,b=h.N;if(a&&b){var d=a.site,a=h.site,e=b.site;if(d!==e){var b=a.x,g=a.y,f=d.x-b,k=d.y-g,d=e.x-b,e=e.y-g,l=2*(f*e-k*d);if(!(l>=-od)){var m=f*f+k*k,n=d*d+e*e,k=(e*m-k*n)/l,f=(f*n-d*m)/l,e=f+g,g=gf.pop()||new gh;g.arc=h;g.site=a;g.x=k+b;g.y=e+Math.sqrt(k*k+f*f);g.cy=e;h.circle=g;h=null;for(a=Db._;a;)if(g.y<a.y||g.y===a.y&&g.x<=a.x){if(!a.L){h=a.P;break}a=a.L}else{if(!a.R){h=a;break}a=a.R}Db.insert(h,g);h||(pd=g)}}}}function ob(h){var a=h.circle;a&&(a.P||(pd=a.N),Db.remove(a),
gf.push(a),kc(a),h.circle=null)}function hh(h,a){var b=h.b;if(b)return!0;var d,e,g=h.a,b=a[0][0],f=a[1][0],k=a[0][1],l=a[1][1],m=h.l,n=h.r,p=m.x,m=m.y,q=n.x,n=n.y;e=(p+q)/2;if(n===m){if(b>e||e>=f)return;if(p>q){if(g){if(g.y>=l)return}else g={x:e,y:k};b={x:e,y:l}}else{if(g){if(g.y<k)return}else g={x:e,y:l};b={x:e,y:k}}}else if(d=(p-q)/(n-m),e=(m+n)/2-d*e,-1>d||1<d)if(p>q){if(g){if(g.y>=l)return}else g={x:(k-e)/d,y:k};b={x:(l-e)/d,y:l}}else{if(g){if(g.y<k)return}else g={x:(l-e)/d,y:l};b={x:(k-e)/d,
y:k}}else if(n>m){if(g){if(g.x>=f)return}else g={x:b,y:d*b+e};b={x:f,y:d*f+e}}else{if(g){if(g.x<b)return}else g={x:f,y:d*f+e};b={x:b,y:d*b+e}}return h.a=g,h.b=b,!0}function hf(h,a){this.l=h;this.r=a;this.a=this.b=null}function Eb(h,a,b,d){var e=new hf(h,a);return rb.push(e),b&&lc(e,h,a,b),d&&lc(e,a,h,d),db[h.i].edges.push(new mc(e,h,a)),db[a.i].edges.push(new mc(e,a,h)),e}function ih(h,a,b){h=new hf(h,null);return h.a=a,h.b=b,rb.push(h),h}function lc(a,b,d,e){a.a||a.b?a.l===d?a.b=e:a.a=e:(a.a=e,a.l=
b,a.r=d)}function mc(a,b,d){var e=a.a,g=a.b;this.edge=a;this.site=b;this.angle=d?Math.atan2(d.y-b.y,d.x-b.x):a.l===b?Math.atan2(g.x-e.x,e.y-g.y):Math.atan2(e.x-g.x,g.y-e.y)}function qd(){this._=null}function kc(a){a.U=a.C=a.L=a.R=a.P=a.N=null}function Fb(a,b){var d=b.R,e=b.U;e?e.L===b?e.L=d:e.R=d:a._=d;d.U=e;b.U=d;b.R=d.L;b.R&&(b.R.U=b);d.L=b}function Gb(a,b){var d=b.L,e=b.U;e?e.L===b?e.L=d:e.R=d:a._=d;d.U=e;b.U=d;b.L=d.R;b.L&&(b.L.U=b);d.R=b}function jf(a){for(;a.L;)a=a.L;return a}function rd(a,
b){var d,e,g,f=a.sort(jh).pop();rb=[];db=Array(a.length);pb=new qd;for(Db=new qd;;)if(g=pd,f&&(!g||f.y<g.y||f.y===g.y&&f.x<g.x)){if(f.x!==d||f.y!==e){db[f.i]=new ef(f);d=f;for(var k=e=void 0,l=void 0,m=void 0,n=d.x,p=d.y,q=pb._;q;)if(l=df(q,p)-n,l>C)q=q.L;else{var r;var w=q;r=p;var t=w.N;t?r=df(t,r):(w=w.site,r=w.y===r?w.x:1/0);if(m=n-r,!(m>C)){l>-C?(e=q.P,k=q):m>-C?(e=q,k=q.N):e=k=q;break}if(!q.R){e=q;break}q=q.R}l=bf(d);if(pb.insert(e,l),e||k)if(e===k)ob(e),k=bf(e.site),pb.insert(l,k),l.edge=k.edge=
Eb(e.site,l.site),qb(e),qb(k);else if(k){ob(e);ob(k);m=e.site;p=m.x;q=m.y;r=d.x-p;var w=d.y-q,n=k.site,t=n.x-p,v=n.y-q,oa=2*(r*v-w*t),ka=r*r+w*w,L=t*t+v*v,p={x:(v*ka-w*L)/oa+p,y:(r*L-t*ka)/oa+q};lc(k.edge,m,n,p);l.edge=Eb(m,d,null,p);k.edge=Eb(d,n,null,p);qb(e);qb(k)}else l.edge=Eb(e.site,l.site);d=f.x;e=f.y}f=a.pop()}else{if(!g)break;n=g.arc;k=n.circle;m=k.x;p=k.cy;k={x:m,y:p};r=n.P;q=n.N;l=[n];nd(n);for(n=r;n.circle&&F(m-n.circle.x)<C&&F(p-n.circle.cy)<C;)r=n.P,l.unshift(n),nd(n),n=r;l.unshift(n);
ob(n);for(r=q;r.circle&&F(m-r.circle.x)<C&&F(p-r.circle.cy)<C;)q=r.N,l.push(r),nd(r),r=q;l.push(r);ob(r);m=void 0;p=l.length;for(m=1;p>m;++m)r=l[m],n=l[m-1],lc(r.edge,n.site,r.site,k);n=l[0];r=l[p-1];r.edge=Eb(n.site,r.site,null,k);qb(n);qb(r)}if(b){f=rb;d=De(b[0][0],b[0][1],b[1][0],b[1][1]);for(e=f.length;e--;)g=f[e],(!hh(g,b)||!d(g)||F(g.a.x-g.b.x)<C&&F(g.a.y-g.b.y)<C)&&(g.a=g.b=null,f.splice(e,1));var O,n=b[0][0],p=b[1][0],q=b[0][1];r=b[1][1];w=db;for(t=w.length;t--;)if(O=w[t],O&&O.prepare())for(k=
O.edges,l=k.length,e=0;l>e;)m=k[e].end(),f=m.x,d=m.y,v=k[++e%l].start(),g=v.x,v=v.y,(F(f-g)>C||F(d-v)>C)&&(k.splice(e,0,new mc(ih(O.site,m,F(f-n)<C&&r-d>C?{x:n,y:F(g-n)<C?v:r}:F(d-r)<C&&p-f>C?{x:F(v-r)<C?g:p,y:r}:F(f-p)<C&&d-q>C?{x:p,y:F(g-p)<C?v:q}:F(d-q)<C&&f-n>C?{x:F(v-q)<C?g:n,y:q}:null),O.site,null)),++l)}O={cells:db,edges:rb};return pb=Db=rb=db=null,O}function jh(a,b){return b.y-a.y||b.x-a.x}function kh(a){return a.x}function lh(a){return a.y}function kf(){return{leaf:!0,nodes:[],point:null,
x:null,y:null}}function Hb(a,b,d,e,g,f){if(!a(b,d,e,g,f)){var k=.5*(d+g),l=.5*(e+f);b=b.nodes;b[0]&&Hb(a,b[0],d,e,k,l);b[1]&&Hb(a,b[1],k,e,g,l);b[2]&&Hb(a,b[2],d,l,k,f);b[3]&&Hb(a,b[3],k,l,g,f)}}function sd(a,b){a=r.rgb(a);b=r.rgb(b);var d=a.r,e=a.g,g=a.b,f=b.r-d,k=b.g-e,l=b.b-g;return function(a){return"#"+jb(Math.round(d+f*a))+jb(Math.round(e+k*a))+jb(Math.round(g+l*a))}}function lf(a,b){var d,e={},g={};for(d in a)d in b?e[d]=eb(a[d],b[d]):g[d]=a[d];for(d in b)d in a||(g[d]=b[d]);return function(a){for(d in e)g[d]=
e[d](a);return g}}function Oa(a,b){return a=+a,b=+b,function(d){return a*(1-d)+b*d}}function mf(a,b){var d,e,g,f=td.lastIndex=ud.lastIndex=0,k=-1,l=[],m=[];a+="";for(b+="";(d=td.exec(a))&&(e=ud.exec(b));)(g=e.index)>f&&(g=b.slice(f,g),l[k]?l[k]+=g:l[++k]=g),(d=d[0])===(e=e[0])?l[k]?l[k]+=e:l[++k]=e:(l[++k]=null,m.push({i:k,x:Oa(d,e)})),f=ud.lastIndex;return f<b.length&&(g=b.slice(f),l[k]?l[k]+=g:l[++k]=g),2>l.length?m[0]?(b=m[0].x,function(a){return b(a)+""}):function(){return b}:(b=m.length,function(a){for(var h,
d=0;b>d;++d)l[(h=m[d]).i]=h.x(a);return l.join("")})}function eb(a,b){for(var d,e=r.interpolators.length;0<=--e&&!(d=r.interpolators[e](a,b)););return d}function nc(a,b){var d,e=[],g=[],f=a.length,k=b.length,l=Math.min(a.length,b.length);for(d=0;l>d;++d)e.push(eb(a[d],b[d]));for(;f>d;++d)g[d]=a[d];for(;k>d;++d)g[d]=b[d];return function(a){for(d=0;l>d;++d)g[d]=e[d](a);return g}}function mh(a){return function(b){return 0>=b?0:1<=b?1:a(b)}}function nf(a){return function(b){return 1-a(1-b)}}function of(a){return function(b){return.5*
(.5>b?a(2*b):2-a(2-2*b))}}function nh(a){return a*a}function oh(a){return a*a*a}function ph(a){if(0>=a)return 0;if(1<=a)return 1;var b=a*a,d=b*a;return 4*(.5>a?d:3*(a-b)+d-.75)}function qh(a){return 1-Math.cos(a*ea)}function rh(a){return Math.pow(2,10*(a-1))}function sh(a){return 1-Math.sqrt(1-a*a)}function th(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function pf(a,b){return b-=a,function(d){return Math.round(a+
b*d)}}function qf(a){var b=[a.a,a.b],d=[a.c,a.d],e=rf(b),g=b[0]*d[0]+b[1]*d[1],f;f=-g;f=(d[0]+=f*b[0],d[1]+=f*b[1],d);f=rf(f)||0;b[0]*d[1]<d[0]*b[1]&&(b[0]*=-1,b[1]*=-1,e*=-1,g*=-1);this.rotate=(e?Math.atan2(b[1],b[0]):Math.atan2(-d[0],d[1]))*X;this.translate=[a.e,a.f];this.scale=[e,f];this.skew=f?Math.atan2(g,f)*X:0}function rf(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]);return b&&(a[0]/=b,a[1]/=b),b}function sf(a,b){var d,e=[],g=[],f=r.transform(a),k=r.transform(b),l=f.translate,m=k.translate,n=f.rotate,
p=k.rotate,q=f.skew,U=k.skew,f=f.scale,k=k.scale;return l[0]!=m[0]||l[1]!=m[1]?(e.push("translate(",null,",",null,")"),g.push({i:1,x:Oa(l[0],m[0])},{i:3,x:Oa(l[1],m[1])})):m[0]||m[1]?e.push("translate("+m+")"):e.push(""),n!=p?(180<n-p?p+=360:180<p-n&&(n+=360),g.push({i:e.push(e.pop()+"rotate(",null,")")-2,x:Oa(n,p)})):p&&e.push(e.pop()+"rotate("+p+")"),q!=U?g.push({i:e.push(e.pop()+"skewX(",null,")")-2,x:Oa(q,U)}):U&&e.push(e.pop()+"skewX("+U+")"),f[0]!=k[0]||f[1]!=k[1]?(d=e.push(e.pop()+"scale(",
null,",",null,")"),g.push({i:d-4,x:Oa(f[0],k[0])},{i:d-2,x:Oa(f[1],k[1])})):(1!=k[0]||1!=k[1])&&e.push(e.pop()+"scale("+k+")"),d=g.length,function(a){for(var h,b=-1;++b<d;)e[(h=g[b]).i]=h.x(a);return e.join("")}}function uh(a,b){return b=(b-=a=+a)||1/b,function(d){return(d-a)/b}}function vh(a,b){return b=(b-=a=+a)||1/b,function(d){return Math.max(0,Math.min(1,(d-a)/b))}}function wh(a){var b=a.source;a=a.target;var d;var e=a;if(b===e)d=b;else{d=tf(b);for(var e=tf(e),g=d.pop(),f=e.pop(),k=null;g===
f;)k=g,g=d.pop(),f=e.pop();d=k}for(e=[b];b!==d;)b=b.parent,e.push(b);for(b=e.length;a!==d;)e.splice(b,0,a),a=a.parent;return e}function tf(a){for(var b=[],d=a.parent;null!=d;)b.push(a),a=d,d=d.parent;return b.push(a),b}function xh(a){a.fixed|=2}function yh(a){a.fixed&=-7}function zh(a){a.fixed|=4;a.px=a.x;a.py=a.y}function Ah(a){a.fixed&=-5}function uf(a,b,d){var e=0,g=0;if(a.charge=0,!a.leaf)for(var f,k=a.nodes,l=k.length,m=-1;++m<l;)f=k[m],null!=f&&(uf(f,b,d),a.charge+=f.charge,e+=f.charge*f.cx,
g+=f.charge*f.cy);a.point&&(a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5),b*=d[a.point.index],a.charge+=a.pointCharge=b,e+=b*a.point.x,g+=b*a.point.y);a.cx=e/a.charge;a.cy=g/a.charge}function Ib(a,b){return r.rebind(a,b,"sort","children","value"),a.nodes=a,a.links=Bh,a}function Jb(a,b){for(var d=[a];null!=(a=d.pop());)if(b(a),(g=a.children)&&(e=g.length))for(var e,g;0<=--e;)d.push(g[e])}function Fa(a,b){for(var d=[a],e=[];null!=(a=d.pop());)if(e.push(a),(f=a.children)&&(g=f.length))for(var g,
f,k=-1;++k<g;)d.push(f[k]);for(;null!=(a=e.pop());)b(a)}function Ch(a){return a.children}function Dh(a){return a.value}function Eh(a,b){return b.value-a.value}function Bh(a){return r.merge(a.map(function(a){return(a.children||[]).map(function(h){return{source:a,target:h}})}))}function Fh(a){return a.x}function Gh(a){return a.y}function Hh(a,b,d){a.y0=b;a.y=d}function vd(a){return r.range(a.length)}function wd(a){var b=-1;a=a[0].length;for(var d=[];++b<a;)d[b]=0;return d}function Ih(a){for(var b,d=
1,e=0,g=a[0][1],f=a.length;f>d;++d)(b=a[d][1])>g&&(e=d,g=b);return e}function Jh(a){return a.reduce(Kh,0)}function Kh(a,b){return a+b[1]}function Lh(a,b){return vf(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function vf(a,b){for(var d=-1,e=+a[0],g=(a[1]-e)/b,f=[];++d<=b;)f[d]=g*d+e;return f}function Mh(a){return[r.min(a),r.max(a)]}function Nh(a,b){return a.value-b.value}function xd(a,b){var d=a._pack_next;a._pack_next=b;b._pack_prev=a;b._pack_next=d;d._pack_prev=b}function wf(a,b){a._pack_next=b;
b._pack_prev=a}function xf(a,b){var d=b.x-a.x,e=b.y-a.y,g=a.r+b.r;return.999*g*g>d*d+e*e}function yf(a){function b(a){p=Math.min(a.x-a.r,p);q=Math.max(a.x+a.r,q);r=Math.min(a.y-a.r,r);w=Math.max(a.y+a.r,w)}if((d=a.children)&&(n=d.length)){var d,e,g,f,k,l,m,n,p=1/0,q=-1/0,r=1/0,w=-1/0;if(d.forEach(Oh),e=d[0],e.x=-e.r,e.y=0,b(e),1<n&&(g=d[1],g.x=g.r,g.y=0,b(g),2<n))for(f=d[2],zf(e,g,f),b(f),xd(e,f),e._pack_prev=f,xd(f,g),g=e._pack_next,k=3;n>k;k++){zf(e,g,f=d[k]);var t=0,v=1,oa=1;for(l=g._pack_next;l!==
g;l=l._pack_next,v++)if(xf(l,f)){t=1;break}if(1==t)for(m=e._pack_prev;m!==l._pack_prev&&!xf(m,f);m=m._pack_prev,oa++);t?(oa>v||v==oa&&g.r<e.r?wf(e,g=l):wf(e=m,g),k--):(xd(e,f),g=f,b(f))}e=(p+q)/2;g=(r+w)/2;for(k=l=0;n>k;k++)f=d[k],f.x-=e,f.y-=g,l=Math.max(l,f.r+Math.sqrt(f.x*f.x+f.y*f.y));a.r=l;d.forEach(Ph)}}function Oh(a){a._pack_next=a._pack_prev=a}function Ph(a){delete a._pack_next;delete a._pack_prev}function Af(a,b,d,e){var g=a.children;if(a.x=b+=e*a.x,a.y=d+=e*a.y,a.r*=e,g){a=-1;for(var f=
g.length;++a<f;)Af(g[a],b,d,e)}}function zf(a,b,d){var e=a.r+d.r,g=b.x-a.x,f=b.y-a.y;if(e&&(g||f)){var k=b.r+d.r,l=g*g+f*f,k=k*k,e=e*e;b=.5+(e-k)/(2*l);k=Math.sqrt(Math.max(0,2*k*(e+l)-(e-=l)*e-k*k))/(2*l);d.x=a.x+b*g+k*f;d.y=a.y+b*f-k*g}else d.x=a.x+e,d.y=a.y}function Bf(a,b){return a.parent==b.parent?1:2}function yd(a){var b=a.children;return b.length?b[0]:a.t}function zd(a){var b,d=a.children;return(b=d.length)?d[b-1]:a.t}function Qh(a){return 1+r.max(a,function(a){return a.y})}function Rh(a){return a.reduce(function(a,
h){return a+h.x},0)/a.length}function Cf(a){var b=a.children;return b&&b.length?Cf(b[0]):a}function Df(a){var b,d=a.children;return d&&(b=d.length)?Df(d[b-1]):a}function Ad(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function Ef(a,b){var d=a.x+b[3],e=a.y+b[0],g=a.dx-b[1]-b[3],f=a.dy-b[0]-b[2];return 0>g&&(d+=g/2,g=0),0>f&&(e+=f/2,f=0),{x:d,y:e,dx:g,dy:f}}function sb(a){var b=a[0];a=a[a.length-1];return a>b?[b,a]:[a,b]}function oc(a){return a.rangeExtent?a.rangeExtent():sb(a.range())}function Sh(a,b,d,
e){var g=d(a[0],a[1]),f=e(b[0],b[1]);return function(a){return f(g(a))}}function pc(a,b){var d,e=0,g=a.length-1,f=a[e],k=a[g];return f>k&&(d=e,e=g,g=d,d=f,f=k,k=d),a[e]=b.floor(f),a[g]=b.ceil(k),a}function Ff(a){return a?{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}:Th}function Uh(a,b,d,e){var g=[],f=[],k=0,l=Math.min(a.length,b.length)-1;for(a[l]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());++k<=l;)g.push(d(a[k-1],a[k])),f.push(e(b[k-1],b[k]));return function(b){var d=
r.bisect(a,b,1,l)-1;return f[d](g[d](b))}}function Gf(a,b,d,e){function g(){var m=2<Math.min(a.length,b.length)?Uh:Sh,n=e?vh:uh;return k=m(a,b,n,d),l=m(b,a,n,eb),f}function f(a){return k(a)}var k,l;return f.invert=function(a){return l(a)},f.domain=function(b){return arguments.length?(a=b.map(Number),g()):a},f.range=function(a){return arguments.length?(b=a,g()):b},f.rangeRound=function(a){return f.range(a).interpolate(pf)},f.clamp=function(a){return arguments.length?(e=a,g()):e},f.interpolate=function(a){return arguments.length?
(d=a,g()):d},f.ticks=function(b){return r.range.apply(r,Xa(a,b))},f.tickFormat=function(b,d){return Bd(a,b,d)},f.nice=function(b){return pc(a,Ff(Xa(a,b)[2])),g()},f.copy=function(){return Gf(a,b,d,e)},g()}function Cd(a,b){return r.rebind(a,b,"range","rangeRound","interpolate","clamp")}function Xa(a,b){null==b&&(b=10);var d=sb(a),e=d[1]-d[0],g=Math.pow(10,Math.floor(Math.log(e/b)/Math.LN10)),e=b/e*g;return.15>=e?g*=10:.35>=e?g*=5:.75>=e&&(g*=2),d[0]=Math.ceil(d[0]/g)*g,d[1]=Math.floor(d[1]/g)*g+.5*
g,d[2]=g,d}function Bd(a,b,d){a=Xa(a,b);if(d){b=pe.exec(d);if(b.shift(),"s"===b[8]){var e=r.formatPrefix(Math.max(F(a[0]),F(a[1])));return b[7]||(b[7]="."+qc(e.scale(a[2]))),b[8]="f",d=r.format(b.join("")),function(a){return d(e.scale(a))+e.symbol}}b[7]||(b[7]="."+Vh(b[8],a));d=b.join("")}else d=",."+qc(a[2])+"f";return r.format(d)}function qc(a){return-Math.floor(Math.log(a)/Math.LN10+.01)}function Vh(a,b){var d=qc(b[2]);return a in Wh?Math.abs(d-qc(Math.max(F(b[0]),F(b[1]))))+ +("e"!==a):d-2*("%"===
a)}function Hf(a,b,d,e){function g(a){return(d?Math.log(0>a?0:a):-Math.log(0<a?0:-a))/Math.log(b)}function f(a){return d?Math.pow(b,a):-Math.pow(b,-a)}function k(b){return a(g(b))}return k.invert=function(b){return f(a.invert(b))},k.domain=function(b){return arguments.length?(d=0<=b[0],a.domain((e=b.map(Number)).map(g)),k):e},k.base=function(d){return arguments.length?(b=+d,a.domain(e.map(g)),k):b},k.nice=function(){var b=pc(e.map(g),d?Math:Xh);return a.domain(b),e=b.map(f),k},k.ticks=function(){var a=
sb(e),h=[],k=a[0],a=a[1],l=Math.floor(g(k)),m=Math.ceil(g(a)),n=b%1?2:b;if(isFinite(m-l)){if(d){for(;m>l;l++)for(var p=1;n>p;p++)h.push(f(l)*p);h.push(f(l))}else for(h.push(f(l));l++<m;)for(p=n-1;0<p;p--)h.push(f(l)*p);for(l=0;h[l]<k;l++);for(m=h.length;h[m-1]>a;m--);h=h.slice(l,m)}return h},k.tickFormat=function(a,b){if(!arguments.length)return If;2>arguments.length?b=If:"function"!=typeof b&&(b=r.format(b));var h,e=Math.max(.1,a/k.ticks().length),x=d?(h=1E-12,Math.ceil):(h=-1E-12,Math.floor);return function(a){return a/
f(x(g(a)+h))<=e?b(a):""}},k.copy=function(){return Hf(a.copy(),b,d,e)},Cd(k,a)}function Jf(a,b,d){function e(b){return a(g(b))}var g=rc(b),f=rc(1/b);return e.invert=function(b){return f(a.invert(b))},e.domain=function(b){return arguments.length?(a.domain((d=b.map(Number)).map(g)),e):d},e.ticks=function(a){return r.range.apply(r,Xa(d,a))},e.tickFormat=function(a,b){return Bd(d,a,b)},e.nice=function(a){return e.domain(pc(d,Ff(Xa(d,a)[2])))},e.exponent=function(k){return arguments.length?(g=rc(b=k),
f=rc(1/b),a.domain(d.map(g)),e):b},e.copy=function(){return Jf(a.copy(),b,d)},Cd(e,a)}function rc(a){return function(b){return 0>b?-Math.pow(-b,a):Math.pow(b,a)}}function Kf(a,b){function d(e){return f[((g.get(e)||("range"===b.t?g.set(e,a.push(e)):0/0))-1)%f.length]}function e(b,d){return r.range(a.length).map(function(a){return b+d*a})}var g,f,l;return d.domain=function(e){if(!arguments.length)return a;a=[];g=new k;for(var f,l=-1,m=e.length;++l<m;)g.has(f=e[l])||g.set(f,a.push(f));return d[b.t].apply(d,
b.a)},d.range=function(a){return arguments.length?(f=a,l=0,b={t:"range",a:arguments},d):f},d.rangePoints=function(g,k){2>arguments.length&&(k=0);var m=g[0],n=g[1],P=(n-m)/(Math.max(1,a.length-1)+k);return f=e(2>a.length?(m+n)/2:m+P*k/2,P),l=0,b={t:"rangePoints",a:arguments},d},d.rangeBands=function(g,k,m){2>arguments.length&&(k=0);3>arguments.length&&(m=k);var n=g[1]<g[0],P=g[n-0],p=(g[1-n]-P)/(a.length-k+2*m);return f=e(P+p*m,p),n&&f.reverse(),l=p*(1-k),b={t:"rangeBands",a:arguments},d},d.rangeRoundBands=
function(g,k,m){2>arguments.length&&(k=0);3>arguments.length&&(m=k);var n=g[1]<g[0],P=g[n-0],p=g[1-n],q=Math.floor((p-P)/(a.length-k+2*m));return f=e(P+Math.round((p-P-(a.length-k)*q)/2),q),n&&f.reverse(),l=Math.round(q*(1-k)),b={t:"rangeRoundBands",a:arguments},d},d.rangeBand=function(){return l},d.rangeExtent=function(){return sb(b.a[0])},d.copy=function(){return Kf(a,b)},d.domain(a)}function Lf(a,b){function g(){var d=0,e=b.length;for(l=[];++d<e;)l[d-1]=r.quantile(a,d/e);return k}function k(a){return isNaN(a=
+a)?void 0:b[r.bisect(l,a)]}var l;return k.domain=function(b){return arguments.length?(a=b.map(e).filter(d).sort(f),g()):a},k.range=function(a){return arguments.length?(b=a,g()):b},k.quantiles=function(){return l},k.invertExtent=function(d){return d=b.indexOf(d),0>d?[0/0,0/0]:[0<d?l[d-1]:a[0],d<l.length?l[d]:a[a.length-1]]},k.copy=function(){return Lf(a,b)},g()}function Mf(a,b,d){function e(b){return d[Math.max(0,Math.min(k,Math.floor(f*(b-a))))]}function g(){return f=d.length/(b-a),k=d.length-1,
e}var f,k;return e.domain=function(d){return arguments.length?(a=+d[0],b=+d[d.length-1],g()):[a,b]},e.range=function(a){return arguments.length?(d=a,g()):d},e.invertExtent=function(b){return b=d.indexOf(b),b=0>b?0/0:b/f+a,[b,b+1/f]},e.copy=function(){return Mf(a,b,d)},g()}function Nf(a,b){function d(e){return e>=e?b[r.bisect(a,e)]:void 0}return d.domain=function(b){return arguments.length?(a=b,d):a},d.range=function(a){return arguments.length?(b=a,d):b},d.invertExtent=function(d){return d=b.indexOf(d),
[a[d-1],a[d]]},d.copy=function(){return Nf(a,b)},d}function Of(a){function b(a){return+a}return b.invert=b,b.domain=b.range=function(d){return arguments.length?(a=d.map(b),b):a},b.ticks=function(b){return r.range.apply(r,Xa(a,b))},b.tickFormat=function(b,d){return Bd(a,b,d)},b.copy=function(){return Of(a)},b}function Yh(a){return a.innerRadius}function Zh(a){return a.outerRadius}function Pf(a){return a.startAngle}function Qf(a){return a.endAngle}function Rf(a){function b(k){function x(){n.push("M",
f(a(p),l))}for(var m,n=[],p=[],q=-1,r=k.length,fa=V(d),w=V(e);++q<r;)g.call(this,m=k[q],q)?p.push([+fa.call(this,m,q),+w.call(this,m,q)]):p.length&&(x(),p=[]);return p.length&&x(),n.length?n.join(""):null}var d=nb,e=Cb,g=mb,f=ra,k=f.key,l=.7;return b.x=function(a){return arguments.length?(d=a,b):d},b.y=function(a){return arguments.length?(e=a,b):e},b.defined=function(a){return arguments.length?(g=a,b):g},b.interpolate=function(a){return arguments.length?(k="function"==typeof a?f=a:(f=Dd.get(a)||ra).key,
b):k},b.tension=function(a){return arguments.length?(l=a,b):l},b}function ra(a){return a.join("L")}function Ed(a){for(var b=0,d=a.length,e=a[0],g=[e[0],",",e[1]];++b<d;)g.push("V",(e=a[b])[1],"H",e[0]);return g.join("")}function Fd(a){for(var b=0,d=a.length,e=a[0],g=[e[0],",",e[1]];++b<d;)g.push("H",(e=a[b])[0],"V",e[1]);return g.join("")}function sc(a,b){if(1>b.length||a.length!=b.length&&a.length!=b.length+2)return ra(a);var d=a.length!=b.length,e="",g=a[0],f=a[1],k=b[0],l=k,m=1;if(d&&(e+="Q"+(f[0]-
2*k[0]/3)+","+(f[1]-2*k[1]/3)+","+f[0]+","+f[1],g=a[1],m=2),1<b.length)for(l=b[1],f=a[m],m++,e+="C"+(g[0]+k[0])+","+(g[1]+k[1])+","+(f[0]-l[0])+","+(f[1]-l[1])+","+f[0]+","+f[1],g=2;g<b.length;g++,m++)f=a[m],l=b[g],e+="S"+(f[0]-l[0])+","+(f[1]-l[1])+","+f[0]+","+f[1];d&&(d=a[m],e+="Q"+(f[0]+2*l[0]/3)+","+(f[1]+2*l[1]/3)+","+d[0]+","+d[1]);return e}function Gd(a,b){for(var d,e=[],g=(1-b)/2,f=a[0],k=a[1],l=1,m=a.length;++l<m;)d=f,f=k,k=a[l],e.push([g*(k[0]-d[0]),g*(k[1]-d[1])]);return e}function Sf(a){if(3>
a.length)return ra(a);var b=1,d=a.length,e=a[0],g=e[0],f=e[1],k=[g,g,g,(e=a[1])[0]],l=[f,f,f,e[1]],g=[g,",",f,"L",va(Ya,k),",",va(Ya,l)];for(a.push(a[d-1]);++b<=d;)e=a[b],k.shift(),k.push(e[0]),l.shift(),l.push(e[1]),Hd(g,k,l);return a.pop(),g.push("L",e),g.join("")}function va(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function Hd(a,b,d){a.push("C",va(Tf,b),",",va(Tf,d),",",va(Uf,b),",",va(Uf,d),",",va(Ya,b),",",va(Ya,d))}function Id(a,b){return(b[1]-a[1])/(b[0]-a[0])}function Vf(a){for(var b,
d,e,g=-1,f=a.length;++g<f;)b=a[g],d=b[0],e=b[1]+fb,b[0]=d*Math.cos(e),b[1]=d*Math.sin(e);return a}function Wf(a){function b(x){function m(){t.push("M",l(a(O),q),p,n(a(v.reverse()),q),"Z")}for(var r,Xd,w,t=[],v=[],O=[],S=-1,A=x.length,z=V(d),y=V(g),Q=d===e?function(){return Xd}:V(e),D=g===f?function(){return w}:V(f);++S<A;)k.call(this,r=x[S],S)?(v.push([Xd=+z.call(this,r,S),w=+y.call(this,r,S)]),O.push([+Q.call(this,r,S),+D.call(this,r,S)])):v.length&&(m(),v=[],O=[]);return v.length&&m(),t.length?
t.join(""):null}var d=nb,e=nb,g=0,f=Cb,k=mb,l=ra,m=l.key,n=l,p="L",q=.7;return b.x=function(a){return arguments.length?(d=e=a,b):e},b.x0=function(a){return arguments.length?(d=a,b):d},b.x1=function(a){return arguments.length?(e=a,b):e},b.y=function(a){return arguments.length?(g=f=a,b):f},b.y0=function(a){return arguments.length?(g=a,b):g},b.y1=function(a){return arguments.length?(f=a,b):f},b.defined=function(a){return arguments.length?(k=a,b):k},b.interpolate=function(a){return arguments.length?(m=
"function"==typeof a?l=a:(l=Dd.get(a)||ra).key,n=l.reverse||l,p=l.closed?"M":"L",b):m},b.tension=function(a){return arguments.length?(q=a,b):q},b}function $h(a){return a.radius}function Xf(a){return[a.x,a.y]}function ai(a){return function(){var b=a.apply(this,arguments),d=b[0],b=b[1]+fb;return[d*Math.cos(b),d*Math.sin(b)]}}function bi(){return 64}function ci(){return"circle"}function Yf(a){a=Math.sqrt(a/I);return"M0,"+a+"A"+a+","+a+" 0 1,1 0,"+-a+"A"+a+","+a+" 0 1,1 0,"+a+"Z"}function Kb(a,b){return Mb(a,
ba),a.id=b,a}function Jd(a,b,d,e){var g=a.id;return Ha(a,"function"==typeof d?function(a,h,f){a.__transition__[g].tween.set(b,e(d.call(a,a.__data__,h,f)))}:(d=e(d),function(a){a.__transition__[g].tween.set(b,d)}))}function di(a){return null==a&&(a=""),function(){this.textContent=a}}function tc(a,b,d,e){var g=a.__transition__||(a.__transition__={active:0,count:0}),f=g[d];if(!f){var l=e.time,f=g[d]={tween:new k,time:l,ease:e.ease,delay:e.delay,duration:e.duration};++g.count;r.timer(function(e){function k(e){return g.active>
d?n():(g.active=d,f.event&&f.event.start.call(a,J,b),f.tween.forEach(function(d,e){(e=e.call(a,J,b))&&v.push(e)}),r.timer(function(){return t.c=m(e||1)?mb:m,1},0,l),void 0)}function m(e){if(g.active!==d)return n();e/=w;for(var k=p(e),l=v.length;0<l;)v[--l].call(a,k);return 1<=e?(f.event&&f.event.end.call(a,J,b),n()):void 0}function n(){return--g.count?delete g[d]:delete a.__transition__,1}var J=a.__data__,p=f.ease,q=f.delay,w=f.duration,t=Ka,v=[];return t.t=q+l,e>=q?k(e-q):(t.c=k,void 0)},0,l)}}function ei(a,
b,d){a.attr("transform",function(a){var h=b(a);return"translate("+(isFinite(h)?h:d(a))+",0)"})}function fi(a,b,d){a.attr("transform",function(a){var h=b(a);return"translate(0,"+(isFinite(h)?h:d(a))+")"})}function Kd(a){return a.toISOString()}function Ld(a,b,d){function e(b){return a(b)}function g(a,h){var d=(a[1]-a[0])/h,e=r.bisect(uc,d);return e==uc.length?[b.year,Xa(a.map(function(a){return a/31536E6}),h)[2]]:e?b[d/uc[e-1]<uc[e]/d?e-1:e]:[gi,Xa(a,h)[2]]}return e.invert=function(b){return gb(a.invert(b))},
e.domain=function(b){return arguments.length?(a.domain(b),e):a.domain().map(gb)},e.nice=function(a,b){function h(d){return!isNaN(d)&&!a.range(d,gb(+d+1),b).length}var d=e.domain(),f=sb(d),f=null==a?g(f,10):"number"==typeof a&&g(f,a);return f&&(a=f[0],b=f[1]),e.domain(pc(d,1<b?{floor:function(b){for(;h(b=a.floor(b));)b=gb(b-1);return b},ceil:function(b){for(;h(b=a.ceil(b));)b=gb(+b+1);return b}}:a))},e.ticks=function(a,b){var h=sb(e.domain()),d=null==a?g(h,10):"number"==typeof a?g(h,a):!a.range&&[{range:a},
b];return d&&(a=d[0],b=d[1]),a.range(h[0],gb(+h[1]+1),1>b?1:b)},e.tickFormat=function(){return d},e.copy=function(){return Ld(a.copy(),b,d)},Cd(e,a)}function gb(a){return new Date(a)}function hi(a){return JSON.parse(a.responseText)}function ii(a){var b=Ba.createRange();return b.selectNode(Ba.body),b.createContextualFragment(a.responseText)}var r={version:"3.4.13"};Date.now||(Date.now=function(){return+new Date});var Zf=[].slice,Ra=function(a){return Zf.call(a)},Ba=document,Ja=Ba.documentElement,ha=
window;try{Ra(Ja.childNodes)[0].nodeType}catch(Ii){Ra=function(a){for(var b=a.length,d=Array(b);b--;)d[b]=a[b];return d}}try{Ba.createElement("div").style.setProperty("opacity",0,"")}catch(Ji){var vc=ha.Element.prototype,ji=vc.setAttribute,ki=vc.setAttributeNS,$f=ha.CSSStyleDeclaration.prototype,li=$f.setProperty;vc.setAttribute=function(a,b){ji.call(this,a,b+"")};vc.setAttributeNS=function(a,b,d){ki.call(this,a,b,d+"")};$f.setProperty=function(a,b,d){li.call(this,a,b+"",d)}}r.ascending=f;r.descending=
function(a,b){return a>b?-1:b>a?1:b>=a?0:0/0};r.min=function(a,b){var d,e,g=-1,f=a.length;if(1===arguments.length){for(;++g<f&&!(null!=(d=a[g])&&d>=d);)d=void 0;for(;++g<f;)null!=(e=a[g])&&d>e&&(d=e)}else{for(;++g<f&&!(null!=(d=b.call(a,a[g],g))&&d>=d);)d=void 0;for(;++g<f;)null!=(e=b.call(a,a[g],g))&&d>e&&(d=e)}return d};r.max=function(a,b){var d,e,g=-1,f=a.length;if(1===arguments.length){for(;++g<f&&!(null!=(d=a[g])&&d>=d);)d=void 0;for(;++g<f;)null!=(e=a[g])&&e>d&&(d=e)}else{for(;++g<f&&!(null!=
(d=b.call(a,a[g],g))&&d>=d);)d=void 0;for(;++g<f;)null!=(e=b.call(a,a[g],g))&&e>d&&(d=e)}return d};r.extent=function(a,b){var d,e,g,f=-1,k=a.length;if(1===arguments.length){for(;++f<k&&!(null!=(d=g=a[f])&&d>=d);)d=g=void 0;for(;++f<k;)null!=(e=a[f])&&(d>e&&(d=e),e>g&&(g=e))}else{for(;++f<k&&!(null!=(d=g=b.call(a,a[f],f))&&d>=d);)d=void 0;for(;++f<k;)null!=(e=b.call(a,a[f],f))&&(d>e&&(d=e),e>g&&(g=e))}return[d,g]};r.sum=function(a,b){var e,g=0,f=a.length,k=-1;if(1===arguments.length)for(;++k<f;)d(e=
+a[k])&&(g+=e);else for(;++k<f;)d(e=+b.call(a,a[k],k))&&(g+=e);return g};r.mean=function(a,b){var g,f=0,k=a.length,l=-1,m=k;if(1===arguments.length)for(;++l<k;)d(g=e(a[l]))?f+=g:--m;else for(;++l<k;)d(g=e(b.call(a,a[l],l)))?f+=g:--m;return m?f/m:void 0};r.quantile=function(a,b){var d=(a.length-1)*b+1,e=Math.floor(d),g=+a[e-1];return(d-=e)?g+d*(a[e]-g):g};r.median=function(a,b){var g,k=[],l=a.length,m=-1;if(1===arguments.length)for(;++m<l;)d(g=e(a[m]))&&k.push(g);else for(;++m<l;)d(g=e(b.call(a,a[m],
m)))&&k.push(g);return k.length?r.quantile(k.sort(f),.5):void 0};var ag=b(f);r.bisectLeft=ag.left;r.bisect=r.bisectRight=ag.right;r.bisector=function(a){return b(1===a.length?function(b,d){return f(a(b),d)}:a)};r.shuffle=function(a){for(var b,d,e=a.length;e;)d=0|Math.random()*e--,b=a[e],a[e]=a[d],a[d]=b;return a};r.permute=function(a,b){for(var d=b.length,e=Array(d);d--;)e[d]=a[b[d]];return e};r.pairs=function(a){for(var b=0,d=a.length-1,e=a[0],g=Array(0>d?0:d);d>b;)g[b]=[e,e=a[++b]];return g};r.zip=
function(){if(!(g=arguments.length))return[];for(var b=-1,d=r.min(arguments,a),e=Array(d);++b<d;)for(var g,f=-1,k=e[b]=Array(g);++f<g;)k[f]=arguments[f][b];return e};r.transpose=function(a){return r.zip.apply(r,a)};r.keys=function(a){var b=[],d;for(d in a)b.push(d);return b};r.values=function(a){var b=[],d;for(d in a)b.push(a[d]);return b};r.entries=function(a){var b=[],d;for(d in a)b.push({key:d,value:a[d]});return b};r.merge=function(a){var b,d,e,g=a.length;b=-1;for(var f=0;++b<g;)f+=a[b].length;
for(d=Array(f);0<=--g;)for(e=a[g],b=e.length;0<=--b;)d[--f]=e[b];return d};var F=Math.abs;r.range=function(a,b,d){if(3>arguments.length&&(d=1,2>arguments.length&&(b=a,a=0)),1/0===(b-a)/d)throw Error("infinite range");var e,g=[],f;e=F(d);for(f=1;e*f%1;)f*=10;var k=-1;if(a*=f,b*=f,d*=f,0>d)for(;(e=a+d*++k)>b;)g.push(e/f);else for(;(e=a+d*++k)<b;)g.push(e/f);return g};r.map=function(a){var b=new k;if(a instanceof k)a.forEach(function(a,h){b.set(a,h)});else for(var d in a)b.set(d,a[d]);return b};var tg=
"__proto__",Lc="\x00";g(k,{has:n,get:function(a){return this._[l(a)]},set:function(a,b){return this._[l(a)]=b},remove:p,keys:q,values:function(){var a=[],b;for(b in this._)a.push(this._[b]);return a},entries:function(){var a=[],b;for(b in this._)a.push({key:m(b),value:this._[b]});return a},size:t,empty:v,forEach:function(a){for(var b in this._)a.call(this,m(b),this._[b])}});r.nest=function(){function a(b,l,m){if(m>=f.length)return e?e.call(g,l):d?l.sort(d):l;for(var x,n,p,q,r=-1,w=l.length,fa=f[m++],
t=new k;++r<w;)(q=t.get(x=fa(n=l[r])))?q.push(n):t.set(x,[n]);return b?(n=b(),p=function(d,e){n.set(d,a(b,e,m))}):(n={},p=function(d,e){n[d]=a(b,e,m)}),t.forEach(p),n}function b(a,h){if(h>=f.length)return a;var d=[],e=l[h++];return a.forEach(function(a,e){d.push({key:a,values:b(e,h)})}),e?d.sort(function(a,b){return e(a.key,b.key)}):d}var d,e,g={},f=[],l=[];return g.map=function(b,d){return a(d,b,0)},g.entries=function(d){return b(a(r.map,d,0),0)},g.key=function(a){return f.push(a),g},g.sortKeys=
function(a){return l[f.length-1]=a,g},g.sortValues=function(a){return d=a,g},g.rollup=function(a){return e=a,g},g};r.set=function(a){var b=new w;if(a)for(var d=0,e=a.length;e>d;++d)b.add(a[d]);return b};g(w,{has:n,add:function(a){return this._[l(a+="")]=!0,a},remove:p,values:q,size:t,empty:v,forEach:function(a){for(var b in this._)a.call(this,m(b))}});r.behavior={};r.rebind=function(a,b){for(var d,e=1,g=arguments.length;++e<g;)a[d=arguments[e]]=y(a,b,b[d]);return a};var Wd="webkit ms moz Moz o O".split(" ");
r.dispatch=function(){for(var a=new A,b=-1,d=arguments.length;++b<d;)a[arguments[b]]=z(a);return a};A.prototype.on=function(a,b){var d=a.indexOf("."),e="";if(0<=d&&(e=a.slice(d+1),a=a.slice(0,d)),a)return 2>arguments.length?this[a].on(e):this[a].on(e,b);if(2===arguments.length){if(null==b)for(a in this)this.hasOwnProperty(a)&&this[a].on(e,null);return this}};r.event=null;r.requote=function(a){return a.replace(mi,"\\$&")};var mi=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,Mb={}.__proto__?function(a,b){a.__proto__=
b}:function(a,b){for(var d in b)a[d]=b[d]},Mc=function(a,b){return b.querySelector(a)},Nc=function(a,b){return b.querySelectorAll(a)},ni=Ja.matches||Ja[K(Ja,"matchesSelector")],Yd=function(a,b){return ni.call(a,b)};"function"==typeof Sizzle&&(Mc=function(a,b){return Sizzle(a,b)[0]||null},Nc=Sizzle,Yd=Sizzle.matchesSelector);r.selection=function(){return bg};var R=r.selection.prototype=[];R.select=function(a){var b,d,e,g,f=[];a=W(a);for(var k=-1,l=this.length;++k<l;){f.push(b=[]);b.parentNode=(e=this[k]).parentNode;
for(var m=-1,n=e.length;++m<n;)(g=e[m])?(b.push(d=a.call(g,g.__data__,m,k)),d&&"__data__"in g&&(d.__data__=g.__data__)):b.push(null)}return ma(f)};R.selectAll=function(a){var b,d,e=[];a=vb(a);for(var g=-1,f=this.length;++g<f;)for(var k=this[g],l=-1,m=k.length;++l<m;)(d=k[l])&&(e.push(b=Ra(a.call(d,d.__data__,l,g))),b.parentNode=d);return ma(e)};var Md={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",
xmlns:"http://www.w3.org/2000/xmlns/"};r.ns={prefix:Md,qualify:function(a){var b=a.indexOf(":"),d=a;return 0<=b&&(d=a.slice(0,b),a=a.slice(b+1)),Md.hasOwnProperty(d)?{space:Md[d],local:a}:a}};R.attr=function(a,b){if(2>arguments.length){if("string"==typeof a){var d=this.node();return a=r.ns.qualify(a),a.local?d.getAttributeNS(a.space,a.local):d.getAttribute(a)}for(b in a)this.each(Td(b,a[b]));return this}return this.each(Td(a,b))};R.classed=function(a,b){if(2>arguments.length){if("string"==typeof a){var d=
this.node(),e=(a=(a+"").trim().split(/^|\s+/)).length,g=-1;if(b=d.classList)for(;++g<e;){if(!b.contains(a[g]))return!1}else for(b=d.getAttribute("class");++g<e;)if(!Qa(a[g]).test(b))return!1;return!0}for(b in a)this.each(Vd(b,a[b]));return this}return this.each(Vd(a,b))};R.style=function(a,b,d){var e=arguments.length;if(3>e){if("string"!=typeof a){2>e&&(b="");for(d in a)this.each(wb(d,a[d],b));return this}if(2>e)return ha.getComputedStyle(this.node(),null).getPropertyValue(a);d=""}return this.each(wb(a,
b,d))};R.property=function(a,b){if(2>arguments.length){if("string"==typeof a)return this.node()[a];for(b in a)this.each(Z(b,a[b]));return this}return this.each(Z(a,b))};R.text=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}:null==a?function(){this.textContent=""}:function(){this.textContent=a}):this.node().textContent};R.html=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=
a.apply(this,arguments);this.innerHTML=null==b?"":b}:null==a?function(){this.innerHTML=""}:function(){this.innerHTML=a}):this.node().innerHTML};R.append=function(a){return a=Ga(a),this.select(function(){return this.appendChild(a.apply(this,arguments))})};R.insert=function(a,b){return a=Ga(a),b=W(b),this.select(function(){return this.insertBefore(a.apply(this,arguments),b.apply(this,arguments)||null)})};R.remove=function(){return this.each(function(){var a=this.parentNode;a&&a.removeChild(this)})};
R.data=function(a,b){function d(a,h){var e,g,f,l=a.length,E=h.length,J=Math.min(l,E),q=Array(E),N=Array(E),r=Array(l);if(b){var P,J=new k,w=Array(l);for(e=-1;++e<l;)J.has(P=b.call(g=a[e],g.__data__,e))?r[e]=g:J.set(P,g),w[e]=P;for(e=-1;++e<E;)(g=J.get(P=b.call(h,f=h[e],e)))?!0!==g&&(q[e]=g,g.__data__=f):N[e]={__data__:f},J.set(P,!0);for(e=-1;++e<l;)!0!==J.get(w[e])&&(r[e]=a[e])}else{for(e=-1;++e<J;)g=a[e],f=h[e],g?(g.__data__=f,q[e]=g):N[e]={__data__:f};for(;E>e;++e)N[e]={__data__:h[e]};for(;l>e;++e)r[e]=
a[e]}N.update=q;N.parentNode=q.parentNode=r.parentNode=a.parentNode;m.push(N);n.push(q);p.push(r)}var e,g,f=-1,l=this.length;if(!arguments.length){for(a=Array(l=(e=this[0]).length);++f<l;)(g=e[f])&&(a[f]=g.__data__);return a}var m=Zd([]),n=ma([]),p=ma([]);if("function"==typeof a)for(;++f<l;)d(e=this[f],a.call(e,e.parentNode.__data__,f));else for(;++f<l;)d(e=this[f],a);return n.enter=function(){return m},n.exit=function(){return p},n};R.datum=function(a){return arguments.length?this.property("__data__",
a):this.property("__data__")};R.filter=function(a){var b,d,e,g=[];"function"!=typeof a&&(a=wa(a));for(var f=0,k=this.length;k>f;f++){g.push(b=[]);b.parentNode=(d=this[f]).parentNode;for(var l=0,m=d.length;m>l;l++)(e=d[l])&&a.call(e,e.__data__,l,f)&&b.push(e)}return ma(g)};R.order=function(){for(var a=-1,b=this.length;++a<b;)for(var d,e=this[a],g=e.length-1,f=e[g];0<=--g;)(d=e[g])&&(f&&f!==d.nextSibling&&f.parentNode.insertBefore(d,f),f=d);return this};R.sort=function(a){a=ug.apply(this,arguments);
for(var b=-1,d=this.length;++b<d;)this[b].sort(a);return this.order()};R.each=function(a){return Ha(this,function(b,d,e){a.call(b,b.__data__,d,e)})};R.call=function(a){var b=Ra(arguments);return a.apply(b[0]=this,b),this};R.empty=function(){return!this.node()};R.node=function(){for(var a=0,b=this.length;b>a;a++)for(var d=this[a],e=0,g=d.length;g>e;e++){var f=d[e];if(f)return f}return null};R.size=function(){var a=0;return Ha(this,function(){++a}),a};var Ia=[];r.selection.enter=Zd;r.selection.enter.prototype=
Ia;Ia.append=R.append;Ia.empty=R.empty;Ia.node=R.node;Ia.call=R.call;Ia.size=R.size;Ia.select=function(a){for(var b,d,e,g,f,k=[],l=-1,m=this.length;++l<m;){e=(g=this[l]).update;k.push(b=[]);b.parentNode=g.parentNode;for(var n=-1,p=g.length;++n<p;)(f=g[n])?(b.push(e[n]=d=a.call(g.parentNode,f.__data__,n,l)),d.__data__=f.__data__):b.push(null)}return ma(k)};Ia.insert=function(a,b){return 2>arguments.length&&(b=vg(this)),R.insert.call(this,a,b)};R.transition=function(){for(var a,b,d=hb||++cg,e=[],g=
wc||{time:Date.now(),ease:ph,delay:0,duration:250},f=-1,k=this.length;++f<k;){e.push(a=[]);for(var l=this[f],m=-1,n=l.length;++m<n;)(b=l[m])&&tc(b,m,d,g),a.push(b)}return Kb(e,d)};R.interrupt=function(){return this.each(Nb)};r.select=function(a){a=["string"==typeof a?Mc(a,Ba):a];return a.parentNode=Ja,ma([a])};r.selectAll=function(a){a=Ra("string"==typeof a?Nc(a,Ba):a);return a.parentNode=Ja,ma([a])};var bg=r.select(Ja);R.on=function(a,b,d){var e=arguments.length;if(3>e){if("string"!=typeof a){2>
e&&(b=!1);for(d in a)this.each($d(d,a[d],b));return this}if(2>e)return(e=this.node()["__on"+a])&&e._;d=!1}return this.each($d(a,b,d))};var Oc=r.map({mouseenter:"mouseover",mouseleave:"mouseout"});Oc.forEach(function(a){"on"+a in Ba&&Oc.remove(a)});var xb="onselectstart"in Ba?null:K(Ja.style,"userSelect"),xg=0;r.mouse=function(a){return Pc(a,T())};var Qc=/WebKit/.test(ha.navigator.userAgent)?-1:0;r.touch=function(a,b,d){if(3>arguments.length&&(d=b,b=T().changedTouches),b)for(var e,g=0,f=b.length;f>
g;++g)if((e=b[g]).identifier===d)return Pc(a,e)};r.behavior.drag=function(){function a(){this.on("mousedown.drag",g).on("touchstart.drag",f)}function b(a,h,g,f,k){return function(){var b,l=r.event.target,m=this.parentNode,n=d.of(this,arguments),x=0,p=a(),q=".drag"+(null==p?"":"-"+p),N=r.select(g()).on(f+q,function(){var a,d,e=h(m,p);e&&(a=e[0]-w[0],d=e[1]-w[1],x=x|a|d,w=e,n({type:"drag",x:e[0]+b[0],y:e[1]+b[1],dx:a,dy:d}))}).on(k+q,function(){h(m,p)&&(N.on(f+q,null).on(k+q,null),P(x&&r.event.target===
l),n({type:"dragend"}))}),P=Ob(),w=h(m,p);e?(b=e.apply(this,arguments),b=[b.x-w[0],b.y-w[1]]):b=[0,0];n({type:"dragstart"})}}var d=da(a,"drag","dragstart","dragend"),e=null,g=b(D,r.mouse,Ag,"mousemove","mouseup"),f=b(yg,r.touch,zg,"touchmove","touchend");return a.origin=function(b){return arguments.length?(e=b,a):e},r.rebind(a,d,"on")};r.touches=function(a,b){return 2>arguments.length&&(b=T().touches),b?Ra(b).map(function(b){var d=Pc(a,b);return d.identifier=b.identifier,d}):[]};var I=Math.PI,qa=
2*I,ea=I/2,C=1E-6,od=C*C,H=I/180,X=180/I,xc=Math.SQRT2;r.interpolateZoom=function(a,b){function d(a){var b=a*t;if(w){a=ce(r);var h=f/(2*p),k,n=xc*b+r;k=((n=Math.exp(2*n))-1)/(n+1);k*=a;var x=r,n=((x=Math.exp(x))-1/x)/2,h=h*(k-n);return[e+h*l,g+h*m,f*a/ce(xc*b+r)]}return[e+a*l,g+a*m,f*Math.exp(xc*b)]}var e=a[0],g=a[1],f=a[2],k=b[2],l=b[0]-e,m=b[1]-g,n=l*l+m*m,p=Math.sqrt(n),q=(k*k-f*f+4*n)/(4*f*p),n=(k*k-f*f-4*n)/(4*k*p),r=Math.log(Math.sqrt(q*q+1)-q),w=Math.log(Math.sqrt(n*n+1)-n)-r,t=(w||Math.log(k/
f))/xc;return d.duration=1E3*t,d};r.behavior.zoom=function(){function a(b){b.on(D,m).on(oi+".zoom",p).on("dblclick.zoom",q).on(C,n)}function b(a){return[(a[0]-G.x)/G.k,(a[1]-G.y)/G.k]}function d(a){G.k=Math.max(Xb[0],Math.min(Xb[1],a))}function e(a,b){b=[b[0]*G.k+G.x,b[1]*G.k+G.y];G.x+=a[0]-b[0];G.y+=a[1]-b[1]}function g(){L&&L.domain(y.range().map(function(a){return(a-G.x)/G.k}).map(y.invert));S&&S.domain(O.range().map(function(a){return(a-G.y)/G.k}).map(O.invert))}function f(a){a({type:"zoomstart"})}
function k(a){g();a({type:"zoom",scale:G.k,translate:[G.x,G.y]})}function l(a){a({type:"zoomend"})}function m(){var a=this,d=r.event.target,h=T.of(a,arguments),g=0,n=r.select(ha).on(K,function(){g=1;e(r.mouse(a),p);k(h)}).on(B,function(){n.on(K,null).on(B,null);E(g&&r.event.target===d);l(h)}),p=b(r.mouse(a)),E=Ob();Nb.call(a);f(h)}function n(){function a(){var d=r.touches(P);return q=G.k,d.forEach(function(a){a.identifier in t&&(t[a.identifier]=b(a))}),d}function h(){var b=r.event.target;r.select(b).on(U,
g).on(O,p);Sa.push(b);for(var b=r.event.changedTouches,f=0,l=b.length;l>f;++f)t[b[f].identifier]=null;l=a();f=Date.now();1===l.length?(500>f-z&&(b=l[0],l=t[b.identifier],d(2*G.k),e(b,l),Q(),k(w)),z=f):1<l.length&&(b=l[0],l=l[1],f=b[0]-l[0],b=b[1]-l[1],v=f*f+b*b)}function g(){for(var a,b,h,f,l=r.touches(P),m=0,n=l.length;n>m;++m,f=null)if(h=l[m],f=t[h.identifier]){if(b)break;a=h;b=f}if(f){var x=(x=h[0]-a[0])*x+(x=h[1]-a[1])*x,l=v&&Math.sqrt(x/v);a=[(a[0]+h[0])/2,(a[1]+h[1])/2];b=[(b[0]+f[0])/2,(b[1]+
f[1])/2];d(l*q)}z=null;e(a,b);k(w)}function p(){if(r.event.touches.length){for(var b=r.event.changedTouches,d=0,h=b.length;h>d;++d)delete t[b[d].identifier];for(var e in t)return void a()}r.selectAll(Sa).on(aa,null);A.on(D,m).on(C,n);L();l(w)}var q,P=this,w=T.of(P,arguments),t={},v=0,aa=".zoom-"+r.event.changedTouches[0].identifier,U="touchmove"+aa,O="touchend"+aa,Sa=[],A=r.select(P),L=Ob();Nb.call(P);h();f(w);A.on(D,null).on(C,h)}function p(){var a=T.of(this,arguments);A?clearTimeout(A):(w=b(t=v||
r.mouse(this)),Nb.call(this),f(a));A=setTimeout(function(){A=null;l(a)},50);Q();d(Math.pow(2,.002*yc())*G.k);e(t,w);k(a)}function q(){var a=T.of(this,arguments),h=r.mouse(this),g=b(h),m=Math.log(G.k)/Math.LN2;f(a);d(Math.pow(2,r.event.shiftKey?Math.ceil(m)-1:Math.floor(m)+1));e(h,g);k(a);l(a)}var w,t,v,A,z,y,L,O,S,G={x:0,y:0,k:1},Wb=[960,500],Xb=dg,D="mousedown.zoom",K="mousemove.zoom",B="mouseup.zoom",C="touchstart.zoom",T=da(a,"zoomstart","zoom","zoomend");return a.event=function(a){a.each(function(){var a=
T.of(this,arguments),b=G;hb?r.select(this).transition().each("start.zoom",function(){G=this.__chart__||{x:0,y:0,k:1};f(a)}).tween("zoom:zoom",function(){var d=Wb[0],h=d/2,e=Wb[1]/2,g=r.interpolateZoom([(h-G.x)/G.k,(e-G.y)/G.k,d/G.k],[(h-b.x)/b.k,(e-b.y)/b.k,d/b.k]);return function(b){b=g(b);var f=d/b[2];this.__chart__=G={x:h-b[0]*f,y:e-b[1]*f,k:f};k(a)}}).each("end.zoom",function(){l(a)}):(this.__chart__=G,f(a),k(a),l(a))})},a.translate=function(b){return arguments.length?(G={x:+b[0],y:+b[1],k:G.k},
g(),a):[G.x,G.y]},a.scale=function(b){return arguments.length?(G={x:G.x,y:G.y,k:+b},g(),a):G.k},a.scaleExtent=function(b){return arguments.length?(Xb=null==b?dg:[+b[0],+b[1]],a):Xb},a.center=function(b){return arguments.length?(v=b&&[+b[0],+b[1]],a):v},a.size=function(b){return arguments.length?(Wb=b&&[+b[0],+b[1]],a):Wb},a.x=function(b){return arguments.length?(L=b,y=b.copy(),G={x:0,y:0,k:1},a):L},a.y=function(b){return arguments.length?(S=b,O=b.copy(),G={x:0,y:0,k:1},a):S},r.rebind(a,T,"on")};var yc,
dg=[0,1/0],oi="onwheel"in Ba?(yc=function(){return-r.event.deltaY*(r.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Ba?(yc=function(){return r.event.wheelDelta},"mousewheel"):(yc=function(){return-r.event.detail},"MozMousePixelScroll");r.color=Za;Za.prototype.toString=function(){return this.rgb()+""};r.hsl=Ca;var Nd=Ca.prototype=new Za;Nd.brighter=function(a){return a=Math.pow(.7,arguments.length?a:1),new Ca(this.h,this.s,this.l/a)};Nd.darker=function(a){return a=Math.pow(.7,arguments.length?a:
1),new Ca(this.h,this.s,a*this.l)};Nd.rgb=function(){return Sc(this.h,this.s,this.l)};r.hcl=xa;var Od=xa.prototype=new Za;Od.brighter=function(a){return new xa(this.h,this.c,Math.min(100,this.l+zc*(arguments.length?a:1)))};Od.darker=function(a){return new xa(this.h,this.c,Math.max(0,this.l-zc*(arguments.length?a:1)))};Od.rgb=function(){return Tc(this.h,this.c,this.l).rgb()};r.lab=ya;var zc=18,je=.95047,ke=1,le=1.08883,Pd=ya.prototype=new Za;Pd.brighter=function(a){return new ya(Math.min(100,this.l+
zc*(arguments.length?a:1)),this.a,this.b)};Pd.darker=function(a){return new ya(Math.max(0,this.l-zc*(arguments.length?a:1)),this.a,this.b)};Pd.rgb=function(){return ie(this.l,this.a,this.b)};r.rgb=ia;var Ac=ia.prototype=new Za;Ac.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,d=this.g,e=this.b;return b||d||e?(b&&30>b&&(b=30),d&&30>d&&(d=30),e&&30>e&&(e=30),new ia(Math.min(255,b/a),Math.min(255,d/a),Math.min(255,e/a))):new ia(30,30,30)};Ac.darker=function(a){return a=Math.pow(.7,
arguments.length?a:1),new ia(a*this.r,a*this.g,a*this.b)};Ac.hsl=function(){return fe(this.r,this.g,this.b)};Ac.toString=function(){return"#"+jb(this.r)+jb(this.g)+jb(this.b)};var Qb=r.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,
crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,
floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,
lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,
moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,
silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Qb.forEach(function(a,b){Qb.set(a,new ia(b>>16,255&b>>8,255&b))});r.functor=V;r.xhr=Zc(ca);r.dsv=function(a,b){function d(a,h,f){3>arguments.length&&(f=h,h=null);var k=Rb(a,b,null==h?e:
g(h),f);return k.row=function(a){return arguments.length?k.response(null==(h=a)?e:g(a)):h},k}function e(a){return d.parse(a.responseText)}function g(a){return function(b){return d.parse(b.responseText,a)}}function f(b){return b.map(k).join(a)}function k(a){return l.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}var l=new RegExp('["'+a+"\n]"),m=a.charCodeAt(0);return d.parse=function(a,b){var e;return d.parseRows(a,function(a,d){if(e)return e(a,d-1);var h=new Function("d","return {"+a.map(function(a,b){return JSON.stringify(a)+
": d["+b+"]"}).join(",")+"}");e=b?function(a,d){return b(h(a),d)}:h})},d.parseRows=function(a,b){function d(){if(n>=l)return f;if(h)return h=!1,g;var b=n;if(34===a.charCodeAt(b)){for(var e=b;e++<l;)if(34===a.charCodeAt(e)){if(34!==a.charCodeAt(e+1))break;++e}n=e+2;var k=a.charCodeAt(e+1);return 13===k?(h=!0,10===a.charCodeAt(e+2)&&++n):10===k&&(h=!0),a.slice(b+1,e).replace(/""/g,'"')}for(;l>n;){k=a.charCodeAt(n++);e=1;if(10===k)h=!0;else if(13===k)h=!0,10===a.charCodeAt(n)&&(++n,++e);else if(k!==
m)continue;return a.slice(b,n-e)}return a.slice(b)}for(var e,h,g={},f={},k=[],l=a.length,n=0,x=0;(e=d())!==f;){for(var p=[];e!==g&&e!==f;)p.push(e),e=d();b&&null==(p=b(p,x++))||k.push(p)}return k},d.format=function(b){if(Array.isArray(b[0]))return d.formatRows(b);var e=new w,g=[];return b.forEach(function(a){for(var b in a)e.has(b)||g.push(e.add(b))}),[g.map(k).join(a)].concat(b.map(function(b){return g.map(function(a){return k(b[a])}).join(a)})).join("\n")},d.formatRows=function(a){return a.map(f).join("\n")},
d};r.csv=r.dsv(",","text/csv");r.tsv=r.dsv("\t","text/tab-separated-values");var Ub,Vb,Tb,Sb,Ka,oe=ha[K(ha,"requestAnimationFrame")]||function(a){setTimeout(a,17)};r.timer=function(a,b,d){var e=arguments.length;2>e&&(b=0);3>e&&(d=Date.now());e={c:a,t:d+b,f:!1,n:null};Vb?Vb.n=e:Ub=e;Vb=e;Tb||(Sb=clearTimeout(Sb),Tb=1,oe($c))};r.timer.flush=function(){me();ne()};r.round=function(a,b){return b?Math.round(a*(b=Math.pow(10,b)))/b:Math.round(a)};var pi="y z a f p n \u00b5 m  k M G T P E Z Y".split(" ").map(function(a,
b){var d=Math.pow(10,3*F(8-b));return{scale:8<b?function(a){return a/d}:function(a){return a*d},symbol:a}});r.formatPrefix=function(a,b){var d=0;return a&&(0>a&&(a*=-1),b&&(a=r.round(a,ad(a,b))),d=1+Math.floor(1E-12+Math.log(a)/Math.LN10),d=Math.max(-24,Math.min(24,3*Math.floor((d-1)/3)))),pi[8+d/3]};var pe=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Dg=r.map({b:function(a){return a.toString(2)},c:function(a){return String.fromCharCode(a)},o:function(a){return a.toString(8)},
x:function(a){return a.toString(16)},X:function(a){return a.toString(16).toUpperCase()},g:function(a,b){return a.toPrecision(b)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return(a=r.round(a,ad(a,b))).toFixed(Math.max(0,Math.min(20,ad(a*(1+1E-15),b))))}}),B=r.time={},ga=Date;La.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},
getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Pa.setUTCDate.apply(this._,arguments)},setDay:function(){Pa.setUTCDay.apply(this._,arguments)},setFullYear:function(){Pa.setUTCFullYear.apply(this._,
arguments)},setHours:function(){Pa.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Pa.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Pa.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Pa.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Pa.setUTCSeconds.apply(this._,arguments)},setTime:function(){Pa.setTime.apply(this._,arguments)}};var Pa=Date.prototype;B.year=$a(function(a){return a=B.day(a),a.setMonth(0,1),a},function(a,b){a.setFullYear(a.getFullYear()+
b)},function(a){return a.getFullYear()});B.years=B.year.range;B.years.utc=B.year.utc.range;B.day=$a(function(a){var b=new ga(2E3,0);return b.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),b},function(a,b){a.setDate(a.getDate()+b)},function(a){return a.getDate()-1});B.days=B.day.range;B.days.utc=B.day.utc.range;B.dayOfYear=function(a){var b=B.year(a);return Math.floor((a-b-6E4*(a.getTimezoneOffset()-b.getTimezoneOffset()))/864E5)};"sunday monday tuesday wednesday thursday friday saturday".split(" ").forEach(function(a,
b){b=7-b;var d=B[a]=$a(function(a){return(a=B.day(a)).setDate(a.getDate()-(a.getDay()+b)%7),a},function(a,b){a.setDate(a.getDate()+7*Math.floor(b))},function(a){var d=B.year(a).getDay();return Math.floor((B.dayOfYear(a)+(d+b)%7)/7)-(d!==b)});B[a+"s"]=d.range;B[a+"s"].utc=d.utc.range;B[a+"OfYear"]=function(a){var d=B.year(a).getDay();return Math.floor((B.dayOfYear(a)+(d+b)%7)/7)}});B.week=B.sunday;B.weeks=B.sunday.range;B.weeks.utc=B.sunday.utc.range;B.weekOfYear=B.sundayOfYear;var qe={"-":"",_:" ",
0:"0"},Y=/^\s*\d+/,te=/^%/;r.locale=function(a){return{numberFormat:Cg(a),timeFormat:Fg(a)}};var eg=r.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),shortDays:"Sun Mon Tue Wed Thu Fri Sat".split(" "),months:"January February March April May June July August September October November December".split(" "),shortMonths:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")});
r.format=eg.numberFormat;r.geo={};bd.prototype={s:0,t:0,add:function(a){ue(a,this.t,Bc);ue(Bc.s,this.s,this);this.s?this.t+=Bc.t:this.s=Bc.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var Bc=new bd;r.geo.stream=function(a,b){a&&fg.hasOwnProperty(a.type)?fg[a.type](a,b):ac(a,b)};var fg={Feature:function(a,b){ac(a.geometry,b)},FeatureCollection:function(a,b){for(var d=a.features,e=-1,g=d.length;++e<g;)ac(d[e].geometry,b)}},ve={Sphere:function(a,b){b.sphere()},Point:function(a,
b){a=a.coordinates;b.point(a[0],a[1],a[2])},MultiPoint:function(a,b){for(var d=a.coordinates,e=-1,g=d.length;++e<g;)a=d[e],b.point(a[0],a[1],a[2])},LineString:function(a,b){cd(a.coordinates,b,0)},MultiLineString:function(a,b){for(var d=a.coordinates,e=-1,g=d.length;++e<g;)cd(d[e],b,0)},Polygon:function(a,b){we(a.coordinates,b)},MultiPolygon:function(a,b){for(var d=a.coordinates,e=-1,g=d.length;++e<g;)we(d[e],b)},GeometryCollection:function(a,b){for(var d=a.geometries,e=-1,g=d.length;++e<g;)ac(d[e],
b)}};r.geo.area=function(a){return tb=0,r.geo.stream(a,pa),tb};var tb,ab=new bd,pa={sphere:function(){tb+=4*I},point:D,lineStart:D,lineEnd:D,polygonStart:function(){ab.reset();pa.lineStart=Ug},polygonEnd:function(){var a=2*ab;tb+=0>a?4*I+a:a;pa.lineStart=pa.lineEnd=pa.point=D}};r.geo.bounds=function(){function a(b,d){O.push(S=[p=b,w=b]);q>d&&(q=d);d>t&&(t=d)}function b(d,e){var g=bb([d*H,e*H]);if(y){var f=kb(y,g),f=kb([f[1],-f[0],0],f);dc(f);var f=ec(f),k=d-v,m=0<k?1:-1,n=f[0]*X*m,k=180<F(k);k^(n>
m*v&&m*d>n)?(f=f[1]*X,f>t&&(t=f)):(n=(n+360)%360-180,k^(n>m*v&&m*d>n))?(f=-f[1]*X,q>f&&(q=f)):(q>e&&(q=e),e>t&&(t=e));k?v>d?l(p,d)>l(p,w)&&(w=d):l(d,w)>l(p,w)&&(p=d):w>=p?(p>d&&(p=d),d>w&&(w=d)):d>v?l(p,d)>l(p,w)&&(w=d):l(d,w)>l(p,w)&&(p=d)}else a(d,e);y=g;v=d}function d(){G.point=b}function e(){S[0]=p;S[1]=w;G.point=a;y=null}function g(a,d){if(y){var e=a-v;L+=180<F(e)?e+(0<e?360:-360):e}else A=a,z=d;pa.point(a,d);b(a,d)}function f(){pa.lineStart()}function k(){g(A,z);pa.lineEnd();F(L)>C&&(p=-(w=
180));S[0]=p;S[1]=w;y=null}function l(a,b){return 0>(b-=a)?b+360:b}function m(a,b){return a[0]-b[0]}function n(a,b){return b[0]<=b[1]?b[0]<=a&&a<=b[1]:a<b[0]||b[1]<a}var p,q,w,t,v,A,z,y,L,O,S,G={point:a,lineStart:d,lineEnd:e,polygonStart:function(){G.point=g;G.lineStart=f;G.lineEnd=k;L=0;pa.polygonStart()},polygonEnd:function(){pa.polygonEnd();G.point=a;G.lineStart=d;G.lineEnd=e;0>ab?(p=-(w=180),q=-(t=90)):L>C?t=90:-C>L&&(q=-90);S[0]=p;S[1]=w}};return function(a){t=w=-(p=q=1/0);O=[];r.geo.stream(a,
G);if(a=O.length){O.sort(m);for(var b,d=1,e=O[0],h=[e];a>d;++d)b=O[d],n(b[0],e)||n(b[1],e)?(l(e[0],b[1])>l(e[0],e[1])&&(e[1]=b[1]),l(b[0],e[1])>l(e[0],e[1])&&(e[0]=b[0])):h.push(e=b);var g,f=-1/0;a=h.length-1;d=0;for(e=h[a];a>=d;e=b,++d)b=h[d],(g=l(e[1],b[0]))>f&&(f=g,p=b[0],w=e[1])}return O=S=null,1/0===p||1/0===q?[[0/0,0/0],[0/0,0/0]]:[[p,q],[w,t]]}}();r.geo.centroid=function(a){zb=lb=Ma=Na=Da=ta=ua=la=Ta=Ua=Ea=0;r.geo.stream(a,za);a=Ta;var b=Ua,d=Ea,e=a*a+b*b+d*d;return od>e&&(a=ta,b=ua,d=la,C>
lb&&(a=Ma,b=Na,d=Da),e=a*a+b*b+d*d,od>e)?[0/0,0/0]:[Math.atan2(b,a)*X,ib(d/Math.sqrt(e))*X]};var zb,lb,Ma,Na,Da,ta,ua,la,Ta,Ua,Ea,za={sphere:D,point:ed,lineStart:xe,lineEnd:ye,polygonStart:function(){za.lineStart=Vg},polygonEnd:function(){za.lineStart=xe}},Oe=Be(mb,function(a){var b,d=0/0,e=0/0,g=0/0;return{lineStart:function(){a.lineStart();b=1},point:function(f,k){var l=0<f?I:-I,m=F(f-d);if(F(m-I)<C)a.point(d,e=0<(e+k)/2?ea:-ea),a.point(g,e),a.lineEnd(),a.lineStart(),a.point(l,e),a.point(f,e),b=
0;else if(g!==l&&m>=I){F(d-g)<C&&(d-=g*C);F(f-l)<C&&(f-=l*C);var m=d,n=e,p=f,q,r,w=Math.sin(m-p);e=F(w)>C?Math.atan((Math.sin(n)*(r=Math.cos(k))*Math.sin(p)-Math.sin(k)*(q=Math.cos(n))*Math.sin(m))/(q*r*w)):(n+k)/2;a.point(g,e);a.lineEnd();a.lineStart();a.point(l,e);b=0}a.point(d=f,e=k);g=l},lineEnd:function(){a.lineEnd();d=e=0/0},clean:function(){return 2-b}}},function(a,b,d,e){null==a?(d*=ea,e.point(-I,d),e.point(0,d),e.point(I,d),e.point(I,0),e.point(I,-d),e.point(0,-d),e.point(-I,-d),e.point(-I,
0),e.point(-I,d)):F(a[0]-b[0])>C?(a=a[0]<b[0]?I:-I,d=d*a/2,e.point(-a,d),e.point(0,d),e.point(a,d)):e.point(b[0],b[1])},[-I,-I/2]),hc=1E9;r.geo.clipExtent=function(){var a,b,d,e,g,f,k={stream:function(a){return g&&(g.valid=!1),g=f(a),g.valid=!0,g},extent:function(l){return arguments.length?(f=Ee(a=+l[0][0],b=+l[0][1],d=+l[1][0],e=+l[1][1]),g&&(g.valid=!1,g=null),k):[[a,b],[d,e]]}};return k.extent([[0,0],[960,500]])};(r.geo.conicEqualArea=function(){return gd(Ge)}).raw=Ge;r.geo.albers=function(){return r.geo.conicEqualArea().rotate([96,
0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)};r.geo.albersUsa=function(){function a(h){var f=h[0];h=h[1];return b=null,d(f,h),b||(e(f,h),b)||g(f,h),b}var b,d,e,g,f=r.geo.albers(),k=r.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=r.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),m={point:function(a,d){b=[a,d]}};return a.invert=function(a){var b=f.scale(),d=f.translate(),e=(a[0]-d[0])/b,b=(a[1]-d[1])/b;return(.12<=b&&.234>b&&-.425<=
e&&-.214>e?k:.166<=b&&.234>b&&-.214<=e&&-.115>e?l:f).invert(a)},a.stream=function(a){var b=f.stream(a),d=k.stream(a),e=l.stream(a);return{point:function(a,h){b.point(a,h);d.point(a,h);e.point(a,h)},sphere:function(){b.sphere();d.sphere();e.sphere()},lineStart:function(){b.lineStart();d.lineStart();e.lineStart()},lineEnd:function(){b.lineEnd();d.lineEnd();e.lineEnd()},polygonStart:function(){b.polygonStart();d.polygonStart();e.polygonStart()},polygonEnd:function(){b.polygonEnd();d.polygonEnd();e.polygonEnd()}}},
a.precision=function(b){return arguments.length?(f.precision(b),k.precision(b),l.precision(b),a):f.precision()},a.scale=function(b){return arguments.length?(f.scale(b),k.scale(.35*b),l.scale(b),a.translate(f.translate())):f.scale()},a.translate=function(b){if(!arguments.length)return f.translate();var n=f.scale(),p=+b[0],x=+b[1];return d=f.translate(b).clipExtent([[p-.455*n,x-.238*n],[p+.455*n,x+.238*n]]).stream(m).point,e=k.translate([p-.307*n,x+.201*n]).clipExtent([[p-.425*n+C,x+.12*n+C],[p-.214*
n-C,x+.234*n-C]]).stream(m).point,g=l.translate([p-.205*n,x+.212*n]).clipExtent([[p-.214*n+C,x+.166*n+C],[p-.115*n-C,x+.234*n-C]]).stream(m).point,a},a.scale(1070)};var Cc,ic,Dc,Ec,Fc,Gc,Va={point:D,lineStart:D,lineEnd:D,polygonStart:function(){ic=0;Va.lineStart=Zg},polygonEnd:function(){Va.lineStart=Va.lineEnd=Va.point=D;Cc+=F(ic/2)}},qi={point:function(a,b){Dc>a&&(Dc=a);a>Fc&&(Fc=a);Ec>b&&(Ec=b);b>Gc&&(Gc=b)},lineStart:D,lineEnd:D,polygonStart:D,polygonEnd:D},Aa={point:cb,lineStart:Ie,lineEnd:Je,
polygonStart:function(){Aa.lineStart=ah},polygonEnd:function(){Aa.point=cb;Aa.lineStart=Ie;Aa.lineEnd=Je}};r.geo.path=function(){function a(b){return b&&("function"==typeof k&&g.pointRadius(+k.apply(this,arguments)),f&&f.valid||(f=e(g)),r.geo.stream(b,f)),g.result()}var b,d,e,g,f,k=4.5;return a.area=function(a){return Cc=0,r.geo.stream(a,e(Va)),Cc},a.centroid=function(a){return Ma=Na=Da=ta=ua=la=Ta=Ua=Ea=0,r.geo.stream(a,e(Aa)),Ea?[Ta/Ea,Ua/Ea]:la?[ta/la,ua/la]:Da?[Ma/Da,Na/Da]:[0/0,0/0]},a.bounds=
function(a){return Fc=Gc=-(Dc=Ec=1/0),r.geo.stream(a,e(qi)),[[Dc,Ec],[Fc,Gc]]},a.projection=function(d){return arguments.length?(e=(b=d)?d.stream||ch(d):ca,f=null,a):b},a.context=function(b){return arguments.length?(g=null==(d=b)?new $g:new bh(b),"function"!=typeof k&&g.pointRadius(k),f=null,a):d},a.pointRadius=function(b){return arguments.length?(k="function"==typeof b?b:(g.pointRadius(+b),+b),a):k},a.projection(r.geo.albersUsa()).context(null)};r.geo.transform=function(a){return{stream:function(b){b=
new Ne(b);for(var d in a)b[d]=a[d];return b}}};Ne.prototype={point:function(a,b){this.stream.point(a,b)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};r.geo.projection=Wa;r.geo.projectionMutator=hd;(r.geo.equirectangular=function(){return Wa(Ab)}).raw=Ab.invert=Ab;r.geo.rotation=function(a){function b(d){return d=a(d[0]*
H,d[1]*H),d[0]*=X,d[1]*=X,d}return a=id(a[0]%360*H,a[1]*H,2<a.length?a[2]*H:0),b.invert=function(b){return b=a.invert(b[0]*H,b[1]*H),b[0]*=X,b[1]*=X,b},b};Pe.invert=Ab;r.geo.circle=function(){function a(){var b="function"==typeof e?e.apply(this,arguments):e,g=id(-b[0]*H,-b[1]*H,0).invert,h=[];return d(null,null,1,{point:function(a,b){h.push(a=g(a,b));a[0]*=X;a[1]*=X}}),{type:"Polygon",coordinates:[h]}}var b,d,e=[0,0],g=6;return a.origin=function(b){return arguments.length?(e=b,a):e},a.angle=function(e){return arguments.length?
(d=fd((b=+e)*H,g*H),a):b},a.precision=function(e){return arguments.length?(d=fd(b*H,(g=+e)*H),a):g},a.angle(90)};r.geo.distance=function(a,b){var d,e=(b[0]-a[0])*H,g=a[1]*H,f=b[1]*H,k=Math.sin(e),e=Math.cos(e),l=Math.sin(g),g=Math.cos(g),m=Math.sin(f),f=Math.cos(f);return Math.atan2(Math.sqrt((d=f*k)*d+(d=g*m-l*f*e)*d),l*m+g*f*e)};r.geo.graticule=function(){function a(){return{type:"MultiLineString",coordinates:b()}}function b(){return r.range(Math.ceil(f/y)*y,g,y).map(w).concat(r.range(Math.ceil(n/
z)*z,m,z).map(t)).concat(r.range(Math.ceil(e/v)*v,d,v).filter(function(a){return F(a%y)>C}).map(p)).concat(r.range(Math.ceil(l/A)*A,k,A).filter(function(a){return F(a%z)>C}).map(q))}var d,e,g,f,k,l,m,n,p,q,w,t,v=10,A=v,y=90,z=360,L=2.5;return a.lines=function(){return b().map(function(a){return{type:"LineString",coordinates:a}})},a.outline=function(){return{type:"Polygon",coordinates:[w(f).concat(t(m).slice(1),w(g).reverse().slice(1),t(n).reverse().slice(1))]}},a.extent=function(b){return arguments.length?
a.majorExtent(b).minorExtent(b):a.minorExtent()},a.majorExtent=function(b){return arguments.length?(f=+b[0][0],g=+b[1][0],n=+b[0][1],m=+b[1][1],f>g&&(b=f,f=g,g=b),n>m&&(b=n,n=m,m=b),a.precision(L)):[[f,n],[g,m]]},a.minorExtent=function(b){return arguments.length?(e=+b[0][0],d=+b[1][0],l=+b[0][1],k=+b[1][1],e>d&&(b=e,e=d,d=b),l>k&&(b=l,l=k,k=b),a.precision(L)):[[e,l],[d,k]]},a.step=function(b){return arguments.length?a.majorStep(b).minorStep(b):a.minorStep()},a.majorStep=function(b){return arguments.length?
(y=+b[0],z=+b[1],a):[y,z]},a.minorStep=function(b){return arguments.length?(v=+b[0],A=+b[1],a):[v,A]},a.precision=function(b){return arguments.length?(L=+b,p=Ue(l,k,90),q=Ve(e,d,L),w=Ue(n,m,90),t=Ve(f,g,L),a):L},a.majorExtent([[-180,-90+C],[180,90-C]]).minorExtent([[-180,-80-C],[180,80+C]])};r.geo.greatArc=function(){function a(){return{type:"LineString",coordinates:[b||e.apply(this,arguments),d||g.apply(this,arguments)]}}var b,d,e=jd,g=kd;return a.distance=function(){return r.geo.distance(b||e.apply(this,
arguments),d||g.apply(this,arguments))},a.source=function(d){return arguments.length?(e=d,b="function"==typeof d?null:d,a):e},a.target=function(b){return arguments.length?(g=b,d="function"==typeof b?null:b,a):g},a.precision=function(){return arguments.length?a:0},a};r.geo.interpolate=function(a,b){return dh(a[0]*H,a[1]*H,b[0]*H,b[1]*H)};r.geo.length=function(a){return Hc=0,r.geo.stream(a,ub),Hc};var Hc,ub={sphere:D,point:D,lineStart:function(){function a(g,h){var f=Math.sin(h*=H),k=Math.cos(h),l=
F((g*=H)-b),m=Math.cos(l);Hc+=Math.atan2(Math.sqrt((l=k*Math.sin(l))*l+(l=e*f-d*k*m)*l),d*f+e*k*m);b=g;d=f;e=k}var b,d,e;ub.point=function(g,f){b=g*H;d=Math.sin(f*=H);e=Math.cos(f);ub.point=a};ub.lineEnd=function(){ub.point=ub.lineEnd=D}},lineEnd:D,polygonStart:D,polygonEnd:D},gg=Bb(function(a){return Math.sqrt(2/(1+a))},function(a){return 2*Math.asin(a/2)});(r.geo.azimuthalEqualArea=function(){return Wa(gg)}).raw=gg;var hg=Bb(function(a){return(a=Math.acos(a))&&a/Math.sin(a)},ca);(r.geo.azimuthalEquidistant=
function(){return Wa(hg)}).raw=hg;(r.geo.conicConformal=function(){return gd(We)}).raw=We;(r.geo.conicEquidistant=function(){return gd(Xe)}).raw=Xe;var ig=Bb(function(a){return 1/a},Math.atan);(r.geo.gnomonic=function(){return Wa(ig)}).raw=ig;jc.invert=function(a,b){return[a,2*Math.atan(Math.exp(b))-ea]};(r.geo.mercator=function(){return Ye(jc)}).raw=jc;var jg=Bb(function(){return 1},Math.asin);(r.geo.orthographic=function(){return Wa(jg)}).raw=jg;var kg=Bb(function(a){return 1/(1+a)},function(a){return 2*
Math.atan(a)});(r.geo.stereographic=function(){return Wa(kg)}).raw=kg;ld.invert=function(a,b){return[-b,2*Math.atan(Math.exp(a))-ea]};(r.geo.transverseMercator=function(){var a=Ye(ld),b=a.center,d=a.rotate;return a.center=function(a){return a?b([-a[1],a[0]]):(a=b(),[a[1],-a[0]])},a.rotate=function(a){return a?d([a[0],a[1],2<a.length?a[2]+90:90]):(a=d(),[a[0],a[1],a[2]-90])},d([0,0,90])}).raw=ld;r.geom={};r.geom.hull=function(a){function b(a){if(3>a.length)return[];var g,h=V(d),f=V(e),k=a.length,l=
[],m=[];for(g=0;k>g;g++)l.push([+h.call(this,a[g],g),+f.call(this,a[g],g),g]);l.sort(eh);for(g=0;k>g;g++)m.push([l[g][0],-l[g][1]]);var h=Ze(l),m=Ze(m),f=m[0]===h[0],k=m[m.length-1]===h[h.length-1],n=[];for(g=h.length-1;0<=g;--g)n.push(a[l[h[g]][2]]);for(g=+f;g<m.length-k;++g)n.push(a[l[m[g]][2]]);return n}var d=nb,e=Cb;return arguments.length?b(a):(b.x=function(a){return arguments.length?(d=a,b):d},b.y=function(a){return arguments.length?(e=a,b):e},b)};r.geom.polygon=function(a){return Mb(a,Ic),
a};var Ic=r.geom.polygon.prototype=[];Ic.area=function(){for(var a,b=-1,d=this.length,e=this[d-1],g=0;++b<d;)a=e,e=this[b],g+=a[1]*e[0]-a[0]*e[1];return.5*g};Ic.centroid=function(a){var b,d,e=-1,g=this.length,f=0,k=0,l=this[g-1];for(arguments.length||(a=-1/(6*this.area()));++e<g;)b=l,l=this[e],d=b[0]*l[1]-l[0]*b[1],f+=(b[0]+l[0])*d,k+=(b[1]+l[1])*d;return[f*a,k*a]};Ic.clip=function(a){for(var b,d,e,g,f,k,l=af(a),m=-1,n=this.length-af(this),p=this[n-1];++m<n;){b=a.slice();a.length=0;g=this[m];f=b[(e=
b.length-l)-1];for(d=-1;++d<e;)k=b[d],md(k,p,g)?(md(f,p,g)||a.push($e(f,k,p,g)),a.push(k)):md(f,p,g)&&a.push($e(f,k,p,g)),f=k;l&&a.push(a[0]);p=g}return a};var rb,db,pb,pd,Db,cf=[],gf=[];ef.prototype.prepare=function(){for(var a,b=this.edges,d=b.length;d--;)a=b[d].edge,a.b&&a.a||b.splice(d,1);return b.sort(ff),b.length};mc.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};qd.prototype={insert:function(a,
b){var d,e,g;if(a){if(b.P=a,b.N=a.N,a.N&&(a.N.P=b),a.N=b,a.R){for(a=a.R;a.L;)a=a.L;a.L=b}else a.R=b;d=a}else this._?(a=jf(this._),b.P=null,b.N=a,a.P=a.L=b,d=a):(b.P=b.N=null,this._=b,d=null);b.L=b.R=null;b.U=d;b.C=!0;for(a=b;d&&d.C;)e=d.U,d===e.L?(g=e.R,g&&g.C?(d.C=g.C=!1,e.C=!0,a=e):(a===d.R&&(Fb(this,d),a=d,d=a.U),d.C=!1,e.C=!0,Gb(this,e))):(g=e.L,g&&g.C?(d.C=g.C=!1,e.C=!0,a=e):(a===d.L&&(Gb(this,d),a=d,d=a.U),d.C=!1,e.C=!0,Fb(this,e))),d=a.U;this._.C=!1},remove:function(a){a.N&&(a.N.P=a.P);a.P&&
(a.P.N=a.N);a.N=a.P=null;var b,d,e,g=a.U,f=a.L,k=a.R;if(d=f?k?jf(k):f:k,g?g.L===a?g.L=d:g.R=d:this._=d,f&&k?(e=d.C,d.C=a.C,d.L=f,f.U=d,d!==k?(g=d.U,d.U=a.U,a=d.R,g.L=a,d.R=k,k.U=d):(d.U=g,g=d,a=d.R)):(e=a.C,a=d),a&&(a.U=g),!e){if(a&&a.C)return a.C=!1,void 0;do{if(a===this._)break;if(a===g.L){if(b=g.R,b.C&&(b.C=!1,g.C=!0,Fb(this,g),b=g.R),b.L&&b.L.C||b.R&&b.R.C){b.R&&b.R.C||(b.L.C=!1,b.C=!0,Gb(this,b),b=g.R);b.C=g.C;g.C=b.R.C=!1;Fb(this,g);a=this._;break}}else if(b=g.L,b.C&&(b.C=!1,g.C=!0,Gb(this,
g),b=g.L),b.L&&b.L.C||b.R&&b.R.C){b.L&&b.L.C||(b.R.C=!1,b.C=!0,Fb(this,b),b=g.L);b.C=g.C;g.C=b.L.C=!1;Gb(this,g);a=this._;break}b.C=!0;a=g;g=g.U}while(!a.C);a&&(a.C=!1)}}};r.geom.voronoi=function(a){function b(a){var e=Array(a.length),g=l[0][0],h=l[0][1],f=l[1][0],k=l[1][1];return rd(d(a),l).cells.forEach(function(b,d){var l=b.edges,m=b.site;(e[d]=l.length?l.map(function(a){a=a.start();return[a.x,a.y]}):m.x>=g&&m.x<=f&&m.y>=h&&m.y<=k?[[g,k],[f,k],[f,h],[g,h]]:[]).point=a[d]}),e}function d(a){return a.map(function(a,
b){return{x:Math.round(f(a,b)/C)*C,y:Math.round(k(a,b)/C)*C,i:b}})}var e=nb,g=Cb,f=e,k=g,l=Jc;return a?b(a):(b.links=function(a){return rd(d(a)).edges.filter(function(a){return a.l&&a.r}).map(function(b){return{source:a[b.l.i],target:a[b.r.i]}})},b.triangles=function(a){var b=[];return rd(d(a)).cells.forEach(function(d,e){for(var g,h=d.site,f=d.edges.sort(ff),k=-1,l=f.length,m=f[l-1].edge,m=m.l===h?m.r:m.l;++k<l;)g=m,m=f[k].edge,m=m.l===h?m.r:m.l,e<g.i&&e<m.i&&0>(h.x-m.x)*(g.y-h.y)-(h.x-g.x)*(m.y-
h.y)&&b.push([a[e],a[g.i],a[m.i]])}),b},b.x=function(a){return arguments.length?(f=V(e=a),b):e},b.y=function(a){return arguments.length?(k=V(g=a),b):g},b.clipExtent=function(a){return arguments.length?(l=null==a?Jc:a,b):l===Jc?null:l},b.size=function(a){return arguments.length?b.clipExtent(a&&[[0,0],a]):l===Jc?null:l&&l[1]},b)};var Jc=[[-1E6,-1E6],[1E6,1E6]];r.geom.delaunay=function(a){return r.geom.voronoi().triangles(a)};r.geom.quadtree=function(a,b,d,e,g){function f(a){function h(a,b,d,e,g,f,k,
l){if(!isNaN(d)&&!isNaN(e))if(a.leaf){var m=a.x,p=a.y;if(null!=m){if(!(.01>F(m-d)+F(p-e))){var q=a.point;a.x=a.y=a.point=null;n(a,q,m,p,g,f,k,l)}n(a,b,d,e,g,f,k,l)}else a.x=d,a.y=e,a.point=b}else n(a,b,d,e,g,f,k,l)}function n(a,b,d,e,g,f,k,l){var m=.5*(g+k),p=.5*(f+l),q=d>=m,r=e>=p,x=(r<<1)+q;a.leaf=!1;a=a.nodes[x]||(a.nodes[x]=kf());q?g=m:k=m;r?f=p:l=p;h(a,b,d,e,g,f,k,l)}var p,q,r,w,t,N,v,A,y,z=V(l),Q=V(m);if(null!=b)N=b,v=d,A=e,y=g;else if(A=y=-(N=v=1/0),q=[],r=[],t=a.length,k)for(w=0;t>w;++w)p=
a[w],p.x<N&&(N=p.x),p.y<v&&(v=p.y),p.x>A&&(A=p.x),p.y>y&&(y=p.y),q.push(p.x),r.push(p.y);else for(w=0;t>w;++w){var D=+z(p=a[w],w);p=+Q(p,w);N>D&&(N=D);v>p&&(v=p);D>A&&(A=D);p>y&&(y=p);q.push(D);r.push(p)}D=A-N;p=y-v;D>p?y=v+D:A=N+p;var K=kf();if(K.add=function(a){h(K,a,+z(a,++w),+Q(a,w),N,v,A,y)},K.visit=function(a){Hb(a,K,N,v,A,y)},w=-1,null==b){for(;++w<t;)h(K,a[w],q[w],r[w],N,v,A,y);--w}else a.forEach(K.add);return q=r=a=p=null,K}var k,l=nb,m=Cb;return(k=arguments.length)?(l=kh,m=lh,3===k&&(g=
d,e=b,d=b=0),f(a)):(f.x=function(a){return arguments.length?(l=a,f):l},f.y=function(a){return arguments.length?(m=a,f):m},f.extent=function(a){return arguments.length?(null==a?b=d=e=g=null:(b=+a[0][0],d=+a[0][1],e=+a[1][0],g=+a[1][1]),f):null==b?null:[[b,d],[e,g]]},f.size=function(a){return arguments.length?(null==a?b=d=e=g=null:(b=d=0,e=+a[0],g=+a[1]),f):null==b?null:[e-b,g-d]},f)};r.interpolateRgb=sd;r.interpolateObject=lf;r.interpolateNumber=Oa;r.interpolateString=mf;var td=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,
ud=new RegExp(td.source,"g");r.interpolate=eb;r.interpolators=[function(a,b){var d=typeof b;return("string"===d?Qb.has(b)||/^(#|rgb\(|hsl\()/.test(b)?sd:mf:b instanceof Za?sd:Array.isArray(b)?nc:"object"===d&&isNaN(b)?lf:Oa)(a,b)}];r.interpolateArray=nc;var lg=function(){return ca},ri=r.map({linear:lg,poly:function(a){return function(b){return Math.pow(b,a)}},quad:function(){return nh},cubic:function(){return oh},sin:function(){return qh},exp:function(){return rh},circle:function(){return sh},elastic:function(a,
b){var d;return 2>arguments.length&&(b=.45),arguments.length?d=b/qa*Math.asin(1/a):(a=1,d=b/4),function(e){return 1+a*Math.pow(2,-10*e)*Math.sin((e-d)*qa/b)}},back:function(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}},bounce:function(){return th}}),si=r.map({"in":ca,out:nf,"in-out":of,"out-in":function(a){return of(nf(a))}});r.ease=function(a){var b=a.indexOf("-"),d=0<=b?a.slice(0,b):a,b=0<=b?a.slice(b+1):"in";return d=ri.get(d)||lg,b=si.get(b)||ca,mh(b(d.apply(null,Zf.call(arguments,
1))))};r.interpolateHcl=function(a,b){a=r.hcl(a);b=r.hcl(b);var d=a.h,e=a.c,g=a.l,f=b.h-d,k=b.c-e,l=b.l-g;return isNaN(k)&&(k=0,e=isNaN(e)?b.c:e),isNaN(f)?(f=0,d=isNaN(d)?b.h:d):180<f?f-=360:-180>f&&(f+=360),function(a){return Tc(d+f*a,e+k*a,g+l*a)+""}};r.interpolateHsl=function(a,b){a=r.hsl(a);b=r.hsl(b);var d=a.h,e=a.s,g=a.l,f=b.h-d,k=b.s-e,l=b.l-g;return isNaN(k)&&(k=0,e=isNaN(e)?b.s:e),isNaN(f)?(f=0,d=isNaN(d)?b.h:d):180<f?f-=360:-180>f&&(f+=360),function(a){return Sc(d+f*a,e+k*a,g+l*a)+""}};
r.interpolateLab=function(a,b){a=r.lab(a);b=r.lab(b);var d=a.l,e=a.a,g=a.b,f=b.l-d,k=b.a-e,l=b.b-g;return function(a){return ie(d+f*a,e+k*a,g+l*a)+""}};r.interpolateRound=pf;r.transform=function(a){var b=Ba.createElementNS(r.ns.prefix.svg,"g");return(r.transform=function(a){if(null!=a){b.setAttribute("transform",a);var d=b.transform.baseVal.consolidate()}return new qf(d?d.matrix:ti)})(a)};qf.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+
")scale("+this.scale+")"};var ti={a:1,b:0,c:0,d:1,e:0,f:0};r.interpolateTransform=sf;r.layout={};r.layout.bundle=function(){return function(a){for(var b=[],d=-1,e=a.length;++d<e;)b.push(wh(a[d]));return b}};r.layout.chord=function(){function a(){var h,n,q,w,t,v={},A=[],y=r.range(f),z=[];d=[];e=[];h=0;for(w=-1;++w<f;){n=0;for(t=-1;++t<f;)n+=g[w][t];A.push(n);z.push(r.range(f));h+=n}k&&y.sort(function(a,b){return k(A[a],A[b])});l&&z.forEach(function(a,b){a.sort(function(a,d){return l(g[b][a],g[b][d])})});
h=(qa-p*f)/h;n=0;for(w=-1;++w<f;){q=n;for(t=-1;++t<f;){var na=y[w],G=z[na][t],D=g[na][G],Q=n,K=n+=D*h;v[na+"-"+G]={index:na,subindex:G,startAngle:Q,endAngle:K,value:D}}e[na]={index:na,startAngle:q,endAngle:n,value:(n-q)/h};n+=p}for(w=-1;++w<f;)for(t=w-1;++t<f;)h=v[w+"-"+t],n=v[t+"-"+w],(h.value||n.value)&&d.push(h.value<n.value?{source:n,target:h}:{source:h,target:n});m&&b()}function b(){d.sort(function(a,b){return m((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var d,e,g,
f,k,l,m,n={},p=0;return n.matrix=function(a){return arguments.length?(f=(g=a)&&g.length,d=e=null,n):g},n.padding=function(a){return arguments.length?(p=a,d=e=null,n):p},n.sortGroups=function(a){return arguments.length?(k=a,d=e=null,n):k},n.sortSubgroups=function(a){return arguments.length?(l=a,d=null,n):l},n.sortChords=function(a){return arguments.length?(m=a,d&&b(),n):m},n.chords=function(){return d||a(),d},n.groups=function(){return e||a(),e},n};r.layout.force=function(){function a(b){return function(a,
d,e,g){if(a.point!==b){e=a.cx-b.x;var h=a.cy-b.y;d=g-d;g=e*e+h*h;if(g>d*d/y)return v>g&&(d=a.charge/g,b.px-=e*d,b.py-=h*d),!0;a.point&&g&&v>g&&(d=a.pointCharge/g,b.px-=e*d,b.py-=h*d)}return!a.charge}}function b(a){a.px=r.event.x;a.py=r.event.y;l.resume()}var d,e,g,f,k,l={},m=r.dispatch("start","tick","end"),n=[1,1],p=.9,q=ui,w=vi,t=-30,v=wi,A=.1,y=.64,z=[],L=[];return l.tick=function(){if(.005>(e*=.99))return m.end({type:"end",alpha:e=0}),!0;var b,d,l,q,w,x,v,E,M=z.length,y=L.length;for(d=0;y>d;++d)l=
L[d],b=l.source,q=l.target,v=q.x-b.x,E=q.y-b.y,(w=v*v+E*E)&&(w=e*f[d]*((w=Math.sqrt(w))-g[d])/w,v*=w,E*=w,q.x-=v*(x=b.weight/(q.weight+b.weight)),q.y-=E*x,b.x+=v*(x=1-x),b.y+=E*x);if((x=e*A)&&(v=n[0]/2,E=n[1]/2,d=-1,x))for(;++d<M;)l=z[d],l.x+=(v-l.x)*x,l.y+=(E-l.y)*x;if(t)for(uf(b=r.geom.quadtree(z),e,k),d=-1;++d<M;)(l=z[d]).fixed||b.visit(a(l));for(d=-1;++d<M;)l=z[d],l.fixed?(l.x=l.px,l.y=l.py):(l.x-=(l.px-(l.px=l.x))*p,l.y-=(l.py-(l.py=l.y))*p);m.tick({type:"tick",alpha:e})},l.nodes=function(a){return arguments.length?
(z=a,l):z},l.links=function(a){return arguments.length?(L=a,l):L},l.size=function(a){return arguments.length?(n=a,l):n},l.linkDistance=function(a){return arguments.length?(q="function"==typeof a?a:+a,l):q},l.distance=l.linkDistance,l.linkStrength=function(a){return arguments.length?(w="function"==typeof a?a:+a,l):w},l.friction=function(a){return arguments.length?(p=+a,l):p},l.charge=function(a){return arguments.length?(t="function"==typeof a?a:+a,l):t},l.chargeDistance=function(a){return arguments.length?
(v=a*a,l):Math.sqrt(v)},l.gravity=function(a){return arguments.length?(A=+a,l):A},l.theta=function(a){return arguments.length?(y=a*a,l):Math.sqrt(y)},l.alpha=function(a){return arguments.length?(a=+a,e?e=0<a?a:0:0<a&&(m.start({type:"start",alpha:e=a}),r.timer(l.tick)),l):e},l.start=function(){function a(e,g){if(!d){d=Array(h);for(l=0;h>l;++l)d[l]=[];for(l=0;m>l;++l){var f=L[l];d[f.source.index].push(f.target);d[f.target.index].push(f.source)}}for(var k=d[b],l=-1,m=k.length;++l<m;)if(!isNaN(f=k[l][e]))return f;
return Math.random()*g}var b,d,e,h=z.length,m=L.length,p=n[0],r=n[1];for(b=0;h>b;++b)(e=z[b]).index=b,e.weight=0;for(b=0;m>b;++b)e=L[b],"number"==typeof e.source&&(e.source=z[e.source]),"number"==typeof e.target&&(e.target=z[e.target]),++e.source.weight,++e.target.weight;for(b=0;h>b;++b)e=z[b],isNaN(e.x)&&(e.x=a("x",p)),isNaN(e.y)&&(e.y=a("y",r)),isNaN(e.px)&&(e.px=e.x),isNaN(e.py)&&(e.py=e.y);if(g=[],"function"==typeof q)for(b=0;m>b;++b)g[b]=+q.call(this,L[b],b);else for(b=0;m>b;++b)g[b]=q;if(f=
[],"function"==typeof w)for(b=0;m>b;++b)f[b]=+w.call(this,L[b],b);else for(b=0;m>b;++b)f[b]=w;if(k=[],"function"==typeof t)for(b=0;h>b;++b)k[b]=+t.call(this,z[b],b);else for(b=0;h>b;++b)k[b]=t;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){return d||(d=r.behavior.drag().origin(ca).on("dragstart.force",xh).on("drag.force",b).on("dragend.force",yh)),arguments.length?(this.on("mouseover.force",zh).on("mouseout.force",Ah).call(d),void 0):
d},r.rebind(l,m,"on")};var ui=20,vi=1,wi=1/0;r.layout.hierarchy=function(){function a(g){var f,k=[g],l=[];for(g.depth=0;null!=(f=k.pop());)if(l.push(f),(n=d.call(a,f,f.depth))&&(m=n.length)){for(var m,n,p;0<=--m;)k.push(p=n[m]),p.parent=f,p.depth=f.depth+1;e&&(f.value=0);f.children=n}else e&&(f.value=+e.call(a,f,f.depth)||0),delete f.children;return Fa(g,function(a){var d,g;b&&(d=a.children)&&d.sort(b);e&&(g=a.parent)&&(g.value+=a.value)}),l}var b=Eh,d=Ch,e=Dh;return a.sort=function(d){return arguments.length?
(b=d,a):b},a.children=function(b){return arguments.length?(d=b,a):d},a.value=function(b){return arguments.length?(e=b,a):e},a.revalue=function(b){return e&&(Jb(b,function(a){a.children&&(a.value=0)}),Fa(b,function(b){var d;b.children||(b.value=+e.call(a,b,b.depth)||0);(d=b.parent)&&(d.value+=b.value)})),b},a};r.layout.partition=function(){function a(b,d,e,g){var f=b.children;if(b.x=d,b.y=b.depth*g,b.dx=e,b.dy=g,f&&(k=f.length)){var k,l,m=-1;for(e=b.value?e/b.value:0;++m<k;)a(l=f[m],d,b=l.value*e,
g),d+=b}}function b(a){a=a.children;var d=0;if(a&&(e=a.length))for(var e,g=-1;++g<e;)d=Math.max(d,b(a[g]));return 1+d}function d(f,k){var l=e.call(this,f,k);return a(l[0],0,g[0],g[1]/b(l[0])),l}var e=r.layout.hierarchy(),g=[1,1];return d.size=function(a){return arguments.length?(g=a,d):g},Ib(d,e)};r.layout.pie=function(){function a(f){var k=f.map(function(d,e){return+b.call(a,d,e)}),l=+("function"==typeof e?e.apply(this,arguments):e),m=(("function"==typeof g?g.apply(this,arguments):g)-l)/r.sum(k),
n=r.range(f.length);null!=d&&n.sort(d===mg?function(a,b){return k[b]-k[a]}:function(a,b){return d(f[a],f[b])});var p=[];return n.forEach(function(a){var b;p[a]={data:f[a],value:b=k[a],startAngle:l,endAngle:l+=b*m}}),p}var b=Number,d=mg,e=0,g=qa;return a.value=function(d){return arguments.length?(b=d,a):b},a.sort=function(b){return arguments.length?(d=b,a):d},a.startAngle=function(b){return arguments.length?(e=b,a):e},a.endAngle=function(b){return arguments.length?(g=b,a):g},a};var mg={};r.layout.stack=
function(){function a(l,m){if(!(w=l.length))return l;var n=l.map(function(d,e){return b.call(a,d,e)}),p=n.map(function(b){return b.map(function(b,d){return[f.call(a,b,d),k.call(a,b,d)]})}),q=d.call(a,p,m),n=r.permute(n,q),p=r.permute(p,q),w,t,v,A=e.call(a,p,m),y=n[0].length;for(t=0;y>t;++t)for(g.call(a,n[0][t],v=A[t],p[0][t][1]),q=1;w>q;++q)g.call(a,n[q][t],v+=p[q-1][t][1],p[q][t][1]);return l}var b=ca,d=vd,e=wd,g=Hh,f=Fh,k=Gh;return a.values=function(d){return arguments.length?(b=d,a):b},a.order=
function(b){return arguments.length?(d="function"==typeof b?b:xi.get(b)||vd,a):d},a.offset=function(b){return arguments.length?(e="function"==typeof b?b:yi.get(b)||wd,a):e},a.x=function(b){return arguments.length?(f=b,a):f},a.y=function(b){return arguments.length?(k=b,a):k},a.out=function(b){return arguments.length?(g=b,a):g},a};var xi=r.map({"inside-out":function(a){var b,d=a.length,e=a.map(Ih),g=a.map(Jh),f=r.range(d).sort(function(a,b){return e[a]-e[b]}),k=0,l=0,m=[],n=[];for(a=0;d>a;++a)b=f[a],
l>k?(k+=g[b],m.push(b)):(l+=g[b],n.push(b));return n.reverse().concat(m)},reverse:function(a){return r.range(a.length).reverse()},"default":vd}),yi=r.map({silhouette:function(a){var b,d,e,g=a.length,f=a[0].length,k=[],l=0,m=[];for(d=0;f>d;++d){for(e=b=0;g>b;b++)e+=a[b][d][1];e>l&&(l=e);k.push(e)}for(d=0;f>d;++d)m[d]=(l-k[d])/2;return m},wiggle:function(a){var b,d,e,g,f,k,l,m,n,p=a.length,q=a[0],r=q.length,w=[];w[0]=m=n=0;for(d=1;r>d;++d){for(g=b=0;p>b;++b)g+=a[b][d][1];f=b=0;for(l=q[d][0]-q[d-1][0];p>
b;++b){e=0;for(k=(a[b][d][1]-a[b][d-1][1])/(2*l);b>e;++e)k+=(a[e][d][1]-a[e][d-1][1])/l;f+=k*a[b][d][1]}w[d]=m-=g?f/g*l:0;n>m&&(n=m)}for(d=0;r>d;++d)w[d]-=n;return w},expand:function(a){var b,d,e,g=a.length,f=a[0].length,k=1/g,l=[];for(d=0;f>d;++d){for(e=b=0;g>b;b++)e+=a[b][d][1];if(e)for(b=0;g>b;b++)a[b][d][1]/=e;else for(b=0;g>b;b++)a[b][d][1]=k}for(d=0;f>d;++d)l[d]=0;return l},zero:wd});r.layout.histogram=function(){function a(f,h){var k,l,m=[],n=f.map(d,this),p=e.call(this,n,h),q=g.call(this,
p,n,h);h=-1;for(var w=n.length,t=q.length-1,v=b?1:1/w;++h<t;)k=m[h]=[],k.dx=q[h+1]-(k.x=q[h]),k.y=0;if(0<t)for(h=-1;++h<w;)l=n[h],l>=p[0]&&l<=p[1]&&(k=m[r.bisect(q,l,1,t)-1],k.y+=v,k.push(f[h]));return m}var b=!0,d=Number,e=Mh,g=Lh;return a.value=function(b){return arguments.length?(d=b,a):d},a.range=function(b){return arguments.length?(e=V(b),a):e},a.bins=function(b){return arguments.length?(g="number"==typeof b?function(a){return vf(a,b)}:V(b),a):g},a.frequency=function(d){return arguments.length?
(b=!!d,a):b},a};r.layout.pack=function(){function a(f,h){var k=d.call(this,f,h),l=k[0],m=g[0],n=g[1],p=null==b?Math.sqrt:"function"==typeof b?b:function(){return b};if(l.x=l.y=0,Fa(l,function(a){a.r=+p(a.value)}),Fa(l,yf),e){var q=e*(b?1:Math.max(2*l.r/m,2*l.r/n))/2;Fa(l,function(a){a.r+=q});Fa(l,yf);Fa(l,function(a){a.r-=q})}return Af(l,m/2,n/2,b?1:1/Math.max(2*l.r/m,2*l.r/n)),k}var b,d=r.layout.hierarchy().sort(Nh),e=0,g=[1,1];return a.size=function(b){return arguments.length?(g=b,a):g},a.radius=
function(d){return arguments.length?(b=null==d||"function"==typeof d?d:+d,a):b},a.padding=function(b){return arguments.length?(e=+b,a):e},Ib(a,d)};r.layout.tree=function(){function a(h,n){var p=f.call(this,h,n),q=p[0],r=b(q);if(Fa(r,d),r.parent.m=-r.z,Jb(r,e),m)Jb(q,g);else{var w=q,t=q,v=q;Jb(q,function(a){a.x<w.x&&(w=a);a.x>t.x&&(t=a);a.depth>v.depth&&(v=a)});var A=k(w,t)/2-w.x,y=l[0]/(t.x+k(t,w)/2+A),z=l[1]/(v.depth||1);Jb(q,function(a){a.x=(a.x+A)*y;a.y=a.depth*z})}return p}function b(a){for(var d=
{A:null,children:[a]},e=[d];null!=(a=e.pop());)for(var g,f=a.children,h=0,k=f.length;k>h;++h)e.push((f[h]=g={_:f[h],parent:a,children:(g=f[h].children)&&g.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:h}).a=g);return d.children[0]}function d(a){var b=a.children,e=a.parent.children,g=a.i?e[a.i-1]:null;if(b.length){for(var f,h=0,l=0,m=a.children,n=m.length;0<=--n;)f=m[n],f.z+=h,f.m+=h,h+=f.s+(l+=f.c);b=(b[0].z+b[b.length-1].z)/2;g?(a.z=g.z+k(a._,g._),a.m=a.z-b):a.z=b}else g&&(a.z=g.z+k(a._,g._));
b=a.parent;e=a.parent.A||e[0];if(g){for(var h=f=a,l=g,m=f.parent.children[0],n=f.m,p=h.m,q=l.m,r=m.m;l=zd(l),f=yd(f),l&&f;){m=yd(m);h=zd(h);h.a=a;g=l.z+q-f.z-n+k(l._,f._);if(0<g){var w=l.a.parent===a.parent?l.a:e,t=a,v=g,x=v/(t.i-w.i);t.c-=x;t.s+=v;w.c+=x;t.z+=v;t.m+=v;n+=g;p+=g}q+=l.m;n+=f.m;r+=m.m;p+=h.m}l&&!zd(h)&&(h.t=l,h.m+=q-p);f&&!yd(m)&&(m.t=f,m.m+=n-r,e=a)}b.A=e}function e(a){a._.x=a.z+a.parent.m;a.m+=a.parent.m}function g(a){a.x*=l[0];a.y=a.depth*l[1]}var f=r.layout.hierarchy().sort(null).value(null),
k=Bf,l=[1,1],m=null;return a.separation=function(b){return arguments.length?(k=b,a):k},a.size=function(b){return arguments.length?(m=null==(l=b)?g:null,a):m?null:l},a.nodeSize=function(b){return arguments.length?(m=null==(l=b)?null:g,a):m?l:null},Ib(a,f)};r.layout.cluster=function(){function a(f,h){var k,l=b.call(this,f,h),m=l[0],n=0;Fa(m,function(a){var b=a.children;b&&b.length?(a.x=Rh(b),a.y=Qh(b)):(a.x=k?n+=d(a,k):0,a.y=0,k=a)});var p=Cf(m),q=Df(m),r=p.x-d(p,q)/2,w=q.x+d(q,p)/2;return Fa(m,g?function(a){a.x=
(a.x-m.x)*e[0];a.y=(m.y-a.y)*e[1]}:function(a){a.x=(a.x-r)/(w-r)*e[0];a.y=(1-(m.y?a.y/m.y:1))*e[1]}),l}var b=r.layout.hierarchy().sort(null).value(null),d=Bf,e=[1,1],g=!1;return a.separation=function(b){return arguments.length?(d=b,a):d},a.size=function(b){return arguments.length?(g=null==(e=b),a):g?null:e},a.nodeSize=function(b){return arguments.length?(g=null!=(e=b),a):g?e:null},Ib(a,b)};r.layout.treemap=function(){function a(b,d){for(var e,g,f=-1,h=b.length;++f<h;)g=(e=b[f]).value*(0>d?0:d),e.area=
isNaN(g)||0>=g?0:g}function b(d){var g=d.children;if(g&&g.length){var f,k=p(d),l=[],m=g.slice(),n=1/0,q="slice"===w?k.dx:"dice"===w?k.dy:"slice-dice"===w?1&d.depth?k.dy:k.dx:Math.min(k.dx,k.dy);a(m,k.dx*k.dy/d.value);for(l.area=0;0<(d=m.length);){l.push(d=m[d-1]);l.area+=d.area;var r;if(!(r="squarify"!==w)){d=q;f=void 0;var v=l.area;r=0;for(var A=1/0,y=-1,z=l.length;++y<z;)(f=l[y].area)&&(A>f&&(A=f),f>r&&(r=f));r=(f=(v*=v,d*=d,v?Math.max(d*r*t/v,v/(d*A*t)):1/0))<=n}r?(m.pop(),n=f):(l.area-=l.pop().area,
e(l,q,k,!1),q=Math.min(k.dx,k.dy),l.length=l.area=0,n=1/0)}l.length&&(e(l,q,k,!0),l.length=l.area=0);g.forEach(b)}}function d(b){var g=b.children;if(g&&g.length){var f=p(b),k=g.slice(),l=[];a(k,f.dx*f.dy/b.value);for(l.area=0;b=k.pop();)l.push(b),l.area+=b.area,null!=b.z&&(e(l,b.z?f.dx:f.dy,f,!k.length),l.length=l.area=0);g.forEach(d)}}function e(a,b,d,g){var f,h=-1,k=a.length,m=d.x,n=d.y,p=b?l(a.area/b):0;if(b==d.dx){for((g||p>d.dy)&&(p=d.dy);++h<k;)f=a[h],f.x=m,f.y=n,f.dy=p,m+=f.dx=Math.min(d.x+
d.dx-m,p?l(f.area/p):0);f.z=!0;f.dx+=d.x+d.dx-m;d.y+=p;d.dy-=p}else{for((g||p>d.dx)&&(p=d.dx);++h<k;)f=a[h],f.x=m,f.y=n,f.dx=p,n+=f.dy=Math.min(d.y+d.dy-n,p?l(f.area/p):0);f.z=!1;f.dy+=d.y+d.dy-n;d.x+=p;d.dx-=p}}function g(e){e=f||k(e);var l=e[0];return l.x=0,l.y=0,l.dx=m[0],l.dy=m[1],f&&k.revalue(l),a([l],l.dx*l.dy/l.value),(f?d:b)(l),q&&(f=e),e}var f,k=r.layout.hierarchy(),l=Math.round,m=[1,1],n=null,p=Ad,q=!1,w="squarify",t=.5*(1+Math.sqrt(5));return g.size=function(a){return arguments.length?
(m=a,g):m},g.padding=function(a){function b(d){var e=a.call(g,d,d.depth);return null==e?Ad(d):Ef(d,"number"==typeof e?[e,e,e,e]:e)}function d(b){return Ef(b,a)}if(!arguments.length)return n;var e;return p=null==(n=a)?Ad:"function"==(e=typeof a)?b:"number"===e?(a=[a,a,a,a],d):d,g},g.round=function(a){return arguments.length?(l=a?Math.round:Number,g):l!=Number},g.sticky=function(a){return arguments.length?(q=a,f=null,g):q},g.ratio=function(a){return arguments.length?(t=a,g):t},g.mode=function(a){return arguments.length?
(w=a+"",g):w},Ib(g,k)};r.random={normal:function(a,b){var d=arguments.length;return 2>d&&(b=1),1>d&&(a=0),function(){var d,e;do d=2*Math.random()-1,e=2*Math.random()-1,e=d*d+e*e;while(!e||1<e);return a+b*d*Math.sqrt(-2*Math.log(e)/e)}},logNormal:function(){var a=r.random.normal.apply(r,arguments);return function(){return Math.exp(a())}},bates:function(a){var b=r.random.irwinHall(a);return function(){return b()/a}},irwinHall:function(a){return function(){for(var b=0,d=0;a>d;d++)b+=Math.random();return b}}};
r.scale={};var Th={floor:ca,ceil:ca};r.scale.linear=function(){return Gf([0,1],[0,1],eb,!1)};var Wh={s:1,g:1,p:1,r:1,e:1};r.scale.log=function(){return Hf(r.scale.linear().domain([0,1]),10,!0,[1,10])};var If=r.format(".0e"),Xh={floor:function(a){return-Math.ceil(-a)},ceil:function(a){return-Math.floor(-a)}};r.scale.pow=function(){return Jf(r.scale.linear(),1,[0,1])};r.scale.sqrt=function(){return r.scale.pow().exponent(.5)};r.scale.ordinal=function(){return Kf([],{t:"range",a:[[]]})};r.scale.category10=
function(){return r.scale.ordinal().range(zi)};r.scale.category20=function(){return r.scale.ordinal().range(Ai)};r.scale.category20b=function(){return r.scale.ordinal().range(Bi)};r.scale.category20c=function(){return r.scale.ordinal().range(Ci)};var zi=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Pb),Ai=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,
1556175,10410725].map(Pb),Bi=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Pb),Ci=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Pb);r.scale.quantile=function(){return Lf([],[])};r.scale.quantize=function(){return Mf(0,1,[0,1])};r.scale.threshold=
function(){return Nf([.5],[0,1])};r.scale.identity=function(){return Of([0,1])};r.svg={};r.svg.arc=function(){function a(){var f=b.apply(this,arguments),h=d.apply(this,arguments),k=e.apply(this,arguments)+fb,l=g.apply(this,arguments)+fb,m=(k>l&&(m=k,k=l,l=m),l-k),n=I>m?"0":"1",p=Math.cos(k),k=Math.sin(k),q=Math.cos(l),l=Math.sin(l);return m>=Di?f?"M0,"+h+"A"+h+","+h+" 0 1,1 0,"+-h+"A"+h+","+h+" 0 1,1 0,"+h+"M0,"+f+"A"+f+","+f+" 0 1,0 0,"+-f+"A"+f+","+f+" 0 1,0 0,"+f+"Z":"M0,"+h+"A"+h+","+h+" 0 1,1 0,"+
-h+"A"+h+","+h+" 0 1,1 0,"+h+"Z":f?"M"+h*p+","+h*k+"A"+h+","+h+" 0 "+n+",1 "+h*q+","+h*l+"L"+f*q+","+f*l+"A"+f+","+f+" 0 "+n+",0 "+f*p+","+f*k+"Z":"M"+h*p+","+h*k+"A"+h+","+h+" 0 "+n+",1 "+h*q+","+h*l+"L0,0Z"}var b=Yh,d=Zh,e=Pf,g=Qf;return a.innerRadius=function(d){return arguments.length?(b=V(d),a):b},a.outerRadius=function(b){return arguments.length?(d=V(b),a):d},a.startAngle=function(b){return arguments.length?(e=V(b),a):e},a.endAngle=function(b){return arguments.length?(g=V(b),a):g},a.centroid=
function(){var a=(b.apply(this,arguments)+d.apply(this,arguments))/2,f=(e.apply(this,arguments)+g.apply(this,arguments))/2+fb;return[Math.cos(f)*a,Math.sin(f)*a]},a};var fb=-ea,Di=qa-C;r.svg.line=function(){return Rf(ca)};var Dd=r.map({linear:ra,"linear-closed":function(a){return ra(a)+"Z"},step:function(a){for(var b=0,d=a.length,e=a[0],g=[e[0],",",e[1]];++b<d;)g.push("H",(e[0]+(e=a[b])[0])/2,"V",e[1]);return 1<d&&g.push("H",e[0]),g.join("")},"step-before":Ed,"step-after":Fd,basis:Sf,"basis-open":function(a){if(4>
a.length)return ra(a);for(var b,d=[],e=-1,g=a.length,f=[0],k=[0];3>++e;)b=a[e],f.push(b[0]),k.push(b[1]);d.push(va(Ya,f)+","+va(Ya,k));for(--e;++e<g;)b=a[e],f.shift(),f.push(b[0]),k.shift(),k.push(b[1]),Hd(d,f,k);return d.join("")},"basis-closed":function(a){for(var b,d,e=-1,g=a.length,f=g+4,k=[],l=[];4>++e;)d=a[e%g],k.push(d[0]),l.push(d[1]);b=[va(Ya,k),",",va(Ya,l)];for(--e;++e<f;)d=a[e%g],k.shift(),k.push(d[0]),l.shift(),l.push(d[1]),Hd(b,k,l);return b.join("")},bundle:function(a,b){var d=a.length-
1;if(d)for(var e,g,f=a[0][0],k=a[0][1],l=a[d][0]-f,m=a[d][1]-k,n=-1;++n<=d;)e=a[n],g=n/d,e[0]=b*e[0]+(1-b)*(f+g*l),e[1]=b*e[1]+(1-b)*(k+g*m);return Sf(a)},cardinal:function(a,b){return 3>a.length?ra(a):a[0]+sc(a,Gd(a,b))},"cardinal-open":function(a,b){return 4>a.length?ra(a):a[1]+sc(a.slice(1,a.length-1),Gd(a,b))},"cardinal-closed":function(a,b){return 3>a.length?ra(a):a[0]+sc((a.push(a[0]),a),Gd([a[a.length-2]].concat(a,[a[1]]),b))},monotone:function(a){if(3>a.length)a=ra(a);else{var b=a[0],d,e,
g,f,k=[],l;d=0;l=a.length-1;for(var m=[],n=a[1],p=m[0]=Id(a[0],n);++d<l;)m[d]=(p+(p=Id(n,n=a[d+1])))/2;l=(m[d]=p,m);m=-1;for(n=a.length-1;++m<n;)d=Id(a[m],a[m+1]),F(d)<C?l[m]=l[m+1]=0:(e=l[m]/d,g=l[m+1]/d,f=e*e+g*g,9<f&&(f=3*d/Math.sqrt(f),l[m]=f*e,l[m+1]=f*g));for(m=-1;++m<=n;)f=(a[Math.min(n,m+1)][0]-a[Math.max(0,m-1)][0])/(6*(1+l[m]*l[m])),k.push([f||0,l[m]*f||0]);a=b+sc(a,k)}return a}});Dd.forEach(function(a,b){b.key=a;b.closed=/-closed$/.test(a)});var Tf=[0,2/3,1/3,0],Uf=[0,1/3,2/3,0],Ya=[0,
1/6,2/3,1/6];r.svg.line.radial=function(){var a=Rf(Vf);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a};Ed.reverse=Fd;Fd.reverse=Ed;r.svg.area=function(){return Wf(ca)};r.svg.area.radial=function(){var a=Wf(Vf);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a};r.svg.chord=function(){function a(f,h){var k=b(this,e,f,h),l=b(this,g,f,h);return"M"+k.p0+d(k.r,k.p1,k.a1-
k.a0)+(k.a0==l.a0&&k.a1==l.a1?"Q 0,0 "+k.p0:"Q 0,0 "+l.p0+d(l.r,l.p1,l.a1-l.a0)+("Q 0,0 "+k.p0))+"Z"}function b(a,d,e,g){var h=d.call(a,e,g);d=f.call(a,h,g);e=k.call(a,h,g)+fb;a=l.call(a,h,g)+fb;return{r:d,a0:e,a1:a,p0:[d*Math.cos(e),d*Math.sin(e)],p1:[d*Math.cos(a),d*Math.sin(a)]}}function d(a,b,e){return"A"+a+","+a+" 0 "+ +(e>I)+",1 "+b}var e=jd,g=kd,f=$h,k=Pf,l=Qf;return a.radius=function(b){return arguments.length?(f=V(b),a):f},a.source=function(b){return arguments.length?(e=V(b),a):e},a.target=
function(b){return arguments.length?(g=V(b),a):g},a.startAngle=function(b){return arguments.length?(k=V(b),a):k},a.endAngle=function(b){return arguments.length?(l=V(b),a):l},a};r.svg.diagonal=function(){function a(g,f){var h=b.call(this,g,f),k=d.call(this,g,f),l=(h.y+k.y)/2,h=[h,{x:h.x,y:l},{x:k.x,y:l},k];return h=h.map(e),"M"+h[0]+"C"+h[1]+" "+h[2]+" "+h[3]}var b=jd,d=kd,e=Xf;return a.source=function(d){return arguments.length?(b=V(d),a):b},a.target=function(b){return arguments.length?(d=V(b),a):
d},a.projection=function(b){return arguments.length?(e=b,a):e},a};r.svg.diagonal.radial=function(){var a=r.svg.diagonal(),b=Xf,d=a.projection;return a.projection=function(a){return arguments.length?d(ai(b=a)):b},a};r.svg.symbol=function(){function a(e,g){return(ng.get(b.call(this,e,g))||Yf)(d.call(this,e,g))}var b=ci,d=bi;return a.type=function(d){return arguments.length?(b=V(d),a):b},a.size=function(b){return arguments.length?(d=V(b),a):d},a};var ng=r.map({circle:Yf,cross:function(a){a=Math.sqrt(a/
5)/2;return"M"+-3*a+","+-a+"H"+-a+"V"+-3*a+"H"+a+"V"+-a+"H"+3*a+"V"+a+"H"+a+"V"+3*a+"H"+-a+"V"+a+"H"+-3*a+"Z"},diamond:function(a){a=Math.sqrt(a/(2*og));var b=a*og;return"M0,"+-a+"L"+b+",0 0,"+a+" "+-b+",0Z"},square:function(a){a=Math.sqrt(a)/2;return"M"+-a+","+-a+"L"+a+","+-a+" "+a+","+a+" "+-a+","+a+"Z"},"triangle-down":function(a){a=Math.sqrt(a/Kc);var b=a*Kc/2;return"M0,"+b+"L"+a+","+-b+" "+-a+","+-b+"Z"},"triangle-up":function(a){a=Math.sqrt(a/Kc);var b=a*Kc/2;return"M0,"+-b+"L"+a+","+b+" "+
-a+","+b+"Z"}});r.svg.symbolTypes=ng.keys();var hb,wc,Kc=Math.sqrt(3),og=Math.tan(30*H),ba=[],cg=0;ba.call=R.call;ba.empty=R.empty;ba.node=R.node;ba.size=R.size;r.transition=function(a){return arguments.length?hb?a.transition():a:bg.transition()};r.transition.prototype=ba;ba.select=function(a){var b,d,e,g=this.id,f=[];a=W(a);for(var k=-1,l=this.length;++k<l;){f.push(b=[]);for(var m=this[k],n=-1,p=m.length;++n<p;)(e=m[n])&&(d=a.call(e,e.__data__,n,k))?("__data__"in e&&(d.__data__=e.__data__),tc(d,
n,g,e.__transition__[g]),b.push(d)):b.push(null)}return Kb(f,g)};ba.selectAll=function(a){var b,d,e,g,f=this.id,k=[];a=vb(a);for(var l=-1,m=this.length;++l<m;)for(var n=this[l],p=-1,q=n.length;++p<q;)if(b=n[p]){g=b.__transition__[f];d=a.call(b,b.__data__,p,l);k.push(b=[]);for(var r=-1,w=d.length;++r<w;)(e=d[r])&&tc(e,r,f,g),b.push(e)}return Kb(k,f)};ba.filter=function(a){var b,d,e,g=[];"function"!=typeof a&&(a=wa(a));for(var f=0,k=this.length;k>f;f++){g.push(b=[]);d=this[f];for(var l=0,m=d.length;m>
l;l++)(e=d[l])&&a.call(e,e.__data__,l,f)&&b.push(e)}return Kb(g,this.id)};ba.tween=function(a,b){var d=this.id;return 2>arguments.length?this.node().__transition__[d].tween.get(a):Ha(this,null==b?function(b){b.__transition__[d].tween.remove(a)}:function(e){e.__transition__[d].tween.set(a,b)})};ba.attr=function(a,b){function d(){this.removeAttribute(l)}function e(){this.removeAttributeNS(l.space,l.local)}function g(a){return null==a?d:(a+="",function(){var b,d=this.getAttribute(l);return d!==a&&(b=
k(d,a),function(a){this.setAttribute(l,b(a))})})}function f(a){return null==a?e:(a+="",function(){var b,d=this.getAttributeNS(l.space,l.local);return d!==a&&(b=k(d,a),function(a){this.setAttributeNS(l.space,l.local,b(a))})})}if(2>arguments.length){for(b in a)this.attr(b,a[b]);return this}var k="transform"==a?sf:eb,l=r.ns.qualify(a);return Jd(this,"attr."+a,b,l.local?f:g)};ba.attrTween=function(a,b){function d(a,e){var f=b.call(this,a,e,this.getAttribute(g));return f&&function(a){this.setAttribute(g,
f(a))}}function e(a,d){var f=b.call(this,a,d,this.getAttributeNS(g.space,g.local));return f&&function(a){this.setAttributeNS(g.space,g.local,f(a))}}var g=r.ns.qualify(a);return this.tween("attr."+a,g.local?e:d)};ba.style=function(a,b,d){function e(){this.style.removeProperty(a)}var g=arguments.length;if(3>g){if("string"!=typeof a){2>g&&(b="");for(d in a)this.style(d,a[d],b);return this}d=""}return Jd(this,"style."+a,b,function(b){return null==b?e:(b+="",function(){var e,g=ha.getComputedStyle(this,
null).getPropertyValue(a);return g!==b&&(e=eb(g,b),function(b){this.style.setProperty(a,e(b),d)})})})};ba.styleTween=function(a,b,d){return 3>arguments.length&&(d=""),this.tween("style."+a,function(e,g){var f=b.call(this,e,g,ha.getComputedStyle(this,null).getPropertyValue(a));return f&&function(b){this.style.setProperty(a,f(b),d)}})};ba.text=function(a){return Jd(this,"text",a,di)};ba.remove=function(){return this.each("end.transition",function(){var a;2>this.__transition__.count&&(a=this.parentNode)&&
a.removeChild(this)})};ba.ease=function(a){var b=this.id;return 1>arguments.length?this.node().__transition__[b].ease:("function"!=typeof a&&(a=r.ease.apply(r,arguments)),Ha(this,function(d){d.__transition__[b].ease=a}))};ba.delay=function(a){var b=this.id;return 1>arguments.length?this.node().__transition__[b].delay:Ha(this,"function"==typeof a?function(d,e,g){d.__transition__[b].delay=+a.call(d,d.__data__,e,g)}:(a=+a,function(d){d.__transition__[b].delay=a}))};ba.duration=function(a){var b=this.id;
return 1>arguments.length?this.node().__transition__[b].duration:Ha(this,"function"==typeof a?function(d,e,g){d.__transition__[b].duration=Math.max(1,a.call(d,d.__data__,e,g))}:(a=Math.max(1,a),function(d){d.__transition__[b].duration=a}))};ba.each=function(a,b){var d=this.id;if(2>arguments.length){var e=wc,g=hb;hb=d;Ha(this,function(b,e,g){wc=b.__transition__[d];a.call(b,b.__data__,e,g)});wc=e;hb=g}else Ha(this,function(e){e=e.__transition__[d];(e.event||(e.event=r.dispatch("start","end"))).on(a,
b)});return this};ba.transition=function(){for(var a,b,d,e,g=this.id,f=++cg,k=[],l=0,m=this.length;m>l;l++){k.push(a=[]);b=this[l];for(var n=0,p=b.length;p>n;n++)(d=b[n])&&(e=Object.create(d.__transition__[g]),e.delay+=e.duration,tc(d,n,f,e)),a.push(d)}return Kb(k,f)};r.svg.axis=function(){function a(h){h.each(function(){var a,h=r.select(this),n=this.__chart__||d,p=this.__chart__=d.copy(),q=null==m?p.ticks?p.ticks.apply(p,l):p.domain():m,w=null==b?p.tickFormat?p.tickFormat.apply(p,l):ca:b,t=h.selectAll(".tick").data(q,
p),q=t.enter().insert("g",".domain").attr("class","tick").style("opacity",C),v=r.transition(t.exit()).style("opacity",C).remove(),A=r.transition(t.order()).style("opacity",1),y=Math.max(g,0)+k,z=oc(p),h=h.selectAll(".domain").data([0]),h=(h.enter().append("path").attr("class","domain"),r.transition(h));q.append("line");q.append("text");var D,Q,K,B,T=q.select("line"),H=A.select("line"),w=t.select("text").text(w),t=q.select("text"),I=A.select("text"),F="top"===e||"left"===e?-1:1;if("bottom"===e||"top"===
e?(a=ei,D="x",K="y",Q="x2",B="y2",w.attr("dy",0>F?"0em":".71em").style("text-anchor","middle"),h.attr("d","M"+z[0]+","+F*f+"V0H"+z[1]+"V"+F*f)):(a=fi,D="y",K="x",Q="y2",B="x2",w.attr("dy",".32em").style("text-anchor",0>F?"end":"start"),h.attr("d","M"+F*f+","+z[0]+"H0V"+z[1]+"H"+F*f)),T.attr(B,F*g),t.attr(K,F*y),H.attr(Q,0).attr(B,F*g),I.attr(D,0).attr(K,F*y),p.rangeBand)var na=p,da=na.rangeBand()/2,n=p=function(a){return na(a)+da};else n.rangeBand?n=p:v.call(a,p,n);q.call(a,n,p);A.call(a,p,p)})}var b,
d=r.scale.linear(),e=pg,g=6,f=6,k=3,l=[10],m=null;return a.scale=function(b){return arguments.length?(d=b,a):d},a.orient=function(b){return arguments.length?(e=b in Ei?b+"":pg,a):e},a.ticks=function(){return arguments.length?(l=arguments,a):l},a.tickValues=function(b){return arguments.length?(m=b,a):m},a.tickFormat=function(d){return arguments.length?(b=d,a):b},a.tickSize=function(b){var d=arguments.length;return d?(g=+b,f=+arguments[d-1],a):g},a.innerTickSize=function(b){return arguments.length?
(g=+b,a):g},a.outerTickSize=function(b){return arguments.length?(f=+b,a):f},a.tickPadding=function(b){return arguments.length?(k=+b,a):k},a.tickSubdivide=function(){return arguments.length&&a},a};var pg="bottom",Ei={top:1,right:1,bottom:1,left:1};r.svg.brush=function(){function a(f){f.each(function(){var f=r.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",g).on("touchstart.brush",g),k=f.selectAll(".background").data([0]);k.enter().append("rect").attr("class",
"background").style("visibility","hidden").style("cursor","crosshair");f.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var l=f.selectAll(".resize").data(v,ca);l.exit().remove();l.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return Fi[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",6).attr("height",6).style("visibility",
"hidden");l.style("display",a.empty()?"none":null);var p,f=r.transition(f),k=r.transition(k);m&&(p=oc(m),k.attr("x",p[0]).attr("width",p[1]-p[0]),d(f));n&&(p=oc(n),k.attr("y",p[0]).attr("height",p[1]-p[0]),e(f));b(f)})}function b(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+p[+/e$/.test(a)]+","+q[+/^s/.test(a)]+")"})}function d(a){a.select(".extent").attr("x",p[0]);a.selectAll(".extent,.n>rect,.s>rect").attr("width",p[1]-p[0])}function e(a){a.select(".extent").attr("y",
q[0]);a.selectAll(".extent,.e>rect,.w>rect").attr("height",q[1]-q[0])}function g(){function v(){var a=r.mouse(K),g=!1;D&&(a[0]+=D[0],a[1]+=D[1]);da||(r.event.altKey?(z||(z=[(p[0]+p[1])/2,(q[0]+q[1])/2]),W[0]=p[+(a[0]<z[0])],W[1]=q[+(a[1]<z[1])]):z=null);H&&A(a,m,0)&&(d(T),g=!0);I&&A(a,n,1)&&(e(T),g=!0);g&&(b(T),C({type:"brush",mode:da?"move":"resize"}))}function A(a,b,d){var e,g,h=oc(b);b=h[0];var h=h[1],l=W[d],m=d?q:p,n=m[1]-m[0];return da&&(b-=l,h-=n+l),e=(d?t:w)?Math.max(b,Math.min(h,a[d])):a[d],
da?g=(e+=l)+n:(z&&(l=Math.max(b,Math.min(h,2*z[d]-e))),e>l?(g=e,e=l):g=l),m[0]!=e||m[1]!=g?(d?k=null:f=null,m[0]=e,m[1]=g,!0):void 0}function y(){v();T.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null);r.select("body").style("cursor",null);P.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);ma();C({type:"brushend"})}var z,D,K=this,B=r.select(r.event.target),
C=l.of(K,arguments),T=r.select(K),F=B.datum(),H=!/^(n|s)$/.test(F)&&m,I=!/^(e|w)$/.test(F)&&n,da=B.classed("extent"),ma=Ob(),W=r.mouse(K),P=r.select(ha).on("keydown.brush",function(){32==r.event.keyCode&&(da||(z=null,W[0]-=p[1],W[1]-=q[1],da=2),Q())}).on("keyup.brush",function(){32==r.event.keyCode&&2==da&&(W[0]+=p[1],W[1]+=q[1],da=0,Q())});if(r.event.changedTouches?P.on("touchmove.brush",v).on("touchend.brush",y):P.on("mousemove.brush",v).on("mouseup.brush",y),T.interrupt().selectAll("*").interrupt(),
da)W[0]=p[0]-W[0],W[1]=q[0]-W[1];else if(F){var Lb=+/w$/.test(F),F=+/^n/.test(F);D=[p[1-Lb]-W[0],q[1-F]-W[1]];W[0]=p[Lb];W[1]=q[F]}else r.event.altKey&&(z=W.slice());T.style("pointer-events","none").selectAll(".resize").style("display",null);r.select("body").style("cursor",B.style("cursor"));C({type:"brushstart"});v()}var f,k,l=da(a,"brushstart","brush","brushend"),m=null,n=null,p=[0,0],q=[0,0],w=!0,t=!0,v=Qd[0];return a.event=function(a){a.each(function(){var a=l.of(this,arguments),b={x:p,y:q,i:f,
j:k},d=this.__chart__||b;this.__chart__=b;hb?r.select(this).transition().each("start.brush",function(){f=d.i;k=d.j;p=d.x;q=d.y;a({type:"brushstart"})}).tween("brush:brush",function(){var d=nc(p,b.x),e=nc(q,b.y);return f=k=null,function(g){p=b.x=d(g);q=b.y=e(g);a({type:"brush",mode:"resize"})}}).each("end.brush",function(){f=b.i;k=b.j;a({type:"brush",mode:"resize"});a({type:"brushend"})}):(a({type:"brushstart"}),a({type:"brush",mode:"resize"}),a({type:"brushend"}))})},a.x=function(b){return arguments.length?
(m=b,v=Qd[!m<<1|!n],a):m},a.y=function(b){return arguments.length?(n=b,v=Qd[!m<<1|!n],a):n},a.clamp=function(b){return arguments.length?(m&&n?(w=!!b[0],t=!!b[1]):m?w=!!b:n&&(t=!!b),a):m&&n?[w,t]:m?w:n?t:null},a.extent=function(b){var d,e,g,l,r;return arguments.length?(m&&(d=b[0],e=b[1],n&&(d=d[0],e=e[0]),f=[d,e],m.invert&&(d=m(d),e=m(e)),d>e&&(r=d,d=e,e=r),(d!=p[0]||e!=p[1])&&(p=[d,e])),n&&(g=b[0],l=b[1],m&&(g=g[1],l=l[1]),k=[g,l],n.invert&&(g=n(g),l=n(l)),g>l&&(r=g,g=l,l=r),(g!=q[0]||l!=q[1])&&(q=
[g,l])),a):(m&&(f?(d=f[0],e=f[1]):(d=p[0],e=p[1],m.invert&&(d=m.invert(d),e=m.invert(e)),d>e&&(r=d,d=e,e=r))),n&&(k?(g=k[0],l=k[1]):(g=q[0],l=q[1],n.invert&&(g=n.invert(g),l=n.invert(l)),g>l&&(r=g,g=l,l=r))),m&&n?[[d,g],[e,l]]:m?[d,e]:n&&[g,l])},a.clear=function(){return a.empty()||(p=[0,0],q=[0,0],f=k=null),a},a.empty=function(){return!!m&&p[0]==p[1]||!!n&&q[0]==q[1]},r.rebind(a,l,"on")};var Fi={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",
sw:"nesw-resize"},Qd=["n e s w nw ne se sw".split(" "),["e","w"],["n","s"],[]],Rd=B.format=eg.timeFormat,qg=Rd.utc,rg=qg("%Y-%m-%dT%H:%M:%S.%LZ");Rd.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Kd:rg;Kd.parse=function(a){a=new Date(a);return isNaN(a)?null:a};Kd.toString=rg.toString;B.second=$a(function(a){return new ga(1E3*Math.floor(a/1E3))},function(a,b){a.setTime(a.getTime()+1E3*Math.floor(b))},function(a){return a.getSeconds()});B.seconds=B.second.range;B.seconds.utc=
B.second.utc.range;B.minute=$a(function(a){return new ga(6E4*Math.floor(a/6E4))},function(a,b){a.setTime(a.getTime()+6E4*Math.floor(b))},function(a){return a.getMinutes()});B.minutes=B.minute.range;B.minutes.utc=B.minute.utc.range;B.hour=$a(function(a){var b=a.getTimezoneOffset()/60;return new ga(36E5*(Math.floor(a/36E5-b)+b))},function(a,b){a.setTime(a.getTime()+36E5*Math.floor(b))},function(a){return a.getHours()});B.hours=B.hour.range;B.hours.utc=B.hour.utc.range;B.month=$a(function(a){return a=
B.day(a),a.setDate(1),a},function(a,b){a.setMonth(a.getMonth()+b)},function(a){return a.getMonth()});B.months=B.month.range;B.months.utc=B.month.utc.range;var uc=[1E3,5E3,15E3,3E4,6E4,3E5,9E5,18E5,36E5,108E5,216E5,432E5,864E5,1728E5,6048E5,2592E6,7776E6,31536E6],Sd=[[B.second,1],[B.second,5],[B.second,15],[B.second,30],[B.minute,1],[B.minute,5],[B.minute,15],[B.minute,30],[B.hour,1],[B.hour,3],[B.hour,6],[B.hour,12],[B.day,1],[B.day,2],[B.week,1],[B.month,1],[B.month,3],[B.year,1]],Gi=Rd.multi([[".%L",
function(a){return a.getMilliseconds()}],[":%S",function(a){return a.getSeconds()}],["%I:%M",function(a){return a.getMinutes()}],["%I %p",function(a){return a.getHours()}],["%a %d",function(a){return a.getDay()&&1!=a.getDate()}],["%b %d",function(a){return 1!=a.getDate()}],["%B",function(a){return a.getMonth()}],["%Y",mb]]),gi={range:function(a,b,d){return r.range(Math.ceil(a/d)*d,+b,d).map(gb)},floor:ca,ceil:ca};Sd.year=B.year;B.scale=function(){return Ld(r.scale.linear(),Sd,Gi)};var sg=Sd.map(function(a){return[a[0].utc,
a[1]]}),Hi=qg.multi([[".%L",function(a){return a.getUTCMilliseconds()}],[":%S",function(a){return a.getUTCSeconds()}],["%I:%M",function(a){return a.getUTCMinutes()}],["%I %p",function(a){return a.getUTCHours()}],["%a %d",function(a){return a.getUTCDay()&&1!=a.getUTCDate()}],["%b %d",function(a){return 1!=a.getUTCDate()}],["%B",function(a){return a.getUTCMonth()}],["%Y",mb]]);sg.year=B.year.utc;B.scale.utc=function(){return Ld(r.scale.linear(),sg,Hi)};r.text=Zc(function(a){return a.responseText});
r.json=function(a,b){return Rb(a,"application/json",hi,b)};r.html=function(a,b){return Rb(a,"text/html",ii,b)};r.xml=Zc(function(a){return a.responseXML});"function"==typeof define&&define.amd?define(r):"object"==typeof module&&module.exports&&(module.exports=r);this.d3=r}();this.j$=this.jStat=function(f,e){function d(a,b){var d=a>b?a:b;return f.pow(10,17-~~(f.log(0<d?d:-d)*f.LOG10E))}function b(a){return"[object Function]"===q.call(a)}function a(a){return"number"==typeof a&&a===a}function g(){return new g._init(arguments)}function k(){return 0}function l(){return 1}function m(a,b){return a===b?1:0}var n=Array.prototype.concat,p=Array.prototype.slice,q=Object.prototype.toString,t=Array.isArray||function(a){return"[object Array]"===q.call(a)};g.fn=g.prototype;g._init=
function(d){var e;if(t(d[0]))if(t(d[0][0])){b(d[1])&&(d[0]=g.map(d[0],d[1]));for(e=0;e<d[0].length;e++)this[e]=d[0][e];this.length=d[0].length}else this[0]=b(d[1])?g.map(d[0],d[1]):d[0],this.length=1;else{if(a(d[0]))this[0]=g.seq.apply(null,d);else{if(d[0]instanceof g)return g(d[0].toArray());this[0]=[]}this.length=1}return this};g._init.prototype=g.prototype;g._init.constructor=g;g.utils={calcRdx:d,isArray:t,isFunction:b,isNumber:a,toVector:function(a){return n.apply([],a)}};g.extend=function(a){var b,
d;if(1===arguments.length){for(d in a)g[d]=a[d];return this}for(b=1;b<arguments.length;b++)for(d in arguments[b])a[d]=arguments[b][d];return a};g.rows=function(a){return a.length||1};g.cols=function(a){return a[0].length||1};g.dimensions=function(a){return{rows:g.rows(a),cols:g.cols(a)}};g.row=function(a,b){return a[b]};g.col=function(a,b){for(var d=Array(a.length),e=0;e<a.length;e++)d[e]=[a[e][b]];return d};g.diag=function(a){for(var b=g.rows(a),d=Array(b),e=0;e<b;e++)d[e]=[a[e][e]];return d};g.antidiag=
function(a){for(var b=g.rows(a)-1,d=Array(b),e=0;0<=b;b--,e++)d[e]=[a[e][b]];return d};g.transpose=function(a){var b=[],d,e,g,f,k;t(a[0])||(a=[a]);e=a.length;g=a[0].length;for(k=0;k<g;k++){d=Array(e);for(f=0;f<e;f++)d[f]=a[f][k];b.push(d)}return 1===b.length?b[0]:b};g.map=function(a,b,d){var e,g,f,k;t(a[0])||(a=[a]);e=a.length;g=a[0].length;f=d?a:Array(e);for(d=0;d<e;d++)for(f[d]||(f[d]=Array(g)),k=0;k<g;k++)f[d][k]=b(a[d][k],d,k);return 1===f.length?f[0]:f};g.cumreduce=function(a,b,d){var e,g,f,
k;t(a[0])||(a=[a]);e=a.length;g=a[0].length;f=d?a:Array(e);for(d=0;d<e;d++)for(f[d]||(f[d]=Array(g)),0<g&&(f[d][0]=a[d][0]),k=1;k<g;k++)f[d][k]=b(f[d][k-1],a[d][k]);return 1===f.length?f[0]:f};g.alter=function(a,b){return g.map(a,b,!0)};g.create=function(a,d,e){var g=Array(a),f,k;b(d)&&(e=d,d=a);for(f=0;f<a;f++)for(g[f]=Array(d),k=0;k<d;k++)g[f][k]=e(f,k);return g};g.zeros=function(b,d){return a(d)||(d=b),g.create(b,d,k)};g.ones=function(b,d){return a(d)||(d=b),g.create(b,d,l)};g.rand=function(b,
d){return a(d)||(d=b),g.create(b,d,f.random)};g.identity=function(b,d){return a(d)||(d=b),g.create(b,d,m)};g.symmetric=function(a){var b=a.length,d,e;if(a.length!==a[0].length)return!1;for(d=0;d<b;d++)for(e=0;e<b;e++)if(a[e][d]!==a[d][e])return!1;return!0};g.clear=function(a){return g.alter(a,k)};g.seq=function(a,e,g,f){b(f)||(f=!1);var k=[],l=d(a,e);g=(e*l-a*l)/((g-1)*l);var m=a,n;for(n=0;m<=e;n++,m=(a*l+g*l*n)/l)k.push(f?f(m,n):m);return k};var v=g.prototype;return v.length=0,v.push=Array.prototype.push,
v.sort=Array.prototype.sort,v.splice=Array.prototype.splice,v.slice=Array.prototype.slice,v.toArray=function(){return 1<this.length?p.call(this):p.call(this)[0]},v.map=function(a,b){return g(g.map(this,a,b))},v.cumreduce=function(a,b){return g(g.cumreduce(this,a,b))},v.alter=function(a){return g.alter(this,a),this},function(a){for(var b=0;b<a.length;b++)(function(a){v[a]=function(b){var d=this,e;return b?(setTimeout(function(){b.call(d,v[a].call(d))}),this):(e=g[a](this),t(e)?g(e):e)}})(a[b])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),
function(a){for(var b=0;b<a.length;b++)(function(a){v[a]=function(b,d){var e=this;return d?(setTimeout(function(){d.call(e,v[a].call(e,b))}),this):g(g[a](this,b))}})(a[b])}(["row","col"]),function(a){for(var b=0;b<a.length;b++){var d=a[b];v[d]=new Function("return jStat(jStat."+d+".apply(null, arguments));")}}(["create","zeros","ones","rand","identity"]),g}(Math);
(function(f,e){function d(a,b){return a-b}var b=f.utils.isFunction;f.sum=function(a){for(var b=0,d=a.length;0<=--d;)b+=a[d];return b};f.sumsqrd=function(a){for(var b=0,d=a.length;0<=--d;)b+=a[d]*a[d];return b};f.sumsqerr=function(a){for(var b=f.mean(a),d=0,e=a.length,n;0<=--e;)n=a[e]-b,d+=n*n;return d};f.product=function(a){for(var b=1,d=a.length;0<=--d;)b*=a[d];return b};f.min=function(a){for(var b=a[0],d=0;++d<a.length;)a[d]<b&&(b=a[d]);return b};f.max=function(a){for(var b=a[0],d=0;++d<a.length;)a[d]>
b&&(b=a[d]);return b};f.mean=function(a){return f.sum(a)/a.length};f.meansqerr=function(a){return f.sumsqerr(a)/a.length};f.geomean=function(a){return e.pow(f.product(a),1/a.length)};f.median=function(a){var b=a.length;a=a.slice().sort(d);return b&1?a[b/2|0]:(a[b/2-1]+a[b/2])/2};f.cumsum=function(a){return f.cumreduce(a,function(a,b){return a+b})};f.cumprod=function(a){return f.cumreduce(a,function(a,b){return a*b})};f.diff=function(a){var b=[],d=a.length,e;for(e=1;e<d;e++)b.push(a[e]-a[e-1]);return b};
f.mode=function(a){var b=a.length;a=a.slice().sort(d);var e=1,f=0,n=0,p=[],q;for(q=0;q<b;q++)a[q]===a[q+1]?e++:(e>f?(p=[a[q]],f=e,n=0):e===f&&(p.push(a[q]),n++),e=1);return 0===n?p[0]:p};f.range=function(a){return f.max(a)-f.min(a)};f.variance=function(a,b){return f.sumsqerr(a)/(a.length-(b?1:0))};f.stdev=function(a,b){return e.sqrt(f.variance(a,b))};f.meandev=function(a){var b=0,d=f.mean(a),m;for(m=a.length-1;0<=m;m--)b+=e.abs(a[m]-d);return b/a.length};f.meddev=function(a){var b=0,d=f.median(a),
m;for(m=a.length-1;0<=m;m--)b+=e.abs(a[m]-d);return b/a.length};f.coeffvar=function(a){return f.stdev(a)/f.mean(a)};f.quartiles=function(a){var b=a.length;a=a.slice().sort(d);return[a[e.round(b/4)-1],a[e.round(b/2)-1],a[e.round(3*b/4)-1]]};f.quantiles=function(a,b,f,m){var n=a.slice().sort(d),p=[b.length];a=a.length;var q,t,v;"undefined"==typeof f&&(f=.375);"undefined"==typeof m&&(m=.375);for(q=0;q<b.length;q++)t=b[q],v=f+t*(1-f-m),v=a*t+v,t=e.floor(e.max(1,e.min(v,a-1))),v=e.max(0,e.min(v-t,1)),
p[q]=(1-v)*n[t-1]+v*n[t];return p};f.percentileOfScore=function(a,b,d){var e=0,f=a.length,p=!1,q;"strict"===d&&(p=!0);for(q=0;q<f;q++)d=a[q],(p&&d<b||!p&&d<=b)&&e++;return e/f};f.histogram=function(a,b){var d=f.min(a),m=b||4,n=(f.max(a)-d)/m,p=a.length;b=[];var q;for(q=0;q<m;q++)b[q]=0;for(q=0;q<p;q++)b[e.min(e.floor((a[q]-d)/n),m-1)]+=1;return b};f.covariance=function(a,b){var d=f.mean(a),e=f.mean(b),n=a.length,p=Array(n),q;for(q=0;q<n;q++)p[q]=(a[q]-d)*(b[q]-e);return f.sum(p)/(n-1)};f.corrcoeff=
function(a,b){return f.covariance(a,b)/f.stdev(a,1)/f.stdev(b,1)};f.stanMoment=function(a,b){var d=f.mean(a),m=f.stdev(a),n=a.length,p=0;for(i=0;i<n;i++)p+=e.pow((a[i]-d)/m,b);return p/a.length};f.skewness=function(a){return f.stanMoment(a,3)};f.kurtosis=function(a){return f.stanMoment(a,4)-3};var a=f.prototype;(function(d){for(var e=0;e<d.length;e++)(function(d){a[d]=function(e,g){var k=[],q=0,t=this;b(e)&&(g=e,e=!1);if(g)return setTimeout(function(){g.call(t,a[d].call(t,e))}),this;if(1<this.length){for(t=
!0===e?this:this.transpose();q<t.length;q++)k[q]=f[d](t[q]);return k}return f[d](this[0],e)}})(d[e])})(["cumsum","cumprod"]);(function(d){for(var e=0;e<d.length;e++)(function(d){a[d]=function(e,g){var k=[],q=0,t=this;b(e)&&(g=e,e=!1);if(g)return setTimeout(function(){g.call(t,a[d].call(t,e))}),this;if(1<this.length){for(t=!0===e?this:this.transpose();q<t.length;q++)k[q]=f[d](t[q]);return!0===e?f[d](f.utils.toVector(k)):k}return f[d](this[0],e)}})(d[e])})("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" "));
(function(d){for(var e=0;e<d.length;e++)(function(d){a[d]=function(){var e=[],g=0,k=this,q=Array.prototype.slice.call(arguments);if(b(q[q.length-1])){var t=q[q.length-1],v=q.slice(0,q.length-1);return setTimeout(function(){t.call(k,a[d].apply(k,v))}),this}t=void 0;if(1<this.length){for(k=k.transpose();g<k.length;g++)e[g]=f[d].apply(k,[k[g]].concat(q));return e}return f[d].apply(k,[this[0]].concat(q))}})(d[e])})(["quantiles","percentileOfScore"])})(this.jStat,Math);
(function(f,e){f.gammaln=function(d){var b=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5.395239384953E-6],g=1.000000000190015,f,l;l=(f=d)+5.5;for(l-=(d+.5)*e.log(l);6>b;b++)g+=a[b]/++f;return e.log(2.5066282746310007*g/d)-l};f.gammafn=function(d){var b=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,
-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],g=!1,f=0,l=0,m=0,n,p,q,t;if(0>=d)if(t=d%1+3.6E-16)g=(d&1?-1:1)*e.PI/e.sin(e.PI*t),d=1-d;else return Infinity;q=d;1>d?p=d++:p=(d-=f=(d|0)-1)-1;for(n=0;8>n;++n)m=(m+b[n])*p,l=l*p+a[n];t=m/l+1;if(q<d)t/=q;else if(q>d)for(n=0;n<f;++n)t*=d,d++;return g&&(t=g/t),t};f.gammap=function(d,b){var a=f.gammaln(d),g=d,k=1/d,l=k,m=b+1-d,n=1/1E-30,p=1/m,q=p,t=1,v=-~(8.5*e.log(1<=d?d:1/d)+.4*d+17);if(0>
b||0>=d)return NaN;if(b<d+1){for(;t<=v;t++)k+=l*=b/++g;return k*e.exp(-b+d*e.log(b)-a)}for(;t<=v;t++)g=-t*(t-d),m+=2,p=g*p+m,n=m+g/n,p=1/p,q=q*p*n;return 1-q*e.exp(-b+d*e.log(b)-a)};f.factorialln=function(d){return 0>d?NaN:f.gammaln(d+1)};f.factorial=function(d){return 0>d?NaN:f.gammafn(d+1)};f.combination=function(d,b){return 170<d||170<b?e.exp(f.combinationln(d,b)):f.factorial(d)/f.factorial(b)/f.factorial(d-b)};f.combinationln=function(d,b){return f.factorialln(d)-f.factorialln(b)-f.factorialln(d-
b)};f.permutation=function(d,b){return f.factorial(d)/f.factorial(d-b)};f.betafn=function(d,b){return 0>=d||0>=b?void 0:170<d+b?e.exp(f.betaln(d,b)):f.gammafn(d)*f.gammafn(b)/f.gammafn(d+b)};f.betaln=function(d,b){return f.gammaln(d)+f.gammaln(b)-f.gammaln(d+b)};f.betacf=function(d,b,a){var g=1,f=b+a,l=b+1,m=b-1,n=1,p=1-f*d/l,q,t,v;1E-30>e.abs(p)&&(p=1E-30);for(v=p=1/p;100>=g&&!(q=2*g,t=g*(a-g)*d/((m+q)*(b+q)),p=1+t*p,1E-30>e.abs(p)&&(p=1E-30),n=1+t/n,1E-30>e.abs(n)&&(n=1E-30),p=1/p,v=v*p*n,t=-(b+
g)*(f+g)*d/((b+q)*(l+q)),p=1+t*p,1E-30>e.abs(p)&&(p=1E-30),n=1+t/n,1E-30>e.abs(n)&&(n=1E-30),p=1/p,q=p*n,v*=q,3E-7>e.abs(q-1));g++);return v};f.gammapinv=function(d,b){var a=0,g=b-1,k=f.gammaln(b),l,m,n,p,q;if(1<=d)return e.max(100,b+100*e.sqrt(b));if(0>=d)return 0;for(1<b?(p=e.log(g),q=e.exp(g*(p-1)-k),m=.5>d?d:1-d,n=e.sqrt(-2*e.log(m)),l=(2.30753+.27061*n)/(1+n*(.99229+.04481*n))-n,.5>d&&(l=-l),l=e.max(.001,b*e.pow(1-1/(9*b)-l/(3*e.sqrt(b)),3))):(n=1-b*(.253+.12*b),d<n?l=e.pow(d/n,1/b):l=1-e.log(1-
(d-n)/(1-n)));12>a;a++){if(0>=l)return 0;m=f.gammap(b,l)-d;1<b?n=q*e.exp(-(l-g)+g*(e.log(l)-p)):n=e.exp(-l+g*e.log(l)-k);n=m/n;l-=n/=1-.5*e.min(1,n*((b-1)/l-1));0>=l&&(l=.5*(l+n));if(e.abs(n)<1E-8*l)break}return l};f.erf=function(d){var b=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-9.46595344482036E-4,3.66839497852761E-4,4.2523324806907E-5,-2.0278578112534E-5,-1.624290004647E-6,1.30365583558E-6,1.5626441722E-8,-8.5238095915E-8,6.529054439E-9,5.059343495E-9,-9.91364156E-10,
-2.27365122E-10,9.6467911E-11,2.394038E-12,-6.886027E-12,8.94487E-13,3.13092E-13,-1.12708E-13,3.81E-16,7.106E-15,-1.523E-15,-9.4E-17,1.21E-16,-2.8E-17],a=b.length-1,g=!1,f=0,l=0,m,n,p,q;0>d&&(d=-d,g=!0);m=2/(2+d);for(n=4*m-2;0<a;a--)p=f,f=n*f-l+b[a],l=p;return q=m*e.exp(-d*d+.5*(b[0]+n*f)-l),g?q-1:1-q};f.erfc=function(d){return 1-f.erf(d)};f.erfcinv=function(d){var b=0,a,g,k;if(2<=d)return-100;if(0>=d)return 100;k=1>d?d:2-d;a=e.sqrt(-2*e.log(k/2));for(a=-.70711*((2.30753+.27061*a)/(1+a*(.99229+.04481*
a))-a);2>b;b++)g=f.erfc(a)-k,a+=g/(1.1283791670955126*e.exp(-a*a)-a*g);return 1>d?a:-a};f.ibetainv=function(d,b,a){var g=b-1,k=a-1,l=0,m,n,p,q,t,v,w,y,K;if(0>=d)return 0;if(1<=d)return 1;1<=b&&1<=a?(p=.5>d?d:1-d,q=e.sqrt(-2*e.log(p)),v=(2.30753+.27061*q)/(1+q*(.99229+.04481*q))-q,.5>d&&(v=-v),w=(v*v-3)/6,y=2/(1/(2*b-1)+1/(2*a-1)),K=v*e.sqrt(w+y)/y-(1/(2*a-1)-1/(2*b-1))*(w+5/6-2/(3*y)),v=b/(b+a*e.exp(2*K))):(m=e.log(b/(b+a)),n=e.log(a/(b+a)),q=e.exp(b*m)/b,t=e.exp(a*n)/a,K=q+t,d<q/K?v=e.pow(b*K*d,
1/b):v=1-e.pow(a*K*(1-d),1/a));for(m=-f.gammaln(b)-f.gammaln(a)+f.gammaln(b+a);10>l&&0!==v&&1!==v&&!(t=f.ibeta(v,b,a)-d,q=e.exp(g*e.log(v)+k*e.log(1-v)+m),t/=q,v-=q=t/(1-.5*e.min(1,t*(g/v-k/(1-v)))),0>=v&&(v=.5*(v+q)),1<=v&&(v=.5*(v+q+1)),e.abs(q)<1E-8*v&&0<l);l++);return v};f.ibeta=function(d,b,a){var g=0===d||1===d?0:e.exp(f.gammaln(b+a)-f.gammaln(b)-f.gammaln(a)+b*e.log(d)+a*e.log(1-d));return 0>d||1<d?!1:d<(b+1)/(b+a+2)?g*f.betacf(d,b,a)/b:1-g*f.betacf(1-d,a,b)/a};f.randn=function(d,b){var a,
g,k,l;b||(b=d);if(d)return f.create(d,b,function(){return f.randn()});do a=e.random(),g=1.7156*(e.random()-.5),k=a-.449871,l=e.abs(g)+.386595,k=k*k+l*(.196*l-.25472*k);while(.27597<k&&(.27846<k||g*g>-4*e.log(a)*a*a));return g/a};f.randg=function(d,b,a){var g=d,k,l,m;a||(a=b);d||(d=1);if(b)return k=f.zeros(b,a),k.alter(function(){return f.randg(d)}),k;1>d&&(d+=1);b=d-1/3;a=1/e.sqrt(9*b);do{do m=f.randn(),l=1+a*m;while(0>=l);l*=l*l;k=e.random()}while(k>1-.331*e.pow(m,4)&&e.log(k)>.5*m*m+b*(1-l+e.log(l)));
if(d==g)return b*l;do k=e.random();while(0===k);return e.pow(k,1/g)*b*l};(function(d){for(var b=0;b<d.length;b++)(function(a){f.fn[a]=function(){return f(f.map(this,function(b){return f[a](b)}))}})(d[b])})(["gammaln","gammafn","factorial","factorialln"]);(function(d){for(var b=0;b<d.length;b++)(function(a){f.fn[a]=function(){return f(f[a].apply(null,arguments))}})(d[b])})(["randn"])})(this.jStat,Math);
(function(f,e){(function(d){for(var b=0;b<d.length;b++)(function(a){f[a]=function(a,b,d){return this instanceof arguments.callee?(this._a=a,this._b=b,this._c=d,this):new arguments.callee(a,b,d)};f.fn[a]=function(b,d,e){b=f[a](b,d,e);return b.data=this,b};f[a].prototype.sample=function(b){var d=this._a,e=this._b,m=this._c;return b?f.alter(b,function(){return f[a].sample(d,e,m)}):f[a].sample(d,e,m)};(function(b){for(var d=0;d<b.length;d++)(function(b){f[a].prototype[b]=function(d){var e=this._a,g=this._b,
k=this._c;return!d&&0!==d&&(d=this.data),"number"!=typeof d?f.fn.map.call(d,function(d){return f[a][b](d,e,g,k)}):f[a][b](d,e,g,k)}})(b[d])})(["pdf","cdf","inv"]);(function(b){for(var d=0;d<b.length;d++)(function(b){f[a].prototype[b]=function(){return f[a][b](this._a,this._b,this._c)}})(b[d])})(["mean","median","mode","variance"])})(d[b])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" "));
f.extend(f.beta,{pdf:function(d,b,a){return 1<d||0>d?0:1==b&&1==a?1:512>b||512>a?e.pow(d,b-1)*e.pow(1-d,a-1)/f.betafn(b,a):e.exp((b-1)*e.log(d)+(a-1)*e.log(1-d)-f.betaln(b,a))},cdf:function(d,b,a){return 1<d||0>d?1*(1<d):f.ibeta(d,b,a)},inv:function(d,b,a){return f.ibetainv(d,b,a)},mean:function(d,b){return d/(d+b)},median:function(d,b){throw Error("median not yet implemented");},mode:function(d,b){return d*b/(e.pow(d+b,2)*(d+b+1))},sample:function(d,b){var a=f.randg(d);return a/(a+f.randg(b))},variance:function(d,
b){return d*b/(e.pow(d+b,2)*(d+b+1))}});f.extend(f.centralF,{pdf:function(d,b,a){var g,k,l;return 0>d?void 0:2>=b?e.sqrt(e.pow(b*d,b)*e.pow(a,a)/e.pow(b*d+a,b+a))/(d*f.betafn(b/2,a/2)):(g=b*d/(a+d*b),k=a/(a+d*b),l=b*k/2,l*f.binomial.pdf((b-2)/2,(b+a-2)/2,g))},cdf:function(d,b,a){return f.ibeta(b*d/(b*d+a),b/2,a/2)},inv:function(d,b,a){return a/(b*(1/f.ibetainv(d,b/2,a/2)-1))},mean:function(d,b){return 2<b?b/(b-2):void 0},mode:function(d,b){return 2<d?b*(d-2)/(d*(b+2)):void 0},sample:function(d,b){var a=
2*f.randg(d/2),e=2*f.randg(b/2);return a/d/(e/b)},variance:function(d,b){return 4>=b?void 0:2*b*b*(d+b-2)/(d*(b-2)*(b-2)*(b-4))}});f.extend(f.cauchy,{pdf:function(d,b,a){return a/(e.pow(d-b,2)+e.pow(a,2))/e.PI},cdf:function(d,b,a){return e.atan((d-b)/a)/e.PI+.5},inv:function(d,b,a){return b+a*e.tan(e.PI*(d-.5))},median:function(d,b){return d},mode:function(d,b){return d},sample:function(d,b){return f.randn()*e.sqrt(1/(2*f.randg(.5)))*b+d}});f.extend(f.chisquare,{pdf:function(d,b){return 0===d?0:e.exp((b/
2-1)*e.log(d)-d/2-b/2*e.log(2)-f.gammaln(b/2))},cdf:function(d,b){return f.gammap(b/2,d/2)},inv:function(d,b){return 2*f.gammapinv(d,.5*b)},mean:function(d){return d},median:function(d){return d*e.pow(1-2/(9*d),3)},mode:function(d){return 0<d-2?d-2:0},sample:function(d){return 2*f.randg(d/2)},variance:function(d){return 2*d}});f.extend(f.exponential,{pdf:function(d,b){return 0>d?0:b*e.exp(-b*d)},cdf:function(d,b){return 0>d?0:1-e.exp(-b*d)},inv:function(d,b){return-e.log(1-d)/b},mean:function(d){return 1/
d},median:function(d){return 1/d*e.log(2)},mode:function(d){return 0},sample:function(d){return-1/d*e.log(e.random())},variance:function(d){return e.pow(d,-2)}});f.extend(f.gamma,{pdf:function(d,b,a){return e.exp((b-1)*e.log(d)-d/a-f.gammaln(b)-b*e.log(a))},cdf:function(d,b,a){return f.gammap(b,d/a)},inv:function(d,b,a){return f.gammapinv(d,b)*a},mean:function(d,b){return d*b},mode:function(d,b){return 1<d?(d-1)*b:void 0},sample:function(d,b){return f.randg(d)*b},variance:function(d,b){return d*b*
b}});f.extend(f.invgamma,{pdf:function(d,b,a){return e.exp(-(b+1)*e.log(d)-a/d-f.gammaln(b)+b*e.log(a))},cdf:function(d,b,a){return 1-f.gammap(b,a/d)},inv:function(d,b,a){return a/f.gammapinv(1-d,b)},mean:function(d,b){return 1<d?b/(d-1):void 0},mode:function(d,b){return b/(d+1)},sample:function(d,b){return b/f.randg(d)},variance:function(d,b){return 2>=d?void 0:b*b/((d-1)*(d-1)*(d-2))}});f.extend(f.kumaraswamy,{pdf:function(d,b,a){return e.exp(e.log(b)+e.log(a)+(b-1)*e.log(d)+(a-1)*e.log(1-e.pow(d,
b)))},cdf:function(d,b,a){return 1-e.pow(1-e.pow(d,b),a)},mean:function(d,b){return b*f.gammafn(1+1/d)*f.gammafn(b)/f.gammafn(1+1/d+b)},median:function(d,b){return e.pow(1-e.pow(2,-1/b),1/d)},mode:function(d,b){return 1<=d&&1<=b&&1!==d&&1!==b?e.pow((d-1)/(d*b-1),1/d):void 0},variance:function(d,b){throw Error("variance not yet implemented");}});f.extend(f.lognormal,{pdf:function(d,b,a){return e.exp(-e.log(d)-.5*e.log(2*e.PI)-e.log(a)-e.pow(e.log(d)-b,2)/(2*a*a))},cdf:function(d,b,a){return.5+.5*f.erf((e.log(d)-
b)/e.sqrt(2*a*a))},inv:function(d,b,a){return e.exp(-1.4142135623730951*a*f.erfcinv(2*d)+b)},mean:function(d,b){return e.exp(d+b*b/2)},median:function(d,b){return e.exp(d)},mode:function(d,b){return e.exp(d-b*b)},sample:function(d,b){return e.exp(f.randn()*b+d)},variance:function(d,b){return(e.exp(b*b)-1)*e.exp(2*d+b*b)}});f.extend(f.normal,{pdf:function(d,b,a){return e.exp(-.5*e.log(2*e.PI)-e.log(a)-e.pow(d-b,2)/(2*a*a))},cdf:function(d,b,a){return.5*(1+f.erf((d-b)/e.sqrt(2*a*a)))},inv:function(d,
b,a){return-1.4142135623730951*a*f.erfcinv(2*d)+b},mean:function(d,b){return d},median:function(d,b){return d},mode:function(d,b){return d},sample:function(d,b){return f.randn()*b+d},variance:function(d,b){return b*b}});f.extend(f.pareto,{pdf:function(d,b,a){return d<b?void 0:a*e.pow(b,a)/e.pow(d,a+1)},cdf:function(d,b,a){return 1-e.pow(b/d,a)},mean:function(d,b){return 1>=b?void 0:b*e.pow(d,b)/(b-1)},median:function(d,b){return d*b*e.SQRT2},mode:function(d,b){return d},variance:function(d,b){return 2>=
b?void 0:d*d*b/(e.pow(b-1,2)*(b-2))}});f.extend(f.studentt,{pdf:function(d,b){return f.gammafn((b+1)/2)/(e.sqrt(b*e.PI)*f.gammafn(b/2))*e.pow(1+d*d/b,-((b+1)/2))},cdf:function(d,b){var a=b/2;return f.ibeta((d+e.sqrt(d*d+b))/(2*e.sqrt(d*d+b)),a,a)},inv:function(d,b){var a=f.ibetainv(2*e.min(d,1-d),.5*b,.5);return a=e.sqrt(b*(1-a)/a),.5<d?a:-a},mean:function(d){return 1<d?0:void 0},median:function(d){return 0},mode:function(d){return 0},sample:function(d){return f.randn()*e.sqrt(d/(2*f.randg(d/2)))},
variance:function(d){return 2<d?d/(d-2):1<d?Infinity:void 0}});f.extend(f.weibull,{pdf:function(d,b,a){return 0>d?0:a/b*e.pow(d/b,a-1)*e.exp(-e.pow(d/b,a))},cdf:function(d,b,a){return 0>d?0:1-e.exp(-e.pow(d/b,a))},inv:function(d,b,a){return b*e.pow(-e.log(1-d),1/a)},mean:function(d,b){return d*f.gammafn(1+1/b)},median:function(d,b){return d*e.pow(e.log(2),1/b)},mode:function(d,b){return 1>=b?void 0:d*e.pow((b-1)/b,1/b)},sample:function(d,b){return d*e.pow(-e.log(e.random()),1/b)},variance:function(d,
b){return d*d*f.gammafn(1+2/b)-e.pow(this.mean(d,b),2)}});f.extend(f.uniform,{pdf:function(d,b,a){return d<b||d>a?0:1/(a-b)},cdf:function(d,b,a){return d<b?0:d<a?(d-b)/(a-b):1},inv:function(d,b,a){return b+d*(a-b)},mean:function(d,b){return.5*(d+b)},median:function(d,b){return f.mean(d,b)},mode:function(d,b){throw Error("mode is not yet implemented");},sample:function(d,b){return d/2+b/2+(b/2-d/2)*(2*e.random()-1)},variance:function(d,b){return e.pow(b-d,2)/12}});f.extend(f.binomial,{pdf:function(d,
b,a){return 0===a||1===a?b*a===d?1:0:f.combination(b,d)*e.pow(a,d)*e.pow(1-a,b-d)},cdf:function(d,b,a){var e=[],k=0;if(0>d)return 0;if(d<b){for(;k<=d;k++)e[k]=f.binomial.pdf(k,b,a);return f.sum(e)}return 1}});f.extend(f.negbin,{pdf:function(d,b,a){return d!==d|0?!1:0>d?0:f.combination(d+b-1,b-1)*e.pow(1-a,d)*e.pow(a,b)},cdf:function(d,b,a){var e=0,k=0;if(0>d)return 0;for(;k<=d;k++)e+=f.negbin.pdf(k,b,a);return e}});f.extend(f.hypgeom,{pdf:function(d,b,a,g){if(d!==d|0)return!1;if(0>d||d<a-(b-g)||d>
g||d>a)return 0;if(2*a>b)return 2*g>b?f.hypgeom.pdf(b-a-g+d,b,b-a,b-g):f.hypgeom.pdf(g-d,b,b-a,g);if(2*g>b)return f.hypgeom.pdf(a-d,b,a,b-g);if(a<g)return f.hypgeom.pdf(d,b,g,a);for(var k=1,l=0,m=0;m<d;m++){for(;1<k&&l<g;)k*=1-a/(b-l),l++;k*=(g-m)*(a-m)/((m+1)*(b-a-g+m+1))}for(;l<g;l++)k*=1-a/(b-l);return e.min(1,e.max(0,k))},cdf:function(d,b,a,g){if(0>d||d<a-(b-g))return 0;if(d>=g||d>=a)return 1;if(2*a>b)return 2*g>b?f.hypgeom.cdf(b-a-g+d,b,b-a,b-g):1-f.hypgeom.cdf(g-d-1,b,b-a,g);if(2*g>b)return 1-
f.hypgeom.cdf(a-d-1,b,a,b-g);if(a<g)return f.hypgeom.cdf(d,b,g,a);for(var k=1,l=1,m=0,n=0;n<d;n++){for(;1<k&&m<g;){var p=1-a/(b-m),l=l*p,k=k*p;m++}l*=(g-n)*(a-n)/((n+1)*(b-a-g+n+1));k+=l}for(;m<g;m++)k*=1-a/(b-m);return e.min(1,e.max(0,k))}});f.extend(f.poisson,{pdf:function(d,b){return e.pow(b,d)*e.exp(-b)/f.factorial(d)},cdf:function(d,b){var a=[],e=0;if(0>d)return 0;for(;e<=d;e++)a.push(f.poisson.pdf(e,b));return f.sum(a)},mean:function(d){return d},variance:function(d){return d},sample:function(d){var b=
1,a=0;d=e.exp(-d);do a++,b*=e.random();while(b>d);return a-1}});f.extend(f.triangular,{pdf:function(d,b,a,e){return a<=b||e<b||e>a?void 0:d<b||d>a?0:d<=e?2*(d-b)/((a-b)*(e-b)):2*(a-d)/((a-b)*(a-e))},cdf:function(d,b,a,g){return a<=b||g<b||g>a?void 0:d<b?0:d<=g?e.pow(d-b,2)/((a-b)*(g-b)):1-e.pow(a-d,2)/((a-b)*(a-g))},mean:function(d,b,a){return(d+b+a)/3},median:function(d,b,a){if(a<=(d+b)/2)return b-e.sqrt((b-d)*(b-a))/e.sqrt(2);if(a>(d+b)/2)return d+e.sqrt((b-d)*(a-d))/e.sqrt(2)},mode:function(d,
b,a){return a},sample:function(d,b,a){var g=e.random();return g<(a-d)/(b-d)?d+e.sqrt(g*(b-d)*(a-d)):b-e.sqrt((1-g)*(b-d)*(b-a))},variance:function(d,b,a){return(d*d+b*b+a*a-d*b-d*a-b*a)/18}})})(this.jStat,Math);
(function(f,e){var d=Array.prototype.push,b=f.utils.isArray;f.extend({add:function(a,d){return b(d)?(b(d[0])||(d=[d]),f.map(a,function(a,b,e){return a+d[b][e]})):f.map(a,function(a){return a+d})},subtract:function(a,d){return b(d)?(b(d[0])||(d=[d]),f.map(a,function(a,b,e){return a-d[b][e]||0})):f.map(a,function(a){return a-d})},divide:function(a,d){return b(d)?(b(d[0])||(d=[d]),f.multiply(a,f.inv(d))):f.map(a,function(a){return a/d})},multiply:function(a,d){var e,l,m,n,p=a.length,q=a[0].length,t=
f.zeros(p,m=b(d)?d[0].length:q),v=0;if(b(d)){for(;v<m;v++)for(e=0;e<p;e++){for(l=n=0;l<q;l++)n+=a[e][l]*d[l][v];t[e][v]=n}return 1===p&&1===v?t[0][0]:t}return f.map(a,function(a){return a*d})},dot:function(a,d){b(a[0])||(a=[a]);b(d[0])||(d=[d]);for(var e=1===a[0].length&&1!==a.length?f.transpose(a):a,l=1===d[0].length&&1!==d.length?f.transpose(d):d,m=[],n=0,p=e.length,q=e[0].length,t,v;n<p;n++){m[n]=[];for(v=t=0;v<q;v++)t+=e[n][v]*l[n][v];m[n]=t}return 1===m.length?m[0]:m},pow:function(a,b){return f.map(a,
function(a){return e.pow(a,b)})},exp:function(a){return f.map(a,function(a){return e.exp(a)})},log:function(a){return f.map(a,function(a){return e.log(a)})},abs:function(a){return f.map(a,function(a){return e.abs(a)})},norm:function(a,d){var f=0,l=0;isNaN(d)&&(d=2);for(b(a[0])&&(a=a[0]);l<a.length;l++)f+=e.pow(e.abs(a[l]),d);return e.pow(f,1/d)},angle:function(a,b){return e.acos(f.dot(a,b)/(f.norm(a)*f.norm(b)))},aug:function(a,b){for(var e=a.slice(),f=0;f<e.length;f++)d.apply(e[f],b[f]);return e},
inv:function(a){var b=a.length,d=a[0].length,e=f.identity(b,d);a=f.gauss_jordan(a,e);for(var e=[],m=0,n;m<b;m++)for(e[m]=[],n=d;n<a[0].length;n++)e[m][n-d]=a[m][n];return e},det:function(a){var b=a.length,d=2*b,e=Array(d),f=b-1,n=d-1,p=f-b+1,q=n,t=0,v=0,w;if(2===b)return a[0][0]*a[1][1]-a[0][1]*a[1][0];for(;t<d;t++)e[t]=1;for(t=0;t<b;t++){for(w=0;w<b;w++)e[0>p?p+b:p]*=a[t][w],e[q<b?q+b:q]*=a[t][w],p++,q--;p=--f-b+1;q=--n}for(t=0;t<b;t++)v+=e[t];for(;t<d;t++)v-=e[t];return v},gauss_elimination:function(a,
b){var d=0,l=0,m=a.length,n=a[0].length,p=1,q=0,t=[],v;a=f.aug(a,b);v=a[0].length;for(d=0;d<m;d++){p=a[d][d];l=d;for(q=d+1;q<n;q++)p<e.abs(a[q][d])&&(p=a[q][d],l=q);if(l!=d)for(q=0;q<v;q++)p=a[d][q],a[d][q]=a[l][q],a[l][q]=p;for(l=d+1;l<m;l++)for(p=a[l][d]/a[d][d],q=d;q<v;q++)a[l][q]-=p*a[d][q]}for(d=m-1;0<=d;d--){q=0;for(l=d+1;l<=m-1;l++)q+=t[l]*a[d][l];t[d]=(a[d][v-1]-q)/a[d][d]}return t},gauss_jordan:function(a,b){for(var d=f.aug(a,b),l=d.length,m=d[0].length,n=0;n<l;n++){for(var p=n,q=n+1;q<l;q++)e.abs(d[q][n])>
e.abs(d[p][n])&&(p=q);q=d[n];d[n]=d[p];d[p]=q;for(q=n+1;q<l;q++)for(c=d[q][n]/d[n][n],p=n;p<m;p++)d[q][p]-=d[n][p]*c}for(n=l-1;0<=n;n--){c=d[n][n];for(q=0;q<n;q++)for(p=m-1;p>n-1;p--)d[q][p]-=d[n][p]*d[q][n]/c;d[n][n]/=c;for(p=l;p<m;p++)d[n][p]/=c}return d},lu:function(a,b){throw Error("lu not yet implemented");},cholesky:function(a,b){throw Error("cholesky not yet implemented");},gauss_jacobi:function(a,b,d,l){for(var m=0,n=0,p=a.length,q=[],t=[],v=[];m<p;m++)for(q[m]=[],t[m]=[],v[m]=[],n=0;n<p;n++)m>
n?(q[m][n]=a[m][n],t[m][n]=v[m][n]=0):m<n?(t[m][n]=a[m][n],q[m][n]=v[m][n]=0):(v[m][n]=a[m][n],q[m][n]=t[m][n]=0);a=f.multiply(f.multiply(f.inv(v),f.add(q,t)),-1);v=f.multiply(f.inv(v),b);b=d;d=f.add(f.multiply(a,d),v);for(m=2;e.abs(f.norm(f.subtract(d,b)))>l;)b=d,d=f.add(f.multiply(a,b),v),m++;return d},gauss_seidel:function(a,b,d,l){for(var m=0,n=a.length,p=[],q=[],t=[],v;m<n;m++)for(p[m]=[],q[m]=[],t[m]=[],v=0;v<n;v++)m>v?(p[m][v]=a[m][v],q[m][v]=t[m][v]=0):m<v?(q[m][v]=a[m][v],p[m][v]=t[m][v]=
0):(t[m][v]=a[m][v],p[m][v]=q[m][v]=0);a=f.multiply(f.multiply(f.inv(f.add(t,p)),q),-1);p=f.multiply(f.inv(f.add(t,p)),b);b=d;d=f.add(f.multiply(a,d),p);for(m=2;e.abs(f.norm(f.subtract(d,b)))>l;)b=d,d=f.add(f.multiply(a,b),p),m+=1;return d},SOR:function(a,b,d,l,m){for(var n=0,p=a.length,q=[],t=[],v=[],w;n<p;n++)for(q[n]=[],t[n]=[],v[n]=[],w=0;w<p;w++)n>w?(q[n][w]=a[n][w],t[n][w]=v[n][w]=0):n<w?(t[n][w]=a[n][w],q[n][w]=v[n][w]=0):(v[n][w]=a[n][w],q[n][w]=t[n][w]=0);a=f.multiply(f.inv(f.add(v,f.multiply(q,
m))),f.subtract(f.multiply(v,1-m),f.multiply(t,m)));m=f.multiply(f.multiply(f.inv(f.add(v,f.multiply(q,m))),b),m);b=d;d=f.add(f.multiply(a,d),m);for(n=2;e.abs(f.norm(f.subtract(d,b)))>l;)b=d,d=f.add(f.multiply(a,b),m),n++;return d},householder:function(a){for(var b=a.length,d=a[0].length,l=0,m=[],n=[],p;l<b-1;l++){n=0;for(m=l+1;m<d;m++)n+=a[m][l]*a[m][l];m=0<a[l+1][l]?-1:1;n=m*e.sqrt(n);p=e.sqrt((n*n-a[l+1][l]*n)/2);m=f.zeros(b,1);m[l+1][0]=(a[l+1][l]-n)/(2*p);for(n=l+2;n<b;n++)m[n][0]=a[n][l]/(2*
p);n=f.subtract(f.identity(b,d),f.multiply(f.multiply(m,f.transpose(m)),2));a=f.multiply(n,f.multiply(a,n))}return a},QR:function(a,b){for(var d=a.length,l=a[0].length,m=0,n=[],p=[],q=[],t;m<d-1;m++){p=0;for(n=m+1;n<l;n++)p+=a[n][m]*a[n][m];n=0<a[m+1][m]?-1:1;p=n*e.sqrt(p);t=e.sqrt((p*p-a[m+1][m]*p)/2);n=f.zeros(d,1);n[m+1][0]=(a[m+1][m]-p)/(2*t);for(p=m+2;p<d;p++)n[p][0]=a[p][m]/(2*t);p=f.subtract(f.identity(d,l),f.multiply(f.multiply(n,f.transpose(n)),2));a=f.multiply(p,a);b=f.multiply(p,b)}for(m=
d-1;0<=m;m--){for(n=m+1;n<=l-1;n++);q[m]=b[m][0]/a[m][m]}return q},jacobi:function(a){for(var b=1,d=0,l=a.length,m=f.identity(l,l),n=[],p,q,t,v,w;1===b;){d++;v=a[0][1];b=0;t=1;for(p=0;p<l;p++)for(q=0;q<l;q++)p!=q&&v<e.abs(a[p][q])&&(v=e.abs(a[p][q]),b=p,t=q);a[b][b]===a[t][t]?w=0<a[b][t]?e.PI/4:-e.PI/4:w=e.atan(2*a[b][t]/(a[b][b]-a[t][t]))/2;p=f.identity(l,l);p[b][b]=e.cos(w);p[b][t]=-e.sin(w);p[t][b]=e.sin(w);p[t][t]=e.cos(w);m=f.multiply(m,p);a=f.multiply(f.multiply(f.inv(p),a),p);b=0;for(p=1;p<
l;p++)for(q=1;q<l;q++)p!=q&&.001<e.abs(a[p][q])&&(b=1)}for(p=0;p<l;p++)n.push(a[p][p]);return[m,n]},rungekutta:function(a,b,d,e,f,n){var p,q,t;if(2===n)for(;e<=d;)p=b*a(e,f),q=b*a(e+b,f+p),f+=(p+q)/2,e+=b;if(4===n)for(;e<=d;)p=b*a(e,f),q=b*a(e+b/2,f+p/2),n=b*a(e+b/2,f+q/2),t=b*a(e+b,f+n),f+=(p+2*q+2*n+t)/6,e+=b;return f},romberg:function(a,b,d,f){for(var m=0,n=(d-b)/2,p=[],q=[],t=[],v,w,y;m<f/2;){y=a(b);w=b;for(v=0;w<=d;w+=n,v++)p[v]=w;v=p.length;for(w=1;w<v-1;w++)y+=(0!==w%2?4:2)*a(p[w]);y=n/3*(y+
a(d));t[m]=y;n/=2;m++}a=t.length;for(v=1;1!==a;){for(w=0;w<a-1;w++)q[w]=(e.pow(4,v)*t[w+1]-t[w])/(e.pow(4,v)-1);a=q.length;t=q;q=[];v++}return t},richardson:function(a,b,d,f){function m(a,b){for(var d=0,e=a.length,g;d<e;d++)a[d]===b&&(g=d);return g}for(var n=e.abs(d-a[m(a,d)+1]),p=0,q=[],t=[],v,w;f>=n;)v=m(a,d+f),w=m(a,d),q[p]=(b[v]-2*b[w]+b[2*w-v])/(f*f),f/=2,p++;b=q.length;for(a=1;1!=b;){for(d=0;d<b-1;d++)t[d]=(e.pow(4,a)*q[d+1]-q[d])/(e.pow(4,a)-1);b=t.length;q=t;t=[];a++}return q},simpson:function(a,
b,d,e){e=(d-b)/e;var f=a(b),n=[],p=b,q=0;for(b=1;p<=d;p+=e,q++)n[q]=p;for(p=n.length;b<p-1;b++)f+=(0!==b%2?4:2)*a(n[b]);return e/3*(f+a(d))},hermite:function(a,b,d,e){for(var f=a.length,n=0,p=0,q=[],t=[],v=[],w=[],y;p<f;p++){q[p]=1;for(y=0;y<f;y++)p!=y&&(q[p]*=(e-a[y])/(a[p]-a[y]));for(y=t[p]=0;y<f;y++)p!=y&&(t[p]+=1/(a[p]-a[y]));v[p]=(1-2*(e-a[p])*t[p])*q[p]*q[p];w[p]=(e-a[p])*q[p]*q[p];n+=v[p]*b[p]+w[p]*d[p]}return n},lagrange:function(a,b,d){for(var e=0,f=0,n,p,q=a.length;f<q;f++){p=b[f];for(n=
0;n<q;n++)f!=n&&(p*=(d-a[n])/(a[f]-a[n]));e+=p}return e},cubic_spline:function(a,b,d){for(var e=a.length,m=0,n=[],p=[],q=[],t=[],v=[],w=[],y=[];m<e-1;m++)v[m]=a[m+1]-a[m];q[0]=0;for(m=1;m<e-1;m++)q[m]=3/v[m]*(b[m+1]-b[m])-3/v[m-1]*(b[m]-b[m-1]);for(m=1;m<e-1;m++)n[m]=[],p[m]=[],n[m][m-1]=v[m-1],n[m][m]=2*(v[m-1]+v[m]),n[m][m+1]=v[m],p[m][0]=q[m];t=f.multiply(f.inv(n),p);for(m=0;m<e-1;m++)w[m]=(b[m+1]-b[m])/v[m]-v[m]*(t[m+1][0]+2*t[m][0])/3,y[m]=(t[m+1][0]-t[m][0])/(3*v[m]);for(m=0;m<e&&!(a[m]>d);m++);
return--m,b[m]+(d-a[m])*w[m]+f.sq(d-a[m])*t[m]+(d-a[m])*f.sq(d-a[m])*y[m]},gauss_quadrature:function(){throw Error("gauss_quadrature not yet implemented");},PCA:function(a){var b=a.length,d=a[0].length,e=0,m,n,p=[],q=[];m=[];for(var t=[],v=[],w=[],w=[],q=[],e=[],y=[],e=0;e<b;e++)p[e]=f.sum(a[e])/d;for(e=0;e<d;e++)for(w[e]=[],m=0;m<b;m++)w[e][m]=a[m][e]-p[m];w=f.transpose(w);for(e=0;e<b;e++)for(q[e]=[],m=0;m<b;m++)q[e][m]=f.dot([w[e]],[w[m]])/(d-1);m=f.jacobi(q);e=m[0];q=m[1];y=f.transpose(e);for(e=
0;e<q.length;e++)for(m=e;m<q.length;m++)q[e]<q[m]&&(n=q[e],q[e]=q[m],q[m]=n,t=y[e],y[e]=y[m],y[m]=t);w=f.transpose(w);for(e=0;e<b;e++)for(v[e]=[],m=0;m<w.length;m++)v[e][m]=f.dot([y[e]],[w[m]]);return[a,q,y,v]}});(function(a){for(var b=0;b<a.length;b++)(function(a){f.fn[a]=function(b,d){var e=this;return d?(setTimeout(function(){d.call(e,f.fn[a].call(e,b))},15),this):"number"==typeof f[a](this,b)?f[a](this,b):f(f[a](this,b))}})(a[b])})("add divide multiply subtract dot pow exp log abs norm angle".split(" "))})(this.jStat,
Math);
(function(f,e){var d=[].slice,b=f.utils.isNumber;f.extend({zscore:function(){var a=d.call(arguments);return b(a[1])?(a[0]-a[1])/a[2]:(a[0]-f.mean(a[1]))/f.stdev(a[1],a[2])},ztest:function(){var a=d.call(arguments);if(4===a.length){if(b(a[1])){var g=f.zscore(a[0],a[1],a[2]);return 1===a[3]?f.normal.cdf(-e.abs(g),0,1):2*f.normal.cdf(-e.abs(g),0,1)}g=a[0];return 1===a[2]?f.normal.cdf(-e.abs(g),0,1):2*f.normal.cdf(-e.abs(g),0,1)}g=f.zscore(a[0],a[1],a[3]);return 1===a[1]?f.normal.cdf(-e.abs(g),0,1):2*
f.normal.cdf(-e.abs(g),0,1)}});f.extend(f.fn,{zscore:function(a,b){return(a-this.mean())/this.stdev(b)},ztest:function(a,b,d){a=e.abs(this.zscore(a,d));return 1===b?f.normal.cdf(-a,0,1):2*f.normal.cdf(-a,0,1)}});f.extend({tscore:function(){var a=d.call(arguments);return 4===a.length?(a[0]-a[1])/(a[2]/e.sqrt(a[3])):(a[0]-f.mean(a[1]))/(f.stdev(a[1],!0)/e.sqrt(a[1].length))},ttest:function(){var a=d.call(arguments),g;return 5===a.length?(g=e.abs(f.tscore(a[0],a[1],a[2],a[3])),1===a[4]?f.studentt.cdf(-g,
a[3]-1):2*f.studentt.cdf(-g,a[3]-1)):b(a[1])?(g=e.abs(a[0]),1==a[2]?f.studentt.cdf(-g,a[1]-1):2*f.studentt.cdf(-g,a[1]-1)):(g=e.abs(f.tscore(a[0],a[1])),1==a[2]?f.studentt.cdf(-g,a[1].length-1):2*f.studentt.cdf(-g,a[1].length-1))}});f.extend(f.fn,{tscore:function(a){return(a-this.mean())/(this.stdev(!0)/e.sqrt(this.cols()))},ttest:function(a,b){return 1===b?1-f.studentt.cdf(e.abs(this.tscore(a)),this.cols()-1):2*f.studentt.cdf(-e.abs(this.tscore(a)),this.cols()-1)}});f.extend({anovafscore:function(){var a=
d.call(arguments),b,k,l,m,n,p;if(1===a.length){b=Array(a[0].length);for(n=0;n<a[0].length;n++)b[n]=a[0][n];a=b}if(2===a.length)return f.variance(a[0])/f.variance(a[1]);k=[];for(n=0;n<a.length;n++)k=k.concat(a[n]);l=f.mean(k);for(n=b=0;n<a.length;n++)b+=a[n].length*e.pow(f.mean(a[n])-l,2);b/=a.length-1;for(n=m=0;n<a.length;n++)for(l=f.mean(a[n]),p=0;p<a[n].length;p++)m+=e.pow(a[n][p]-l,2);return m/=k.length-a.length,b/m},anovaftest:function(){var a=d.call(arguments),e,k,l,m;if(b(a[0]))return 1-f.centralF.cdf(a[0],
a[1],a[2]);anovafscore=f.anovafscore(a);e=a.length-1;for(m=l=0;m<a.length;m++)l+=a[m].length;return k=l-e-1,1-f.centralF.cdf(anovafscore,e,k)},ftest:function(a,b,d){return 1-f.centralF.cdf(a,b,d)}});f.extend(f.fn,{anovafscore:function(){return f.anovafscore(this.toArray())},anovaftes:function(){var a=0,b;for(b=0;b<this.length;b++)a+=this[b].length;return f.ftest(this.anovafscore(),this.length-1,a-this.length)}});f.extend({normalci:function(){var a=d.call(arguments),b=Array(2),k;return 4===a.length?
k=e.abs(f.normal.inv(a[1]/2,0,1)*a[2]/e.sqrt(a[3])):k=e.abs(f.normal.inv(a[1]/2,0,1)*f.stdev(a[2])/e.sqrt(a[2].length)),b[0]=a[0]-k,b[1]=a[0]+k,b},tci:function(){var a=d.call(arguments),b=Array(2),k;return 4===a.length?k=e.abs(f.studentt.inv(a[1]/2,a[3]-1)*a[2]/e.sqrt(a[3])):k=e.abs(f.studentt.inv(a[1]/2,a[2].length-1)*f.stdev(a[2],!0)/e.sqrt(a[2].length)),b[0]=a[0]-k,b[1]=a[0]+k,b},significant:function(a,b){return a<b}});f.extend(f.fn,{normalci:function(a,b){return f.normalci(a,b,this.toArray())},
tci:function(a,b){return f.tci(a,b,this.toArray())}})})(this.jStat,Math);var utils=utils||{};
(function(f){f.htmlNamespaceUri="http://www.w3.org/1999/xhtml";f.svgNamespaceUri="http://www.w3.org/2000/svg";f.xlinkUri="http://www.w3.org/1999/xlink";f.hasOwnProperty=function(e,d){var b=e.__proto__||e.constructor.prototype;return d in e&&(!(d in b)||b[d]!==e[d])};f.shuffleArray=function(e){for(var d=e.length,b,a;0!==d;)a=Math.floor(Math.random()*d),--d,b=e[d],e[d]=e[a],e[a]=b;return e};f.isObjInArray=function(e,d){var b=!1;0<=e.indexOf(d)&&(b=!0);return b};f.removeA=function(e){for(var d,b=arguments,
a=b.length,g;1<a&&e.length;)for(d=b[--a];-1!==(g=e.indexOf(d));)e.splice(g,1);return e};f.getKeys=function(e){var d=[],b;for(b in e)d.push(b);return d};f.eliminateDuplicates=function(e){for(var d=[],b=0;b<e.length;b++){var a=e[b];f.isObjInArray(d,a)||d.push(a)}return d};f.keepReplicates=function(e,d,b){for(var a={},g=0;g<e.length;g++){var f=e[g];f in a||(a[f]=0);a[f]++}d=null==d?2:d;e=[];for(f in a)null!=b&&b?a[f]<d&&e.push(f):a[f]>=d&&e.push(f);return e};f.beginsWith=function(e,d){return 0===e.indexOf(d)};
f.endsWith=function(e,d){return-1!==e.indexOf(d,e.length-d.length)};f.lengthOfLongestString=function(e){var d=[],b;for(b in e)d.push(e[b].length);return Math.max.apply(null,d)};f.isNumerical=function(e){return null==e||""===e||isNaN(e)?!1:!0};f.getListBoxSelectedValues=function(e){for(var d=[],b=0;b<e.length;b++){var a=e[b];a.selected&&d.push(a.value)}return d};f.linearInterpolation=function(e,d,b){return(b-d)*e+d};f.rangeLimit=function(e,d,b){"undefined"===typeof d&&(d=-1);"undefined"===typeof b&&
(b=1);return e<d?d:e>b?b:e};f.extractFromJq=function(e){return e.get(0)};f.convertToJq=function(e){$(e);return e};f.extractFromD3=function(e){return e.node()};f.convertToD3=function(e){return d3.select(e)};f.sort_by=function(e,d,b){var a=b?function(a){return b(a[e])}:function(a){return a[e]};d=[-1,1][+!!d];return function(b,e){return b=a(b),e=a(e),d*((b>e)-(e>b))}};f.compareAsNumeric=function(e,d){var b=parseFloat(e),a=parseFloat(d);if(utils.isNumerical(b)&&utils.isNumerical(a)){if(b<a)return-1;if(b>
a)return 1}else if(b==b||a==a){if(b!=b)return-1;if(a!=a)return 1}return 0};f.compareAsString=function(e,d){var b=new String(e),a=new String(d);return"null"==b&&"null"!=a?1:"null"!=b&&"null"==a?-1:b.localeCompare(a)};f.compareAsDate=function(e,d){var b=e,a=d;null==b?b="1000":""==b&&(b="1001");null==a?a="1000":""==a&&(a="1001");return new Date(b)-new Date(a)};f.rgbComponentToHex=function(e){e=e.toString(16);return 1==e.length?"0"+e:e};f.rgbToHex=function(e,d,b){return"#"+this.rgbComponentToHex(e)+this.rgbComponentToHex(d)+
this.rgbComponentToHex(b)};f.centeredRgbaColorMapper=function(e,d,b,a){var g=null,f=null==d?0:d,l=null==b?-1.96:b,m=null==a?1.96:a;return g=function(a){var b=1,d=169,g=169,v=169;a=parseFloat(a);null!=a&&a==a&&(a>f?(d=255,v=g=0,a>m?b=1:(b=(a-f)/(m-f),b=Math.abs(b),e&&(b=Math.log(b)))):a<f?(g=d=0,v=255,a<l?b=1:(b=(a-f)/(l-f),b=Math.abs(b),e&&(b=Math.log(b)))):(v=g=d=255,b=1));return"rgba("+d+","+g+","+v+","+b+")"}};f.setupQuantileColorMapper=function(e,d){var b=d;null==b&&(b="rgb(255,255,217) rgb(237,248,177) rgb(199,233,180) rgb(127,205,187) rgb(65,182,196) rgb(29,145,192) rgb(34,94,168) rgb(37,52,148) rgb(8,29,88)".split(" "));
var a=b.length;return d3.scale.quantile().domain([0,a-1,d3.max(e,function(a){return parseFloat(a)})]).range(b)};f.getXmlDom_url=function(e){xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");xmlhttp.open("GET",e,!1);xmlhttp.send();return xmlDoc=xmlhttp.responseXML};f.getXmlDom_string=function(e){window.DOMParser?(parser=new DOMParser,xmlDoc=parser.parseFromString(e,"text/xml")):(xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.async=!1,xmlDoc.loadXML(e));return xmlDoc};
f.getDateTime=function(){var e=new Date,d=e.getFullYear(),b=e.getMonth()+1,a=e.getDate(),g=e.getHours(),f=e.getMinutes(),e=e.getSeconds();1==b.toString().length&&(b="0"+b);1==a.toString().length&&(a="0"+a);1==g.toString().length&&(g="0"+g);1==f.toString().length&&(f="0"+f);1==e.toString().length&&(e="0"+e);return d+"/"+b+"/"+a+" "+g+":"+f+":"+e};f.todaysDate=function(){var e=new Date,d=e.getDate();e.getDay();var b=e.getMonth()+1,e=e.getYear();return[,"January","February","March","April","May","June",
"July","August","September","October","November","December"][b]+" "+d+", "+(1E3>e?e+1900:e)};f.pushElemToBack=function(e){var d=e.parentNode;d.insertBefore(e,d.firstChild);return e};f.pullElemToFront=function(e){e.parentNode.appendChild(e);return e};f.removeElemById=function(e){e=document.getElementById(e);e.parentNode.removeChild(e)};f.removeChildElems=function(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e};f.createDivElement=function(e,d){var b=document.createElement("div");null!=e&&
(b.id=e);null!=d&&(b.className=d);return b};f.setElemAttributes=function(e,d,b){b="undefined"===typeof b?null:b;if(null!=d)for(var a in d)e.setAttributeNS(b,a,d[a]);return e};f.swapContainingDivs=function(e,d){var b=d.parentNode;document.getElementById(e.parentNode.id).appendChild(d);document.getElementById(b.id).appendChild(e)};f.simpleAsyncGet=function(e,d){var b=new XMLHttpRequest,b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");b.onreadystatechange=function(){this.readyState===
(this.DONE||4)&&(200==this.status?d(this.responseText):400==this.status?console.log("There was an error 400"):console.log("status was not 200",this.status))};b.open("GET",e,!0);b.setRequestHeader("X-Requested-With","XMLHttpRequest");b.send(null)};f.getResponse=function(e){var d=null,b=null,b=new XMLHttpRequest;b.open("GET",e,!1);b.onload=function(){d=b.status;200!=d&&console.log("xhr status: "+d+" for "+e)};b.send(null);var a=null;200==d&&(a=b.responseText);return a};f.loadNewSettings=function(e){e=
window.location.pathname+"?query="+JSON.stringify(e);window.open(e,"_self")};f.getQueryObj=function(){var e={};location.search.slice(1).split("&").forEach(function(d){d=d.split("=");e[d[0]]=decodeURIComponent(d[1])||""});return e};f.getQueryStringParameterByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");e=(new RegExp("[\\?&]"+e+"=([^&#]*)")).exec(location.search);return null==e?"":decodeURIComponent(e[1].replace(/\+/g," "))};f.parseJson=function(e){return JSON.parse(e)};f.serializeJson=
function(e,d){return d?JSON.stringify(e,null,"\t"):JSON.stringify(e)};f.prettyJson=function(e){return this.serializeJson(e,!0)};f.bottomRoundedRectSvgPath=function(e,d,b,a,f){e=""+("M"+e+","+d)+("h"+b);e+="v"+(a-f);e+="a"+f+","+f+" 0 0 1 "+-1*f+","+f;e+="h"+-1*(b-2*f);e+="a"+f+","+f+" 0 0 1 "+-1*f+","+-1*f;e+="v"+-1*(a-f);return e+="z"};f.allRoundedRectSvgPath=function(e,d,b,a,f){e=""+("M"+e+","+(d+f))+("a"+f+","+f+" 0 0 1 "+f+","+-1*f);e+="h"+(b-2*f);e+="a"+f+","+f+" 0 0 1 "+f+","+f;e+="v"+(a-2*
f);e+="a"+f+","+f+" 0 0 1 "+-1*f+","+f;e+="h"+-1*(b-2*f);e+="a"+f+","+f+" 0 0 1 "+-1*f+","+-1*f;e+="v"+-1*(a-2*f);return e+="z"};f.allAngledRectSvgPath=function(e,d,b,a){var f=b>a?b/8:a/8;e=""+("M"+(e+f)+","+d)+("h"+(b-2*f));e+="l"+f+","+f;e+="v"+(a-2*f);e+="l"+-1*f+","+f;e+="h"+-1*(b-2*f);e+="l"+-1*f+","+-1*f;e+="v"+-1*(a-2*f);return e+="z"};f.createSvgRingElement=function(e,d,b,a){function f(a,b,d,e){e=(e-90)*Math.PI/180;return{x:a+d*Math.cos(e),y:b+d*Math.sin(e)}}e=function(a,b,d,e,k){var t=f(a,
b,d,k);a=f(a,b,d,e);return["M",t.x,t.y,"A",d,d,0,180>=k-e?"0":"1",0,a.x,a.y].join(" ")}(e,d,b,0,359.9);d=document.createElementNS(this.svgNamespaceUri,"path");d.setAttributeNS(null,"d",e);if(null!=a)for(var k in a)d.setAttributeNS(null,k,a[k]);return d};f.createSvgCircleElement=function(e,d,b,a){var f=document.createElementNS(this.svgNamespaceUri,"circle");f.setAttributeNS(null,"cx",e);f.setAttributeNS(null,"cy",d);f.setAttributeNS(null,"r",b);if(null!=a)for(var k in a)f.setAttributeNS(null,k,a[k]);
return f};f.createSvgRectElement=function(e,d,b,a,f,k,l){var m=document.createElementNS(this.svgNamespaceUri,"rect");m.setAttributeNS(null,"x",e);m.setAttributeNS(null,"y",d);m.setAttributeNS(null,"rx",b);m.setAttributeNS(null,"ry",a);m.setAttributeNS(null,"width",f);m.setAttributeNS(null,"height",k);if(null!=l)for(var n in l)m.setAttributeNS(null,n,l[n]);return m};f.createSVGPolygonElement=function(e){var d=document.createElementNS(this.svgNamespaceUri,"polygon");if(null!=e)for(var b in e)d.setAttributeNS(null,
b,e[b]);return d};f.createSvgImageElement=function(e,d,b,a,f,k){var l=document.createElementNS(this.svgNamespaceUri,"image");l.setAttributeNS(this.xlinkUri,"href",e);l.setAttributeNS(null,"x",d);l.setAttributeNS(null,"y",b);l.setAttributeNS(null,"width",a);l.setAttributeNS(null,"height",f);if(null!=k)for(var m in k)l.setAttributeNS(null,m,k[m]);return l};f.setCookie=function(e,d,b){if(b){var a=new Date;a.setTime(a.getTime()+864E5*b);b="; expires="+a.toGMTString()}else b="";document.cookie=e+"="+d+
b+"; path=/"};f.getCookie=function(e){e+="=";for(var d=document.cookie.split(";"),b=0;b<d.length;b++){for(var a=d[b];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return null};f.deleteCookie=function(e){this.setCookie(e,"",-1)};f.getNormalizedVector=function(e){var d=[],b=jStat.min(e),a=jStat.max(e);if(0>b||0==a){console.log("min:"+b+"\tmax:"+a);if(0>b)return null;if(0==a)return e}for(b=0;b<e.length;b++)d.push(e[b]/a);return d};f.computeMarginalEntropy=
function(e,d){for(var b=0,a=[],f=d(e),k=0;k<f.length;k++)a.push({bin:k,count:f[k].length});for(k=0;k<a.length;k++)f=a[k],f.probability=f.count/e.length,f.prod=0==f.probability?0:f.probability*Math.log2(f.probability),b+=f.prod;return-1*b};f.computeJointEntropy=function(e,d,b){if(e.length!=d.length)return null;var a=function(a,b){for(var d=null,e=0;e<a.length;e++){var f=a[e];b>=f.x&&b<f.x+f.dx&&(d=e)}null==d&&(f=a[a.length-1],b-f.x-f.dx<f.dx&&(d=a.length-1));return d},g=b(e),k=b(d);b={};for(var l=
0;l<g.length;l++)for(var m=0;m<k.length;m++){var n=l+"_"+m;b[n]=0}for(l=0;l<e.length;l++)n=a(g,e[l]),m=a(k,d[l]),n=n+"_"+m,b[n]++;d=0;a=f.getKeys(b);for(l=0;l<a.length;l++)n=a[l],g=b[n]/e.length,g=0==g?0:g*Math.log2(g),d+=g;return-1*d};f.mutualInformation=function(e,d,b){b="undefined"===typeof b?e.length:b;var a=d3.layout.histogram().bins(b).frequency(!1);b=f.computeMarginalEntropy(e,a);var g=f.computeMarginalEntropy(d,a);e=f.computeJointEntropy(e,d,a);return b+g-e}})(utils);var eventData=eventData||{};
(function(f){f.getEventElems=function(e,d){var b=[];e.find("event").each(function(a,e){var f=e.getAttribute("type");void 0===d||null===d?b.push(e):f===d&&b.push(e)});return b};f.getEventParentChildren=function(e,d){var b={parent:null,children:[]},a=f.getEventElems(e,d);$(a).each(function(a,d){if("event"!==d.tagName)return"continue";b.parent=d.parentNode.getAttribute("type");$(d.children).each(function(a,d){"event"===d.tagName&&b.children.push(d.getAttribute("type"))})});return b};f.tracebackToRoot=
function(e,d){for(var b=[],a=f.getEventElems(e,d),g=0;g<a.length;g++){var k=a[g],l=[];b.push(l);k=k.getAttribute("type");for(k=f.getEventParentChildren(e,k).parent;void 0!==k&&null!==k;)l.push(k),k=f.getEventParentChildren(e,k).parent}return b};f.OD_eventAlbum=function(){this.album={};this.datatypeSuffixMapping={};this.pivot={};this.getSuffixedEventId=function(e,d){return e+(d in this.datatypeSuffixMapping?this.datatypeSuffixMapping[d]:"")};this.addEvent=function(e,d){var b=new f.OD_event(e);this.album[e.id]=
b;"datatype"in e&&"geneSuffix"in e&&(this.datatypeSuffixMapping[e.datatype]=e.geneSuffix);b.data.setData(d,"numeric"==e.allowedValues||"expression"==e.allowedValues);return b};this.deleteEvent=function(e){delete this.album[e]};this.getAllEventIds=function(){var e=[],d=this.getEventIdsByType(),b;for(b in d)e=e.concat(d[b]);return e};this.getEventIdsByType=function(){for(var e={},d=utils.getKeys(this.album),b=0;b<d.length;b++){var a=d[b],f=this.getEvent(a).metadata.datatype;utils.hasOwnProperty(e,f)||
(e[f]=[]);e[f].push(a)}return e};this.getEventData=function(e){for(var d={},b=utils.getKeys(this.album),a=0;a<b.length;a++){var f=b[a],k=this.getEvent(f).data.getData(e);d[f]=k}return d};this.getAllDataAsList=function(){for(var e=[],d=this.getEventData(),b=utils.getKeys(d),a=0;a<b.length;a++){for(var f=b[a],k=d[f].slice(),l=0;l<k.length;l++)k[l].eventId=f;e=e.concat(k)}return e};this.getAllSampleIds=function(){for(var e=[],d=utils.getKeys(this.album),b=0;b<d.length;b++)var a=this.getEvent(d[b]).data.getAllSampleIds(),
e=e.concat(a);return utils.eliminateDuplicates(e)};this.selectSamples=function(e){var d=this.getAllSampleIds();if(0==e.length)return d;for(var b in e)var a=e[b].value,d=this.getEvent(e[b].eventId).data.selectIds(a,d);return d};this.getEvent=function(e){return this.album[e]};this.getAllChildren=function(e,d){for(var b="undefined"===typeof d?[]:d,a=[],f=0;f<e.length;f++)var k=this.getEvent(e[f]).metadata,a=a.concat(getKeys(k.children));if(0==a.length)return b;b=b.concat(a);return this.getAllChildren(a,
b)};this.setPivotScores_dict=function(e,d){this.pivot=null==d?{}:{event:e,scores:d};return this};this.setPivotScores_array=function(e,d){null==d?this.pivot={}:(d=d.sort(utils.sort_by("score")),this.pivot={event:e,scores:d});return this};this.getPivotSortedEvents=function(e){if("undefined"===typeof this.pivot.scores||null==this.pivot.scores)return console.log("getPivotSortedEvents found no pivot scores"),[];for(var d=[],b={},a=0,f=this.pivot.scores.length;a<f;a++){var k=this.pivot.scores[a],l=k.eventId1,
m=k.eventId2,k=k.score;if(l===e)l=m;else if(m!==e)continue;utils.hasOwnProperty(b,l)||(d.push({key:l,val:parseFloat(k)}),b[l]=1)}return d=d.sort(utils.sort_by("val"))};this.getGroupedPivotSorts=function(e,d){console.log("getGroupedPivotSorts");for(var b=["expression data","expression signature"],a={},b=this.getPivotSortedEvents(e),f=[],k=0;k<b.length;k++)f.push(b[k].key);var k=this.getEventIdsByType(),b=utils.getKeys(k),b=utils.removeA(b,"clinical data"),l;for(l in k){var m=[],n=k[l];if(0==f.length)console.log("pivotSortedEvents.length == 0 for "+
l),a[l]=n;else{for(var p=0;p<f.length;p++){var q=this.getSuffixedEventId(f[p],l);utils.isObjInArray(n,q)&&m.push(q)}utils.isObjInArray(b,l)||(m=m.concat(n),m=utils.eliminateDuplicates(m));a[l]=m}}return a};this.getAllPivotScores=function(e,d){var b={},a=this.getEventIdsByType();if(!utils.hasOwnProperty(a,e))return b;for(var a=a[e],f=0;f<a.length;f++){var k=a[f],l=this.pivotSort(k,d);b[k]=l}return b};this.pivotSort_2=function(e,d){for(var b=this.pivotSort(e,jStat.corrcoeff),a={},f=0;f<b.length;f++){var k=
b[f],l=k.event;a[l]=0>k.score?-1:1}for(var b=this.pivotSort(e,d),m=[],n=[],f=0;f<b.length;f++)k=b[f],l=k.event,0>a[l]?n.push(k):m.push(k);m.sort(utils.sort_by("score"));n.sort(utils.sort_by("score"),!0);return m.concat(n)};this.pivotSort=function(e,d){console.log("eventAlbum.pivotSort:",e);"undefined"===typeof d&&(console.log("using default scoringAlgorithm, jStat.corrcoeff"),d=jStat.corrcoeff);var b=this.getEvent(e);if(null==b)return console.log("eventObj not found for",e),null;for(var a=b.data.getAllSampleIds(),
f=b.data.getNullSamples(),a=utils.keepReplicates(a.concat(f),2,!0),f=this.getEventIdsByType()[b.metadata.datatype],k=[],l=0;l<f.length;l++){var m=f[l],n=this.getEvent(m),p=n.data.getAllSampleIds(),q=n.data.getNullSamples(),p=utils.keepReplicates(p.concat(q),2,!0),p=utils.keepReplicates(p.concat(a)),q=b.data.getData(p),n=n.data.getData(p);if(0<n.length){var t=[],v=[],w=null;null==w&&(w=utils.hasOwnProperty(q[0],"val_orig")?"val_orig":"val");for(var y=null,K=0;K<p.length;K++)null==y&&(y=utils.hasOwnProperty(n[K],
"val_orig")?"val_orig":"val"),t.push(q[K][w]),v.push(n[K][y]);p=d(t,v);k.push({event:m,score:p})}else console.log("eventData2 is empty")}k.sort(utils.sort_by("score"));return k};this.multisortEvents=function(e,d){console.log("multisortEvents");console.log("rowSortSteps",e);console.log("colSortSteps",d);var b=this.getEventIdsByType(),a=[],f;for(f in b)var k=b[f],a=a.concat(k);k=[];if(null!=d){for(var l=d.getSteps(),m=0;m<l.length;m++){f=l[m];var n=f.name;k.push(n)}k.reverse()}var p=k.slice(0);for(f=
0;f<a.length;f++)n=a[f],utils.isObjInArray(p,n)||p.push(n);if(null!=e)for(l=e.getSteps().reverse(),m=0;m<l.length;m++){f=l[m];n=f.name;a=f.reverse;n=this.getEvent(n);f=n.metadata.datatype;var q=n.metadata.scoredDatatype;if(null==q)console.log("no scored datatype to sort");else if(n=n.metadata.sortSignatureVector(),a&&n.reverse(),utils.hasOwnProperty(b,q)){a=b[q].slice(0);p=[];l=[];for(m=0;m<n.length;m++){var t=this.getSuffixedEventId(n[m],q),v=a.indexOf(t);0<=v&&l.push(t);0<=v&&!utils.isObjInArray(k,
t)&&(p.push(t),delete a[v]);utils.isObjInArray(k,t)&&delete a[v]}console.log("scoredEventSigWeightOverlap",l.length,l);for(var w in a)p.push(a[w]);a=k.slice(0);for(f in b)if(f===q)a=a.concat(p);else{var k=b[f],y;for(y in k)n=k[y],utils.isObjInArray(a,n)||a.push(n)}p=a;console.log("rowNames.length",p.length,p);break}else console.log(q+" group has no events")}return p};this.multisortSamples=function(e){var d=this.getAllSampleIds();if(null==e)return d;var b=e.getSteps().slice();b.reverse();var a=this;
d.sort(function(d,e){for(var f=0,m=0;m<b.length;m++){var n=b[m].name,p=b[m].reverse,q=a.getEvent(n);if(void 0==q||null==q){for(var t in a.datatypeSuffixMapping){var v=n+a.datatypeSuffixMapping[t],q=a.getEvent(v);if(void 0!=q&&null!=q){n=v;break}}if(void 0==q||null==q){console.log("no event found for sorting: "+n);continue}}f=q.metadata.allowedValues;n=q.data.getData([d,e]);q=n[0].val;v=n[1].val;n=null;n="numeric"==f?utils.compareAsNumeric:"categoric"==f?utils.compareAsString:"expression"==f?utils.compareAsNumeric:
"date"==f?utils.compareAsDate:utils.compareAsString;f=n(q,v);n==utils.compareAsNumeric&&(f*=-1);p&&(f*=-1);if(0!=f)break}return f});return d};this.zScoreExpressionRescaling=function(){console.log("zScoreExpressionRescaling");var e=this.getEventIdsByType();if(!utils.hasOwnProperty(e,"expression data"))return console.log("no expression"),null;for(var e=e["expression data"],d={},b={stats:d},a=[],f=0;f<e.length;f++){var k=e[f],l=this.getEvent(k).data.getStats();d[k]={};d[k]=l;for(var l=this.getEvent(k).data.getData(),
m=0;m<l.length;m++){var n=l[m];utils.hasOwnProperty(n,"val_orig")&&(n.val=n.val_orig);var p=n.val;n.val_orig=p;utils.isNumerical(p)&&(n.val=(p-d[k].mean)/d[k].sd,a.push(n.val))}}b.maxVal=jStat.max(a);b.minVal=jStat.min(a);return b};this.betweenMeansExpressionRescaling=function(e,d,b){console.log("betweenMeansExpressionRescaling",e,d,b);d=this.getEvent(e).data.selectIds(d);var a=null;null==b?(a=this.getEvent(e).data.selectIds(b),a=a.concat(d),a=utils.eliminateDuplicates(a)):a=this.getEvent(e).data.selectIds(b);
e=this.getEventIdsByType();if(!utils.hasOwnProperty(e,"expression data"))return console.log("no expression"),null;e=e["expression data"];b={};for(var f={meanVals:b},k=[],l=0;l<e.length;l++){var m=e[l];b[m]={};b[m].group1=this.getEvent(m).data.getStats(d).mean;b[m].group2=this.getEvent(m).data.getStats(a).mean;for(var n=(b[m].group2-b[m].group1)/2,m=this.getEvent(m).data.getData(),p=0;p<m.length;p++){var q=m[p];utils.hasOwnProperty(q,"val_orig")&&(q.val=q.val_orig);var t=q.val;q.val_orig=t;utils.isNumerical(t)&&
(q.val=t-n,k.push(q.val))}}f.maxVal=jStat.max(k);f.minVal=jStat.min(k);return f};this.yuliaExpressionRescaling=function(e,d){console.log("yuliaExpressionRescaling",e,d);var b=this.getEvent(e).data.selectIds(d),a=this.getEventIdsByType();if(!utils.hasOwnProperty(a,"expression data"))return console.log("no expression"),null;for(var a=a["expression data"],f={},k={meanVals:f},l=[],m=0;m<a.length;m++){var n=a[m];f[n]=this.getEvent(n).data.getStats(b).mean;for(var p=this.getEvent(n).data.getData(),q=0;q<
p.length;q++){var t=p[q];utils.hasOwnProperty(t,"val_orig")&&(t.val=t.val_orig);var v=t.val;t.val_orig=v;utils.isNumerical(v)&&(t.val=v-f[n],l.push(t.val))}}k.maxVal=jStat.max(l);k.minVal=jStat.min(l);return k};this.eventwiseMedianRescaling=function(){console.log("eventwiseMedianRescaling");var e=this.getEventIdsByType();if(!utils.hasOwnProperty(e,"expression data"))return console.log("no expression"),null;for(var e=e["expression data"],d={},b={stats:d},a=[],f=0;f<e.length;f++){var k=e[f],l=this.getEvent(k).data.getStats();
d[k]={};d[k]=l;for(var l=this.getEvent(k).data.getData(),m=0;m<l.length;m++){var n=l[m];utils.hasOwnProperty(n,"val_orig")&&(n.val=n.val_orig);var p=n.val;n.val_orig=p;utils.isNumerical(p)&&(n.val=p-d[k].median,a.push(n.val))}}b.maxVal=jStat.max(a);b.minVal=jStat.min(a);return b};this.samplewiseMedianRescaling=function(){console.log("samplewiseMedianRescaling");var e=this.getEventIdsByType();if(!utils.hasOwnProperty(e,"expression data"))return console.log("no expression"),null;for(var e=e["expression data"],
d={},b={stats:d},a=[],f=this.getAllSampleIds(),k=0;k<f.length;k++){var l=f[k];d[l]={};for(var m=this.getEventData([l]),n=[],p=0;p<e.length;p++){var q=e[p];if(utils.hasOwnProperty(m,q)){if(q=m[q][0],q.id===l){utils.hasOwnProperty(q,"val_orig")&&(q.val=q.val_orig);var t=q.val;q.val_orig=t;utils.isNumerical(t)&&n.push(t)}}else console.log(q+" was not found for "+l)}n=jStat.median(n);d[l]["samplewise median"]=n;if(isNaN(n))console.log("sample median for "+l+" is NaN.");else for(p=0;p<e.length;p++)q=e[p],
utils.hasOwnProperty(m,q)?(q=m[q][0],q.id===l&&(utils.hasOwnProperty(q,"val_orig")&&(q.val=q.val_orig),t=q.val,q.val_orig=t,utils.isNumerical(t)&&(q.val=t-d[l]["samplewise median"],a.push(t)))):console.log(q+" was not found for "+l)}b.maxVal=jStat.max(a);b.minVal=jStat.min(a);return b};this.bivariateNormalization=function(){};this.fillInMissingSamples=function(e){for(var d=this.getAllSampleIds(),b=this.getEventIdsByType(),a=0,f=utils.getKeys(b).length;a<f;a++)for(var k=utils.getKeys(b)[a],l=0;l<b[k].length;l++){var m=
b[k][l],n=this.getEvent(m).data.getAllSampleIds();if(0!=d.length-n.length){for(var n=utils.keepReplicates(d.concat(n),2,!0),p={},q=0;q<n.length;q++)p[n[q]]=e;this.getEvent(m).data.setData(p)}}return this};this.fillInDatatypeLabelEvents=function(e){for(var d=this.getEventIdsByType(),d=utils.getKeys(d),b=0,a=d.length;b<a;b++){var f=d[b];"datatype label"!==f&&(this.addEvent({id:f+"(+)",name:f+"(+)",displayName:f+"(+)",description:null,datatype:"datatype label",allowedValues:null},{}),this.addEvent({id:f+
"(-)",name:f+"(-)",displayName:f+"(-)",description:null,datatype:"datatype label",allowedValues:null},{}))}this.fillInMissingSamples(e)}};f.OD_event=function(e){this.metadata=new f.OD_eventMetadata(e);this.data=new f.OD_eventDataCollection};f.OD_eventMetadata=function(e){this.id=e.id;this.name=e.name;this.displayName=e.displayName;this.description=e.description;this.datatype=e.datatype;this.allowedValues=e.allowedValues;this.minAllowedVal=e.minAllowedVal;this.maxAllowedVal=e.maxAllowedVal;this.weightedGeneVector=
[];this.setScoreRange=function(d,b){this.minAllowedVal=d;this.maxAllowedVal=b};this.setWeightVector=function(d,b){this.weightedGeneVector=d;this.scoredDatatype=b;return this};this.sortSignatureVector=function(d){var b=this.weightedGeneVector.slice(0);b.sort(function(a,b){return utils.compareAsNumeric(a.weight,b.weight)});for(var a=[],e=0;e<b.length;e++)a.push(b[e].gene);d||a.reverse();return a}};f.OD_eventDataCollection=function(){function e(d,b){this.id=d;this.val=b}this.dataCollection=[];this.getPercentNullData=
function(){var d=this.getValueCounts(),b=0;null in d&&(b=this.getAllSampleIds().length,b=d[null]/b);return b};this.getValueCounts=function(d){var b={};d=this.getData(d);for(var a=0;a<d.length;a++){var e=d[a].val;utils.hasOwnProperty(b,e)||(b[e]=0);b[e]+=1}return b};this.getValues=function(d){var b=this.getValueCounts(),b=utils.getKeys(b);null!=d&&1==d&&(b=utils.eliminateDuplicates(b));return b};this.setData=function(d,b){for(var a in d){var f=d[a];"NaN"!=f&&"null"!=f&&""!=f&&"N/A"!=f&&(null!=b&&1==
b&&(f=parseFloat(f)),this.dataCollection.push(new e(a,f)))}return this};this.getData=function(d){var b=this.getAllSampleIds(!0);null==d&&(d=utils.getKeys(b));for(var a=[],f=0;f<d.length;f++){var k=d[f];k in b?a.push(this.dataCollection[b[k]]):a.push(new e(k,null))}return a};this.getAllSampleIds=function(d){for(var b={},a=0;a<this.dataCollection.length;a++)b[this.dataCollection[a].id]=a;return d?b:utils.getKeys(b)};this.getNullSamples=function(d){var b=[];d=this.getData(d);for(var a=0;a<d.length;a++){var e=
d[a];null==e.val&&b.push(e.id)}return b};this.sortSamples=function(d,b){var a=this.getData(d),e=compareSamplesAsStrings;b=null==b?"categoric":b.toLowerCase();"numeric"==b||"expression"==b?e=compareSamplesAsNumeric:"date"==b&&(e=compareSamplesAsDate);a.sort(e);for(var e=[],f=0;f<a.length;f++)e.push(a[f].id);return e};this.selectIds=function(d,b){for(var a=[],e=null==b?this.getData():this.getData(b),f=0;f<e.length;f++){var l=e[f];l.val==d&&a.push(l.id)}return a};this.getStats=function(d,b){"undefined"===
typeof b&&(b=3);var a={min:0,max:0,mean:0,median:0,sd:0,meddev:0,meandev:0,percentNullData:0};a.percentNullData=this.getPercentNullData();var e=this.getAllSampleIds(!0);null==d&&(d=utils.getKeys(e));for(var f=[],l=0;l<d.length;l++){var m=d[l];if(m in e){var m=this.dataCollection[e[m]],n=null,n=utils.hasOwnProperty(m,"val_orig")?m.val_orig:m.val;utils.isNumerical(n)&&f.push(n)}}a.mean=jStat.mean(f).toPrecision(b);a.sd=jStat.stdev(f).toPrecision(b);a.median=jStat.median(f).toPrecision(b);a.meddev=jStat.meddev(f).toPrecision(b);
a.meandev=jStat.meandev(f).toPrecision(b);a.min=jStat.min(f).toPrecision(b);a.max=jStat.max(f).toPrecision(b);a.percentNullData=a.percentNullData.toPrecision(b);return a}};f.sortingSteps=function(e){this.steps=[];null!=e&&(this.steps=e);this.getSteps=function(){return this.steps};this.getIndex=function(d){for(var b=0;b<this.steps.length;b++)if(this.steps[b].name==d)return b;return-1};this.addStep=function(d,b){var a=this.getIndex(d);0<=a?(a=this.steps.splice(a,1)[0],b||(a.reverse=!a.reverse),this.steps.push(a)):
this.steps.push({name:d,reverse:!1})};this.removeStep=function(d){d=this.getIndex(d);0<=d&&this.steps.splice(d,1)};this.clearSteps=function(){this.steps.splice(0,this.steps.length)}};f.sampleSelectionCriteria=function(){this.criteria=[];this.getCriteria=function(){return this.criteria};this.addCriteria=function(e,d){var b={eventId:e,value:d},a;for(a in this.criteria)if(JSON.stringify(this.criteria[a])==JSON.stringify(b))return;this.criteria.push(b)};this.removeCriteria=function(e,d){for(var b=0;b<
this.criteria.length;b++)if(this.criteria[b].eventId==e&&this.criteria[b].value==d){this.criteria.splice(b,1);break}};this.clearCriteria=function(){this.criteria.splice(0,this.criteria.length)}}})(eventData);var medbookDataLoader=medbookDataLoader||{};
(function(f){f.transposeClinicalData=function(e,d){for(var b={},a=0;a<e.length;a++){var f=e[a],k=f[d],l;for(l in f)l in b||(b[l]={}),b[l][k]=f[l]}return b};f.getClinicalData=function(e,d){for(var b=utils.getResponse(e).split("\n"),a=[],g=[],k=[],l=0;l<b.length;l++){var m=b[l];utils.beginsWith(m,"#")?g.push(m):utils.beginsWith(m,"STRING")?k=m.split("\t"):a.push(m)}b=d3.tsv.parse(a.join("\n"));a=this.transposeClinicalData(b,"SAMPLE_ID");delete a.SAMPLE_ID;g=utils.getKeys(a);for(l=0;l<g.length;l++){var m=
g[l],n=a[m],p=k[l+1],q="categoric";"number"==p.toLowerCase()?q="numeric":"date"==p.toLowerCase()&&(q="date");f.loadEventBySampleData(d,m,"","clinical data",q,n)}return b};f.getMutationData=function(e,d){for(var b=utils.getResponse(e),a=d3.tsv.parse(b),b={},f=0;f<a.length;f++){var k=a[f],l=k.Hugo_Symbol,k=k.Tumor_Sample_Barcode,k=k.replace(/_/g,"-"),k=k.replace(/[A-Z]$/,"");utils.hasOwnProperty(b,l)||(b[l]={},b[l].metadata={id:l+"_mut",name:null,displayName:null,description:null,datatype:"mutation data",
allowedValues:"categoric"},b[l].data={});b[l].data[k]=!0}a=utils.getKeys(b);for(f=0;f<a.length;f++)l=b[a[f]],d.addEvent(l.metadata,l.data);return b};f.getExpressionData=function(e,d){f.getGeneBySampleData(e,d,"_mRNA","expression data","numeric")};f.getViperData=function(e,d){f.getGeneBySampleData(e,d,"_viper","viper data","numeric")};f.getGeneBySampleData=function(e,d,b,a,g){e=utils.getResponse(e);e=d3.tsv.parse(e);for(var k in e){var l=e[k],m=l[""];delete l[""];f.loadEventBySampleData(d,m,b,a,g,
l)}};f.loadEventBySampleData=function(e,d,b,a,f,k){return e.addEvent({geneSuffix:b,id:d+b,name:a+" for "+d,displayName:d,description:null,datatype:a,allowedValues:f},k)};f.mongoClinicalData=function(e,d){for(var b=0;b<e.length;b++){var a=e[b],g=null;if(utils.hasOwnProperty(a,"sample"))g=a.sample;else if(hasOwnProperty(a,"Sample"))g=a.Sample;else if(hasOwnProperty(a,"Patient ID"))g=a["Patient ID"];else if(hasOwnProperty(a,"Patient ID "))g=a["Patient ID "];else{console.log("no sample ID found in clinical doc: "+
prettyJson(a));continue}g=g.trim();if("Patient ID"!==g&&"Patient ID "!==g)for(var k=utils.getKeys(a),l=0;l<k.length;l++){var m=k[l];if(!utils.isObjInArray(["_id","sample","Sample"],m)){var n=d.getEvent(m);null==n&&(n=f.loadEventBySampleData(d,m,"","clinical data","categoric",[]));var p={};p[g]=a[m];n.data.setData(p)}}}return n};f.mongoExpressionData=function(e,d){for(var b=0;b<e.length;b++){var a=e[b],g=null;if(utils.hasOwnProperty(a,"gene"))g=a.gene;else if(utils.hasOwnProperty(a,"id"))g=a.id;else{console.log("no gene identifier found in expression doc: "+
utils.prettyJson(a));continue}var g=g.trim(),k=g+"_mRNA";utils.getKeys(a);var l=a.samples,a={},m;for(m in l)a[m]=l[m].rsem_quan_log2;k=d.getEvent(k);null==k?f.loadEventBySampleData(d,g,"_mRNA","expression data","numeric",a):k.data.setData(a)}};f.mongoExpressionData_old=function(e,d){for(var b=0;b<e.length;b++){var a=e[b],g=null;if(utils.hasOwnProperty(a,"gene"))g=a.gene;else if(utils.hasOwnProperty(a,"id"))g=a.id;else{console.log("no gene identifier found in expression doc: "+utils.prettyJson(a));
continue}for(var g=g.trim(),k=g+"_mRNA",l=utils.getKeys(a),m=0;m<l.length;m++){var n=l[m];if(!utils.isObjInArray(["_id","gene","id"],n)){var p=d.getEvent(k);null==p&&(p=f.loadEventBySampleData(d,g,"_mRNA","expression data","numeric",[]));var q={};q[n]=parseFloat(a[n]);p.data.setData(q)}}}return p};f.getSignature=function(e,d){var b=utils.getResponse(e),b=d3.tsv.parse(b),a=e.split("/").pop(),f=d.getEvent(a);null==f&&(d.addEvent({id:a,name:null,displayName:null,description:null,datatype:"expression signature",
allowedValues:"numeric",weightedGeneVector:b},[]),f=d.getEvent(a));return f};f.loadSignatureObj=function(e,d){for(var b={},a=0;a<e.length;a++){var g=e[a],k=g.id,l=g.name,g=g.val;utils.hasOwnProperty(b,l)||(b[l]={});b[l][k]=g}k=utils.getKeys(b);for(a=0;a<k.length;a++){var l=k[a],g=b[l],m;m=l.split("_v");m.pop();m=m.join("_v");m=utils.endsWith(m,"_kinase_viper")?"kinase target activity":utils.endsWith(m,"_tf_viper")||utils.beginsWith(m,"tf_viper_")?"tf target activity":"expression signature";var n=
d.getEvent(l);null==n&&(n=f.loadEventBySampleData(d,l,"",m,"numeric",{}),n.metadata.setWeightVector([],"expression data"));n.data.setData(g)}};f.loadSignatureWeightsObj=function(e,d){var b=e.name+"_v"+e.version,a;a=utils.endsWith(e.name,"_kinase_viper")?"kinase target activity":utils.endsWith(e.name,"_tf_viper")||utils.beginsWith(e.name,"tf_viper_")?"tf target activity":"expression signature";for(var g=d.getEvent(b),k=[],l=e.signature,m=utils.getKeys(l),n=0;n<m.length;n++){var p=m[n];k.push({gene:p,
weight:l[p].weight})}null==g&&(g=f.loadEventBySampleData(d,b,"",a,"numeric",[]));g.metadata.setWeightVector(k,"expression data");return g};f.loadBmegSignatureWeightsAsSamples=function(e,d){var b=utils.getKeys(e.query.weights),a=e.features,g=[],k=[],l;for(l in a)g.push({gene:l,weight:a[l]}),k.push(l);var k=utils.eliminateDuplicates(k),m=e.signatures,a={},n={},p;for(p in m){l=m[p];n[p]=l.score;var q=l.weights;l=b.slice(0);l=l.concat(utils.getKeys(q));l=utils.eliminateDuplicates(l);for(var t=0,v=l.length;t<
v;t++){var w=l[t];if(utils.isObjInArray(b,w)||utils.isObjInArray(k,w)){var y=q[w];"undefined"!==typeof y&&(utils.hasOwnProperty(a,w)||(a[w]={}),a[w][p]=y)}}}console.log("num genes:"+utils.getKeys(a).length);f.loadEventBySampleData(d,"query_score","","signature query score","numeric",n).metadata.setWeightVector(g,"signature weight");l=utils.getKeys(a);for(b=0;b<l.length;b++)w=l[b],g=w+"_weight",k=d.getEvent(g),null==k?(k=f.loadEventBySampleData(d,w,"_weight","signature weight","numeric",a[w]),k.metadata.setScoreRange(-1,
1)):console.log("loadBmegSignatureWeightsAsSamples:","existing event for: "+g)};f.loadPivotScores=function(e,d){for(var b=[],a=0;a<e.length;a++){var f=e[a],k=f.name_1,l=function(a,b,d){var e;"signature"===b?e=a+"_v"+d:"expression"===b&&(e=a);return e},k=l(k,f.datatype_1,f.version_1),m=f.name_2,m=l(m,f.datatype_2,f.version_2);b.push({eventId1:k,eventId2:m,score:f.score})}d.setPivotScores_array(null,b)}})(medbookDataLoader);u=utils;var observation_deck=observation_deck||{};(function(f){})(observation_deck);buildObservationDeck=function(f,e){e=getConfiguration(e);e.containerDivId=f.id;drawMatrix(f,e);setupDialogBox("hugoSearch","HUGO symbol",e.geneQueryUrl);setupDialogBox("sigSearch","signature name",e.sigQueryUrl);setupContextMenus(e);return e};
getConfiguration=function(f){var e=utils.getCookie("od_config"),e=utils.parseJson(e)||{};f.querySettings=e;e=null;"pivot_event"in f&&null!=f.pivot_event&&(f.querySettings.pivot_event=f.pivot_event);"eventAlbum"in f?e=f.eventAlbum:(e=new eventData.OD_eventAlbum,f.eventAlbum=e);var d=medbookDataLoader;if("pivotScores"in f){var b=f.pivotScores;"object"in b&&d.loadPivotScores(b.object,e)}delete f.pivotScores;"dataUrl"in f&&(b=f.dataUrl,"clinicalUrl"in b&&d.getClinicalData(b.clinicalUrl,e),"expressionUrl"in
b&&d.getExpressionData(b.expressionUrl,e),"mutationUrl"in b&&d.getMutationData(b.mutationUrl,e));"mongoData"in f&&(b=f.mongoData,"clinical"in b&&d.mongoClinicalData(b.clinical,e),"expression"in b&&d.mongoExpressionData(b.expression,e));delete f.mongoData;if("signature"in f&&(b=f.signature,"expression"in b)){var a=b.expression;if("file"in a)for(var g=a.file,b=0;b<g.length;b++){var k=g[b];console.log(k);d.getSignature(k,e)}if("object"in a)for(a=a.object,b=0;b<a.length;b++)g=a[b],d.loadSignatureObj(g,
e)}delete f.signature;if("signature_index"in f&&(b=f.signature_index,"expression"in b&&(b=b.expression,"object"in b)))for(a=b.object,b=0;b<a.length;b++)g=a[b],d.loadSignatureWeightsObj(g,e);delete f.signature_index;"bmegSigServiceData"in f&&(console.log("bmegSigServiceData in config"),d.loadBmegSignatureWeightsAsSamples(f.bmegSigServiceData,e));delete f.bmegSigServiceData;"displayedSamples"in f||(f.displayedSamples=[]);var e=f.eventAlbum.getEventIdsByType(),l;for(l in e);if("deleteEvents"in f)for(l=
f.deleteEvents,b=0;b<l.length;b++)f.eventAlbum.deleteEvent(l[b]);return f};
getCookieEvents=function(){var f=[],e=utils.parseJson(utils.getCookie("od_config"));if("undefined"===typeof e||null==e||0==utils.getKeys(e).length)return[];utils.hasOwnProperty(e,"pivot_sort")&&f.push(e.pivot_sort.pivot_event);if(utils.hasOwnProperty(e,"colSort"))for(var d=e.colSort.steps,b=0;b<d.length;b++)f.push(d[b].name);utils.hasOwnProperty(e,"required events")&&(f=f.concat(e["required events"]));e=[];for(b=0;b<f.length;b++)d=f[b],utils.endsWith(d,"_mRNA")&&e.push(d.replace("_mRNA",""));return utils.eliminateDuplicates(e)};
createSuggestBoxDialog=function(f){var e=f.placeholderText,d=utils.createDivElement(f.title);d.style.display="none";var b=document.createElement("input");d.appendChild(b);utils.setElemAttributes(b,{type:"text",placeholder:e});e=document.createElement("button");d.appendChild(e);utils.setElemAttributes(e,{type:"button",style:"float: right"});e.innerHTML="select";e.onclick=function(){console.log("button clicked",b.value);$(d).dialog("close")};for(e=0;9>e;e++)d.appendChild(document.createElement("br"));
$(b).typeahead({hint:!0,highlight:!0,minLength:2},{name:"dataset",source:f.bloodhoundObj,limit:99});return d};
setupDialogBox=function(f,e,d){var b=document.getElementsByTagName("body")[0];f=createSuggestBoxDialog({title:f,placeholderText:e,bloodhoundObj:new Bloodhound({datumTokenizer:Bloodhound.tokenizers.whitespace,queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:d+"%VALUE",wildcard:"%VALUE",transform:function(a){console.log("response",a);a=a.items;for(var b=[],d=0,e=a.length;d<e;d++)b.push(a[d].id);return b}}})});b.appendChild(f)};
setupContextMenus=function(f){for(var e=[".typeLabel",".colLabel",".rowLabel",".mrna_exp",".categoric"],d=0;d<e.length;d++)$.contextMenu("destroy",e[d]);setupTypeLabelContextMenu(f);setupColLabelContextMenu(f);setupRowLabelContextMenu(f);setupCategoricCellContextMenu(f);setupExpressionCellContextMenu(f);setupSignatureCellContextMenu(f)};
resetConfig=function(f){var e="dataUrl eventAlbum mongoData containerDivId signature rowTitleCallback columnTitleCallback".split(" ");utils.deleteCookie("od_config");for(var d=utils.getKeys(f),b=0;b<d.length;b++){var a=d[b];utils.isObjInArray(e,a)||delete f[a]}console.log("remaining config",f)};setSession=function(f,e){if("undefined"!==typeof Session)return f&&Session.set(f,e),!0;console.log("no session object for setting");return!1};
getSession=function(f){var e=null;"undefined"!==typeof Session?f&&(e=Session.get(f)):console.log("no session object for getting");return e};resetSession=function(f){if("undefined"!==typeof Session){for(var e=0,d=f.length;e<d;e++)delete Session.keys[f[e]];return!0}console.log("no session object to reset");return!1};
setDatatypePaging=function(f,e,d){var b=getSession("subscriptionPaging");b||(b={});utils.hasOwnProperty(b,f)||(b[f]={head:0,tail:0});if(!e||!d)return b[f];var a;"down"===d?a=--b[f][e]:"up"===d?a=++b[f][e]:"0"===d&&(a=b[f][e]=0);0>a&&(b[f][e]=0);setSession("subscriptionPaging",b)};addSortStepToCookies=function(f,e,d,b){d=d||"colSort";b=b||!1;var a=e.querySettings;e=d in a?new eventData.sortingSteps(a[d].steps):new eventData.sortingSteps;e.addStep(f,b);a[d]=e;utils.setCookie("od_config",JSON.stringify(a))};
createResetContextMenuItem=function(f){return{name:"reset",icon:null,disabled:!1,callback:function(e,d){resetConfig(f);resetSession(["pivotSettings","subscriptionPaging","geneList"]);setSession("pivotSettings","");var b=document.getElementById(f.containerDivId);buildObservationDeck(b,f)}}};
setupColLabelContextMenu=function(f){var e=f.columnTitleCallback;$.contextMenu({selector:".colLabel",trigger:"left",build:function(d,b){var a=d[0].getAttribute("sample");return{items:{title:{name:a,icon:null,disabled:null==e,callback:function(b,d){null==e?console.log("default titleCallback for column",a):e(a,f)}},reset:createResetContextMenuItem(f)}}}})};
setupTypeLabelContextMenu=function(f){var e=f.datatypeTitleCallback;$.contextMenu({selector:".typeLabel",trigger:"left",callback:function(d,b){console.log("elem",this[0])},build:function(d,b){var a=d[0].getAttribute("eventId");utils.endsWith(a,"(+)");var g=a.split("(");g.pop();var k=g.join("(");return{items:{title:{name:function(){return k},icon:null,disabled:!1,callback:function(b,d){null==e?(console.log("datatype",k),console.log("default titleCallback for datatype",k)):e(a,f)}},sep1:"---------",
toggle_datatype_visibility:{name:function(){return"toggle visibility"},icon:null,disabled:null,callback:function(a,b){"hiddenDatatypes"in f.querySettings||(f.querySettings.hiddenDatatypes=[]);var d=f.querySettings.hiddenDatatypes;utils.isObjInArray(d,k)?utils.removeA(d,k):d.push(k);utils.setCookie("od_config",JSON.stringify(f.querySettings));d=document.getElementById(f.containerDivId);buildObservationDeck(d,f)}},test_fold:{name:"dev_features",items:{hugoSearch:{name:"HUGO search",icon:null,disabled:!1,
callback:function(a,b){var d=document.getElementById("hugoSearch");d.style.display="block";$(d).dialog({title:"HUGO search",buttons:{close:function(){$(this).dialog("close")}}})}},sigSearch:{name:"signature search",icon:null,disabled:!1,callback:function(a,b){var d=document.getElementById("sigSearch");d.style.display="block";$(d).dialog({title:"signature search",buttons:{close:function(){$(this).dialog("close")}}})}}}},reset:createResetContextMenuItem(f)}}}})};
setupRowLabelContextMenu=function(f){var e=f.rowTitleCallback;$.contextMenu({selector:".rowLabel",trigger:"left",callback:function(d,b){console.log("elem",this[0])},build:function(d,b){var a=d[0].getAttribute("eventId"),g=f.eventAlbum.getEvent(a),k=g.metadata.datatype;return{items:{title:{name:g.metadata.displayName,icon:null,disabled:function(){var a=!0;null!=e&&utils.isObjInArray(["expression data","clinical data","expression signature","kinase target activity","tf target activity"],k)&&(a=!1);
return a},callback:function(b,d){null==e?console.log("default titleCallback for row",a):e(a,f)}},sep1:"---------",set_pivot:{name:function(){return"set as pivot"},icon:null,disabled:function(a,b){return utils.isObjInArray(["expression signature","kinase target activity","tf target activity"],k)?!1:!0},callback:function(b,d){if("undefined"!==typeof Session){var e=a,g="";utils.isObjInArray(["expression signature","kinase target activity","tf target activity"],k)&&(e=e.split("_v"),g=e.pop(),e=e.join("_v"),
k="signature");g={name:e,datatype:k,version:g};e=f.querySettings;e.pivot_event={id:a,datatype:k};var q=[];"pivot_sort_list"in e&&(q=e.pivot_sort_list);q.push("expression data");e.pivot_sort_list=utils.eliminateDuplicates(q);utils.setCookie("od_config",JSON.stringify(e));addSortStepToCookies(a,f,"colSort",!0);console.log("writing pivotSettings to Session",g);setSession("pivotSettings",g)}else console.log("no Session object. Writing pivotSettings to querySettings."),e=f.querySettings,e.pivot_event=
{id:a,datatype:k},utils.setCookie("od_config",JSON.stringify(e)),addSortStepToCookies(a,f,"colSort",!0),g=document.getElementById(f.containerDivId),buildObservationDeck(g,f)}},sort_fold:{name:"sort...",items:{sort:{name:"samples by this event",icon:null,disabled:!1,callback:function(b,d){addSortStepToCookies(a,f,"colSort",!1);var e=document.getElementById(f.containerDivId);buildObservationDeck(e,f)}}}},hide_fold:{name:"hide...",items:{hide_null_samples:{name:"null samples in this event",icon:null,
disabled:!1,callback:function(b,d){var e=f.querySettings;e["required events"]=[a];utils.setCookie("od_config",JSON.stringify(e));e=document.getElementById(f.containerDivId);buildObservationDeck(e,f)}},hide_event:{name:"this event",icon:null,disabled:!1,callback:function(b,d){var e=f.querySettings,g=e.hiddenEvents||[];g.push(a);e.hiddenEvents=utils.eliminateDuplicates(g);utils.setCookie("od_config",JSON.stringify(e));e=document.getElementById(f.containerDivId);buildObservationDeck(e,f)}}}},sep1:"---------",
reset:createResetContextMenuItem(f)}}}})};
setupExpressionCellContextMenu=function(f){var e=f.columnTitleCallback;$.contextMenu({selector:".mrna_exp",trigger:"left",callback:function(d,b){},build:function(d,b){var a=d[0],g=a.getAttribute("eventId"),k=a.getAttribute("sampleId");return{items:{title:{name:g+" for "+k,icon:null,disabled:!0},sep1:"---------",sample_link_out:{name:"go to details for "+k,icon:null,disabled:!1,callback:function(a,b){e(k,f)}},rescaling_fold:{name:"normalize coloring...",items:{"samplewise median rescaling":{name:"over each column",icon:null,
disabled:!1,callback:function(a,b){var d=f.querySettings;d["expression rescaling"]={method:"samplewiseMedianRescaling"};utils.setCookie("od_config",JSON.stringify(d));d=document.getElementById(f.containerDivId);buildObservationDeck(d,f)}},"eventwise median rescaling":{name:"over each row",icon:null,disabled:!1,callback:function(a,b){var d=f.querySettings;d["expression rescaling"]={method:"eventwiseMedianRescaling"};utils.setCookie("od_config",JSON.stringify(d));d=document.getElementById(f.containerDivId);
buildObservationDeck(d,f)}}}},sep1:"---------",reset:createResetContextMenuItem(f)}}}})};
setupCategoricCellContextMenu=function(f){var e=f.columnTitleCallback;$.contextMenu({selector:".categoric",trigger:"left",callback:function(d,b){},build:function(d,b){var a=d[0],g=a.getAttribute("eventId"),k=a.getAttribute("sampleId");return{items:{title:{name:g+" for "+k,icon:null,disabled:!0},sep1:"---------",sample_link_out:{name:"go to details for "+k,icon:null,disabled:!1,callback:function(a,b){e(k,f)}},"yulia expression rescaling":{name:"rescale mRNA values using this category",icon:null,disabled:!1,
callback:function(a,b){var d=this[0],e=d.getAttribute("eventId");d.getAttribute("sampleId");d=d.getAttribute("val");console.log("key:",a,"eventId:",e,"val:",d);console.log("href",window.location.href);console.log("host",window.location.host);console.log("pathname",window.location.pathname);console.log("search",window.location.search);var g=f.querySettings;g["expression rescaling"]={method:"yulia_rescaling",eventId:e,val:d};utils.setCookie("od_config",JSON.stringify(g));e=document.getElementById(f.containerDivId);
buildObservationDeck(e,f)}},sep1:"---------",reset:createResetContextMenuItem(f)}}}})};
setupSignatureCellContextMenu=function(f){var e=f.columnTitleCallback;$.contextMenu({selector:".signature",trigger:"left",callback:function(d,b){},build:function(d,b){var a=d[0],g=a.getAttribute("eventId"),k=a.getAttribute("sampleId");return{items:{title:{name:g+" for "+k,icon:null,disabled:!0},sep1:"---------",sample_link_out:{name:"go to details for "+k,icon:null,disabled:!1,callback:function(a,b){e(k,f)}},sep1:"---------",reset:createResetContextMenuItem(f)}}}})};
drawMatrix=function(f,e){var d=utils.removeChildElems(f),b=e.eventAlbum;b.fillInMissingSamples(null);b.fillInDatatypeLabelEvents("black");var a=b.getEventIdsByType(),g=d3.scale.category10(),k=[],l;for(l in a)g(l),k=k.concat(a[l]);var m=e.querySettings,n=function(a,b){var d=a.getEventIdsByType(),e=null;utils.hasOwnProperty(d,"expression data")&&utils.hasOwnProperty(b,"expression rescaling")?(d=b["expression rescaling"],"yulia_rescaling"===d.method?e=a.yuliaExpressionRescaling(d.eventId,d.val):"eventwiseMedianRescaling"===
d.method?e=a.eventwiseMedianRescaling():"zScoreExpressionRescaling"===d.method?e=a.zScoreExpressionRescaling():"samplewiseMedianRescaling"===d.method&&(e=a.samplewiseMedianRescaling())):utils.hasOwnProperty(d,"expression data")?e=a.eventwiseMedianRescaling():console.log("no expression data rescaling");return e}(b,m),p=function(a,b){var d=utils.centeredRgbaColorMapper(!1);null!=a&&(d=utils.centeredRgbaColorMapper(!1,0,a.minVal,a.maxVal));for(var e={},f=0;f<k.length;f++){var g=k[f],l=b.getEvent(g).metadata.allowedValues;
if("categoric"==l)e[g]=d3.scale.category10();else if("numeric"==l){var m=b.getEvent(g),l=m.metadata.minAllowedVal,m=m.metadata.maxAllowedVal;if("undefined"!=typeof l&&"undefined"!=typeof m)e[g]=utils.centeredRgbaColorMapper(!1,0,l,m);else{for(var m=b.getEvent(g).data.getValues(),l=[],n=0;n<m.length;n++){var p=m[n];utils.isNumerical(p)&&l.push(p)}m=Math.min.apply(null,l);l=Math.max.apply(null,l);e[g]=utils.centeredRgbaColorMapper(!1,0,m,l)}}else e[g]="expression"==l?d:d3.scale.category10()}return e}(n,
b),a=function(a){var d=null;if("colSort"in a)for(var d=new eventData.sortingSteps(a.colSort.steps),e=d.getSteps().length-1;0<=e;e--){var f=d.steps[e].name;b.getEvent(f)||(console.log(f,"not found, skip sorting by that event"),d.removeStep(f))}utils.hasOwnProperty(a,"pivot_sort")&&(a=a.pivot_sort.pivot_event,null==d&&(d=new eventData.sortingSteps),b.getEvent(a)&&d.addStep(a,!0));return d}(m),q=function(a){var d=null;if("rowSort"in a)for(d=new eventData.sortingSteps(a.rowSort.steps),a=d.getSteps().length-
1;0<=a;a--){var e=d.steps[a].name;b.getEvent(e)||(console.log(e,"not found, skip sorting by that event"),d.removeStep(e))}return d}(m);l=function(a,b,d){var f=null,f=b.multisortSamples(d);d=[];if("required events"in a){a=a["required events"][0];console.log("requiredEventId",a);try{var g=b.getEvent(a).data.getNullSamples();d=d.concat(g)}catch(k){console.log("ERROR while getting samples to hide in eventID:",a,"error.message ->",k.message)}finally{console.log("samplesToHide",d)}}d=utils.eliminateDuplicates(d);
b=[];for(g=0;g<f.length;g++)a=f[g],utils.isObjInArray(e.displayedSamples,a)?b.push(a):utils.isObjInArray(d,a)||0==e.displayedSamples.length&&b.push(a);return b}(m,b,a);var t={},v;for(v in l){var w=l[v];t[w]=v}var a=function(a,b,d,e){d=b.multisortEvents(e,d);if(utils.hasOwnProperty(a,"pivot_sort_list")){console.log("querySettings has a pivot_sort_list of datatypes",a.pivot_sort_list);d=[];e=[];var f=a.pivot_event.id;b.getEvent(f);var f=b.getGroupedPivotSorts(f,!0),g;for(g in f){var k;"datatype label"===
g?k=[]:(k=f[g],k.unshift(g+"(+)"),k.push(g+"(-)"));e=e.concat(k)}d=e.concat(d);d=utils.eliminateDuplicates(d)}else{k=[];e=0;for(g=d.length;e<g;e++)f=d[e],(utils.endsWith(f,"(+)")||utils.endsWith(f,"(-)"))&&k.push(f);e=0;for(g=k.length;e<g;e++)utils.removeA(d,k[e])}k=a.hiddenDatatypes||[];var l=a.hiddenEvents||[],m=[],n=b.getAllEventIds();for(e=0;e<d.length;e++)f=d[e],utils.isObjInArray(n,f)&&(g=b.getEvent(f).metadata.datatype,utils.isObjInArray(k,g)||utils.isObjInArray(l,f)||m.push(f));d=m;g=null;
null!=a.pivot_event&&(g=a.pivot_event.id,console.log("moving pivot event to top:",g),d.unshift(g),d=utils.eliminateDuplicates(d));a=[];e=0;for(g=d.length;e<g;e++)f=d[e],b.getEvent(f)?a.push(f):console.log("eventObj not found for",f);return a}(m,b,a,q),y=null;null!=m.pivot_event&&(y=m.pivot_event.id,console.log("moving pivot event to top:",y),a.unshift(y),a=utils.eliminateDuplicates(a));var K={};for(v in a)w=a[v],K[w]=v;utils.lengthOfLongestString(l);v=utils.lengthOfLongestString(a);console.log("longestRowName",
v);w={top:10,right:0,bottom:0,left:1<v?8*(v+1):15};v=document.documentElement.clientWidth;var D=Math.floor((v-w.left-w.right)/(l.length>a.length?l.length:a.length)),D=13<D?D:13;console.log("gridSize",D,"margin",w);m=w.top+w.bottom+D*a.length;d=d3.select(d).append("svg").attr({width:v+0,height:m,viewBox:"0 0 "+v+" "+m,perserveAspectRatio:"xMinYMin meet"}).append("g").attr({transform:"translate("+w.left+","+w.top+")"});utils.createSvgRectElement(0,0,0,0,v,m,{fill:"white","class":"primer"});d.append("rect").attr({x:0,
y:0,rx:0,ry:0,width:D*l.length,height:D*a.length,fill:"white","class":"primer"});v=-6;m=D/1.5;d.selectAll(".rowLabel").data(a).enter().append("text").text(function(a){return b.getEvent(a).metadata.displayName}).attr({x:0,y:function(a,b){return b*D},transform:"translate("+v+", "+m+")","class":function(a,d){var e;"datatype label"===b.getEvent(a).metadata.datatype?e="typeLabel mono axis unselectable":(e="rowLabel mono axis unselectable",a===y&&(e+=" pivotEvent"));return e},eventId:function(a,b){return a},
datatype:function(a,d){return b.getEvent(a).metadata.datatype}}).style("text-anchor","end").style("fill",function(a){a=b.getEvent(a).metadata.datatype;return"datatype label"===a?"black":g(a)}).append("title").text(function(a,d){var e=b.getEvent(a),f="event: "+a+"\ndatatype: "+e.metadata.datatype;"numeric"===e.metadata.allowedValues&&null!=n&&utils.hasOwnProperty(n,"stats")&&"undefined"!==typeof n.stats[a]&&(f=f+"\nraw data stats: "+utils.prettyJson(n.stats[a]));return f});v=Math.floor(D/5);m=-1*Math.floor(D/
3);d.selectAll(".colLabel").data(l).enter().append("text").text(function(a){return a}).attr({y:function(a,b){return(b+1)*D},x:0,transform:"rotate(-90) translate("+v+", "+m+")","class":function(a,b){return"colLabel mono axis unselectable hidden"},sample:function(a,b){return a}}).style("text-anchor","start").append("title").text(function(a){return"sample: "+a});l=b.getAllDataAsList();m=[];for(v=0;v<l.length;v++)w=l[v],utils.isObjInArray(a,w.eventId)&&m.push(w);d.selectAll(".cell").data(m).enter().append(function(a,
d){var e=function(a,b,d,e){var f=[];f.push(d/2+a+","+(0+b));f.push(d+a+","+(e+b));f.push(0+a+","+(e+b));return f},f=function(a,b,d,e){var f=[];f.push(d/2+a+","+(e+b));f.push(d+a+","+(0+b));f.push(0+a+","+(0+b));return f},g=document.createElementNS(utils.svgNamespaceUri,"g");g.setAttributeNS(null,"class","cell");var k=a.id;if(!utils.hasOwnProperty(t,k))return g;var l=t[a.id]*D,m=K[a.eventId]*D,n=4,q=4,v=D,w=D,y={"class":"bordered"},wb=a.eventId;if(null==wb||null==a.val)y.fill="lightgrey",g.appendChild(utils.createSvgRectElement(l,
m,n,q,v,w,y));if(null==wb||null==a.val)return g;var y=a.val,l=t[a.id]*D,m=K[a.eventId]*D,q=n=4,w=v=D,y={stroke:"#E6E6E6","stroke-width":"2px",fill:(0,p[a.eventId])(y)},Z;if("categoric"===b.getEvent(a.eventId).metadata.allowedValues)y["class"]="categoric",y.eventId=a.eventId,y.sampleId=a.id,y.val=a.val,Z=utils.createSvgRectElement(l,m,n,q,v,w,y);else if("expression data"===b.getEvent(a.eventId).metadata.datatype)y["class"]="mrna_exp",y.eventId=a.eventId,y.sampleId=a.id,y.val=a.val,Z=utils.createSvgRectElement(l,
m,n,q,v,w,y);else if(utils.isObjInArray(["expression signature","kinase target activity","tf target activity"],b.getEvent(a.eventId).metadata.datatype))y["class"]="signature",y.eventId=a.eventId,y.sampleId=a.id,y.val=a.val,Z=utils.createSvgRectElement(l,m,n,q,v,w,y);else if("datatype label"===b.getEvent(a.eventId).metadata.datatype){Z=a.eventId;var Ga,wa;utils.endsWith(Z,"(+)")?(Ga=Z.replace("(+)",""),wa="head"):(Ga=Z.replace("(-)",""),wa="tail");y["class"]="datatype";y.eventId=Ga;y.fill="black";
Z=t[k];0==Z?(y["stroke-width"]="0px",g.onclick=function(){setDatatypePaging(Ga,wa,"head"===wa?"down":"up")},y.points=e(l,m,v,w).join(" "),Z=utils.createSVGPolygonElement(y)):1==Z?(y["stroke-width"]="0px",g.onclick=function(){setDatatypePaging(Ga,wa,"head"===wa?"up":"down")},y.points=f(l,m,v,w).join(" "),Z=utils.createSVGPolygonElement(y)):2==Z?(Z=document.createElementNS(utils.svgNamespaceUri,"g"),y["stroke-width"]="0px",g.onclick=function(){setDatatypePaging(Ga,wa,"0")},"head"===wa?(k=utils.createSvgRectElement(l,
m,0,0,v,2,y),y.points=e(l,m,v,w).join(" ")):(k=utils.createSvgRectElement(l,m+w-3,0,0,v,2,y),y.points=f(l,m+1,v,w-2).join(" ")),e=utils.createSVGPolygonElement(y),Z.appendChild(k),Z.appendChild(e)):(y["stroke-width"]="0px",y.fill="DarkSlateGray",Z=utils.createSvgRectElement(l,1+m+w/2,0,0,v,2,y))}g.appendChild(Z);return g}).append("title").text(function(a){var d=a.eventId,e=b.getEvent(d).metadata.datatype,f=a.id;if("datatype label"===e){a=t[f];utils.endsWith(d,"(+)")?(e=d.replace("(+)",""),d="head"):
(e=d.replace("(-)",""),d="tail");var f="head"===d?"":"ANTI-",g="";0==a?g="show "+e+" events "+("head"===d?"MORE":"LESS")+" "+f+"CORRELATED to pivot event":1==a?g="show "+e+" events "+("head"===d?"LESS":"MORE")+" "+f+"CORRELATED to pivot event":2==a&&(g="show TOP "+e+" events "+f+"CORRELATED to pivot event")}else g="event: "+a.eventId+"\nsample: "+a.id+"\nvalue: "+a.val;return g});return e};
