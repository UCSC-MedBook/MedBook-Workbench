(function(g,f){"function"===typeof define&&define.amd?define("bloodhound",["jquery"],function(d){return g.Bloodhound=f(d)}):"object"===typeof exports?module.exports=f(require("jquery")):g.Bloodhound=f(jQuery)})(this,function(g){var f=function(){return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(a){return!a||/^\s*$/.test(a)},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,
"\\$&")},isString:function(a){return"string"===typeof a},isNumber:function(a){return"number"===typeof a},isArray:g.isArray,isFunction:g.isFunction,isObject:g.isPlainObject,isUndefined:function(a){return"undefined"===typeof a},isElement:function(a){return!(!a||1!==a.nodeType)},isJQuery:function(a){return a instanceof g},toStr:function(a){return f.isUndefined(a)||null===a?"":a+""},bind:g.proxy,each:function(a,b){g.each(a,function(a,e){return b(e,a)})},map:g.map,filter:g.grep,every:function(a,b){var e=
!0;if(!a)return e;g.each(a,function(d,f){if(!(e=b.call(null,f,d,a)))return!1});return!!e},some:function(a,b){var e=!1;if(!a)return e;g.each(a,function(d,f){if(e=b.call(null,f,d,a))return!1});return!!e},mixin:g.extend,identity:function(a){return a},clone:function(a){return g.extend(!0,{},a)},getIdGenerator:function(){var a=0;return function(){return a++}},templatify:function(a){function b(){return String(a)}return g.isFunction(a)?a:b},defer:function(a){setTimeout(a,0)},debounce:function(a,b,e){var d,
f;return function(){var g=this,l=arguments,k;k=e&&!d;clearTimeout(d);d=setTimeout(function(){d=null;e||(f=a.apply(g,l))},b);k&&(f=a.apply(g,l));return f}},throttle:function(a,b){var e,d,f,g,l,k;l=0;k=function(){l=new Date;f=null;g=a.apply(e,d)};return function(){var m=new Date,n=b-(m-l);e=this;d=arguments;0>=n?(clearTimeout(f),f=null,l=m,g=a.apply(e,d)):f||(f=setTimeout(k,n));return g}},stringify:function(a){return f.isString(a)?a:JSON.stringify(a)},noop:function(){}}}(),d=function(){function a(b){return(b=
f.toStr(b))?b.split(/\s+/):[]}function b(a){return(a=f.toStr(a))?a.split(/\W+/):[]}function e(a){return function(b){b=f.isArray(b)?b:[].slice.call(arguments,0);return function(e){var d=[];f.each(b,function(b){d=d.concat(a(f.toStr(e[b])))});return d}}}return{nonword:b,whitespace:a,obj:{nonword:e(b),whitespace:e(a)}}}(),b=function(){function a(b){this.maxSize=f.isNumber(b)?b:100;this.reset();0>=this.maxSize&&(this.set=this.get=g.noop)}function b(){this.head=this.tail=null}function e(a,b){this.key=a;
this.val=b;this.prev=this.next=null}f.mixin(a.prototype,{set:function(a,b){var d=this.list.tail;this.size>=this.maxSize&&(this.list.remove(d),delete this.hash[d.key],this.size--);(d=this.hash[a])?(d.val=b,this.list.moveToFront(d)):(d=new e(a,b),this.list.add(d),this.hash[a]=d,this.size++)},get:function(a){if(a=this.hash[a])return this.list.moveToFront(a),a.val},reset:function(){this.size=0;this.hash={};this.list=new b}});f.mixin(b.prototype,{add:function(a){this.head&&(a.next=this.head,this.head.prev=
a);this.head=a;this.tail=this.tail||a},remove:function(a){a.prev?a.prev.next=a.next:this.head=a.next;a.next?a.next.prev=a.prev:this.tail=a.prev},moveToFront:function(a){this.remove(a);this.add(a)}});return a}(),a=function(){function a(b,d){this.prefix=["__",b,"__"].join("");this.ttlKey="__ttl__";this.keyMatcher=new RegExp("^"+f.escapeRegExChars(this.prefix));this.ls=d||e;!this.ls&&this._noop()}function b(a){return JSON.stringify(f.isUndefined(a)?null:a)}var e;try{e=window.localStorage,e.setItem("~~~",
"!"),e.removeItem("~~~")}catch(d){e=null}f.mixin(a.prototype,{_prefix:function(a){return this.prefix+a},_ttlKey:function(a){return this._prefix(a)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=f.noop},_safeSet:function(a,b){try{this.ls.setItem(a,b)}catch(e){"QuotaExceededError"===e.name&&(this.clear(),this._noop())}},get:function(a){this.isExpired(a)&&this.remove(a);a=this.ls.getItem(this._prefix(a));return g.parseJSON(a)},set:function(a,e,d){f.isNumber(d)?
this._safeSet(this._ttlKey(a),b((new Date).getTime()+d)):this.ls.removeItem(this._ttlKey(a));return this._safeSet(this._prefix(a),b(e))},remove:function(a){this.ls.removeItem(this._ttlKey(a));this.ls.removeItem(this._prefix(a));return this},clear:function(){var a;a=this.keyMatcher;var b,d,f=[],g=e.length;for(b=0;b<g;b++)(d=e.key(b)).match(a)&&f.push(d.replace(a,""));for(a=f.length;a--;)this.remove(f[a]);return this},isExpired:function(a){a=this.ls.getItem(this._ttlKey(a));a=g.parseJSON(a);return f.isNumber(a)&&
(new Date).getTime()>a?!0:!1}});return a}(),e=function(){function a(e){e=e||{};this.cancelled=!1;this.lastReq=null;this._send=e.transport;this._get=e.limiter?e.limiter(this._get):this._get;this._cache=!1===e.cache?new b(0):k}var e=0,d={},l=6,k=new b(10);a.setMaxPendingRequests=function(a){l=a};a.resetCache=function(){k.reset()};f.mixin(a.prototype,{_fingerprint:function(a){a=a||{};return a.url+a.type+g.param(a.data||{})},_get:function(a,b){function f(a){b(null,a);m._cache.set(L,a)}function g(){b(!0)}
function k(){e--;delete d[L];m.onDeckRequestArgs&&(m._get.apply(m,m.onDeckRequestArgs),m.onDeckRequestArgs=null)}var m=this,L,n;L=this._fingerprint(a);this.cancelled||L!==this.lastReq||((n=d[L])?n.done(f).fail(g):e<l?(e++,d[L]=this._send(a).done(f).fail(g).always(k)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(a,b){var e,d;b=b||g.noop;a=f.isString(a)?{url:a}:a||{};d=this._fingerprint(a);this.cancelled=!1;this.lastReq=d;(e=this._cache.get(d))?b(null,e):this._get(a,b)},cancel:function(){this.cancelled=
!0}});return a}(),l=window.SearchIndex=function(){function a(b){b=b||{};b.datumTokenizer&&b.queryTokenizer||g.error("datumTokenizer and queryTokenizer are both required");this.identify=b.identify||f.stringify;this.datumTokenizer=b.datumTokenizer;this.queryTokenizer=b.queryTokenizer;this.reset()}function b(a){a=f.filter(a,function(a){return!!a});return a=f.map(a,function(a){return a.toLowerCase()})}function e(a){for(var b={},d=[],f=0,g=a.length;f<g;f++)b[a[f]]||(b[a[f]]=!0,d.push(a[f]));return d}f.mixin(a.prototype,
{bootstrap:function(a){this.datums=a.datums;this.trie=a.trie},add:function(a){var e=this;a=f.isArray(a)?a:[a];f.each(a,function(a){var d;e.datums[d=e.identify(a)]=a;a=b(e.datumTokenizer(a));f.each(a,function(a){var b,f;b=e.trie;for(a=a.split("");f=a.shift();)b=b.c[f]||(b.c[f]={i:[],c:{}}),b.i.push(d)})})},get:function(a){var b=this;return f.map(a,function(a){return b.datums[a]})},search:function(a){var d=this,g;a=b(this.queryTokenizer(a));f.each(a,function(a){var b,e;if(g&&0===g.length)return!1;b=
d.trie;for(a=a.split("");b&&(e=a.shift());)b=b.c[e];if(b&&0===a.length){e=b.i.slice(0);if(g){b=g;var f=a=0,l=[];b=b.sort();e=e.sort();for(var k=b.length,m=e.length;a<k&&f<m;)b[a]<e[f]?a++:(b[a]>e[f]||(l.push(b[a]),a++),f++);b=l}else b=e;g=b}else return g=[],!1});return g?f.map(e(g),function(a){return d.datums[a]}):[]},all:function(){var a=[],b;for(b in this.datums)a.push(this.datums[b]);return a},reset:function(){this.datums={};this.trie={i:[],c:{}}},serialize:function(){return{datums:this.datums,
trie:this.trie}}});return a}(),k=function(){function b(e){this.url=e.url;this.ttl=e.ttl;this.cache=e.cache;this.prepare=e.prepare;this.transform=e.transform;this.transport=e.transport;this.thumbprint=e.thumbprint;this.storage=new a(e.cacheKey)}f.mixin(b.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(a){this.cache&&(this.storage.set("data",a,this.ttl),this.storage.set("protocol",location.protocol,this.ttl),this.storage.set("thumbprint",this.thumbprint,
this.ttl))},fromCache:function(){var a,b;if(!this.cache)return null;a=this.storage.get("data");b=this.storage.get("protocol");b=this.storage.get("thumbprint")!==this.thumbprint||b!==location.protocol;return a&&!b?a:null},fromNetwork:function(a){function b(){a(!0)}function e(b){a(null,d.transform(b))}var d=this,f;a&&(f=this.prepare(this._settings()),this.transport(f).fail(b).done(e))},clear:function(){this.storage.clear();return this}});return b}(),m=function(){function a(b){this.url=b.url;this.prepare=
b.prepare;this.transform=b.transform;this.transport=new e({cache:b.cache,limiter:b.limiter,transport:b.transport})}f.mixin(a.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(a,b){function e(a,f){a?b([]):b(d.transform(f))}var d=this,f;if(b)return f=this.prepare(a||"",this._settings()),this.transport.get(f,e)},cancelLastRequest:function(){this.transport.cancel()}});return a}(),n=function(){function a(b){var e;if(!b)return null;e={url:null,ttl:864E5,cache:!0,
cacheKey:null,thumbprint:"",prepare:f.identity,transform:f.identity,transport:null};b=f.isString(b)?{url:b}:b;b=f.mixin(e,b);!b.url&&g.error("prefetch requires url to be set");b.transform=b.filter||b.transform;b.cacheKey=b.cacheKey||b.url;b.thumbprint="0.11.1"+b.thumbprint;b.transport=b.transport?l(b.transport):g.ajax;return b}function b(a){var k;if(a)return k={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:f.identity,transport:null},
a=f.isString(a)?{url:a}:a,a=f.mixin(k,a),!a.url&&g.error("remote requires url to be set"),a.transform=a.filter||a.transform,a.prepare=e(a),a.limiter=d(a),a.transport=a.transport?l(a.transport):g.ajax,delete a.replace,delete a.wildcard,delete a.rateLimitBy,delete a.rateLimitWait,a}function e(a){function b(a,e){e.url=l(e.url,a);return e}function d(a,b){b.url=b.url.replace(k,encodeURIComponent(a));return b}function f(a,b){return b}var g,l,k;g=a.prepare;l=a.replace;k=a.wildcard;return g?g:g=l?b:a.wildcard?
d:f}function d(a){function b(a){return function(b){return f.debounce(b,a)}}function e(a){return function(b){return f.throttle(b,a)}}var g,l;g=a.limiter;l=a.rateLimitBy;a=a.rateLimitWait;g||(g=/^throttle$/i.test(l)?e(a):b(a));return g}function l(a){return function(b){var e=g.Deferred();a(b,function(a){f.defer(function(){e.resolve(a)})},function(a){f.defer(function(){e.reject(a)})});return e}}return function(e){var d;e=f.mixin({initialize:!0,identify:f.stringify,datumTokenizer:null,queryTokenizer:null,
sufficient:5,sorter:null,local:[],prefetch:null,remote:null},e||{});!e.datumTokenizer&&g.error("datumTokenizer is required");!e.queryTokenizer&&g.error("queryTokenizer is required");d=e.sorter;e.sorter=d?function(a){return a.sort(d)}:f.identity;e.local=f.isFunction(e.local)?e.local():e.local;e.prefetch=a(e.prefetch);e.remote=b(e.remote);return e}}();return function(){function a(b){b=n(b);this.sorter=b.sorter;this.identify=b.identify;this.sufficient=b.sufficient;this.local=b.local;this.remote=b.remote?
new m(b.remote):null;this.prefetch=b.prefetch?new k(b.prefetch):null;this.index=new l({identify:this.identify,datumTokenizer:b.datumTokenizer,queryTokenizer:b.queryTokenizer});!1!==b.initialize&&this.initialize()}var b;b=window&&window.Bloodhound;a.noConflict=function(){window&&(window.Bloodhound=b);return a};a.tokenizers=d;f.mixin(a.prototype,{__ttAdapter:function(){function a(b,d,f){return e.search(b,d,f)}function b(a,d){return e.search(a,d)}var e=this;return this.remote?a:b},_loadPrefetch:function(){function a(d,
f){if(d)return e.reject();b.add(f);b.prefetch.store(b.index.serialize());e.resolve()}var b=this,e,d;e=g.Deferred();this.prefetch?(d=this.prefetch.fromCache())?(this.index.bootstrap(d),e.resolve()):this.prefetch.fromNetwork(a):e.resolve();return e.promise()},_initialize:function(){var a=this;this.clear();(this.initPromise=this._loadPrefetch()).done(function(){a.add(a.local)});return this.initPromise},initialize:function(a){return!this.initPromise||a?this._initialize():this.initPromise},add:function(a){this.index.add(a);
return this},get:function(a){a=f.isArray(a)?a:[].slice.call(arguments);return this.index.get(a)},search:function(a,b,e){function d(a){var b=[];f.each(a,function(a){!f.some(l,function(b){return g.identify(a)===g.identify(b)})&&b.push(a)});e&&e(b)}var g=this,l;l=this.sorter(this.index.search(a));b(this.remote?l.slice():l);this.remote&&l.length<this.sufficient?this.remote.get(a,d):this.remote&&this.remote.cancelLastRequest();return this},all:function(){return this.index.all()},clear:function(){this.index.reset();
return this},clearPrefetchCache:function(){this.prefetch&&this.prefetch.clear();return this},clearRemoteCache:function(){e.resetCache();return this},ttAdapter:function(){return this.__ttAdapter()}});return a}()});
(function(g,f){"function"===typeof define&&define.amd?define("typeahead.js",["jquery"],function(d){return f(d)}):"object"===typeof exports?module.exports=f(require("jquery")):f(jQuery)})(this,function(g){var f=function(){return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(a){return!a||/^\s*$/.test(a)},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},
isString:function(a){return"string"===typeof a},isNumber:function(a){return"number"===typeof a},isArray:g.isArray,isFunction:g.isFunction,isObject:g.isPlainObject,isUndefined:function(a){return"undefined"===typeof a},isElement:function(a){return!(!a||1!==a.nodeType)},isJQuery:function(a){return a instanceof g},toStr:function(a){return f.isUndefined(a)||null===a?"":a+""},bind:g.proxy,each:function(a,b){g.each(a,function(a,e){return b(e,a)})},map:g.map,filter:g.grep,every:function(a,b){var e=!0;if(!a)return e;
g.each(a,function(d,f){if(!(e=b.call(null,f,d,a)))return!1});return!!e},some:function(a,b){var e=!1;if(!a)return e;g.each(a,function(d,f){if(e=b.call(null,f,d,a))return!1});return!!e},mixin:g.extend,identity:function(a){return a},clone:function(a){return g.extend(!0,{},a)},getIdGenerator:function(){var a=0;return function(){return a++}},templatify:function(a){function b(){return String(a)}return g.isFunction(a)?a:b},defer:function(a){setTimeout(a,0)},debounce:function(a,b,e){var d,f;return function(){var g=
this,l=arguments,k;k=e&&!d;clearTimeout(d);d=setTimeout(function(){d=null;e||(f=a.apply(g,l))},b);k&&(f=a.apply(g,l));return f}},throttle:function(a,b){var e,d,f,g,l,k;l=0;k=function(){l=new Date;f=null;g=a.apply(e,d)};return function(){var m=new Date,n=b-(m-l);e=this;d=arguments;0>=n?(clearTimeout(f),f=null,l=m,g=a.apply(e,d)):f||(f=setTimeout(k,n));return g}},stringify:function(a){return f.isString(a)?a:JSON.stringify(a)},noop:function(){}}}(),d=function(){function a(b){var e={};f.each(b,function(a,
b){e[b]="."+a});return e}function b(){var a={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};f.isMsie()&&f.mixin(a.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"});
return a}var e={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return function(d){var g;d=f.mixin({},e,d);g={css:b(),classes:d,html:{wrapper:'<span class="'+d.wrapper+'"></span>',menu:'<div class="'+d.menu+'"></div>'},selectors:a(d)};return{css:g.css,html:g.html,classes:g.classes,selectors:g.selectors,mixin:function(a){f.mixin(a,
g)}}}}(),b=function(){function a(b){b&&b.el||g.error("EventBus initialized without el");this.$el=g(b.el)}var b;b={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"};f.mixin(a.prototype,{_trigger:function(a,b){var e;e=g.Event("typeahead:"+a);(b=b||[]).unshift(e);this.$el.trigger.apply(this.$el,b);return e},before:function(a){var b;b=[].slice.call(arguments,1);return this._trigger("before"+a,b).isDefaultPrevented()},trigger:function(a){var e;this._trigger(a,
[].slice.call(arguments,1));(e=b[a])&&this._trigger(e,[].slice.call(arguments,1))}});return a}(),a=function(){function a(b,f,g,l){if(!g)return this;f=f.split(d);g=l?e(g,l):g;for(this._callbacks=this._callbacks||{};l=f.shift();)this._callbacks[l]=this._callbacks[l]||{sync:[],async:[]},this._callbacks[l][b].push(g);return this}function b(a,e,d){return function(){for(var b,f=0,g=a.length;!b&&f<g;f+=1)b=!1===a[f].apply(e,d);return!b}}function e(a,b){return a.bind?a.bind(b):function(){a.apply(b,[].slice.call(arguments,
0))}}var d=/\s+/,f=function(){return window.setImmediate?function(a){setImmediate(function(){a()})}:function(a){setTimeout(function(){a()},0)}}();return{onSync:function(b,e,d){return a.call(this,"sync",b,e,d)},onAsync:function(b,e,d){return a.call(this,"async",b,e,d)},off:function(a){var b;if(!this._callbacks)return this;for(a=a.split(d);b=a.shift();)delete this._callbacks[b];return this},trigger:function(a){var e,g,l,k,m;if(!this._callbacks)return this;a=a.split(d);for(l=[].slice.call(arguments,
1);(e=a.shift())&&(g=this._callbacks[e]);)k=b(g.sync,this,[e].concat(l)),m=b(g.async,this,[e].concat(l)),k()&&f(m);return this}}}(),e=function(a){function b(a,e,d){for(var g=[],l=0,k=a.length;l<k;l++)g.push(f.escapeRegExChars(a[l]));a=d?"\\b("+g.join("|")+")\\b":"("+g.join("|")+")";return e?new RegExp(a):new RegExp(a,"i")}var e={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(d){function g(b){var e,f,l;if(e=k.exec(b.data))l=a.createElement(d.tagName),
d.className&&(l.className=d.className),f=b.splitText(e.index),f.splitText(e[0].length),l.appendChild(f.cloneNode(!0)),b.parentNode.replaceChild(l,f);return!!e}function l(a,b){for(var e,d=0;d<a.childNodes.length;d++)e=a.childNodes[d],3===e.nodeType?d+=b(e)?1:0:l(e,b)}var k;d=f.mixin({},e,d);d.node&&d.pattern&&(d.pattern=f.isArray(d.pattern)?d.pattern:[d.pattern],k=b(d.pattern,d.caseSensitive,d.wordsOnly),l(d.node,g))}}(window.document),l=function(){function b(a,e){a=a||{};a.input||g.error("input is missing");
e.mixin(this);this.$hint=g(a.hint);this.$input=g(a.input);this.query=this.$input.val();this.queryWhenFocused=this.hasFocus()?this.query:null;var d=this.$input;this.$overflowHelper=g('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:d.css("font-family"),fontSize:d.css("font-size"),fontStyle:d.css("font-style"),fontVariant:d.css("font-variant"),fontWeight:d.css("font-weight"),wordSpacing:d.css("word-spacing"),letterSpacing:d.css("letter-spacing"),
textIndent:d.css("text-indent"),textRendering:d.css("text-rendering"),textTransform:d.css("text-transform")}).insertAfter(d);this._checkLanguageDirection();0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=f.noop)}var e;e={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"};b.normalizeQuery=function(a){return f.toStr(a).replace(/^\s*/g,"").replace(/\s{2,}/g," ")};f.mixin(b.prototype,a,{_onBlur:function(){this.resetInputValue();this.trigger("blurred")},
_onFocus:function(){this.queryWhenFocused=this.query;this.trigger("focused")},_onKeydown:function(a){var b=e[a.which||a.keyCode];this._managePreventDefault(b,a);b&&this._shouldTrigger(b,a)&&this.trigger(b+"Keyed",a)},_onInput:function(){this._setQuery(this.getInputValue());this.clearHintIfInvalid();this._checkLanguageDirection()},_managePreventDefault:function(a,b){var e;switch(a){case "up":case "down":e=!(b.altKey||b.ctrlKey||b.metaKey||b.shiftKey);break;default:e=!1}e&&b.preventDefault()},_shouldTrigger:function(a,
b){var e;switch(a){case "tab":e=!(b.altKey||b.ctrlKey||b.metaKey||b.shiftKey);break;default:e=!0}return e},_checkLanguageDirection:function(){var a=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==a&&(this.dir=a,this.$hint.attr("dir",a),this.trigger("langDirChanged",a))},_setQuery:function(a,e){var d,f;d=this.query;f=(d=b.normalizeQuery(a)===b.normalizeQuery(d))?this.query.length!==a.length:!1;this.query=a;e||d?!e&&f&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",
this.query)},bind:function(){var a=this,b,d,g,l;b=f.bind(this._onBlur,this);d=f.bind(this._onFocus,this);g=f.bind(this._onKeydown,this);l=f.bind(this._onInput,this);this.$input.on("blur.tt",b).on("focus.tt",d).on("keydown.tt",g);if(!f.isMsie()||9<f.isMsie())this.$input.on("input.tt",l);else this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(b){e[b.which||b.keyCode]||f.defer(f.bind(a._onInput,a,b))});return this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},
getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(a,b){this.setInputValue(a);this._setQuery(a,b)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(a){this.$input.val(a);this.clearHintIfInvalid();this._checkLanguageDirection()},resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(a){this.$hint.val(a)},
clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var a,b;a=this.getInputValue();b=this.getHint();b=a!==b&&0===b.indexOf(a);""!==a&&b&&!this.hasOverflow()||this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var a=this.$input.width()-2;this.$overflowHelper.text(this.getInputValue());return this.$overflowHelper.width()>=a},isCursorAtEnd:function(){var a,b;a=this.$input.val().length;b=this.$input[0].selectionStart;return f.isNumber(b)?b===
a:document.selection?(b=document.selection.createRange(),b.moveStart("character",-a),a===b.text.length):!0},destroy:function(){this.$hint.off(".tt");this.$input.off(".tt");this.$overflowHelper.remove();this.$hint=this.$input=this.$overflowHelper=g("<div>")}});return b}(),k=function(){function b(a,e){a=a||{};a.templates=a.templates||{};a.templates.notFound=a.templates.notFound||a.templates.empty;a.source||g.error("missing source");a.node||g.error("missing node");a.name&&!/^[_a-zA-Z0-9-]+$/.test(a.name)&&
g.error("invalid dataset name: "+a.name);e.mixin(this);this.highlight=!!a.highlight;this.name=a.name||k();this.limit=a.limit||5;this.displayFn=d(a.display||a.displayKey);this.templates=l(a.templates,this.displayFn);this.source=a.source.__ttAdapter?a.source.__ttAdapter():a.source;this.async=f.isUndefined(a.async)?2<this.source.length:!!a.async;this._resetLastSuggestion();this.$el=g(a.node).addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}function d(a){function b(e){return e[a]}
a=a||f.stringify;return f.isFunction(a)?a:b}function l(a,b){function e(a){return g("<div>").text(b(a))}return{notFound:a.notFound&&f.templatify(a.notFound),pending:a.pending&&f.templatify(a.pending),header:a.header&&f.templatify(a.header),footer:a.footer&&f.templatify(a.footer),suggestion:a.suggestion||e}}var k;k=f.getIdGenerator();b.extractData=function(a){a=g(a);return a.data("tt-selectable-object")?{val:a.data("tt-selectable-display")||"",obj:a.data("tt-selectable-object")||null}:null};f.mixin(b.prototype,
a,{_overwrite:function(a,b){b=b||[];b.length?this._renderSuggestions(a,b):this.async&&this.templates.pending?this._renderPending(a):!this.async&&this.templates.notFound?this._renderNotFound(a):this._empty();this.trigger("rendered",this.name,b,!1)},_append:function(a,b){b=b||[];b.length&&this.$lastSuggestion.length?this._appendSuggestions(a,b):b.length?this._renderSuggestions(a,b):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(a);this.trigger("rendered",this.name,b,!0)},
_renderSuggestions:function(a,b){var e;e=this._getSuggestionsFragment(a,b);this.$lastSuggestion=e.children().last();this.$el.html(e).prepend(this._getHeader(a,b)).append(this._getFooter(a,b))},_appendSuggestions:function(a,b){var e,d;e=this._getSuggestionsFragment(a,b);d=e.children().last();this.$lastSuggestion.after(e);this.$lastSuggestion=d},_renderPending:function(a){var b=this.templates.pending;this._resetLastSuggestion();b&&this.$el.html(b({query:a,dataset:this.name}))},_renderNotFound:function(a){var b=
this.templates.notFound;this._resetLastSuggestion();b&&this.$el.html(b({query:a,dataset:this.name}))},_empty:function(){this.$el.empty();this._resetLastSuggestion()},_getSuggestionsFragment:function(a,b){var d=this,l;l=document.createDocumentFragment();f.each(b,function(b){var e;e=d._injectQuery(a,b);b=g(d.templates.suggestion(e)).data("tt-selectable-object",b).data("tt-selectable-display",d.displayFn(b)).addClass(d.classes.suggestion+" "+d.classes.selectable);l.appendChild(b[0])});this.highlight&&
e({className:this.classes.highlight,node:l,pattern:a});return g(l)},_getFooter:function(a,b){return this.templates.footer?this.templates.footer({query:a,suggestions:b,dataset:this.name}):null},_getHeader:function(a,b){return this.templates.header?this.templates.header({query:a,suggestions:b,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=g()},_injectQuery:function(a,b){return f.isObject(b)?f.mixin({_query:a},b):b},update:function(a){function b(d){f||(f=!0,d=(d||[]).slice(0,
e.limit),l=d.length,e._overwrite(a,d),l<e.limit&&e.async&&e.trigger("asyncRequested",a))}var e=this,d=!1,f=!1,l=0;this.cancel();this.cancel=function(){d=!0;e.cancel=g.noop;e.async&&e.trigger("asyncCanceled",a)};this.source(a,b,function(b){b=b||[];!d&&l<e.limit&&(e.cancel=g.noop,l+=b.length,e._append(a,b.slice(0,e.limit-l)),e.async&&e.trigger("asyncReceived",a))});!f&&b([])},cancel:g.noop,clear:function(){this._empty();this.cancel();this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},
destroy:function(){this.$el=g("<div>")}});return b}(),m=function(){function b(a,e){var d=this;a=a||{};a.node||g.error("node is required");e.mixin(this);this.$node=g(a.node);this.query=null;this.datasets=f.map(a.datasets,function(a){var b=d.$node.find(a.node).first();a.node=b.length?b:g("<div>").appendTo(d.$node);return new k(a,e)})}f.mixin(b.prototype,a,{_onSelectableClick:function(a){this.trigger("selectableClicked",g(a.currentTarget))},_onRendered:function(a,b,e,d){this.$node.toggleClass(this.classes.empty,
this._allDatasetsEmpty());this.trigger("datasetRendered",b,e,d)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty());this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){return f.every(this.datasets,function(a){return a.isEmpty()})},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},_removeCursor:function(){var a=this.getActiveSelectable();a&&a.removeClass(this.classes.cursor)},
_ensureVisible:function(a){var b,e,d;b=a.position().top;a=b+a.outerHeight(!0);e=this.$node.scrollTop();d=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10);0>b?this.$node.scrollTop(e+b):d<a&&this.$node.scrollTop(e+(a-d))},bind:function(){var a=this,b;b=f.bind(this._onSelectableClick,this);this.$node.on("click.tt",this.selectors.selectable,b);f.each(this.datasets,function(b){b.onSync("asyncRequested",a._propagate,a).onSync("asyncCanceled",a._propagate,
a).onSync("asyncReceived",a._propagate,a).onSync("rendered",a._onRendered,a).onSync("cleared",a._onCleared,a)});return this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.addClass(this.classes.open)},close:function(){this.$node.removeClass(this.classes.open);this._removeCursor()},setLanguageDirection:function(a){this.$node.attr("dir",a)},selectableRelativeToCursor:function(a){var b,e;e=this.getActiveSelectable();b=this._getSelectables();a=(e?b.index(e):
-1)+a;a=(a+1)%(b.length+1)-1;a=-1>a?b.length-1:a;return-1===a?null:b.eq(a)},setCursor:function(a){this._removeCursor();if(a=a&&a.first())a.addClass(this.classes.cursor),this._ensureVisible(a)},getSelectableData:function(a){return a&&a.length?k.extractData(a):null},getActiveSelectable:function(){var a=this._getSelectables().filter(this.selectors.cursor).first();return a.length?a:null},getTopSelectable:function(){var a=this._getSelectables().first();return a.length?a:null},update:function(a){function b(e){e.update(a)}
var e=a!==this.query;e&&(this.query=a,f.each(this.datasets,b));return e},empty:function(){f.each(this.datasets,function(a){a.clear()});this.query=null;this.$node.addClass(this.classes.empty)},destroy:function(){this.$node.off(".tt");this.$node=g("<div>");f.each(this.datasets,function(a){a.destroy()})}});return b}(),n=function(){function a(){m.apply(this,[].slice.call(arguments,0))}var b=m.prototype;f.mixin(a.prototype,m.prototype,{open:function(){!this._allDatasetsEmpty()&&this._show();return b.open.apply(this,
[].slice.call(arguments,0))},close:function(){this._hide();return b.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show();return b._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show();return b._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(a){this.$node.css("ltr"===a?this.css.ltr:this.css.rtl);return b.setLanguageDirection.apply(this,
[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}});return a}(),p=function(){function a(e,d){var l,k,m,n,p,q,L,C,V,gb,vb;e=e||{};e.input||g.error("missing input");e.menu||g.error("missing menu");e.eventBus||g.error("missing event bus");d.mixin(this);this.eventBus=e.eventBus;this.minLength=f.isNumber(e.minLength)?e.minLength:1;this.input=e.input;this.menu=e.menu;this.enabled=!0;this.active=!1;this.input.hasFocus()&&this.activate();
this.dir=this.input.getLangDir();this._hacks();this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this);l=b(this,"activate","open","_onFocused");k=b(this,"deactivate","_onBlurred");m=b(this,"isActive","isOpen","_onEnterKeyed");
n=b(this,"isActive","isOpen","_onTabKeyed");p=b(this,"isActive","_onEscKeyed");q=b(this,"isActive","open","_onUpKeyed");L=b(this,"isActive","open","_onDownKeyed");C=b(this,"isActive","isOpen","_onLeftKeyed");V=b(this,"isActive","isOpen","_onRightKeyed");gb=b(this,"_openIfActive","_onQueryChanged");vb=b(this,"_openIfActive","_onWhitespaceChanged");this.input.bind().onSync("focused",l,this).onSync("blurred",k,this).onSync("enterKeyed",m,this).onSync("tabKeyed",n,this).onSync("escKeyed",p,this).onSync("upKeyed",
q,this).onSync("downKeyed",L,this).onSync("leftKeyed",C,this).onSync("rightKeyed",V,this).onSync("queryChanged",gb,this).onSync("whitespaceChanged",vb,this).onSync("langDirChanged",this._onLangDirChanged,this)}function b(a){var e=[].slice.call(arguments,1);return function(){var b=[].slice.call(arguments);f.each(e,function(e){return a[e].apply(a,b)})}}f.mixin(a.prototype,{_hacks:function(){var a,b;a=this.input.$input||g("<div>");b=this.menu.$node||g("<div>");a.on("blur.tt",function(e){var d,g;d=document.activeElement;
g=b.is(d);d=0<b.has(d).length;f.isMsie()&&(g||d)&&(e.preventDefault(),e.stopImmediatePropagation(),f.defer(function(){a.focus()}))});b.on("mousedown.tt",function(a){a.preventDefault()})},_onSelectableClicked:function(a,b){this.select(b)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(a,b,e,d){this._updateHint();this.eventBus.trigger("render",e,d,b)},_onAsyncRequested:function(a,b,e){this.eventBus.trigger("asyncrequest",e,b)},_onAsyncCanceled:function(a,b,e){this.eventBus.trigger("asynccancel",
e,b)},_onAsyncReceived:function(a,b,e){this.eventBus.trigger("asyncreceive",e,b)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(a,b){var e;(e=this.menu.getActiveSelectable())&&this.select(e)&&b.preventDefault()},_onTabKeyed:function(a,b){var e;(e=this.menu.getActiveSelectable())?this.select(e)&&b.preventDefault():(e=
this.menu.getTopSelectable())&&this.autocomplete(e)&&b.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onQueryChanged:function(a,b){this._minLengthMet(b)?this.menu.update(b):
this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(a,b){this.dir!==b&&(this.dir=b,this.menu.setLanguageDirection(b))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(a){a=f.isString(a)?a:this.input.getQuery()||"";return a.length>=this.minLength},_updateHint:function(){var a,b,e;a=this.menu.getTopSelectable();b=this.menu.getSelectableData(a);a=this.input.getInputValue();!b||f.isBlankString(a)||this.input.hasOverflow()?this.input.clearHint():
(e=l.normalizeQuery(a),e=f.escapeRegExChars(e),e=new RegExp("^(?:"+e+")(.+$)","i"),(b=e.exec(b.val))&&this.input.setHint(a+b[1]))},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){if(this.isActive())return!0;if(!this.isEnabled()||this.eventBus.before("active"))return!1;this.active=!0;this.eventBus.trigger("active");return!0},deactivate:function(){if(this.isActive()){if(this.eventBus.before("idle"))return!1;
this.active=!1;this.close();this.eventBus.trigger("idle")}return!0},isOpen:function(){return this.menu.isOpen()},open:function(){this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open"));return this.isOpen()},close:function(){this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close"));return!this.isOpen()},setVal:function(a){this.input.setQuery(f.toStr(a))},
getVal:function(){return this.input.getQuery()},select:function(a){return(a=this.menu.getSelectableData(a))&&!this.eventBus.before("select",a.obj)?(this.input.setQuery(a.val,!0),this.eventBus.trigger("select",a.obj),this.close(),!0):!1},autocomplete:function(a){var b;b=this.input.getQuery();return(a=this.menu.getSelectableData(a))&&b!==a.val&&!this.eventBus.before("autocomplete",a.obj)?(this.input.setQuery(a.val),this.eventBus.trigger("autocomplete",a.obj),!0):!1},moveCursor:function(a){var b,e,d;
b=this.input.getQuery();a=this.menu.selectableRelativeToCursor(a);d=(e=this.menu.getSelectableData(a))?e.obj:null;return this._minLengthMet()&&this.menu.update(b)||this.eventBus.before("cursorchange",d)?!1:(this.menu.setCursor(a),e?this.input.setInputValue(e.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",d),!0)},destroy:function(){this.input.destroy();this.menu.destroy()}});return a}();(function(){function a(b,e){b.each(function(){var a=g(this),b;(b=a.data(Z.typeahead))&&
e(b,a)})}function e(a,b){return a.clone().addClass(b.classes.hint).removeData().css(b.css.hint).css(v(a)).prop("readonly",!0).removeAttr("id name placeholder required").attr({autocomplete:"off",spellcheck:"false",tabindex:-1})}function k(a,b){a.data(Z.attrs,{dir:a.attr("dir"),autocomplete:a.attr("autocomplete"),spellcheck:a.attr("spellcheck"),style:a.attr("style")});a.addClass(b.classes.input).attr({autocomplete:"off",spellcheck:!1});try{!a.attr("dir")&&a.attr("dir","auto")}catch(e){}return a}function v(a){return{backgroundAttachment:a.css("background-attachment"),
backgroundClip:a.css("background-clip"),backgroundColor:a.css("background-color"),backgroundImage:a.css("background-image"),backgroundOrigin:a.css("background-origin"),backgroundPosition:a.css("background-position"),backgroundRepeat:a.css("background-repeat"),backgroundSize:a.css("background-size")}}function z(a){var b,e;b=a.data(Z.www);e=a.parent().filter(b.selectors.wrapper);f.each(a.data(Z.attrs),function(b,e){f.isUndefined(b)?a.removeAttr(e):a.attr(e,b)});a.removeData(Z.typeahead).removeData(Z.www).removeData(Z.attr).removeClass(b.classes.input);
e.length&&(a.detach().insertAfter(e),e.remove())}function I(a){a=f.isJQuery(a)||f.isElement(a)?g(a).first():[];return a.length?a:null}var J,Z,x;J=g.fn.typeahead;Z={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"};x={initialize:function(a,L){var C;L=f.isArray(L)?L:[].slice.call(arguments,1);a=a||{};C=d(a.classNames);return this.each(function(){var d,q,v,x,z,J;f.each(L,function(b){b.highlight=!!a.highlight});d=g(this);q=g(C.html.wrapper);v=I(a.hint);x=I(a.menu);z=!1!==a.hint&&!v;J=!1!==a.menu&&
!x;z&&(v=e(d,C));J&&(x=g(C.html.menu).css(C.css.menu));v&&v.val("");d=k(d,C);if(z||J)q.css(C.css.wrapper),d.css(z?C.css.input:C.css.inputWithNoHint),d.wrap(q).parent().prepend(z?v:null).append(J?x:null);z=J?n:m;q=new b({el:d});v=new l({hint:v,input:d},C);x=new z({node:x,datasets:L},C);x=new p({input:v,menu:x,eventBus:q,minLength:a.minLength},C);d.data(Z.www,C);d.data(Z.typeahead,x)})},isEnabled:function(){var b;a(this.first(),function(a){b=a.isEnabled()});return b},enable:function(){a(this,function(a){a.enable()});
return this},disable:function(){a(this,function(a){a.disable()});return this},isActive:function(){var b;a(this.first(),function(a){b=a.isActive()});return b},activate:function(){a(this,function(a){a.activate()});return this},deactivate:function(){a(this,function(a){a.deactivate()});return this},isOpen:function(){var b;a(this.first(),function(a){b=a.isOpen()});return b},open:function(){a(this,function(a){a.open()});return this},close:function(){a(this,function(a){a.close()});return this},select:function(b){var e=
!1,d=g(b);a(this.first(),function(a){e=a.select(d)});return e},autocomplete:function(b){var e=!1,d=g(b);a(this.first(),function(a){e=a.autocomplete(d)});return e},moveCursor:function(b){var e=!1;a(this.first(),function(a){e=a.moveCursor(b)});return e},val:function(b){var e;if(arguments.length)return a(this,function(a){a.setVal(b)}),this;a(this.first(),function(a){e=a.getVal()});return e},destroy:function(){a(this,function(a,b){z(b);a.destroy()});return this}};g.fn.typeahead=function(a){return x[a]?
x[a].apply(this,[].slice.call(arguments,1)):x.initialize.apply(this,arguments)};g.fn.typeahead.noConflict=function(){g.fn.typeahead=J;return this}})()});(function(g,f){function d(a){a=a.split(/\s+/);for(var b=[],e=0,d;d=a[e];e++)d=d.charAt(0).toUpperCase(),b.push(d);return b}function b(a){return a.id&&g('label[for="'+a.id+'"]').val()||a.name}function a(e,d,l){l||(l=0);d.each(function(){var d=g(this),k=this,m=this.nodeName.toLowerCase(),n,p;"label"==m&&d.find("input, textarea, select").length&&(n=d.text(),d=d.children().first(),k=d.get(0),m=k.nodeName.toLowerCase());switch(m){case "menu":p={name:d.attr("label"),items:{}};l=a(p.items,d.children(),l);
break;case "a":case "button":p={name:d.text(),disabled:!!d.attr("disabled"),callback:function(){return function(){d.click()}}()};break;case "menuitem":case "command":switch(d.attr("type")){case f:case "command":case "menuitem":p={name:d.attr("label"),disabled:!!d.attr("disabled"),callback:function(){return function(){d.click()}}()};break;case "checkbox":p={type:"checkbox",disabled:!!d.attr("disabled"),name:d.attr("label"),selected:!!d.attr("checked")};break;case "radio":p={type:"radio",disabled:!!d.attr("disabled"),
name:d.attr("label"),radio:d.attr("radiogroup"),value:d.attr("id"),selected:!!d.attr("checked")};break;default:p=f}break;case "hr":p="-------";break;case "input":switch(d.attr("type")){case "text":p={type:"text",name:n||b(k),disabled:!!d.attr("disabled"),value:d.val()};break;case "checkbox":p={type:"checkbox",name:n||b(k),disabled:!!d.attr("disabled"),selected:!!d.attr("checked")};break;case "radio":p={type:"radio",name:n||b(k),disabled:!!d.attr("disabled"),radio:!!d.attr("name"),value:d.val(),selected:!!d.attr("checked")};
break;default:p=f}break;case "select":p={type:"select",name:n||b(k),disabled:!!d.attr("disabled"),selected:d.val(),options:{}};d.children().each(function(){p.options[this.value]=g(this).text()});break;case "textarea":p={type:"textarea",name:n||b(k),disabled:!!d.attr("disabled"),value:d.val()};break;case "label":break;default:p={type:"html",html:d.clone(!0)}}p&&(l++,e["key"+l]=p)});return l}g.support.htmlMenuitem="HTMLMenuItemElement"in window;g.support.htmlCommand="HTMLCommandElement"in window;g.support.eventSelectstart=
"onselectstart"in document.documentElement;if(!g.ui||!g.ui.widget){var e=g.cleanData;g.cleanData=function(a){for(var b=0,d;null!=(d=a[b]);b++)try{g(d).triggerHandler("remove")}catch(f){}e(a)}}var l=null,k=!1,m=g(window),n=0,p={},q={},t={},w={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,determinePosition:function(a){if(g.ui&&g.ui.position)a.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");
else{var b=this.offset();b.top+=this.outerHeight();b.left+=this.outerWidth()/2-a.outerWidth()/2;a.css(b)}},position:function(a,b,e){if(b||e){b="maintain"===b&&"maintain"===e?a.$menu.position():{top:e,left:b};e=m.scrollTop()+m.height();var d=m.scrollLeft()+m.width(),f=a.$menu.height(),g=a.$menu.width();b.top+f>e&&(b.top-=f);0>b.top&&(b.top=0);b.left+g>d&&(b.left-=g);a.$menu.css(b)}else a.determinePosition.call(this,a.$menu)},positionSubmenu:function(a){if(g.ui&&g.ui.position)a.css("display","block").position({my:"left top",
at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var b={top:0,left:this.outerWidth()};a.css(b)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:g.noop,hide:g.noop},callback:null,items:{}},v=null,z=null,I=null,J,Z=function(a){for(var b=0;b=Math.max(b,parseInt(a.css("z-index"),10)||0),a=a.parent(),a&&a.length&&!(-1<"html body".indexOf(a.prop("nodeName").toLowerCase())););return b},x={abortevent:function(a){a.preventDefault();a.stopImmediatePropagation()},
contextmenu:function(a){var b=g(this);"right"==a.data.trigger&&(a.preventDefault(),a.stopImmediatePropagation());if(!("right"!=a.data.trigger&&a.originalEvent||b.hasClass("context-menu-active")||b.hasClass("context-menu-disabled"))){l=b;if(a.data.build){var e=a.data.build(l,a);if(!1===e)return;a.data=g.extend(!0,{},w,a.data,e||{});if(!a.data.items||g.isEmptyObject(a.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),Error("No Items specified");
a.data.$trigger=l;B.create(a.data)}B.show.call(b,a.data,a.pageX,a.pageY)}},click:function(a){a.preventDefault();a.stopImmediatePropagation();g(this).trigger(g.Event("contextmenu",{data:a.data,pageX:a.pageX,pageY:a.pageY}))},mousedown:function(a){var b=g(this);l&&l.length&&!l.is(b)&&l.data("contextMenu").$menu.trigger("contextmenu:hide");2==a.button&&(l=b.data("contextMenuActive",!0))},mouseup:function(a){var b=g(this);b.data("contextMenuActive")&&l&&l.length&&l.is(b)&&!b.hasClass("context-menu-disabled")&&
(a.preventDefault(),a.stopImmediatePropagation(),l=b,b.trigger(g.Event("contextmenu",{data:a.data,pageX:a.pageX,pageY:a.pageY})));b.removeData("contextMenuActive")},mouseenter:function(a){var b=g(this),e=g(a.relatedTarget),d=g(document);e.is(".context-menu-list")||e.closest(".context-menu-list").length||l&&l.length||(z=a.pageX,I=a.pageY,J=a.data,d.on("mousemove.contextMenuShow",x.mousemove),v=setTimeout(function(){v=null;d.off("mousemove.contextMenuShow");l=b;b.trigger(g.Event("contextmenu",{data:J,
pageX:z,pageY:I}))},a.data.delay))},mousemove:function(a){z=a.pageX;I=a.pageY},mouseleave:function(a){a=g(a.relatedTarget);if(!a.is(".context-menu-list")&&!a.closest(".context-menu-list").length){try{clearTimeout(v)}catch(b){}v=null}},layerClick:function(a){var b=g(this).data("contextMenuRoot"),e=a.button,d=a.pageX,f=a.pageY,l,k;a.preventDefault();a.stopImmediatePropagation();setTimeout(function(){var n,p="left"==b.trigger&&0===e||"right"==b.trigger&&2===e;document.elementFromPoint&&(b.$layer.hide(),
l=document.elementFromPoint(d-m.scrollLeft(),f-m.scrollTop()),b.$layer.show());if(b.reposition&&p)if(document.elementFromPoint){if(b.$trigger.is(l)||b.$trigger.has(l).length){b.position.call(b.$trigger,b,d,f);return}}else if(k=b.$trigger.offset(),n=g(window),k.top+=n.scrollTop(),k.top<=a.pageY&&(k.left+=n.scrollLeft(),k.left<=a.pageX&&(k.bottom=k.top+b.$trigger.outerHeight(),k.bottom>=a.pageY&&(k.right=k.left+b.$trigger.outerWidth(),k.right>=a.pageX)))){b.position.call(b.$trigger,b,d,f);return}if(l&&
p)b.$trigger.one("contextmenu:hidden",function(){g(l).contextMenu({x:d,y:f})});b.$menu.trigger("contextmenu:hide")},50)},keyStop:function(a,b){b.isInput||a.preventDefault();a.stopPropagation()},key:function(a){var b={};l&&(b=l.data("contextMenu")||{});switch(a.keyCode){case 9:case 38:if(x.keyStop(a,b),b.isInput){if(9==a.keyCode&&a.shiftKey){a.preventDefault();b.$selected&&b.$selected.find("input, textarea, select").blur();b.$menu.trigger("prevcommand");return}if(38==a.keyCode&&"checkbox"==b.$selected.find("input, textarea, select").prop("type")){a.preventDefault();
return}}else if(9!=a.keyCode||a.shiftKey){b.$menu.trigger("prevcommand");return}case 40:x.keyStop(a,b);if(b.isInput){if(9==a.keyCode){a.preventDefault();b.$selected&&b.$selected.find("input, textarea, select").blur();b.$menu.trigger("nextcommand");return}if(40==a.keyCode&&"checkbox"==b.$selected.find("input, textarea, select").prop("type")){a.preventDefault();return}}else{b.$menu.trigger("nextcommand");return}break;case 37:x.keyStop(a,b);if(b.isInput||!b.$selected||!b.$selected.length)break;if(!b.$selected.parent().hasClass("context-menu-root")){a=
b.$selected.parent().parent();b.$selected.trigger("contextmenu:blur");b.$selected=a;return}break;case 39:x.keyStop(a,b);if(b.isInput||!b.$selected||!b.$selected.length)break;var e=b.$selected.data("contextMenu")||{};if(e.$menu&&b.$selected.hasClass("context-menu-submenu")){b.$selected=null;e.$selected=null;e.$menu.trigger("nextcommand");return}break;case 35:case 36:b.$selected&&b.$selected.find("input, textarea, select").length||((b.$selected&&b.$selected.parent()||b.$menu).children(":not(.disabled, .not-selectable)")[36==
a.keyCode?"first":"last"]().trigger("contextmenu:focus"),a.preventDefault());return;case 13:x.keyStop(a,b);if(b.isInput){if(b.$selected&&!b.$selected.is("textarea, select")){a.preventDefault();return}break}b.$selected&&b.$selected.trigger("mouseup");return;case 32:case 33:case 34:x.keyStop(a,b);return;case 27:x.keyStop(a,b);b.$menu.trigger("contextmenu:hide");return;default:if(e=String.fromCharCode(a.keyCode).toUpperCase(),b.accesskeys&&b.accesskeys[e]){b.accesskeys[e].$node.trigger(b.accesskeys[e].$menu?
"contextmenu:focus":"mouseup");return}}a.stopPropagation();b.$selected&&b.$selected.trigger(a)},prevItem:function(a){a.stopPropagation();var b=g(this).data("contextMenu")||{};if(b.$selected){var e=b.$selected,b=b.$selected.parent().data("contextMenu")||{};b.$selected=e}for(var e=b.$menu.children(),d=b.$selected&&b.$selected.prev().length?b.$selected.prev():e.last(),f=d;d.hasClass("disabled")||d.hasClass("not-selectable");)if(d=d.prev().length?d.prev():e.last(),d.is(f))return;b.$selected&&x.itemMouseleave.call(b.$selected.get(0),
a);x.itemMouseenter.call(d.get(0),a);a=d.find("input, textarea, select");a.length&&a.focus()},nextItem:function(a){a.stopPropagation();var b=g(this).data("contextMenu")||{};if(b.$selected){var e=b.$selected,b=b.$selected.parent().data("contextMenu")||{};b.$selected=e}for(var e=b.$menu.children(),d=b.$selected&&b.$selected.next().length?b.$selected.next():e.first(),f=d;d.hasClass("disabled")||d.hasClass("not-selectable");)if(d=d.next().length?d.next():e.first(),d.is(f))return;b.$selected&&x.itemMouseleave.call(b.$selected.get(0),
a);x.itemMouseenter.call(d.get(0),a);a=d.find("input, textarea, select");a.length&&a.focus()},focusInput:function(a){a=g(this).closest(".context-menu-item");var b=a.data(),e=b.contextMenu,b=b.contextMenuRoot;b.$selected=e.$selected=a;b.isInput=e.isInput=!0},blurInput:function(a){a=g(this).closest(".context-menu-item").data();a.contextMenuRoot.isInput=a.contextMenu.isInput=!1},menuMouseenter:function(a){g(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(a){var b=g(this).data().contextMenuRoot;
b.$layer&&b.$layer.is(a.relatedTarget)&&(b.hovering=!1)},itemMouseenter:function(a){var b=g(this),e=b.data(),d=e.contextMenu,e=e.contextMenuRoot;e.hovering=!0;a&&e.$layer&&e.$layer.is(a.relatedTarget)&&(a.preventDefault(),a.stopImmediatePropagation());(d.$menu?d:e).$menu.children(".hover").trigger("contextmenu:blur");b.hasClass("disabled")||b.hasClass("not-selectable")?d.$selected=null:b.trigger("contextmenu:focus")},itemMouseleave:function(a){var b=g(this),e=b.data(),d=e.contextMenu,e=e.contextMenuRoot;
e!==d&&e.$layer&&e.$layer.is(a.relatedTarget)?(e.$selected&&e.$selected.trigger("contextmenu:blur"),a.preventDefault(),a.stopImmediatePropagation(),e.$selected=d.$selected=d.$node):b.trigger("contextmenu:blur")},itemClick:function(a){var b=g(this),e=b.data(),d=e.contextMenuRoot,f=e.contextMenuKey;if(e.contextMenu.items[f]&&!b.is(".disabled, .context-menu-submenu, .context-menu-separator, .not-selectable")){a.preventDefault();a.stopImmediatePropagation();if(g.isFunction(d.callbacks[f])&&Object.prototype.hasOwnProperty.call(d.callbacks,
f))a=d.callbacks[f];else if(g.isFunction(d.callback))a=d.callback;else return;!1!==a.call(d.$trigger,f,d)?d.$menu.trigger("contextmenu:hide"):d.$menu.parent().length&&B.update.call(d.$trigger,d)}},inputClick:function(a){a.stopImmediatePropagation()},hideMenu:function(a,b){var e=g(this).data("contextMenuRoot");B.hide.call(e.$trigger,e,b&&b.force)},focusItem:function(a){a.stopPropagation();a=g(this);var b=a.data(),e=b.contextMenu,b=b.contextMenuRoot;a.addClass("hover").siblings(".hover").trigger("contextmenu:blur");
e.$selected=b.$selected=a;e.$node&&b.positionSubmenu.call(e.$node,e.$menu)},blurItem:function(a){a.stopPropagation();a=g(this);var b=a.data().contextMenu;a.removeClass("hover");b.$selected=null}},B={show:function(a,b,e){var d=g(this),f={};g("#context-menu-layer").trigger("mousedown");a.$trigger=d;if(!1===a.events.show.call(d,a))l=null;else if(B.update.call(d,a),a.position.call(d,a,b,e),a.zIndex&&(f.zIndex=Z(d)+a.zIndex),B.layer.call(a.$menu,a,f.zIndex),a.$menu.find("ul").css("zIndex",f.zIndex+1),
a.$menu.css(f)[a.animation.show](a.animation.duration,function(){d.trigger("contextmenu:visible")}),d.data("contextMenu",a).addClass("context-menu-active"),g(document).off("keydown.contextMenu").on("keydown.contextMenu",x.key),a.autoHide)g(document).on("mousemove.contextMenuAutoHide",function(b){var e=d.offset();e.right=e.left+d.outerWidth();e.bottom=e.top+d.outerHeight();!a.$layer||a.hovering||b.pageX>=e.left&&b.pageX<=e.right&&b.pageY>=e.top&&b.pageY<=e.bottom||a.$menu.trigger("contextmenu:hide")})},
hide:function(a,b){var e=g(this);a||(a=e.data("contextMenu")||{});if(b||!a.events||!1!==a.events.hide.call(e,a)){e.removeData("contextMenu").removeClass("context-menu-active");if(a.$layer){setTimeout(function(a){return function(){a.remove()}}(a.$layer),10);try{delete a.$layer}catch(d){a.$layer=null}}l=null;a.$menu.find(".hover").trigger("contextmenu:blur");a.$selected=null;g(document).off(".contextMenuAutoHide").off("keydown.contextMenu");a.$menu&&a.$menu[a.animation.hide](a.animation.duration,function(){a.build&&
(a.$menu.remove(),g.each(a,function(b,e){switch(b){case "ns":case "selector":case "build":case "trigger":return!0;default:a[b]=f;try{delete a[b]}catch(d){}return!0}}));setTimeout(function(){e.trigger("contextmenu:hidden")},10)})}},create:function(a,b){b===f&&(b=a);a.$menu=g('<ul class="context-menu-list"></ul>').addClass(a.className||"").data({contextMenu:a,contextMenuRoot:b});g.each(["callbacks","commands","inputs"],function(e,d){a[d]={};b[d]||(b[d]={})});b.accesskeys||(b.accesskeys={});g.each(a.items,
function(e,f){var l=g('<li class="context-menu-item"></li>').addClass(f.className||""),k=null,m=null;l.on("click",g.noop);f.$node=l.data({contextMenu:a,contextMenuRoot:b,contextMenuKey:e});if(f.accesskey)for(var n=d(f.accesskey),p=0,q;q=n[p];p++)if(!b.accesskeys[q]){b.accesskeys[q]=f;f._name=f.name.replace(new RegExp("("+q+")","i"),'<span class="context-menu-accesskey">$1</span>');break}if("string"==typeof f)l.addClass("context-menu-separator not-selectable");else if(f.type&&t[f.type])t[f.type].call(l,
f,a,b),g.each([a,b],function(a,b){b.commands[e]=f;g.isFunction(f.callback)&&(b.callbacks[e]=f.callback)});else{"html"==f.type?l.addClass("context-menu-html not-selectable"):f.type?(k=g("<label></label>").appendTo(l),g("<span></span>").text(f._name||f.name).appendTo(k),l.addClass("context-menu-input"),a.hasTypes=!0,g.each([a,b],function(a,b){b.commands[e]=f;b.inputs[e]=f})):f.items&&(f.type="sub");switch(f.type){case "text":m=g('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+
e).val(f.value||"").appendTo(k);break;case "textarea":m=g('<textarea name=""></textarea>').attr("name","context-menu-input-"+e).val(f.value||"").appendTo(k);f.height&&m.height(f.height);break;case "checkbox":m=g('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+e).val(f.value||"").prop("checked",!!f.selected).prependTo(k);break;case "radio":m=g('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+f.radio).val(f.value||"").prop("checked",
!!f.selected).prependTo(k);break;case "select":m=g('<select name="">').attr("name","context-menu-input-"+e).appendTo(k);f.options&&(g.each(f.options,function(a,b){g("<option></option>").val(a).text(b).appendTo(m)}),m.val(f.selected));break;case "sub":g("<span></span>").text(f._name||f.name).appendTo(l);f.appendTo=f.$node;B.create(f,b);l.data("contextMenu",f).addClass("context-menu-submenu");f.callback=null;break;case "html":g(f.html).appendTo(l);break;default:g.each([a,b],function(a,b){b.commands[e]=
f;g.isFunction(f.callback)&&(b.callbacks[e]=f.callback)}),g("<span></span>").text(f._name||f.name||"").appendTo(l)}if(f.type&&"sub"!=f.type&&"html"!=f.type&&(m.on("focus",x.focusInput).on("blur",x.blurInput),f.events))m.on(f.events,a);f.icon&&l.addClass("icon icon-"+f.icon)}f.$input=m;f.$label=k;l.appendTo(a.$menu);if(!a.hasTypes&&g.support.eventSelectstart)l.on("selectstart.disableTextSelect",x.abortevent)});a.$node||a.$menu.css("display","none").addClass("context-menu-root");a.$menu.appendTo(a.appendTo||
document.body)},resize:function(a,b){a.css({position:"absolute",display:"block"});a.data("width",Math.ceil(a.width())+1);a.css({position:"static",minWidth:"0px",maxWidth:"100000px"});a.find("> li > ul").each(function(){B.resize(g(this),!0)});b||a.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).width(function(){return g(this).data("width")})},update:function(a,b){var e=this;b===f&&(b=a,B.resize(a.$menu));a.$menu.children().each(function(){var d=g(this),f=d.data("contextMenuKey"),
l=a.items[f],f=g.isFunction(l.disabled)&&l.disabled.call(e,f,b)||!0===l.disabled;d[f?"addClass":"removeClass"]("disabled");if(l.type)switch(d.find("input, select, textarea").prop("disabled",f),l.type){case "text":case "textarea":l.$input.val(l.value||"");break;case "checkbox":case "radio":l.$input.val(l.value||"").prop("checked",!!l.selected);break;case "select":l.$input.val(l.selected||"")}l.$menu&&B.update.call(e,l,b)})},layer:function(a,b){var e=a.$layer=g('<div id="context-menu-layer" style="position:fixed; z-index:'+
b+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:m.height(),width:m.width(),display:"block"}).data("contextMenuRoot",a).insertBefore(this).on("contextmenu",x.abortevent).on("mousedown",x.layerClick);document.body.style.maxWidth===f&&e.css({position:"absolute",height:g(document).height()});return e}};g.fn.contextMenu=function(a){a===f?this.first().trigger("contextmenu"):a.x&&a.y?this.first().trigger(g.Event("contextmenu",{pageX:a.x,pageY:a.y})):
"hide"===a?(a=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null)&&a.trigger("contextmenu:hide"):"destroy"===a?g.contextMenu("destroy",{context:this}):g.isPlainObject(a)?(a.context=this,g.contextMenu("create",a)):a?this.removeClass("context-menu-disabled"):a||this.addClass("context-menu-disabled");return this};g.contextMenu=function(a,b){"string"!=typeof a&&(b=a,a="create");"string"==typeof b?b={selector:b}:b===f&&(b={});var e=g.extend(!0,{},w,b||{}),d=g(document),l=d,m=
!1;e.context&&e.context.length?(l=g(e.context).first(),e.context=l.get(0),m=e.context!==document):e.context=document;switch(a){case "create":if(!e.selector)throw Error("No selector specified");if(e.selector.match(/.context-menu-(list|item|input)($|\s)/))throw Error('Cannot bind to selector "'+e.selector+'" as it contains a reserved className');if(!e.build&&(!e.items||g.isEmptyObject(e.items)))throw Error("No Items specified");n++;e.ns=".contextMenu"+n;m||(p[e.selector]=e.ns);q[e.ns]=e;e.trigger||
(e.trigger="right");k||(d.on({"contextmenu:hide.contextMenu":x.hideMenu,"prevcommand.contextMenu":x.prevItem,"nextcommand.contextMenu":x.nextItem,"contextmenu.contextMenu":x.abortevent,"mouseenter.contextMenu":x.menuMouseenter,"mouseleave.contextMenu":x.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",x.inputClick).on({"mouseup.contextMenu":x.itemClick,"contextmenu:focus.contextMenu":x.focusItem,"contextmenu:blur.contextMenu":x.blurItem,"contextmenu.contextMenu":x.abortevent,
"mouseenter.contextMenu":x.itemMouseenter,"mouseleave.contextMenu":x.itemMouseleave},".context-menu-item"),k=!0);l.on("contextmenu"+e.ns,e.selector,e,x.contextmenu);if(m)l.on("remove"+e.ns,function(){g(this).contextMenu("destroy")});switch(e.trigger){case "hover":l.on("mouseenter"+e.ns,e.selector,e,x.mouseenter).on("mouseleave"+e.ns,e.selector,e,x.mouseleave);break;case "left":l.on("click"+e.ns,e.selector,e,x.click)}e.build||B.create(e);break;case "destroy":var v;if(m){var t=e.context;g.each(q,function(a,
b){if(b.context!==t)return!0;v=g(".context-menu-list").filter(":visible");v.length&&v.data().contextMenuRoot.$trigger.is(g(b.context).find(b.selector))&&v.trigger("contextmenu:hide",{force:!0});try{q[b.ns].$menu&&q[b.ns].$menu.remove(),delete q[b.ns]}catch(e){q[b.ns]=null}g(b.context).off(b.ns);return!0})}else if(!e.selector)d.off(".contextMenu .contextMenuAutoHide"),g.each(q,function(a,b){g(b.context).off(b.ns)}),p={},q={},n=0,k=!1,g("#context-menu-layer, .context-menu-list").remove();else if(p[e.selector]){v=
g(".context-menu-list").filter(":visible");v.length&&v.data().contextMenuRoot.$trigger.is(e.selector)&&v.trigger("contextmenu:hide",{force:!0});try{q[p[e.selector]].$menu&&q[p[e.selector]].$menu.remove(),delete q[p[e.selector]]}catch(z){q[p[e.selector]]=null}d.off(p[e.selector])}break;case "html5":(!g.support.htmlCommand&&!g.support.htmlMenuitem||"boolean"==typeof b&&b)&&g('menu[type="context"]').each(function(){this.id&&g.contextMenu({selector:"[contextmenu="+this.id+"]",items:g.contextMenu.fromMenu(this)})}).css("display",
"none");break;default:throw Error('Unknown operation "'+a+'"');}return this};g.contextMenu.setInputValues=function(a,b){b===f&&(b={});g.each(a.inputs,function(a,e){switch(e.type){case "text":case "textarea":e.value=b[a]||"";break;case "checkbox":e.selected=b[a]?!0:!1;break;case "radio":e.selected=(b[e.radio]||"")==e.value?!0:!1;break;case "select":e.selected=b[a]||""}})};g.contextMenu.getInputValues=function(a,b){b===f&&(b={});g.each(a.inputs,function(a,e){switch(e.type){case "text":case "textarea":case "select":b[a]=
e.$input.val();break;case "checkbox":b[a]=e.$input.prop("checked");break;case "radio":e.$input.prop("checked")&&(b[e.radio]=e.value)}});return b};g.contextMenu.fromMenu=function(b){b=g(b);var e={};a(e,b.children());return e};g.contextMenu.defaults=w;g.contextMenu.types=t;g.contextMenu.handle=x;g.contextMenu.op=B;g.contextMenu.menus=q})(jQuery);!function(){function g(h,a){return a>h?-1:h>a?1:h>=a?0:0/0}function f(h){return null===h?0/0:+h}function d(h){return!isNaN(h)}function b(h){return{left:function(a,b,e,d){3>arguments.length&&(e=0);for(4>arguments.length&&(d=a.length);d>e;){var A=e+d>>>1;0>h(a[A],b)?e=A+1:d=A}return e},right:function(a,b,e,d){3>arguments.length&&(e=0);for(4>arguments.length&&(d=a.length);d>e;){var A=e+d>>>1;0<h(a[A],b)?d=A:e=A+1}return e}}}function a(h){return h.length}function e(h,a){for(var b in a)Object.defineProperty(h.prototype,
b,{value:a[b],enumerable:!1})}function l(){this._=Object.create(null)}function k(h){return(h+="")===ug||h[0]===Gc?Gc+h:h}function m(h){return(h+="")[0]===Gc?h.slice(1):h}function n(h){return k(h)in this._}function p(h){return(h=k(h))in this._&&delete this._[h]}function q(){var h=[],a;for(a in this._)h.push(m(a));return h}function t(){var h=0,a;for(a in this._)++h;return h}function w(){for(var h in this._)return!1;return!0}function v(){this._=Object.create(null)}function z(h,a,b){return function(){var e=
b.apply(a,arguments);return e===a?h:e}}function I(h,a){if(a in h)return a;a=a.charAt(0).toUpperCase()+a.slice(1);for(var b=0,e=Ud.length;e>b;++b){var d=Ud[b]+a;if(d in h)return d}}function J(){}function Z(){}function x(h){function a(){for(var y,e=b,d=-1,H=e.length;++d<H;)(y=e[d].on)&&y.apply(this,arguments);return h}var b=[],e=new l;return a.on=function(a,y){var d,f=e.get(a);return 2>arguments.length?f&&f.on:(f&&(f.on=null,b=b.slice(0,d=b.indexOf(f)).concat(b.slice(d+1)),e.remove(a)),y&&b.push(e.set(a,
{on:y})),h)},a}function B(){r.event.preventDefault()}function L(){for(var h,a=r.event;h=a.sourceEvent;)a=h;return a}function C(h){for(var a=new Z,b=0,e=arguments.length;++b<e;)a[arguments[b]]=x(a);return a.of=function(b,F){return function(e){try{var d=e.sourceEvent=r.event;e.target=h;r.event=e;a[e.type].apply(b,F)}finally{r.event=d}}},a}function V(h){return Kb(h,U),h}function gb(h){return"function"==typeof h?h:function(){return Hc(h,this)}}function vb(h){return"function"==typeof h?h:function(){return Ic(h,
this)}}function Od(h,a){function b(){this.removeAttribute(h)}function e(){this.removeAttributeNS(h.space,h.local)}function d(){this.setAttribute(h,a)}function A(){this.setAttributeNS(h.space,h.local,a)}function f(){var b=a.apply(this,arguments);null==b?this.removeAttribute(h):this.setAttribute(h,b)}function g(){var b=a.apply(this,arguments);null==b?this.removeAttributeNS(h.space,h.local):this.setAttributeNS(h.space,h.local,b)}return h=r.ns.qualify(h),null==a?h.local?e:b:"function"==typeof a?h.local?
g:f:h.local?A:d}function Pd(h){return h.trim().replace(/\s+/g," ")}function Qd(h){return new RegExp("(?:^|\\s+)"+r.requote(h)+"(?:\\s+|$)","g")}function Rd(h,a){function b(){for(var F=-1;++F<d;)h[F](this,a)}function e(){for(var b=-1,F=a.apply(this,arguments);++b<d;)h[b](this,F)}h=(h+"").trim().split(/^|\s+/).map(tg);var d=h.length;return"function"==typeof a?e:b}function tg(h){var a=Qd(h);return function(b,e){if(d=b.classList)return e?d.add(h):d.remove(h);var d=b.getAttribute("class")||"";e?(a.lastIndex=
0,a.test(d)||b.setAttribute("class",Pd(d+" "+h))):b.setAttribute("class",Pd(d.replace(a," ")))}}function Sd(h,a,b){function e(){this.style.removeProperty(h)}function d(){this.style.setProperty(h,a,b)}function A(){var e=a.apply(this,arguments);null==e?this.style.removeProperty(h):this.style.setProperty(h,e,b)}return null==a?e:"function"==typeof a?A:d}function Td(h,a){function b(){delete this[h]}function e(){this[h]=a}function d(){var b=a.apply(this,arguments);null==b?delete this[h]:this[h]=b}return null==
a?b:"function"==typeof a?d:e}function Wd(h){return"function"==typeof h?h:(h=r.ns.qualify(h)).local?function(){return this.ownerDocument.createElementNS(h.space,h.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,h)}}function Xd(h){return function(){return Yd(this,h)}}function vg(h){return arguments.length||(h=g),function(a,b){return a&&b?h(a.__data__,b.__data__):!a-!b}}function W(h,a){for(var b=0,e=h.length;e>b;b++)for(var d,A=h[b],f=0,g=A.length;g>f;f++)(d=A[f])&&a(d,
f,b);return h}function T(h){return Kb(h,Ea),h}function na(h){var a,b;return function(e,d,A){e=h[A].update;var f=e.length;A!=b&&(b=A,a=0);for(d>=a&&(a=d+1);!(d=e[a])&&++a<f;);return d}}function Fa(){var h=this.__transition__;h&&++h.active}function Zd(h,a,b){function e(){var a=this[f];a&&(this.removeEventListener(h,a,a.$),delete this[f])}function d(){var A=l(a,Oa(arguments));e.call(this);this.addEventListener(h,this[f]=A,A.$=b);A._=a}function A(){var a,b=new RegExp("^__on([^.]+)"+r.requote(h)+"$"),
y;for(y in this)if(a=y.match(b)){var e=this[y];this.removeEventListener(a[1],e,e.$);delete this[y]}}var f="__on"+h,g=h.indexOf("."),l=$d;0<g&&(h=h.slice(0,g));var P=Jc.get(h);return P&&(h=P,l=wg),g?a?d:e:a?J:A}function $d(h,a){return function(b){var e=r.event;r.event=b;a[0]=this.__data__;try{h.apply(this,a)}finally{r.event=e}}}function wg(h,a){var b=$d(h,a);return function(h){var a=h.relatedTarget;a&&(a===this||8&a.compareDocumentPosition(this))||b.call(this,h)}}function Lb(){var h=".dragsuppress-"+
++xg,a="click"+h,b=r.select(ja).on("touchmove"+h,B).on("dragstart"+h,B).on("selectstart"+h,B);if(wb){var e=Ga.style,d=e[wb];e[wb]="none"}return function(A){function f(){b.on(a,null)}b.on(h,null);wb&&(e[wb]=d);A&&(b.on(a,function(){B();f()},!0),setTimeout(f,0))}}function Kc(h,a){a.changedTouches&&(a=a.changedTouches[0]);var b=h.ownerSVGElement||h;if(b.createSVGPoint){var e=b.createSVGPoint();if(0>Lc&&(ja.scrollX||ja.scrollY)){var b=r.select("body").append("svg").style({position:"absolute",top:0,left:0,
margin:0,padding:0,border:"none"},"important"),d=b[0][0].getScreenCTM();Lc=!(d.f||d.e);b.remove()}return Lc?(e.x=a.pageX,e.y=a.pageY):(e.x=a.clientX,e.y=a.clientY),e=e.matrixTransform(h.getScreenCTM().inverse()),[e.x,e.y]}b=h.getBoundingClientRect();return[a.clientX-b.left-h.clientLeft,a.clientY-b.top-h.clientTop]}function yg(){return r.event.changedTouches[0].identifier}function zg(){return r.event.target}function Ag(){return ja}function Mc(h,a,b){return(a[0]-h[0])*(b[1]-h[1])-(a[1]-h[1])*(b[0]-
h[0])}function ae(h){return 1<h?0:-1>h?K:Math.acos(h)}function hb(h){return 1<h?ha:-1>h?-ha:Math.asin(h)}function be(h){return((h=Math.exp(h))+1/h)/2}function ce(h){return(h=Math.sin(h/2))*h}function Xa(){}function Aa(h,a,b){return this instanceof Aa?(this.h=+h,this.s=+a,void(this.l=+b)):2>arguments.length?h instanceof Aa?new Aa(h.h,h.s,h.l):de(""+h,ee,Aa):new Aa(h,a,b)}function Nc(h,a,b){function e(h){return 360<h?h-=360:0>h&&(h+=360),60>h?d+(A-d)*h/60:180>h?A:240>h?d+(A-d)*(240-h)/60:d}var d,A;
return h=isNaN(h)?0:0>(h%=360)?h+360:h,a=isNaN(a)?0:0>a?0:1<a?1:a,b=0>b?0:1<b?1:b,A=.5>=b?b*(1+a):b+a-b*a,d=2*b-A,new ka(Math.round(255*e(h+120)),Math.round(255*e(h)),Math.round(255*e(h-120)))}function va(h,a,b){return this instanceof va?(this.h=+h,this.c=+a,void(this.l=+b)):2>arguments.length?h instanceof va?new va(h.h,h.c,h.l):h instanceof wa?fe(h.l,h.a,h.b):fe((h=ge((h=r.rgb(h)).r,h.g,h.b)).l,h.a,h.b):new va(h,a,b)}function Oc(h,a,b){return isNaN(h)&&(h=0),isNaN(a)&&(a=0),new wa(b,Math.cos(h*=
G)*a,Math.sin(h)*a)}function wa(h,a,b){return this instanceof wa?(this.l=+h,this.a=+a,void(this.b=+b)):2>arguments.length?h instanceof wa?new wa(h.l,h.a,h.b):h instanceof va?Oc(h.h,h.c,h.l):ge((h=ka(h)).r,h.g,h.b):new wa(h,a,b)}function he(h,a,b){h=(h+16)/116;a=h+a/500;b=h-b/200;return a=Pc(a)*ie,h=Pc(h)*je,b=Pc(b)*ke,new ka(Qc(3.2404542*a-1.5371385*h-.4985314*b),Qc(-.969266*a+1.8760108*h+.041556*b),Qc(.0556434*a-.2040259*h+1.0572252*b))}function fe(h,a,b){return 0<h?new va(Math.atan2(b,a)*aa,Math.sqrt(a*
a+b*b),h):new va(0/0,0/0,h)}function Pc(h){return.206893034<h?h*h*h:(h-4/29)/7.787037}function Rc(h){return.008856<h?Math.pow(h,1/3):7.787037*h+4/29}function Qc(h){return Math.round(255*(.00304>=h?12.92*h:1.055*Math.pow(h,1/2.4)-.055))}function ka(h,a,b){return this instanceof ka?(this.r=~~h,this.g=~~a,void(this.b=~~b)):2>arguments.length?h instanceof ka?new ka(h.r,h.g,h.b):de(""+h,ka,Nc):new ka(h,a,b)}function Mb(h){return new ka(h>>16,255&h>>8,255&h)+""}function ib(h){return 16>h?"0"+Math.max(0,
h).toString(16):Math.min(255,h).toString(16)}function de(h,a,b){var e,d,A,f=0,g=0,l=0;if(e=/([a-z]+)\((.*)\)/i.exec(h))switch(d=e[2].split(","),e[1]){case "hsl":return b(parseFloat(d[0]),parseFloat(d[1])/100,parseFloat(d[2])/100);case "rgb":return a(Sc(d[0]),Sc(d[1]),Sc(d[2]))}return(A=Nb.get(h))?a(A.r,A.g,A.b):(null==h||"#"!==h.charAt(0)||isNaN(A=parseInt(h.slice(1),16))||(4===h.length?(f=(3840&A)>>4,f|=f>>4,g=240&A,g|=g>>4,l=15&A,l|=l<<4):7===h.length&&(f=(16711680&A)>>16,g=(65280&A)>>8,l=255&A)),
a(f,g,l))}function ee(h,a,b){var e,d,A=Math.min(h/=255,a/=255,b/=255),f=Math.max(h,a,b),g=f-A,l=(f+A)/2;return g?(d=.5>l?g/(f+A):g/(2-f-A),e=h==f?(a-b)/g+(b>a?6:0):a==f?(b-h)/g+2:(h-a)/g+4,e*=60):(e=0/0,d=0<l&&1>l?0:e),new Aa(e,d,l)}function ge(h,a,b){h=Tc(h);a=Tc(a);b=Tc(b);var e=Rc((.4124564*h+.3575761*a+.1804375*b)/ie),d=Rc((.2126729*h+.7151522*a+.072175*b)/je);h=Rc((.0193339*h+.119192*a+.9503041*b)/ke);return wa(116*d-16,500*(e-d),200*(d-h))}function Tc(h){return.04045>=(h/=255)?h/12.92:Math.pow((h+
.055)/1.055,2.4)}function Sc(h){var a=parseFloat(h);return"%"===h.charAt(h.length-1)?Math.round(2.55*a):a}function Y(h){return"function"==typeof h?h:function(){return h}}function ga(h){return h}function Uc(h){return function(a,b,e){return 2===arguments.length&&"function"==typeof b&&(e=b,b=null),Ob(a,b,h,e)}}function Ob(h,a,b,e){function d(){var h,a=l.status,y;if(y=!a)y=(y=l.responseType)&&"text"!==y?l.response:l.responseText;if(y||200<=a&&300>a||304===a){try{h=b.call(A,l)}catch(e){return f.error.call(A,
e),void 0}f.load.call(A,h)}else f.error.call(A,l)}var A={},f=r.dispatch("beforesend","progress","load","error"),g={},l=new XMLHttpRequest,P=null;return!ja.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(h)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=d:l.onreadystatechange=function(){3<l.readyState&&d()},l.onprogress=function(h){var a=r.event;r.event=h;try{f.progress.call(A,l)}finally{r.event=a}},A.header=function(h,a){return h=(h+"").toLowerCase(),2>arguments.length?g[h]:
(null==a?delete g[h]:g[h]=a+"",A)},A.mimeType=function(h){return arguments.length?(a=null==h?null:h+"",A):a},A.responseType=function(h){return arguments.length?(P=h,A):P},A.response=function(h){return b=h,A},["get","post"].forEach(function(h){A[h]=function(){return A.send.apply(A,[h].concat(Oa(arguments)))}}),A.send=function(b,e,F){if(2===arguments.length&&"function"==typeof e&&(F=e,e=null),l.open(b,h,!0),null==a||"accept"in g||(g.accept=a+",*/*"),l.setRequestHeader)for(var d in g)l.setRequestHeader(d,
g[d]);return null!=a&&l.overrideMimeType&&l.overrideMimeType(a),null!=P&&(l.responseType=P),null!=F&&A.on("error",F).on("load",function(h){F(null,h)}),f.beforesend.call(A,l),l.send(null==e?null:e),A},A.abort=function(){return l.abort(),A},r.rebind(A,f,"on"),null==e?A:A.get(Bg(e))}function Bg(h){return 1===h.length?function(a,b){h(null==a?b:null)}:h}function Vc(){var h=le(),h=me()-h;24<h?(isFinite(h)&&(clearTimeout(Pb),Pb=setTimeout(Vc,h)),Qb=0):(Qb=1,ne(Vc))}function le(){var h=Date.now();for(Ha=
Rb;Ha;)h>=Ha.t&&(Ha.f=Ha.c(h-Ha.t)),Ha=Ha.n;return h}function me(){for(var h,a=Rb,b=1/0;a;)a.f?a=h?h.n=a.n:Rb=a.n:(a.t<b&&(b=a.t),a=(h=a).n);return Sb=h,b}function Wc(h,a){return a-(h?Math.ceil(Math.log(h)/Math.LN10):1)}function Cg(h){var a=h.decimal,b=h.thousands,e=h.grouping,d=h.currency,A=e&&b?function(h,a){for(var y=h.length,d=[],A=0,f=e[0],M=0;0<y&&0<f&&(M+f+1>a&&(f=Math.max(1,a-M)),d.push(h.substring(y-=f,y+f)),!((M+=f+1)>a));)f=e[A=(A+1)%e.length];return d.reverse().join(b)}:ga;return function(h){h=
oe.exec(h);var b=h[1]||" ",e=h[2]||">",F=h[3]||"-",H=h[4]||"",f=h[5],g=+h[6],l=h[7],k=h[8],m=h[9],n=1,p="",q="",O=!1,v=!0;switch(k&&(k=+k.substring(1)),(f||"0"===b&&"="===e)&&(f=b="0",e="="),m){case "n":l=!0;m="g";break;case "%":n=100;q="%";m="f";break;case "p":n=100;q="%";m="r";break;case "b":case "o":case "x":case "X":"#"===H&&(p="0"+m.toLowerCase());case "c":v=!1;case "d":O=!0;k=0;break;case "s":n=-1,m="r"}"$"===H&&(p=d[0],q=d[1]);"r"!=m||k||(m="g");null!=k&&("g"==m?k=Math.max(1,Math.min(21,k)):
("e"==m||"f"==m)&&(k=Math.max(0,Math.min(20,k))));var m=Dg.get(m)||Eg,x=f&&l;return function(h){var d=q;if(O&&h%1)return"";var H=0>h||0===h&&0>1/h?(h=-h,"-"):"-"===F?"":F;0>n?(d=r.formatPrefix(h,k),h=d.scale(h),d=d.symbol+q):h*=n;h=m(h,k);var M,fa,X=h.lastIndexOf(".");0>X?(X=v?h.lastIndexOf("e"):-1,0>X?(M=h,fa=""):(M=h.substring(0,X),fa=h.substring(X))):(M=h.substring(0,X),fa=a+h.substring(X+1));!f&&l&&(M=A(M,1/0));var X=p.length+M.length+fa.length+(x?0:H.length),t=g>X?Array(X=g-X+1).join(b):"";return x&&
(M=A(t+M,t.length?g-fa.length:1/0)),H+=p,h=M+fa,("<"===e?H+h+t:">"===e?t+H+h:"^"===e?t.substring(0,X>>=1)+H+h+t.substring(X):H+(x?h:t+h))+d}}}function Eg(h){return h+""}function Ja(){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):arguments[0])}function Ya(h,a,b){function e(a){var b=h(a),y=A(b,1);return y-a>a-b?b:y}function d(b){return a(b=h(new ia(b-1)),1),b}function A(h,b){return a(h=new ia(+h),b),h}function f(h,e,A){h=d(h);var H=[];if(1<A)for(;e>h;)b(h)%A||H.push(new Date(+h)),
a(h,1);else for(;e>h;)H.push(new Date(+h)),a(h,1);return H}h.floor=h;h.round=e;h.ceil=d;h.offset=A;h.range=f;var g=h.utc=Tb(h);return g.floor=g,g.round=Tb(e),g.ceil=Tb(d),g.offset=Tb(A),g.range=function(h,a,b){try{ia=Ja;var y=new Ja;return y._=h,f(y,a,b)}finally{ia=Date}},h}function Tb(h){return function(a,b){try{ia=Ja;var e=new Ja;return e._=a,h(e,b)._}finally{ia=Date}}}function Fg(h){function a(h){function y(a){for(var b,F,d,A=[],H=-1,f=0;++H<e;)37===h.charCodeAt(H)&&(A.push(h.slice(f,H)),null!=
(F=qe[b=h.charAt(++H)])&&(b=h.charAt(++H)),(d=t[b])&&(b=d(a,null==F?"e"===b?" ":"0":F)),A.push(b),f=H+1);return A.push(h.slice(f,H)),A.join("")}var e=h.length;return y.parse=function(a){var y={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(b(y,h,a,0)!=a.length)return null;"p"in y&&(y.H=y.H%12+12*y.p);a=null!=y.Z&&ia!==Ja;var e=new (a?Ja:ia);return"j"in y?e.setFullYear(y.y,0,y.j):"w"in y&&("W"in y||"U"in y)?(e.setFullYear(y.y,0,1),e.setFullYear(y.y,0,"W"in y?(y.w+6)%7+7*y.W-(e.getDay()+5)%7:y.w+7*y.U-(e.getDay()+
6)%7)):e.setFullYear(y.y,y.m,y.d),e.setHours(y.H+(0|y.Z/100),y.M+y.Z%100,y.S,y.L),a?e._:e},y.toString=function(){return h},y}function b(h,a,y,e){for(var F,d,A,H=0,f=a.length,M=y.length;f>H;){if(e>=M)return-1;if(F=a.charCodeAt(H++),37===F){if(A=a.charAt(H++),d=w[A in qe?a.charAt(H++):A],!d||0>(e=d(h,y,e)))return-1}else if(F!=y.charCodeAt(e++))return-1}return e}var e=h.dateTime,d=h.date,A=h.time,f=h.periods,g=h.days,l=h.shortDays,P=h.months,k=h.shortMonths;a.utc=function(h){function b(h){try{ia=Ja;
var a=new ia;return a._=h,e(a)}finally{ia=Date}}var e=a(h);return b.parse=function(h){try{ia=Ja;var a=e.parse(h);return a&&a._}finally{ia=Date}},b.toString=e.toString,b};a.multi=a.utc.multi=Gg;var m=r.map(),n=Ub(g),p=Vb(g),q=Ub(l),ra=Vb(l),v=Ub(P),Ia=Vb(P),x=Ub(k),O=Vb(k);f.forEach(function(h,a){m.set(h.toLowerCase(),a)});var t={a:function(h){return l[h.getDay()]},A:function(h){return g[h.getDay()]},b:function(h){return k[h.getMonth()]},B:function(h){return P[h.getMonth()]},c:a(e),d:function(h,a){return la(h.getDate(),
a,2)},e:function(h,a){return la(h.getDate(),a,2)},H:function(h,a){return la(h.getHours(),a,2)},I:function(h,a){return la(h.getHours()%12||12,a,2)},j:function(h,a){return la(1+D.dayOfYear(h),a,3)},L:function(h,a){return la(h.getMilliseconds(),a,3)},m:function(h,a){return la(h.getMonth()+1,a,2)},M:function(h,a){return la(h.getMinutes(),a,2)},p:function(h){return f[+(12<=h.getHours())]},S:function(h,a){return la(h.getSeconds(),a,2)},U:function(h,a){return la(D.sundayOfYear(h),a,2)},w:function(h){return h.getDay()},
W:function(h,a){return la(D.mondayOfYear(h),a,2)},x:a(d),X:a(A),y:function(h,a){return la(h.getFullYear()%100,a,2)},Y:function(h,a){return la(h.getFullYear()%1E4,a,4)},Z:Hg,"%":function(){return"%"}},w={a:function(h,a,b){q.lastIndex=0;return(a=q.exec(a.slice(b)))?(h.w=ra.get(a[0].toLowerCase()),b+a[0].length):-1},A:function(h,a,b){n.lastIndex=0;return(a=n.exec(a.slice(b)))?(h.w=p.get(a[0].toLowerCase()),b+a[0].length):-1},b:function(h,a,b){x.lastIndex=0;return(a=x.exec(a.slice(b)))?(h.m=O.get(a[0].toLowerCase()),
b+a[0].length):-1},B:function(h,a,b){v.lastIndex=0;return(a=v.exec(a.slice(b)))?(h.m=Ia.get(a[0].toLowerCase()),b+a[0].length):-1},c:function(h,a,y){return b(h,t.c.toString(),a,y)},d:re,e:re,H:se,I:se,j:Ig,L:Jg,m:Kg,M:Lg,p:function(h,a,b){a=m.get(a.slice(b,b+=2).toLowerCase());return null==a?-1:(h.p=a,b)},S:Mg,U:Ng,w:Og,W:Pg,x:function(h,a,y){return b(h,t.x.toString(),a,y)},X:function(h,a,y){return b(h,t.X.toString(),a,y)},y:Qg,Y:Rg,Z:Sg,"%":Tg};return a}function la(h,a,b){var e=0>h?"-":"";h=(e?-h:
h)+"";var d=h.length;return e+(b>d?Array(b-d+1).join(a)+h:h)}function Ub(h){return new RegExp("^(?:"+h.map(r.requote).join("|")+")","i")}function Vb(h){for(var a=new l,b=-1,e=h.length;++b<e;)a.set(h[b].toLowerCase(),b);return a}function Og(h,a,b){ba.lastIndex=0;return(a=ba.exec(a.slice(b,b+1)))?(h.w=+a[0],b+a[0].length):-1}function Ng(h,a,b){ba.lastIndex=0;return(a=ba.exec(a.slice(b)))?(h.U=+a[0],b+a[0].length):-1}function Pg(h,a,b){ba.lastIndex=0;return(a=ba.exec(a.slice(b)))?(h.W=+a[0],b+a[0].length):
-1}function Rg(h,a,b){ba.lastIndex=0;return(a=ba.exec(a.slice(b,b+4)))?(h.y=+a[0],b+a[0].length):-1}function Qg(h,a,b){ba.lastIndex=0;if(a=ba.exec(a.slice(b,b+2))){var e=+a[0];h=(h.y=e+(68<e?1900:2E3),b+a[0].length)}else h=-1;return h}function Sg(h,a,b){return/^[+-]\d{4}$/.test(a=a.slice(b,b+5))?(h.Z=-a,b+5):-1}function Kg(h,a,b){ba.lastIndex=0;return(a=ba.exec(a.slice(b,b+2)))?(h.m=a[0]-1,b+a[0].length):-1}function re(h,a,b){ba.lastIndex=0;return(a=ba.exec(a.slice(b,b+2)))?(h.d=+a[0],b+a[0].length):
-1}function Ig(h,a,b){ba.lastIndex=0;return(a=ba.exec(a.slice(b,b+3)))?(h.j=+a[0],b+a[0].length):-1}function se(h,a,b){ba.lastIndex=0;return(a=ba.exec(a.slice(b,b+2)))?(h.H=+a[0],b+a[0].length):-1}function Lg(h,a,b){ba.lastIndex=0;return(a=ba.exec(a.slice(b,b+2)))?(h.M=+a[0],b+a[0].length):-1}function Mg(h,a,b){ba.lastIndex=0;return(a=ba.exec(a.slice(b,b+2)))?(h.S=+a[0],b+a[0].length):-1}function Jg(h,a,b){ba.lastIndex=0;return(a=ba.exec(a.slice(b,b+3)))?(h.L=+a[0],b+a[0].length):-1}function Hg(h){var a=
h.getTimezoneOffset();h=0<a?"-":"+";var b=0|N(a)/60,a=N(a)%60;return h+la(b,"0",2)+la(a,"0",2)}function Tg(h,a,b){te.lastIndex=0;return(h=te.exec(a.slice(b,b+1)))?b+h[0].length:-1}function Gg(h){for(var a=h.length,b=-1;++b<a;)h[b][0]=this(h[b][0]);return function(a){for(var b=0,y=h[b];!y[1](a);)y=h[++b];return y[0](a)}}function Xc(){}function ue(h,a,b){var e=b.s=h+a,d=e-h;b.t=h-(e-d)+(a-d)}function Wb(h,a){h&&ve.hasOwnProperty(h.type)&&ve[h.type](h,a)}function Yc(h,a,b){var e=-1,d=h.length-b;for(a.lineStart();++e<
d;)b=h[e],a.point(b[0],b[1],b[2]);a.lineEnd()}function we(h,a){var b=-1,e=h.length;for(a.polygonStart();++b<e;)Yc(h[b],a,1);a.polygonEnd()}function Ug(){function h(h,a){h*=G;a=a*G/2+K/4;var b=h-e,y=0<=b?1:-1,F=y*b,b=Math.cos(a),f=Math.sin(a),g=A*f,l=d*b+g*Math.cos(F),y=g*y*Math.sin(F);Za.add(Math.atan2(y,l));e=h;d=b;A=f}var a,b,e,d,A;oa.point=function(f,g){oa.point=h;e=(a=f)*G;d=Math.cos(g=(b=g)*G/2+K/4);A=Math.sin(g)};oa.lineEnd=function(){h(a,b)}}function $a(h){var a=h[0];h=h[1];var b=Math.cos(h);
return[b*Math.cos(a),b*Math.sin(a),Math.sin(h)]}function Xb(h,a){return h[0]*a[0]+h[1]*a[1]+h[2]*a[2]}function kb(h,a){return[h[1]*a[2]-h[2]*a[1],h[2]*a[0]-h[0]*a[2],h[0]*a[1]-h[1]*a[0]]}function Zc(h,a){h[0]+=a[0];h[1]+=a[1];h[2]+=a[2]}function Yb(h,a){return[h[0]*a,h[1]*a,h[2]*a]}function Zb(h){var a=Math.sqrt(h[0]*h[0]+h[1]*h[1]+h[2]*h[2]);h[0]/=a;h[1]/=a;h[2]/=a}function $b(h){return[Math.atan2(h[1],h[0]),hb(h[2])]}function ac(h,a){return N(h[0]-a[0])<E&&N(h[1]-a[1])<E}function $c(h,a){h*=G;var b=
Math.cos(a*=G);xb(b*Math.cos(h),b*Math.sin(h),Math.sin(a))}function xb(h,a,b){++yb;Ka+=(h-Ka)/yb;La+=(a-La)/yb;Ba+=(b-Ba)/yb}function xe(){function h(h,d){h*=G;var f=Math.cos(d*=G),g=f*Math.cos(h),f=f*Math.sin(h),l=Math.sin(d),k=Math.atan2(Math.sqrt((k=b*l-e*f)*k+(k=e*g-a*l)*k+(k=a*f-b*g)*k),a*g+b*f+e*l);lb+=k;sa+=k*(a+(a=g));ta+=k*(b+(b=f));ma+=k*(e+(e=l));xb(a,b,e)}var a,b,e;xa.point=function(d,f){d*=G;var g=Math.cos(f*=G);a=g*Math.cos(d);b=g*Math.sin(d);e=Math.sin(f);xa.point=h;xb(a,b,e)}}function ye(){xa.point=
$c}function Vg(){function h(h,a){h*=G;var b=Math.cos(a*=G),y=b*Math.cos(h),b=b*Math.sin(h),F=Math.sin(a),g=d*F-f*b,l=f*y-e*F,k=e*b-d*y,m=Math.sqrt(g*g+l*l+k*k),n=e*y+d*b+f*F,p=m&&-ae(n)/m,m=Math.atan2(m,n);Ra+=p*g;Sa+=p*l;Ca+=p*k;lb+=m;sa+=m*(e+(e=y));ta+=m*(d+(d=b));ma+=m*(f+(f=F));xb(e,d,f)}var a,b,e,d,f;xa.point=function(g,l){a=g;b=l;xa.point=h;g*=G;var k=Math.cos(l*=G);e=k*Math.cos(g);d=k*Math.sin(g);f=Math.sin(l);xb(e,d,f)};xa.lineEnd=function(){h(a,b);xa.lineEnd=ye;xa.point=$c}}function mb(){return!0}
function ze(h,a,b,e,d){var f=[],g=[];if(h.forEach(function(h){if(!(0>=(a=h.length-1))){var a,b=h[0],e=h[a];if(ac(b,e)){d.lineStart();for(e=0;a>e;++e)d.point((b=h[e])[0],b[1]);return d.lineEnd(),void 0}a=new bc(b,h,null,!0);b=new bc(b,null,a,!1);a.o=b;f.push(a);g.push(b);a=new bc(e,h,null,!1);b=new bc(e,null,a,!0);a.o=b;f.push(a);g.push(b)}}),g.sort(a),Ae(f),Ae(g),f.length){h=0;a=b;for(b=g.length;b>h;++h)g[h].e=a=!a;for(var l,k=f[0];;){for(var P=k,m=!0;P.v;)if((P=P.n)===k)return;a=P.z;d.lineStart();
do{if(P.v=P.o.v=!0,P.e){if(m)for(h=0,b=a.length;b>h;++h)d.point((l=a[h])[0],l[1]);else e(P.x,P.n.x,1,d);P=P.n}else{if(m)for(a=P.p.z,h=a.length-1;0<=h;--h)d.point((l=a[h])[0],l[1]);else e(P.x,P.p.x,-1,d);P=P.p}P=P.o;a=P.z;m=!m}while(!P.v);d.lineEnd()}}}function Ae(h){if(a=h.length){for(var a,b,e=0,d=h[0];++e<a;)d.n=b=h[e],b.p=d,d=b;d.n=b=h[0];b.p=d}}function bc(h,a,b,e){this.x=h;this.z=a;this.o=b;this.e=e;this.v=!1;this.n=this.p=null}function Be(h,a,b,e){return function(d,f){function g(a,b){var e=
d(a,b);h(a=e[0],b=e[1])&&f.point(a,b)}function l(h,a){var b=d(h,a);v.point(b[0],b[1])}function k(){R.point=l;v.lineStart()}function P(){R.point=g;v.lineEnd()}function m(h,a){ra.push([h,a]);var b=d(h,a);t.point(b[0],b[1])}function n(){t.lineStart();ra=[]}function S(){m(ra[0][0],ra[0][1]);t.lineEnd();var h;h=t.clean();var a=O.buffer(),b=a.length;if(ra.pop(),q.push(ra),ra=null,b)if(1&h){h=a[0];var e,b=h.length-1,a=-1;if(0<b){w||(f.polygonStart(),w=!0);for(f.lineStart();++a<b;)f.point((e=h[a])[0],e[1]);
f.lineEnd()}}else 1<b&&2&h&&a.push(a.pop().concat(a.shift())),p.push(a.filter(Wg))}var p,q,ra,v=a(f),x=d.invert(e[0],e[1]),R={point:g,lineStart:k,lineEnd:P,polygonStart:function(){R.point=m;R.lineStart=n;R.lineEnd=S;p=[];q=[]},polygonEnd:function(){R.point=g;R.lineStart=k;R.lineEnd=P;p=r.merge(p);var h,a=x;h=q;var e=a[0],y=a[1],d=[Math.sin(e),-Math.cos(e),0],H=0,M=0;Za.reset();for(var l=0,ea=h.length;ea>l;++l){var m=h[l],n=m.length;if(n)for(var X=m[0],S=X[0],a=X[1]/2+K/4,Pa=Math.sin(a),ra=Math.cos(a),
O=1;;){O===n&&(O=0);var a=m[O],v=a[0],t=a[1]/2+K/4,pe=Math.sin(t),t=Math.cos(t),ca=v-S,z=0<=ca?1:-1,C=z*ca,B=C>K,Pa=Pa*pe;if(Za.add(Math.atan2(Pa*z*Math.sin(C),ra*t+Pa*Math.cos(C))),H+=B?ca+z*pa:ca,B^S>=e^v>=e)X=kb($a(X),$a(a)),Zb(X),S=kb(d,X),Zb(S),S=(B^0<=ca?-1:1)*hb(S[2]),(y>S||y===S&&(X[0]||X[1]))&&(M+=B^0<=ca?1:-1);if(!O++)break;S=v;Pa=pe;ra=t;X=a}}h=(-E>H||E>H&&0>Za)^1&M;p.length?(w||(f.polygonStart(),w=!0),ze(p,Xg,h,b,f)):h&&(w||(f.polygonStart(),w=!0),f.lineStart(),b(null,null,1,f),f.lineEnd());
w&&(f.polygonEnd(),w=!1);p=q=null},sphere:function(){f.polygonStart();f.lineStart();b(null,null,1,f);f.lineEnd();f.polygonEnd()}},O=Ce(),t=a(O),w=!1;return R}}function Wg(h){return 1<h.length}function Ce(){var h,a=[];return{lineStart:function(){a.push(h=[])},point:function(a,b){h.push([a,b])},lineEnd:J,buffer:function(){var b=a;return a=[],h=null,b},rejoin:function(){1<a.length&&a.push(a.pop().concat(a.shift()))}}}function Xg(h,a){return(0>(h=h.x)[0]?h[1]-ha-E:ha-h[1])-(0>(a=a.x)[0]?a[1]-ha-E:ha-
a[1])}function Yg(h){function a(h,b){return Math.cos(h)*Math.cos(b)>d}function b(h,a,e){var y=$a(h),F=$a(a),f=[1,0,0],F=kb(y,F),A=Xb(F,F),y=F[0],H=A-y*y;if(!H)return!e&&h;A=d*A/H;H=-d*y/H;y=kb(f,F);f=Yb(f,A);F=Yb(F,H);Zc(f,F);F=Xb(f,y);A=Xb(y,y);H=F*F-A*(Xb(f,f)-1);if(!(0>H)){var g=Math.sqrt(H),H=Yb(y,(-F-g)/A);if(Zc(H,f),H=$b(H),!e)return H;var l;e=h[0];var ea=a[0];h=h[1];a=a[1];e>ea&&(l=e,e=ea,ea=l);var k=ea-e,fa=N(k-K)<E,m=fa||E>k;if(!fa&&h>a&&(l=h,h=a,a=l),m?fa?0<h+a^H[1]<(N(H[0]-e)<E?h:a):h<=
H[1]&&H[1]<=a:k>K^(e<=H[0]&&H[0]<=ea))return l=Yb(y,(-F+g)/A),Zc(l,f),[H,$b(l)]}}function e(a,b){var y=f?h:K-h,d=0;return-y>a?d|=1:a>y&&(d|=2),-y>b?d|=4:b>y&&(d|=8),d}var d=Math.cos(h),f=0<d,g=N(d)>E,l=ad(h,6*G);return Be(a,function(h){var d,M,l,ea,k;return{lineStart:function(){ea=l=!1;k=1},point:function(m,n){var p,q=[m,n],r=a(m,n),O=f?r?0:e(m,n):r?e(m+(0>m?K:-K),n):0;if(!d&&(ea=l=r)&&h.lineStart(),r!==l&&(p=b(d,q),(ac(d,p)||ac(q,p))&&(q[0]+=E,q[1]+=E,r=a(q[0],q[1]))),r!==l)k=0,r?(h.lineStart(),
p=b(q,d),h.point(p[0],p[1])):(p=b(d,q),h.point(p[0],p[1]),h.lineEnd()),d=p;else if(g&&d&&f^r){var v;O&M||!(v=b(q,d,!0))||(k=0,f?(h.lineStart(),h.point(v[0][0],v[0][1]),h.point(v[1][0],v[1][1]),h.lineEnd()):(h.point(v[1][0],v[1][1]),h.lineEnd(),h.lineStart(),h.point(v[0][0],v[0][1])))}!r||d&&ac(d,q)||h.point(q[0],q[1]);d=q;l=r;M=O},lineEnd:function(){l&&h.lineEnd();d=null},clean:function(){return k|(ea&&l)<<1}}},l,f?[0,-h]:[-K,h-K])}function De(h,a,b,e){return function(d){var f,g=d.a,l=d.b,k=g.x,g=
g.y,m=0,n=1,p=l.x-k,l=l.y-g;if(f=h-k,p||!(0<f)){if(f/=p,0>p){if(m>f)return;n>f&&(n=f)}else if(0<p){if(f>n)return;f>m&&(m=f)}if(f=b-k,p||!(0>f)){if(f/=p,0>p){if(f>n)return;f>m&&(m=f)}else if(0<p){if(m>f)return;n>f&&(n=f)}if(f=a-g,l||!(0<f)){if(f/=l,0>l){if(m>f)return;n>f&&(n=f)}else if(0<l){if(f>n)return;f>m&&(m=f)}if(f=e-g,l||!(0>f)){if(f/=l,0>l){if(f>n)return;f>m&&(m=f)}else if(0<l){if(m>f)return;n>f&&(n=f)}return 0<m&&(d.a={x:k+m*p,y:g+m*l}),1>n&&(d.b={x:k+n*p,y:g+n*l}),d}}}}}}function Ee(h,a,b,
e){function d(e,f){return N(e[0]-h)<E?0<f?0:3:N(e[0]-b)<E?0<f?2:1:N(e[1]-a)<E?0<f?1:0:0<f?3:2}function f(h,a){return g(h.x,a.x)}function g(h,a){var b=d(h,1),e=d(a,1);return b!==e?b-e:0===b?a[1]-h[1]:1===b?h[0]-a[0]:2===b?h[1]-a[1]:a[0]-h[0]}return function(l){function k(f,A,l,ea){var m=0,P=0;if(null==f||(m=d(f,l))!==(P=d(A,l))||0>g(f,A)^0<l){do ea.point(0===m||3===m?h:b,1<m?e:a);while((m=(m+l+4)%4)!==P)}else ea.point(A[0],A[1])}function m(d,f){d>=h&&b>=d&&f>=a&&e>=f&&l.point(d,f)}function n(d,f){d=
Math.max(-cc,Math.min(cc,d));f=Math.max(-cc,Math.min(cc,f));var A=d>=h&&b>=d&&f>=a&&e>=f;if(S&&q.push([d,f]),w)v=d,x=f,t=A,w=!1,A&&(l.lineStart(),l.point(d,f));else if(A&&O)l.point(d,f);else{var g={a:{x:Ia,y:R},b:{x:d,y:f}};z(g)?(O||(l.lineStart(),l.point(g.a.x,g.a.y)),l.point(g.b.x,g.b.y),A||l.lineEnd(),Q=!1):A&&(l.lineStart(),l.point(d,f),Q=!1)}Ia=d;R=f;O=A}var p,S,q,v,x,t,Ia,R,O,w,Q,jb=l,Qa=Ce(),z=De(h,a,b,e),C={point:m,lineStart:function(){C.point=n;S&&S.push(q=[]);w=!0;O=!1;Ia=R=0/0},lineEnd:function(){p&&
(n(v,x),t&&O&&Qa.rejoin(),p.push(Qa.buffer()));C.point=m;O&&l.lineEnd()},polygonStart:function(){l=Qa;p=[];S=[];Q=!0},polygonEnd:function(){l=jb;p=r.merge(p);var a;a=[h,e];for(var b=0,y=S.length,d=a[1],F=0;y>F;++F)for(var g,M=1,m=S[F],fa=m.length,P=m[0];fa>M;++M)g=m[M],P[1]<=d?g[1]>d&&0<Mc(P,g,a)&&++b:g[1]<=d&&0>Mc(P,g,a)&&--b,P=g;a=0!==b;b=Q&&a;y=p.length;(b||y)&&(l.polygonStart(),b&&(l.lineStart(),k(null,null,1,l),l.lineEnd()),y&&ze(p,f,a,k,l),l.polygonEnd());p=S=q=null}};return C}}function Fe(h,
a){function b(e,d){return e=h(e,d),a(e[0],e[1])}return h.invert&&a.invert&&(b.invert=function(b,e){return b=a.invert(b,e),b&&h.invert(b[0],b[1])}),b}function bd(h){var a=0,b=K/3,e=cd(h);h=e(a,b);return h.parallels=function(h){return arguments.length?e(a=h[0]*K/180,b=h[1]*K/180):[a/K*180,b/K*180]},h}function Ge(h,a){function b(h,a){var e=Math.sqrt(f-2*d*Math.sin(a))/d;return[e*Math.sin(h*=d),g-e*Math.cos(h)]}var e=Math.sin(h),d=(e+Math.sin(a))/2,f=1+e*(2*d-e),g=Math.sqrt(f)/d;return b.invert=function(h,
a){var b=g-a;return[Math.atan2(h,b)/d,hb((f-(h*h+b*b)*d*d)/(2*d))]},b}function Zg(){function h(h,a){dc+=d*h-e*a;e=h;d=a}var a,b,e,d;Ta.point=function(f,g){Ta.point=h;a=e=f;b=d=g};Ta.lineEnd=function(){h(a,b)}}function $g(){function h(h,a){g.push("M",h,",",a,f)}function a(h,e){g.push("M",h,",",e);l.point=b}function b(h,a){g.push("L",h,",",a)}function e(){l.point=h}function d(){g.push("Z")}var f=He(4.5),g=[],l={point:h,lineStart:function(){l.point=a},lineEnd:e,polygonStart:function(){l.lineEnd=d},polygonEnd:function(){l.lineEnd=
e;l.point=h},pointRadius:function(h){return f=He(h),l},result:function(){if(g.length){var h=g.join("");return g=[],h}}};return l}function He(h){return"m0,"+h+"a"+h+","+h+" 0 1,1 0,"+-2*h+"a"+h+","+h+" 0 1,1 0,"+2*h+"z"}function ab(h,a){Ka+=h;La+=a;++Ba}function Ie(){function h(h,e){var d=h-a,f=e-b,d=Math.sqrt(d*d+f*f);sa+=d*(a+h)/2;ta+=d*(b+e)/2;ma+=d;ab(a=h,b=e)}var a,b;ya.point=function(e,d){ya.point=h;ab(a=e,b=d)}}function Je(){ya.point=ab}function ah(){function h(h,a){var b=h-e,y=a-d,b=Math.sqrt(b*
b+y*y);sa+=b*(e+h)/2;ta+=b*(d+a)/2;ma+=b;b=d*h-e*a;Ra+=b*(e+h);Sa+=b*(d+a);Ca+=3*b;ab(e=h,d=a)}var a,b,e,d;ya.point=function(f,g){ya.point=h;ab(a=e=f,b=d=g)};ya.lineEnd=function(){h(a,b)}}function bh(h){function a(b,e){h.moveTo(b,e);h.arc(b,e,g,0,pa)}function b(a,y){h.moveTo(a,y);l.point=e}function e(a,b){h.lineTo(a,b)}function d(){l.point=a}function f(){h.closePath()}var g=4.5,l={point:a,lineStart:function(){l.point=b},lineEnd:d,polygonStart:function(){l.lineEnd=f},polygonEnd:function(){l.lineEnd=
d;l.point=a},pointRadius:function(h){return g=h,l},result:J};return l}function Ke(h){function a(h){return(l?e:b)(h)}function b(a){return Le(a,function(b,e){b=h(b,e);a.point(b[0],b[1])})}function e(a){function b(e,y){e=h(e,y);a.point(e[0],e[1])}function y(){v=0/0;C.point=f;a.lineStart()}function f(b,e){var y=$a([b,e]),F=h(b,e);d(v,x,r,t,w,z,v=F[0],x=F[1],r=b,t=y[0],w=y[1],z=y[2],l,a);a.point(v,x)}function F(){C.point=b;a.lineEnd()}function H(){y();C.point=A;C.lineEnd=g}function A(h,a){f(k=h,a);m=v;
fa=x;n=t;p=w;q=z;C.point=f}function g(){d(v,x,r,t,w,z,m,fa,k,n,p,q,l,a);C.lineEnd=F;F()}var k,m,fa,n,p,q,r,v,x,t,w,z,C={point:b,lineStart:y,lineEnd:F,polygonStart:function(){a.polygonStart();C.lineStart=H},polygonEnd:function(){a.polygonEnd();C.lineStart=y}};return C}function d(a,b,e,y,F,H,l,k,m,ea,n,p,q,r){var v=l-a,x=k-b,t=v*v+x*x;if(t>4*f&&q--){var w=y+ea,C=F+n,z=H+p,B=Math.sqrt(w*w+C*C+z*z),T=Math.asin(z/=B),L=N(N(z)-1)<E||N(e-m)<E?(e+m)/2:Math.atan2(C,w),I=h(L,T),T=I[0],I=I[1],V=T-a,J=I-b,D=
x*V-v*J;(D*D/t>f||.3<N((v*V+x*J)/t-.5)||g>y*ea+F*n+H*p)&&(d(a,b,e,y,F,H,T,I,L,w/=B,C/=B,z,q,r),r.point(T,I),d(T,I,L,w,C,z,l,k,m,ea,n,p,q,r))}}var f=.5,g=Math.cos(30*G),l=16;return a.precision=function(h){return arguments.length?(l=0<(f=h*h)&&16,a):Math.sqrt(f)},a}function ch(h){var a=Ke(function(a,b){return h([a*aa,b*aa])});return function(h){return Me(a(h))}}function Ne(h){this.stream=h}function Le(h,a){return{point:a,sphere:function(){h.sphere()},lineStart:function(){h.lineStart()},lineEnd:function(){h.lineEnd()},
polygonStart:function(){h.polygonStart()},polygonEnd:function(){h.polygonEnd()}}}function Ua(h){return cd(function(){return h})()}function cd(h){function a(h){return h=l(h[0]*G,h[1]*G),[h[0]*S+k,m-h[1]*S]}function b(h){return h=l.invert((h[0]-k)/S,(m-h[1])/S),h&&[h[0]*aa,h[1]*aa]}function e(){l=Fe(g=dd(w,R,O),f);var h=f(x,t);return k=q-h[0]*S,m=v+h[1]*S,d()}function d(){return n&&(n.valid=!1,n=null),a}var f,g,l,k,m,n,p=Ke(function(h,a){return h=f(h,a),[h[0]*S+k,m-h[1]*S]}),S=150,q=480,v=250,x=0,t=
0,w=0,R=0,O=0,ca=Oe,C=ga,z=null,B=null;return a.stream=function(h){return n&&(n.valid=!1),n=Me(ca(g,p(C(h)))),n.valid=!0,n},a.clipAngle=function(h){return arguments.length?(ca=null==h?(z=h,Oe):Yg((z=+h)*G),d()):z},a.clipExtent=function(h){return arguments.length?(B=h,C=h?Ee(h[0][0],h[0][1],h[1][0],h[1][1]):ga,d()):B},a.scale=function(h){return arguments.length?(S=+h,e()):S},a.translate=function(h){return arguments.length?(q=+h[0],v=+h[1],e()):[q,v]},a.center=function(h){return arguments.length?(x=
h[0]%360*G,t=h[1]%360*G,e()):[x*aa,t*aa]},a.rotate=function(h){return arguments.length?(w=h[0]%360*G,R=h[1]%360*G,O=2<h.length?h[2]%360*G:0,e()):[w*aa,R*aa,O*aa]},r.rebind(a,p,"precision"),function(){return f=h.apply(this,arguments),a.invert=f.invert&&b,e()}}function Me(h){return Le(h,function(a,b){h.point(a*G,b*G)})}function zb(h,a){return[h,a]}function Pe(h,a){return[h>K?h-pa:-K>h?h+pa:h,a]}function dd(h,a,b){return h?a||b?Fe(Qe(h),Re(a,b)):Qe(h):a||b?Re(a,b):Pe}function Se(h){return function(a,
b){return a+=h,[a>K?a-pa:-K>a?a+pa:a,b]}}function Qe(h){var a=Se(h);return a.invert=Se(-h),a}function Re(h,a){function b(h,a){var y=Math.cos(a),F=Math.cos(h)*y,y=Math.sin(h)*y,l=Math.sin(a),k=l*e+F*d;return[Math.atan2(y*f-k*g,F*e-l*d),hb(k*f+y*g)]}var e=Math.cos(h),d=Math.sin(h),f=Math.cos(a),g=Math.sin(a);return b.invert=function(h,a){var b=Math.cos(a),y=Math.cos(h)*b,b=Math.sin(h)*b,F=Math.sin(a),l=F*f-b*g;return[Math.atan2(b*f+F*g,y*e+l*d),hb(l*e-y*d)]},b}function ad(h,a){var b=Math.cos(h),e=Math.sin(h);
return function(d,f,g,l){var k=g*a;null!=d?(d=Te(b,d),f=Te(b,f),(0<g?f>d:d>f)&&(d+=g*pa)):(d=h+g*pa,f=h-.5*k);for(var m;0<g?d>f:f>d;d-=k)l.point((m=$b([b,-e*Math.cos(d),-e*Math.sin(d)]))[0],m[1])}}function Te(h,a){var b=$a(a);b[0]-=h;Zb(b);var e=ae(-b[1]);return((0>-b[2]?-e:e)+2*Math.PI-E)%(2*Math.PI)}function Ue(h,a,b){var e=r.range(h,a-E,b).concat(a);return function(h){return e.map(function(a){return[h,a]})}}function Ve(h,a,b){var e=r.range(h,a-E,b).concat(a);return function(h){return e.map(function(a){return[a,
h]})}}function ed(h){return h.source}function fd(h){return h.target}function dh(h,a,b,e){var d=Math.cos(a),f=Math.sin(a),g=Math.cos(e),l=Math.sin(e),k=d*Math.cos(h),m=d*Math.sin(h),n=g*Math.cos(b),p=g*Math.sin(b),q=2*Math.asin(Math.sqrt(ce(e-a)+d*g*ce(b-h))),r=1/Math.sin(q);b=q?function(h){var a=Math.sin(h*=q)*r,b=Math.sin(q-h)*r;h=b*k+a*n;var e=b*m+a*p,a=b*f+a*l;return[Math.atan2(e,h)*aa,Math.atan2(a,Math.sqrt(h*h+e*e))*aa]}:function(){return[h*aa,a*aa]};return b.distance=q,b}function Ab(h,a){function b(a,
e){var d=Math.cos(a),y=Math.cos(e),d=h(d*y);return[d*y*Math.sin(a),d*Math.sin(e)]}return b.invert=function(h,b){var e=Math.sqrt(h*h+b*b),d=a(e),f=Math.sin(d),d=Math.cos(d);return[Math.atan2(h*f,e*d),Math.asin(e&&b*f/e)]},b}function We(h,a){function b(h,a){0<f?-ha+E>a&&(a=-ha+E):a>ha-E&&(a=ha-E);var e=f/Math.pow(Math.tan(K/4+a/2),d);return[e*Math.sin(d*h),f-e*Math.cos(d*h)]}var e=Math.cos(h),d=h===a?Math.sin(h):Math.log(e/Math.cos(a))/Math.log(Math.tan(K/4+a/2)/Math.tan(K/4+h/2)),f=e*Math.pow(Math.tan(K/
4+h/2),d)/d;return d?(b.invert=function(h,a){var b=f-a,e=(0<d?1:0>d?-1:0)*Math.sqrt(h*h+b*b);return[Math.atan2(h,b)/d,2*Math.atan(Math.pow(f/e,1/d))-ha]},b):ec}function Xe(h,a){function b(h,a){var e=f-a;return[e*Math.sin(d*h),f-e*Math.cos(d*h)]}var e=Math.cos(h),d=h===a?Math.sin(h):(e-Math.cos(a))/(a-h),f=e/d+h;return N(d)<E?zb:(b.invert=function(h,a){var b=f-a;return[Math.atan2(h,b)/d,f-(0<d?1:0>d?-1:0)*Math.sqrt(h*h+b*b)]},b)}function ec(h,a){return[h,Math.log(Math.tan(K/4+a/2))]}function Ye(h){var a,
b=Ua(h),e=b.scale,d=b.translate,f=b.clipExtent;return b.scale=function(){var h=e.apply(b,arguments);return h===b?a?b.clipExtent(null):b:h},b.translate=function(){var h=d.apply(b,arguments);return h===b?a?b.clipExtent(null):b:h},b.clipExtent=function(h){var g=f.apply(b,arguments);if(g===b){if(a=null==h){var l=K*e(),k=d();f([[k[0]-l,k[1]-l],[k[0]+l,k[1]+l]])}}else a&&(g=null);return g},b.clipExtent(null)}function gd(h,a){return[Math.log(Math.tan(K/4+a/2)),-h]}function nb(h){return h[0]}function Bb(h){return h[1]}
function Ze(h){for(var a=h.length,b=[0,1],e=2,d=2;a>d;d++){for(;1<e&&0>=Mc(h[b[e-2]],h[b[e-1]],h[d]);)--e;b[e++]=d}return b.slice(0,e)}function eh(h,a){return h[0]-a[0]||h[1]-a[1]}function hd(h,a,b){return(b[0]-a[0])*(h[1]-a[1])<(b[1]-a[1])*(h[0]-a[0])}function $e(h,a,b,e){var d=h[0],f=b[0],g=a[0]-d,l=e[0]-f;h=h[1];b=b[1];a=a[1]-h;e=e[1]-b;f=(l*(h-b)-e*(d-f))/(e*g-l*a);return[d+f*g,h+f*a]}function af(h){var a=h[0];h=h[h.length-1];return!(a[0]-h[0]||a[1]-h[1])}function fh(){fc(this);this.edge=this.site=
this.circle=null}function bf(h){var a=cf.pop()||new fh;return a.site=h,a}function id(h){ob(h);pb.remove(h);cf.push(h);fc(h)}function df(h,a){var b=h.site,e=b.x,d=b.y,f=d-a;if(!f)return e;var g=h.P;if(!g)return-1/0;var b=g.site,g=b.x,b=b.y,l=b-a;if(!l)return g;var k=g-e,m=1/f-1/l,n=k/l;return m?(-n+Math.sqrt(n*n-2*m*(k*k/(-2*l)-b+l/2+d-f/2)))/m+e:(e+g)/2}function ef(h){this.site=h;this.edges=[]}function ff(h,a){return a.angle-h.angle}function gh(){fc(this);this.x=this.y=this.arc=this.site=this.cy=
null}function qb(h){var a=h.P,b=h.N;if(a&&b){var e=a.site,a=h.site,d=b.site;if(e!==d){var b=a.x,f=a.y,g=e.x-b,l=e.y-f,e=d.x-b,d=d.y-f,k=2*(g*d-l*e);if(!(k>=-jd)){var m=g*g+l*l,n=e*e+d*d,l=(d*m-l*n)/k,g=(g*n-e*m)/k,d=g+f,f=gf.pop()||new gh;f.arc=h;f.site=a;f.x=l+b;f.y=d+Math.sqrt(l*l+g*g);f.cy=d;h.circle=f;h=null;for(a=Cb._;a;)if(f.y<a.y||f.y===a.y&&f.x<=a.x){if(!a.L){h=a.P;break}a=a.L}else{if(!a.R){h=a;break}a=a.R}Cb.insert(h,f);h||(kd=f)}}}}function ob(h){var a=h.circle;a&&(a.P||(kd=a.N),Cb.remove(a),
gf.push(a),fc(a),h.circle=null)}function hh(h,a){var b=h.b;if(b)return!0;var e,d,f=h.a,b=a[0][0],g=a[1][0],l=a[0][1],k=a[1][1],m=h.l,n=h.r,p=m.x,m=m.y,q=n.x,n=n.y;d=(p+q)/2;if(n===m){if(b>d||d>=g)return;if(p>q){if(f){if(f.y>=k)return}else f={x:d,y:l};b={x:d,y:k}}else{if(f){if(f.y<l)return}else f={x:d,y:k};b={x:d,y:l}}}else if(e=(p-q)/(n-m),d=(m+n)/2-e*d,-1>e||1<e)if(p>q){if(f){if(f.y>=k)return}else f={x:(l-d)/e,y:l};b={x:(k-d)/e,y:k}}else{if(f){if(f.y<l)return}else f={x:(k-d)/e,y:k};b={x:(l-d)/e,
y:l}}else if(n>m){if(f){if(f.x>=g)return}else f={x:b,y:e*b+d};b={x:g,y:e*g+d}}else{if(f){if(f.x<b)return}else f={x:g,y:e*g+d};b={x:b,y:e*b+d}}return h.a=f,h.b=b,!0}function hf(h,a){this.l=h;this.r=a;this.a=this.b=null}function Db(h,a,b,e){var d=new hf(h,a);return rb.push(d),b&&gc(d,h,a,b),e&&gc(d,a,h,e),bb[h.i].edges.push(new hc(d,h,a)),bb[a.i].edges.push(new hc(d,a,h)),d}function ih(h,a,b){h=new hf(h,null);return h.a=a,h.b=b,rb.push(h),h}function gc(h,a,b,e){h.a||h.b?h.l===b?h.b=e:h.a=e:(h.a=e,h.l=
a,h.r=b)}function hc(h,a,b){var e=h.a,d=h.b;this.edge=h;this.site=a;this.angle=b?Math.atan2(b.y-a.y,b.x-a.x):h.l===a?Math.atan2(d.x-e.x,e.y-d.y):Math.atan2(e.x-d.x,d.y-e.y)}function ld(){this._=null}function fc(h){h.U=h.C=h.L=h.R=h.P=h.N=null}function Eb(h,a){var b=a.R,e=a.U;e?e.L===a?e.L=b:e.R=b:h._=b;b.U=e;a.U=b;a.R=b.L;a.R&&(a.R.U=a);b.L=a}function Fb(h,a){var b=a.L,e=a.U;e?e.L===a?e.L=b:e.R=b:h._=b;b.U=e;a.U=b;a.L=b.R;a.L&&(a.L.U=a);b.R=a}function jf(h){for(;h.L;)h=h.L;return h}function md(h,
a){var b,e,d,f=h.sort(jh).pop();rb=[];bb=Array(h.length);pb=new ld;for(Cb=new ld;;)if(d=kd,f&&(!d||f.y<d.y||f.y===d.y&&f.x<d.x)){if(f.x!==b||f.y!==e){bb[f.i]=new ef(f);b=f;for(var g=e=void 0,l=void 0,k=void 0,m=b.x,n=b.y,p=pb._;p;)if(l=df(p,n)-m,l>E)p=p.L;else{var q;var r=p;q=n;var v=r.N;v?q=df(v,q):(r=r.site,q=r.y===q?r.x:1/0);if(k=m-q,!(k>E)){l>-E?(e=p.P,g=p):k>-E?(e=p,g=p.N):e=g=p;break}if(!p.R){e=p;break}p=p.R}l=bf(b);if(pb.insert(e,l),e||g)if(e===g)ob(e),g=bf(e.site),pb.insert(l,g),l.edge=g.edge=
Db(e.site,l.site),qb(e),qb(g);else if(g){ob(e);ob(g);k=e.site;n=k.x;p=k.y;q=b.x-n;var r=b.y-p,m=g.site,v=m.x-n,x=m.y-p,t=2*(q*x-r*v),w=q*q+r*r,R=v*v+x*x,n={x:(x*w-r*R)/t+n,y:(q*R-v*w)/t+p};gc(g.edge,k,m,n);l.edge=Db(k,b,null,n);g.edge=Db(b,m,null,n);qb(e);qb(g)}else l.edge=Db(e.site,l.site);b=f.x;e=f.y}f=h.pop()}else{if(!d)break;m=d.arc;g=m.circle;k=g.x;n=g.cy;g={x:k,y:n};q=m.P;p=m.N;l=[m];id(m);for(m=q;m.circle&&N(k-m.circle.x)<E&&N(n-m.circle.cy)<E;)q=m.P,l.unshift(m),id(m),m=q;l.unshift(m);ob(m);
for(q=p;q.circle&&N(k-q.circle.x)<E&&N(n-q.circle.cy)<E;)p=q.N,l.push(q),id(q),q=p;l.push(q);ob(q);k=void 0;n=l.length;for(k=1;n>k;++k)q=l[k],m=l[k-1],gc(q.edge,m.site,q.site,g);m=l[0];q=l[n-1];q.edge=Db(m.site,q.site,null,g);qb(m);qb(q)}if(a){f=rb;b=De(a[0][0],a[0][1],a[1][0],a[1][1]);for(e=f.length;e--;)d=f[e],(!hh(d,a)||!b(d)||N(d.a.x-d.b.x)<E&&N(d.a.y-d.b.y)<E)&&(d.a=d.b=null,f.splice(e,1));var O,m=a[0][0],n=a[1][0],p=a[0][1];q=a[1][1];r=bb;for(v=r.length;v--;)if(O=r[v],O&&O.prepare())for(g=O.edges,
l=g.length,e=0;l>e;)k=g[e].end(),f=k.x,b=k.y,x=g[++e%l].start(),d=x.x,x=x.y,(N(f-d)>E||N(b-x)>E)&&(g.splice(e,0,new hc(ih(O.site,k,N(f-m)<E&&q-b>E?{x:m,y:N(d-m)<E?x:q}:N(b-q)<E&&n-f>E?{x:N(x-q)<E?d:n,y:q}:N(f-n)<E&&b-p>E?{x:n,y:N(d-n)<E?x:p}:N(b-p)<E&&f-m>E?{x:N(x-p)<E?d:m,y:p}:null),O.site,null)),++l)}O={cells:bb,edges:rb};return pb=Cb=rb=bb=null,O}function jh(h,a){return a.y-h.y||a.x-h.x}function kh(h){return h.x}function lh(h){return h.y}function kf(){return{leaf:!0,nodes:[],point:null,x:null,
y:null}}function Gb(h,a,b,e,d,f){if(!h(a,b,e,d,f)){var g=.5*(b+d),l=.5*(e+f);a=a.nodes;a[0]&&Gb(h,a[0],b,e,g,l);a[1]&&Gb(h,a[1],g,e,d,l);a[2]&&Gb(h,a[2],b,l,g,f);a[3]&&Gb(h,a[3],g,l,d,f)}}function nd(h,a){h=r.rgb(h);a=r.rgb(a);var b=h.r,e=h.g,d=h.b,f=a.r-b,g=a.g-e,l=a.b-d;return function(h){return"#"+ib(Math.round(b+f*h))+ib(Math.round(e+g*h))+ib(Math.round(d+l*h))}}function lf(h,a){var b,e={},d={};for(b in h)b in a?e[b]=cb(h[b],a[b]):d[b]=h[b];for(b in a)b in h||(d[b]=a[b]);return function(h){for(b in e)d[b]=
e[b](h);return d}}function Ma(h,a){return h=+h,a=+a,function(b){return h*(1-b)+a*b}}function mf(h,a){var b,e,d,f=od.lastIndex=pd.lastIndex=0,g=-1,l=[],k=[];h+="";for(a+="";(b=od.exec(h))&&(e=pd.exec(a));)(d=e.index)>f&&(d=a.slice(f,d),l[g]?l[g]+=d:l[++g]=d),(b=b[0])===(e=e[0])?l[g]?l[g]+=e:l[++g]=e:(l[++g]=null,k.push({i:g,x:Ma(b,e)})),f=pd.lastIndex;return f<a.length&&(d=a.slice(f),l[g]?l[g]+=d:l[++g]=d),2>l.length?k[0]?(a=k[0].x,function(h){return a(h)+""}):function(){return a}:(a=k.length,function(h){for(var b,
e=0;a>e;++e)l[(b=k[e]).i]=b.x(h);return l.join("")})}function cb(h,a){for(var b,e=r.interpolators.length;0<=--e&&!(b=r.interpolators[e](h,a)););return b}function ic(h,a){var b,e=[],d=[],f=h.length,g=a.length,l=Math.min(h.length,a.length);for(b=0;l>b;++b)e.push(cb(h[b],a[b]));for(;f>b;++b)d[b]=h[b];for(;g>b;++b)d[b]=a[b];return function(a){for(b=0;l>b;++b)d[b]=e[b](a);return d}}function mh(a){return function(b){return 0>=b?0:1<=b?1:a(b)}}function nf(a){return function(b){return 1-a(1-b)}}function of(a){return function(b){return.5*
(.5>b?a(2*b):2-a(2-2*b))}}function nh(a){return a*a}function oh(a){return a*a*a}function ph(a){if(0>=a)return 0;if(1<=a)return 1;var b=a*a,e=b*a;return 4*(.5>a?e:3*(a-b)+e-.75)}function qh(a){return 1-Math.cos(a*ha)}function rh(a){return Math.pow(2,10*(a-1))}function sh(a){return 1-Math.sqrt(1-a*a)}function th(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function pf(a,b){return b-=a,function(e){return Math.round(a+
b*e)}}function qf(a){var b=[a.a,a.b],e=[a.c,a.d],d=rf(b),f=b[0]*e[0]+b[1]*e[1],g;g=-f;g=(e[0]+=g*b[0],e[1]+=g*b[1],e);g=rf(g)||0;b[0]*e[1]<e[0]*b[1]&&(b[0]*=-1,b[1]*=-1,d*=-1,f*=-1);this.rotate=(d?Math.atan2(b[1],b[0]):Math.atan2(-e[0],e[1]))*aa;this.translate=[a.e,a.f];this.scale=[d,g];this.skew=g?Math.atan2(f,g)*aa:0}function rf(a){var b=Math.sqrt(a[0]*a[0]+a[1]*a[1]);return b&&(a[0]/=b,a[1]/=b),b}function sf(a,b){var e,d=[],f=[],g=r.transform(a),l=r.transform(b),k=g.translate,m=l.translate,n=g.rotate,
p=l.rotate,q=g.skew,S=l.skew,g=g.scale,l=l.scale;return k[0]!=m[0]||k[1]!=m[1]?(d.push("translate(",null,",",null,")"),f.push({i:1,x:Ma(k[0],m[0])},{i:3,x:Ma(k[1],m[1])})):m[0]||m[1]?d.push("translate("+m+")"):d.push(""),n!=p?(180<n-p?p+=360:180<p-n&&(n+=360),f.push({i:d.push(d.pop()+"rotate(",null,")")-2,x:Ma(n,p)})):p&&d.push(d.pop()+"rotate("+p+")"),q!=S?f.push({i:d.push(d.pop()+"skewX(",null,")")-2,x:Ma(q,S)}):S&&d.push(d.pop()+"skewX("+S+")"),g[0]!=l[0]||g[1]!=l[1]?(e=d.push(d.pop()+"scale(",
null,",",null,")"),f.push({i:e-4,x:Ma(g[0],l[0])},{i:e-2,x:Ma(g[1],l[1])})):(1!=l[0]||1!=l[1])&&d.push(d.pop()+"scale("+l+")"),e=f.length,function(a){for(var h,b=-1;++b<e;)d[(h=f[b]).i]=h.x(a);return d.join("")}}function uh(a,b){return b=(b-=a=+a)||1/b,function(e){return(e-a)/b}}function vh(a,b){return b=(b-=a=+a)||1/b,function(e){return Math.max(0,Math.min(1,(e-a)/b))}}function wh(a){var b=a.source;a=a.target;var e;var d=a;if(b===d)e=b;else{e=tf(b);for(var d=tf(d),f=e.pop(),g=d.pop(),l=null;f===
g;)l=f,f=e.pop(),g=d.pop();e=l}for(d=[b];b!==e;)b=b.parent,d.push(b);for(b=d.length;a!==e;)d.splice(b,0,a),a=a.parent;return d}function tf(a){for(var b=[],e=a.parent;null!=e;)b.push(a),a=e,e=e.parent;return b.push(a),b}function xh(a){a.fixed|=2}function yh(a){a.fixed&=-7}function zh(a){a.fixed|=4;a.px=a.x;a.py=a.y}function Ah(a){a.fixed&=-5}function uf(a,b,e){var d=0,f=0;if(a.charge=0,!a.leaf)for(var g,l=a.nodes,k=l.length,m=-1;++m<k;)g=l[m],null!=g&&(uf(g,b,e),a.charge+=g.charge,d+=g.charge*g.cx,
f+=g.charge*g.cy);a.point&&(a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5),b*=e[a.point.index],a.charge+=a.pointCharge=b,d+=b*a.point.x,f+=b*a.point.y);a.cx=d/a.charge;a.cy=f/a.charge}function Hb(a,b){return r.rebind(a,b,"sort","children","value"),a.nodes=a,a.links=Bh,a}function Ib(a,b){for(var e=[a];null!=(a=e.pop());)if(b(a),(f=a.children)&&(d=f.length))for(var d,f;0<=--d;)e.push(f[d])}function Da(a,b){for(var e=[a],d=[];null!=(a=e.pop());)if(d.push(a),(g=a.children)&&(f=g.length))for(var f,
g,l=-1;++l<f;)e.push(g[l]);for(;null!=(a=d.pop());)b(a)}function Ch(a){return a.children}function Dh(a){return a.value}function Eh(a,b){return b.value-a.value}function Bh(a){return r.merge(a.map(function(a){return(a.children||[]).map(function(h){return{source:a,target:h}})}))}function Fh(a){return a.x}function Gh(a){return a.y}function Hh(a,b,e){a.y0=b;a.y=e}function qd(a){return r.range(a.length)}function rd(a){var b=-1;a=a[0].length;for(var e=[];++b<a;)e[b]=0;return e}function Ih(a){for(var b,e=
1,d=0,f=a[0][1],g=a.length;g>e;++e)(b=a[e][1])>f&&(d=e,f=b);return d}function Jh(a){return a.reduce(Kh,0)}function Kh(a,b){return a+b[1]}function Lh(a,b){return vf(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function vf(a,b){for(var e=-1,d=+a[0],f=(a[1]-d)/b,g=[];++e<=b;)g[e]=f*e+d;return g}function Mh(a){return[r.min(a),r.max(a)]}function Nh(a,b){return a.value-b.value}function sd(a,b){var e=a._pack_next;a._pack_next=b;b._pack_prev=a;b._pack_next=e;e._pack_prev=b}function wf(a,b){a._pack_next=b;
b._pack_prev=a}function xf(a,b){var e=b.x-a.x,d=b.y-a.y,f=a.r+b.r;return.999*f*f>e*e+d*d}function yf(a){function b(a){p=Math.min(a.x-a.r,p);q=Math.max(a.x+a.r,q);r=Math.min(a.y-a.r,r);v=Math.max(a.y+a.r,v)}if((e=a.children)&&(n=e.length)){var e,d,f,g,l,k,m,n,p=1/0,q=-1/0,r=1/0,v=-1/0;if(e.forEach(Oh),d=e[0],d.x=-d.r,d.y=0,b(d),1<n&&(f=e[1],f.x=f.r,f.y=0,b(f),2<n))for(g=e[2],zf(d,f,g),b(g),sd(d,g),d._pack_prev=g,sd(g,f),f=d._pack_next,l=3;n>l;l++){zf(d,f,g=e[l]);var x=0,t=1,w=1;for(k=f._pack_next;k!==
f;k=k._pack_next,t++)if(xf(k,g)){x=1;break}if(1==x)for(m=d._pack_prev;m!==k._pack_prev&&!xf(m,g);m=m._pack_prev,w++);x?(w>t||t==w&&f.r<d.r?wf(d,f=k):wf(d=m,f),l--):(sd(d,g),f=g,b(g))}d=(p+q)/2;f=(r+v)/2;for(l=k=0;n>l;l++)g=e[l],g.x-=d,g.y-=f,k=Math.max(k,g.r+Math.sqrt(g.x*g.x+g.y*g.y));a.r=k;e.forEach(Ph)}}function Oh(a){a._pack_next=a._pack_prev=a}function Ph(a){delete a._pack_next;delete a._pack_prev}function Af(a,b,e,d){var f=a.children;if(a.x=b+=d*a.x,a.y=e+=d*a.y,a.r*=d,f){a=-1;for(var g=f.length;++a<
g;)Af(f[a],b,e,d)}}function zf(a,b,e){var d=a.r+e.r,f=b.x-a.x,g=b.y-a.y;if(d&&(f||g)){var l=b.r+e.r,k=f*f+g*g,l=l*l,d=d*d;b=.5+(d-l)/(2*k);l=Math.sqrt(Math.max(0,2*l*(d+k)-(d-=k)*d-l*l))/(2*k);e.x=a.x+b*f+l*g;e.y=a.y+b*g-l*f}else e.x=a.x+d,e.y=a.y}function Bf(a,b){return a.parent==b.parent?1:2}function td(a){var b=a.children;return b.length?b[0]:a.t}function ud(a){var b,e=a.children;return(b=e.length)?e[b-1]:a.t}function Qh(a){return 1+r.max(a,function(a){return a.y})}function Rh(a){return a.reduce(function(a,
h){return a+h.x},0)/a.length}function Cf(a){var b=a.children;return b&&b.length?Cf(b[0]):a}function Df(a){var b,e=a.children;return e&&(b=e.length)?Df(e[b-1]):a}function vd(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function Ef(a,b){var e=a.x+b[3],d=a.y+b[0],f=a.dx-b[1]-b[3],g=a.dy-b[0]-b[2];return 0>f&&(e+=f/2,f=0),0>g&&(d+=g/2,g=0),{x:e,y:d,dx:f,dy:g}}function sb(a){var b=a[0];a=a[a.length-1];return a>b?[b,a]:[a,b]}function jc(a){return a.rangeExtent?a.rangeExtent():sb(a.range())}function Sh(a,b,e,
d){var f=e(a[0],a[1]),g=d(b[0],b[1]);return function(a){return g(f(a))}}function kc(a,b){var e,d=0,f=a.length-1,g=a[d],l=a[f];return g>l&&(e=d,d=f,f=e,e=g,g=l,l=e),a[d]=b.floor(g),a[f]=b.ceil(l),a}function Ff(a){return a?{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}:Th}function Uh(a,b,e,d){var f=[],g=[],l=0,k=Math.min(a.length,b.length)-1;for(a[k]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());++l<=k;)f.push(e(a[l-1],a[l])),g.push(d(b[l-1],b[l]));return function(b){var e=
r.bisect(a,b,1,k)-1;return g[e](f[e](b))}}function Gf(a,b,e,d){function f(){var m=2<Math.min(a.length,b.length)?Uh:Sh,M=d?vh:uh;return l=m(a,b,M,e),k=m(b,a,M,cb),g}function g(a){return l(a)}var l,k;return g.invert=function(a){return k(a)},g.domain=function(b){return arguments.length?(a=b.map(Number),f()):a},g.range=function(a){return arguments.length?(b=a,f()):b},g.rangeRound=function(a){return g.range(a).interpolate(pf)},g.clamp=function(a){return arguments.length?(d=a,f()):d},g.interpolate=function(a){return arguments.length?
(e=a,f()):e},g.ticks=function(b){return r.range.apply(r,Va(a,b))},g.tickFormat=function(b,e){return wd(a,b,e)},g.nice=function(b){return kc(a,Ff(Va(a,b)[2])),f()},g.copy=function(){return Gf(a,b,e,d)},f()}function xd(a,b){return r.rebind(a,b,"range","rangeRound","interpolate","clamp")}function Va(a,b){null==b&&(b=10);var e=sb(a),d=e[1]-e[0],f=Math.pow(10,Math.floor(Math.log(d/b)/Math.LN10)),d=b/d*f;return.15>=d?f*=10:.35>=d?f*=5:.75>=d&&(f*=2),e[0]=Math.ceil(e[0]/f)*f,e[1]=Math.floor(e[1]/f)*f+.5*
f,e[2]=f,e}function wd(a,b,e){a=Va(a,b);if(e){b=oe.exec(e);if(b.shift(),"s"===b[8]){var d=r.formatPrefix(Math.max(N(a[0]),N(a[1])));return b[7]||(b[7]="."+lc(d.scale(a[2]))),b[8]="f",e=r.format(b.join("")),function(a){return e(d.scale(a))+d.symbol}}b[7]||(b[7]="."+Vh(b[8],a));e=b.join("")}else e=",."+lc(a[2])+"f";return r.format(e)}function lc(a){return-Math.floor(Math.log(a)/Math.LN10+.01)}function Vh(a,b){var e=lc(b[2]);return a in Wh?Math.abs(e-lc(Math.max(N(b[0]),N(b[1]))))+ +("e"!==a):e-2*("%"===
a)}function Hf(a,b,e,d){function f(a){return(e?Math.log(0>a?0:a):-Math.log(0<a?0:-a))/Math.log(b)}function g(a){return e?Math.pow(b,a):-Math.pow(b,-a)}function l(b){return a(f(b))}return l.invert=function(b){return g(a.invert(b))},l.domain=function(b){return arguments.length?(e=0<=b[0],a.domain((d=b.map(Number)).map(f)),l):d},l.base=function(e){return arguments.length?(b=+e,a.domain(d.map(f)),l):b},l.nice=function(){var b=kc(d.map(f),e?Math:Xh);return a.domain(b),d=b.map(g),l},l.ticks=function(){var a=
sb(d),h=[],l=a[0],a=a[1],k=Math.floor(f(l)),m=Math.ceil(f(a)),n=b%1?2:b;if(isFinite(m-k)){if(e){for(;m>k;k++)for(var p=1;n>p;p++)h.push(g(k)*p);h.push(g(k))}else for(h.push(g(k));k++<m;)for(p=n-1;0<p;p--)h.push(g(k)*p);for(k=0;h[k]<l;k++);for(m=h.length;h[m-1]>a;m--);h=h.slice(k,m)}return h},l.tickFormat=function(a,h){if(!arguments.length)return If;2>arguments.length?h=If:"function"!=typeof h&&(h=r.format(h));var b,d=Math.max(.1,a/l.ticks().length),y=e?(b=1E-12,Math.ceil):(b=-1E-12,Math.floor);return function(a){return a/
g(y(f(a)+b))<=d?h(a):""}},l.copy=function(){return Hf(a.copy(),b,e,d)},xd(l,a)}function Jf(a,b,e){function d(b){return a(f(b))}var f=mc(b),g=mc(1/b);return d.invert=function(b){return g(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain((e=b.map(Number)).map(f)),d):e},d.ticks=function(a){return r.range.apply(r,Va(e,a))},d.tickFormat=function(a,h){return wd(e,a,h)},d.nice=function(a){return d.domain(kc(e,Ff(Va(e,a)[2])))},d.exponent=function(l){return arguments.length?(f=mc(b=l),
g=mc(1/b),a.domain(e.map(f)),d):b},d.copy=function(){return Jf(a.copy(),b,e)},xd(d,a)}function mc(a){return function(b){return 0>b?-Math.pow(-b,a):Math.pow(b,a)}}function Kf(a,b){function e(d){return g[((f.get(d)||("range"===b.t?f.set(d,a.push(d)):0/0))-1)%g.length]}function d(b,e){return r.range(a.length).map(function(a){return b+e*a})}var f,g,k;return e.domain=function(d){if(!arguments.length)return a;a=[];f=new l;for(var g,k=-1,m=d.length;++k<m;)f.has(g=d[k])||f.set(g,a.push(g));return e[b.t].apply(e,
b.a)},e.range=function(a){return arguments.length?(g=a,k=0,b={t:"range",a:arguments},e):g},e.rangePoints=function(f,l){2>arguments.length&&(l=0);var m=f[0],n=f[1],M=(n-m)/(Math.max(1,a.length-1)+l);return g=d(2>a.length?(m+n)/2:m+M*l/2,M),k=0,b={t:"rangePoints",a:arguments},e},e.rangeBands=function(f,l,m){2>arguments.length&&(l=0);3>arguments.length&&(m=l);var n=f[1]<f[0],M=f[n-0],p=(f[1-n]-M)/(a.length-l+2*m);return g=d(M+p*m,p),n&&g.reverse(),k=p*(1-l),b={t:"rangeBands",a:arguments},e},e.rangeRoundBands=
function(f,l,m){2>arguments.length&&(l=0);3>arguments.length&&(m=l);var n=f[1]<f[0],M=f[n-0],p=f[1-n],q=Math.floor((p-M)/(a.length-l+2*m));return g=d(M+Math.round((p-M-(a.length-l)*q)/2),q),n&&g.reverse(),k=Math.round(q*(1-l)),b={t:"rangeRoundBands",a:arguments},e},e.rangeBand=function(){return k},e.rangeExtent=function(){return sb(b.a[0])},e.copy=function(){return Kf(a,b)},e.domain(a)}function Lf(a,b){function e(){var d=0,f=b.length;for(k=[];++d<f;)k[d-1]=r.quantile(a,d/f);return l}function l(a){return isNaN(a=
+a)?void 0:b[r.bisect(k,a)]}var k;return l.domain=function(b){return arguments.length?(a=b.map(f).filter(d).sort(g),e()):a},l.range=function(a){return arguments.length?(b=a,e()):b},l.quantiles=function(){return k},l.invertExtent=function(e){return e=b.indexOf(e),0>e?[0/0,0/0]:[0<e?k[e-1]:a[0],e<k.length?k[e]:a[a.length-1]]},l.copy=function(){return Lf(a,b)},e()}function Mf(a,b,e){function d(b){return e[Math.max(0,Math.min(l,Math.floor(g*(b-a))))]}function f(){return g=e.length/(b-a),l=e.length-1,
d}var g,l;return d.domain=function(e){return arguments.length?(a=+e[0],b=+e[e.length-1],f()):[a,b]},d.range=function(a){return arguments.length?(e=a,f()):e},d.invertExtent=function(b){return b=e.indexOf(b),b=0>b?0/0:b/g+a,[b,b+1/g]},d.copy=function(){return Mf(a,b,e)},f()}function Nf(a,b){function e(d){return d>=d?b[r.bisect(a,d)]:void 0}return e.domain=function(b){return arguments.length?(a=b,e):a},e.range=function(a){return arguments.length?(b=a,e):b},e.invertExtent=function(e){return e=b.indexOf(e),
[a[e-1],a[e]]},e.copy=function(){return Nf(a,b)},e}function Of(a){function b(a){return+a}return b.invert=b,b.domain=b.range=function(e){return arguments.length?(a=e.map(b),b):a},b.ticks=function(b){return r.range.apply(r,Va(a,b))},b.tickFormat=function(b,e){return wd(a,b,e)},b.copy=function(){return Of(a)},b}function Yh(a){return a.innerRadius}function Zh(a){return a.outerRadius}function Pf(a){return a.startAngle}function Qf(a){return a.endAngle}function Rf(a){function b(l){function y(){n.push("M",
g(a(p),k))}for(var m,n=[],p=[],q=-1,r=l.length,fa=Y(e),v=Y(d);++q<r;)f.call(this,m=l[q],q)?p.push([+fa.call(this,m,q),+v.call(this,m,q)]):p.length&&(y(),p=[]);return p.length&&y(),n.length?n.join(""):null}var e=nb,d=Bb,f=mb,g=qa,l=g.key,k=.7;return b.x=function(a){return arguments.length?(e=a,b):e},b.y=function(a){return arguments.length?(d=a,b):d},b.defined=function(a){return arguments.length?(f=a,b):f},b.interpolate=function(a){return arguments.length?(l="function"==typeof a?g=a:(g=yd.get(a)||qa).key,
b):l},b.tension=function(a){return arguments.length?(k=a,b):k},b}function qa(a){return a.join("L")}function zd(a){for(var b=0,e=a.length,d=a[0],f=[d[0],",",d[1]];++b<e;)f.push("V",(d=a[b])[1],"H",d[0]);return f.join("")}function Ad(a){for(var b=0,e=a.length,d=a[0],f=[d[0],",",d[1]];++b<e;)f.push("H",(d=a[b])[0],"V",d[1]);return f.join("")}function nc(a,b){if(1>b.length||a.length!=b.length&&a.length!=b.length+2)return qa(a);var e=a.length!=b.length,d="",f=a[0],g=a[1],l=b[0],k=l,m=1;if(e&&(d+="Q"+(g[0]-
2*l[0]/3)+","+(g[1]-2*l[1]/3)+","+g[0]+","+g[1],f=a[1],m=2),1<b.length)for(k=b[1],g=a[m],m++,d+="C"+(f[0]+l[0])+","+(f[1]+l[1])+","+(g[0]-k[0])+","+(g[1]-k[1])+","+g[0]+","+g[1],f=2;f<b.length;f++,m++)g=a[m],k=b[f],d+="S"+(g[0]-k[0])+","+(g[1]-k[1])+","+g[0]+","+g[1];e&&(e=a[m],d+="Q"+(g[0]+2*k[0]/3)+","+(g[1]+2*k[1]/3)+","+e[0]+","+e[1]);return d}function Bd(a,b){for(var e,d=[],f=(1-b)/2,g=a[0],l=a[1],k=1,m=a.length;++k<m;)e=g,g=l,l=a[k],d.push([f*(l[0]-e[0]),f*(l[1]-e[1])]);return d}function Sf(a){if(3>
a.length)return qa(a);var b=1,e=a.length,d=a[0],f=d[0],g=d[1],l=[f,f,f,(d=a[1])[0]],k=[g,g,g,d[1]],f=[f,",",g,"L",ua(Wa,l),",",ua(Wa,k)];for(a.push(a[e-1]);++b<=e;)d=a[b],l.shift(),l.push(d[0]),k.shift(),k.push(d[1]),Cd(f,l,k);return a.pop(),f.push("L",d),f.join("")}function ua(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function Cd(a,b,e){a.push("C",ua(Tf,b),",",ua(Tf,e),",",ua(Uf,b),",",ua(Uf,e),",",ua(Wa,b),",",ua(Wa,e))}function Dd(a,b){return(b[1]-a[1])/(b[0]-a[0])}function Vf(a){for(var b,
e,d,f=-1,g=a.length;++f<g;)b=a[f],e=b[0],d=b[1]+db,b[0]=e*Math.cos(d),b[1]=e*Math.sin(d);return a}function Wf(a){function b(y){function m(){x.push("M",k(a(O),q),p,n(a(t.reverse()),q),"Z")}for(var r,Vd,v,x=[],t=[],O=[],w=-1,C=y.length,z=Y(e),B=Y(f),T=e===d?function(){return Vd}:Y(d),I=f===g?function(){return v}:Y(g);++w<C;)l.call(this,r=y[w],w)?(t.push([Vd=+z.call(this,r,w),v=+B.call(this,r,w)]),O.push([+T.call(this,r,w),+I.call(this,r,w)])):t.length&&(m(),t=[],O=[]);return t.length&&m(),x.length?
x.join(""):null}var e=nb,d=nb,f=0,g=Bb,l=mb,k=qa,m=k.key,n=k,p="L",q=.7;return b.x=function(a){return arguments.length?(e=d=a,b):d},b.x0=function(a){return arguments.length?(e=a,b):e},b.x1=function(a){return arguments.length?(d=a,b):d},b.y=function(a){return arguments.length?(f=g=a,b):g},b.y0=function(a){return arguments.length?(f=a,b):f},b.y1=function(a){return arguments.length?(g=a,b):g},b.defined=function(a){return arguments.length?(l=a,b):l},b.interpolate=function(a){return arguments.length?(m=
"function"==typeof a?k=a:(k=yd.get(a)||qa).key,n=k.reverse||k,p=k.closed?"M":"L",b):m},b.tension=function(a){return arguments.length?(q=a,b):q},b}function $h(a){return a.radius}function Xf(a){return[a.x,a.y]}function ai(a){return function(){var b=a.apply(this,arguments),e=b[0],b=b[1]+db;return[e*Math.cos(b),e*Math.sin(b)]}}function bi(){return 64}function ci(){return"circle"}function Yf(a){a=Math.sqrt(a/K);return"M0,"+a+"A"+a+","+a+" 0 1,1 0,"+-a+"A"+a+","+a+" 0 1,1 0,"+a+"Z"}function Jb(a,b){return Kb(a,
da),a.id=b,a}function Ed(a,b,e,d){var f=a.id;return W(a,"function"==typeof e?function(a,h,g){a.__transition__[f].tween.set(b,d(e.call(a,a.__data__,h,g)))}:(e=d(e),function(a){a.__transition__[f].tween.set(b,e)}))}function di(a){return null==a&&(a=""),function(){this.textContent=a}}function oc(a,b,e,d){var f=a.__transition__||(a.__transition__={active:0,count:0}),g=f[e];if(!g){var k=d.time,g=f[e]={tween:new l,time:k,ease:d.ease,delay:d.delay,duration:d.duration};++f.count;r.timer(function(d){function l(d){return f.active>
e?H():(f.active=e,g.event&&g.event.start.call(a,n,b),g.tween.forEach(function(e,d){(d=d.call(a,n,b))&&t.push(d)}),r.timer(function(){return x.c=m(d||1)?mb:m,1},0,k),void 0)}function m(d){if(f.active!==e)return H();d/=v;for(var l=p(d),k=t.length;0<k;)t[--k].call(a,l);return 1<=d?(g.event&&g.event.end.call(a,n,b),H()):void 0}function H(){return--f.count?delete f[e]:delete a.__transition__,1}var n=a.__data__,p=g.ease,q=g.delay,v=g.duration,x=Ha,t=[];return x.t=q+k,d>=q?l(d-q):(x.c=l,void 0)},0,k)}}function ei(a,
b,e){a.attr("transform",function(a){var h=b(a);return"translate("+(isFinite(h)?h:e(a))+",0)"})}function fi(a,b,e){a.attr("transform",function(a){var h=b(a);return"translate(0,"+(isFinite(h)?h:e(a))+")"})}function Fd(a){return a.toISOString()}function Gd(a,b,e){function d(b){return a(b)}function f(a,h){var e=(a[1]-a[0])/h,d=r.bisect(pc,e);return d==pc.length?[b.year,Va(a.map(function(a){return a/31536E6}),h)[2]]:d?b[e/pc[d-1]<pc[d]/e?d-1:d]:[gi,Va(a,h)[2]]}return d.invert=function(b){return eb(a.invert(b))},
d.domain=function(b){return arguments.length?(a.domain(b),d):a.domain().map(eb)},d.nice=function(a,b){function h(e){return!isNaN(e)&&!a.range(e,eb(+e+1),b).length}var e=d.domain(),g=sb(e),g=null==a?f(g,10):"number"==typeof a&&f(g,a);return g&&(a=g[0],b=g[1]),d.domain(kc(e,1<b?{floor:function(b){for(;h(b=a.floor(b));)b=eb(b-1);return b},ceil:function(b){for(;h(b=a.ceil(b));)b=eb(+b+1);return b}}:a))},d.ticks=function(a,b){var h=sb(d.domain()),e=null==a?f(h,10):"number"==typeof a?f(h,a):!a.range&&[{range:a},
b];return e&&(a=e[0],b=e[1]),a.range(h[0],eb(+h[1]+1),1>b?1:b)},d.tickFormat=function(){return e},d.copy=function(){return Gd(a.copy(),b,e)},xd(d,a)}function eb(a){return new Date(a)}function hi(a){return JSON.parse(a.responseText)}function ii(a){var b=za.createRange();return b.selectNode(za.body),b.createContextualFragment(a.responseText)}var r={version:"3.4.13"};Date.now||(Date.now=function(){return+new Date});var Zf=[].slice,Oa=function(a){return Zf.call(a)},za=document,Ga=za.documentElement,ja=
window;try{Oa(Ga.childNodes)[0].nodeType}catch(Ii){Oa=function(a){for(var b=a.length,e=Array(b);b--;)e[b]=a[b];return e}}try{za.createElement("div").style.setProperty("opacity",0,"")}catch(Ji){var qc=ja.Element.prototype,ji=qc.setAttribute,ki=qc.setAttributeNS,$f=ja.CSSStyleDeclaration.prototype,li=$f.setProperty;qc.setAttribute=function(a,b){ji.call(this,a,b+"")};qc.setAttributeNS=function(a,b,e){ki.call(this,a,b,e+"")};$f.setProperty=function(a,b,e){li.call(this,a,b+"",e)}}r.ascending=g;r.descending=
function(a,b){return a>b?-1:b>a?1:b>=a?0:0/0};r.min=function(a,b){var e,d,f=-1,g=a.length;if(1===arguments.length){for(;++f<g&&!(null!=(e=a[f])&&e>=e);)e=void 0;for(;++f<g;)null!=(d=a[f])&&e>d&&(e=d)}else{for(;++f<g&&!(null!=(e=b.call(a,a[f],f))&&e>=e);)e=void 0;for(;++f<g;)null!=(d=b.call(a,a[f],f))&&e>d&&(e=d)}return e};r.max=function(a,b){var e,d,f=-1,g=a.length;if(1===arguments.length){for(;++f<g&&!(null!=(e=a[f])&&e>=e);)e=void 0;for(;++f<g;)null!=(d=a[f])&&d>e&&(e=d)}else{for(;++f<g&&!(null!=
(e=b.call(a,a[f],f))&&e>=e);)e=void 0;for(;++f<g;)null!=(d=b.call(a,a[f],f))&&d>e&&(e=d)}return e};r.extent=function(a,b){var e,d,f,g=-1,l=a.length;if(1===arguments.length){for(;++g<l&&!(null!=(e=f=a[g])&&e>=e);)e=f=void 0;for(;++g<l;)null!=(d=a[g])&&(e>d&&(e=d),d>f&&(f=d))}else{for(;++g<l&&!(null!=(e=f=b.call(a,a[g],g))&&e>=e);)e=void 0;for(;++g<l;)null!=(d=b.call(a,a[g],g))&&(e>d&&(e=d),d>f&&(f=d))}return[e,f]};r.sum=function(a,b){var e,f=0,g=a.length,l=-1;if(1===arguments.length)for(;++l<g;)d(e=
+a[l])&&(f+=e);else for(;++l<g;)d(e=+b.call(a,a[l],l))&&(f+=e);return f};r.mean=function(a,b){var e,g=0,l=a.length,k=-1,m=l;if(1===arguments.length)for(;++k<l;)d(e=f(a[k]))?g+=e:--m;else for(;++k<l;)d(e=f(b.call(a,a[k],k)))?g+=e:--m;return m?g/m:void 0};r.quantile=function(a,b){var e=(a.length-1)*b+1,d=Math.floor(e),f=+a[d-1];return(e-=d)?f+e*(a[d]-f):f};r.median=function(a,b){var e,l=[],k=a.length,m=-1;if(1===arguments.length)for(;++m<k;)d(e=f(a[m]))&&l.push(e);else for(;++m<k;)d(e=f(b.call(a,a[m],
m)))&&l.push(e);return l.length?r.quantile(l.sort(g),.5):void 0};var ag=b(g);r.bisectLeft=ag.left;r.bisect=r.bisectRight=ag.right;r.bisector=function(a){return b(1===a.length?function(b,e){return g(a(b),e)}:a)};r.shuffle=function(a){for(var b,e,d=a.length;d;)e=0|Math.random()*d--,b=a[d],a[d]=a[e],a[e]=b;return a};r.permute=function(a,b){for(var e=b.length,d=Array(e);e--;)d[e]=a[b[e]];return d};r.pairs=function(a){for(var b=0,e=a.length-1,d=a[0],f=Array(0>e?0:e);e>b;)f[b]=[d,d=a[++b]];return f};r.zip=
function(){if(!(f=arguments.length))return[];for(var b=-1,e=r.min(arguments,a),d=Array(e);++b<e;)for(var f,g=-1,l=d[b]=Array(f);++g<f;)l[g]=arguments[g][b];return d};r.transpose=function(a){return r.zip.apply(r,a)};r.keys=function(a){var b=[],e;for(e in a)b.push(e);return b};r.values=function(a){var b=[],e;for(e in a)b.push(a[e]);return b};r.entries=function(a){var b=[],e;for(e in a)b.push({key:e,value:a[e]});return b};r.merge=function(a){var b,e,d,f=a.length;b=-1;for(var g=0;++b<f;)g+=a[b].length;
for(e=Array(g);0<=--f;)for(d=a[f],b=d.length;0<=--b;)e[--g]=d[b];return e};var N=Math.abs;r.range=function(a,b,e){if(3>arguments.length&&(e=1,2>arguments.length&&(b=a,a=0)),1/0===(b-a)/e)throw Error("infinite range");var d,f=[],g;d=N(e);for(g=1;d*g%1;)g*=10;var l=-1;if(a*=g,b*=g,e*=g,0>e)for(;(d=a+e*++l)>b;)f.push(d/g);else for(;(d=a+e*++l)<b;)f.push(d/g);return f};r.map=function(a){var b=new l;if(a instanceof l)a.forEach(function(a,h){b.set(a,h)});else for(var e in a)b.set(e,a[e]);return b};var ug=
"__proto__",Gc="\x00";e(l,{has:n,get:function(a){return this._[k(a)]},set:function(a,b){return this._[k(a)]=b},remove:p,keys:q,values:function(){var a=[],b;for(b in this._)a.push(this._[b]);return a},entries:function(){var a=[],b;for(b in this._)a.push({key:m(b),value:this._[b]});return a},size:t,empty:w,forEach:function(a){for(var b in this._)a.call(this,m(b),this._[b])}});r.nest=function(){function a(b,k,y){if(y>=g.length)return d?d.call(f,k):e?k.sort(e):k;for(var m,n,p,q,r=-1,fa=k.length,v=g[y++],
x=new l;++r<fa;)(q=x.get(m=v(n=k[r])))?q.push(n):x.set(m,[n]);return b?(n=b(),p=function(e,d){n.set(e,a(b,d,y))}):(n={},p=function(e,d){n[e]=a(b,d,y)}),x.forEach(p),n}function b(a,h){if(h>=g.length)return a;var e=[],d=k[h++];return a.forEach(function(a,d){e.push({key:a,values:b(d,h)})}),d?e.sort(function(a,b){return d(a.key,b.key)}):e}var e,d,f={},g=[],k=[];return f.map=function(b,e){return a(e,b,0)},f.entries=function(e){return b(a(r.map,e,0),0)},f.key=function(a){return g.push(a),f},f.sortKeys=
function(a){return k[g.length-1]=a,f},f.sortValues=function(a){return e=a,f},f.rollup=function(a){return d=a,f},f};r.set=function(a){var b=new v;if(a)for(var e=0,d=a.length;d>e;++e)b.add(a[e]);return b};e(v,{has:n,add:function(a){return this._[k(a+="")]=!0,a},remove:p,values:q,size:t,empty:w,forEach:function(a){for(var b in this._)a.call(this,m(b))}});r.behavior={};r.rebind=function(a,b){for(var e,d=1,f=arguments.length;++d<f;)a[e=arguments[d]]=z(a,b,b[e]);return a};var Ud="webkit ms moz Moz o O".split(" ");
r.dispatch=function(){for(var a=new Z,b=-1,e=arguments.length;++b<e;)a[arguments[b]]=x(a);return a};Z.prototype.on=function(a,b){var e=a.indexOf("."),d="";if(0<=e&&(d=a.slice(e+1),a=a.slice(0,e)),a)return 2>arguments.length?this[a].on(d):this[a].on(d,b);if(2===arguments.length){if(null==b)for(a in this)this.hasOwnProperty(a)&&this[a].on(d,null);return this}};r.event=null;r.requote=function(a){return a.replace(mi,"\\$&")};var mi=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,Kb={}.__proto__?function(a,b){a.__proto__=
b}:function(a,b){for(var e in b)a[e]=b[e]},Hc=function(a,b){return b.querySelector(a)},Ic=function(a,b){return b.querySelectorAll(a)},ni=Ga.matches||Ga[I(Ga,"matchesSelector")],Yd=function(a,b){return ni.call(a,b)};"function"==typeof Sizzle&&(Hc=function(a,b){return Sizzle(a,b)[0]||null},Ic=Sizzle,Yd=Sizzle.matchesSelector);r.selection=function(){return bg};var U=r.selection.prototype=[];U.select=function(a){var b,e,d,f,g=[];a=gb(a);for(var l=-1,k=this.length;++l<k;){g.push(b=[]);b.parentNode=(d=
this[l]).parentNode;for(var m=-1,n=d.length;++m<n;)(f=d[m])?(b.push(e=a.call(f,f.__data__,m,l)),e&&"__data__"in f&&(e.__data__=f.__data__)):b.push(null)}return V(g)};U.selectAll=function(a){var b,e,d=[];a=vb(a);for(var f=-1,g=this.length;++f<g;)for(var l=this[f],k=-1,m=l.length;++k<m;)(e=l[k])&&(d.push(b=Oa(a.call(e,e.__data__,k,f))),b.parentNode=e);return V(d)};var Hd={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",
xmlns:"http://www.w3.org/2000/xmlns/"};r.ns={prefix:Hd,qualify:function(a){var b=a.indexOf(":"),e=a;return 0<=b&&(e=a.slice(0,b),a=a.slice(b+1)),Hd.hasOwnProperty(e)?{space:Hd[e],local:a}:a}};U.attr=function(a,b){if(2>arguments.length){if("string"==typeof a){var e=this.node();return a=r.ns.qualify(a),a.local?e.getAttributeNS(a.space,a.local):e.getAttribute(a)}for(b in a)this.each(Od(b,a[b]));return this}return this.each(Od(a,b))};U.classed=function(a,b){if(2>arguments.length){if("string"==typeof a){var e=
this.node(),d=(a=(a+"").trim().split(/^|\s+/)).length,f=-1;if(b=e.classList)for(;++f<d;){if(!b.contains(a[f]))return!1}else for(b=e.getAttribute("class");++f<d;)if(!Qd(a[f]).test(b))return!1;return!0}for(b in a)this.each(Rd(b,a[b]));return this}return this.each(Rd(a,b))};U.style=function(a,b,e){var d=arguments.length;if(3>d){if("string"!=typeof a){2>d&&(b="");for(e in a)this.each(Sd(e,a[e],b));return this}if(2>d)return ja.getComputedStyle(this.node(),null).getPropertyValue(a);e=""}return this.each(Sd(a,
b,e))};U.property=function(a,b){if(2>arguments.length){if("string"==typeof a)return this.node()[a];for(b in a)this.each(Td(b,a[b]));return this}return this.each(Td(a,b))};U.text=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=a.apply(this,arguments);this.textContent=null==b?"":b}:null==a?function(){this.textContent=""}:function(){this.textContent=a}):this.node().textContent};U.html=function(a){return arguments.length?this.each("function"==typeof a?function(){var b=
a.apply(this,arguments);this.innerHTML=null==b?"":b}:null==a?function(){this.innerHTML=""}:function(){this.innerHTML=a}):this.node().innerHTML};U.append=function(a){return a=Wd(a),this.select(function(){return this.appendChild(a.apply(this,arguments))})};U.insert=function(a,b){return a=Wd(a),b=gb(b),this.select(function(){return this.insertBefore(a.apply(this,arguments),b.apply(this,arguments)||null)})};U.remove=function(){return this.each(function(){var a=this.parentNode;a&&a.removeChild(this)})};
U.data=function(a,b){function e(a,h){var d,f,g,k=a.length,F=h.length,A=Math.min(k,F),H=Array(F),q=Array(F),M=Array(k);if(b){var r,A=new l,v=Array(k);for(d=-1;++d<k;)A.has(r=b.call(f=a[d],f.__data__,d))?M[d]=f:A.set(r,f),v[d]=r;for(d=-1;++d<F;)(f=A.get(r=b.call(h,g=h[d],d)))?!0!==f&&(H[d]=f,f.__data__=g):q[d]={__data__:g},A.set(r,!0);for(d=-1;++d<k;)!0!==A.get(v[d])&&(M[d]=a[d])}else{for(d=-1;++d<A;)f=a[d],g=h[d],f?(f.__data__=g,H[d]=f):q[d]={__data__:g};for(;F>d;++d)q[d]={__data__:h[d]};for(;k>d;++d)M[d]=
a[d]}q.update=H;q.parentNode=H.parentNode=M.parentNode=a.parentNode;m.push(q);n.push(H);p.push(M)}var d,f,g=-1,k=this.length;if(!arguments.length){for(a=Array(k=(d=this[0]).length);++g<k;)(f=d[g])&&(a[g]=f.__data__);return a}var m=T([]),n=V([]),p=V([]);if("function"==typeof a)for(;++g<k;)e(d=this[g],a.call(d,d.parentNode.__data__,g));else for(;++g<k;)e(d=this[g],a);return n.enter=function(){return m},n.exit=function(){return p},n};U.datum=function(a){return arguments.length?this.property("__data__",
a):this.property("__data__")};U.filter=function(a){var b,e,d,f=[];"function"!=typeof a&&(a=Xd(a));for(var g=0,l=this.length;l>g;g++){f.push(b=[]);b.parentNode=(e=this[g]).parentNode;for(var k=0,m=e.length;m>k;k++)(d=e[k])&&a.call(d,d.__data__,k,g)&&b.push(d)}return V(f)};U.order=function(){for(var a=-1,b=this.length;++a<b;)for(var e,d=this[a],f=d.length-1,g=d[f];0<=--f;)(e=d[f])&&(g&&g!==e.nextSibling&&g.parentNode.insertBefore(e,g),g=e);return this};U.sort=function(a){a=vg.apply(this,arguments);
for(var b=-1,e=this.length;++b<e;)this[b].sort(a);return this.order()};U.each=function(a){return W(this,function(b,e,d){a.call(b,b.__data__,e,d)})};U.call=function(a){var b=Oa(arguments);return a.apply(b[0]=this,b),this};U.empty=function(){return!this.node()};U.node=function(){for(var a=0,b=this.length;b>a;a++)for(var e=this[a],d=0,f=e.length;f>d;d++){var g=e[d];if(g)return g}return null};U.size=function(){var a=0;return W(this,function(){++a}),a};var Ea=[];r.selection.enter=T;r.selection.enter.prototype=
Ea;Ea.append=U.append;Ea.empty=U.empty;Ea.node=U.node;Ea.call=U.call;Ea.size=U.size;Ea.select=function(a){for(var b,e,d,f,g,l=[],k=-1,m=this.length;++k<m;){d=(f=this[k]).update;l.push(b=[]);b.parentNode=f.parentNode;for(var n=-1,p=f.length;++n<p;)(g=f[n])?(b.push(d[n]=e=a.call(f.parentNode,g.__data__,n,k)),e.__data__=g.__data__):b.push(null)}return V(l)};Ea.insert=function(a,b){return 2>arguments.length&&(b=na(this)),U.insert.call(this,a,b)};U.transition=function(){for(var a,b,e=fb||++cg,d=[],f=rc||
{time:Date.now(),ease:ph,delay:0,duration:250},g=-1,l=this.length;++g<l;){d.push(a=[]);for(var k=this[g],m=-1,n=k.length;++m<n;)(b=k[m])&&oc(b,m,e,f),a.push(b)}return Jb(d,e)};U.interrupt=function(){return this.each(Fa)};r.select=function(a){a=["string"==typeof a?Hc(a,za):a];return a.parentNode=Ga,V([a])};r.selectAll=function(a){a=Oa("string"==typeof a?Ic(a,za):a);return a.parentNode=Ga,V([a])};var bg=r.select(Ga);U.on=function(a,b,e){var d=arguments.length;if(3>d){if("string"!=typeof a){2>d&&(b=
!1);for(e in a)this.each(Zd(e,a[e],b));return this}if(2>d)return(d=this.node()["__on"+a])&&d._;e=!1}return this.each(Zd(a,b,e))};var Jc=r.map({mouseenter:"mouseover",mouseleave:"mouseout"});Jc.forEach(function(a){"on"+a in za&&Jc.remove(a)});var wb="onselectstart"in za?null:I(Ga.style,"userSelect"),xg=0;r.mouse=function(a){return Kc(a,L())};var Lc=/WebKit/.test(ja.navigator.userAgent)?-1:0;r.touch=function(a,b,e){if(3>arguments.length&&(e=b,b=L().changedTouches),b)for(var d,f=0,g=b.length;g>f;++f)if((d=
b[f]).identifier===e)return Kc(a,d)};r.behavior.drag=function(){function a(){this.on("mousedown.drag",f).on("touchstart.drag",g)}function b(a,h,f,g,l){return function(){var b,k=r.event.target,m=this.parentNode,y=e.of(this,arguments),n=0,p=a(),A=".drag"+(null==p?"":"-"+p),q=r.select(f()).on(g+A,function(){var a,e,d=h(m,p);d&&(a=d[0]-v[0],e=d[1]-v[1],n=n|a|e,v=d,y({type:"drag",x:d[0]+b[0],y:d[1]+b[1],dx:a,dy:e}))}).on(l+A,function(){h(m,p)&&(q.on(g+A,null).on(l+A,null),M(n&&r.event.target===k),y({type:"dragend"}))}),
M=Lb(),v=h(m,p);d?(b=d.apply(this,arguments),b=[b.x-v[0],b.y-v[1]]):b=[0,0];y({type:"dragstart"})}}var e=C(a,"drag","dragstart","dragend"),d=null,f=b(J,r.mouse,Ag,"mousemove","mouseup"),g=b(yg,r.touch,zg,"touchmove","touchend");return a.origin=function(b){return arguments.length?(d=b,a):d},r.rebind(a,e,"on")};r.touches=function(a,b){return 2>arguments.length&&(b=L().touches),b?Oa(b).map(function(b){var e=Kc(a,b);return e.identifier=b.identifier,e}):[]};var K=Math.PI,pa=2*K,ha=K/2,E=1E-6,jd=E*E,G=
K/180,aa=180/K,sc=Math.SQRT2;r.interpolateZoom=function(a,b){function e(a){var b=a*x;if(v){a=be(r);var h=g/(2*p),l,y=sc*b+r;l=((y=Math.exp(2*y))-1)/(y+1);l*=a;var n=r,y=((n=Math.exp(n))-1/n)/2,h=h*(l-y);return[d+h*k,f+h*m,g*a/be(sc*b+r)]}return[d+a*k,f+a*m,g*Math.exp(sc*b)]}var d=a[0],f=a[1],g=a[2],l=b[2],k=b[0]-d,m=b[1]-f,n=k*k+m*m,p=Math.sqrt(n),q=(l*l-g*g+4*n)/(4*g*p),n=(l*l-g*g-4*n)/(4*l*p),r=Math.log(Math.sqrt(q*q+1)-q),v=Math.log(Math.sqrt(n*n+1)-n)-r,x=(v||Math.log(l/g))/sc;return e.duration=
1E3*x,e};r.behavior.zoom=function(){function a(b){b.on(T,m).on(oi+".zoom",p).on("dblclick.zoom",q).on(V,n)}function b(a){return[(a[0]-Q.x)/Q.k,(a[1]-Q.y)/Q.k]}function e(a){Q.k=Math.max(Qa[0],Math.min(Qa[1],a))}function d(a,b){b=[b[0]*Q.k+Q.x,b[1]*Q.k+Q.y];Q.x+=a[0]-b[0];Q.y+=a[1]-b[1]}function f(){R&&R.domain(Ia.range().map(function(a){return(a-Q.x)/Q.k}).map(Ia.invert));ca&&ca.domain(O.range().map(function(a){return(a-Q.y)/Q.k}).map(O.invert))}function g(a){a({type:"zoomstart"})}function l(a){f();
a({type:"zoom",scale:Q.k,translate:[Q.x,Q.y]})}function k(a){a({type:"zoomend"})}function m(){var a=this,e=r.event.target,h=J.of(a,arguments),f=0,n=r.select(ja).on(I,function(){f=1;d(r.mouse(a),p);l(h)}).on(L,function(){n.on(I,null).on(L,null);F(f&&r.event.target===e);k(h)}),p=b(r.mouse(a)),F=Lb();Fa.call(a);g(h)}function n(){function a(){var e=r.touches(M);return q=Q.k,e.forEach(function(a){a.identifier in x&&(x[a.identifier]=b(a))}),e}function h(){var b=r.event.target;r.select(b).on(S,f).on(w,p);
O.push(b);for(var b=r.event.changedTouches,g=0,k=b.length;k>g;++g)x[b[g].identifier]=null;k=a();g=Date.now();1===k.length?(500>g-z&&(b=k[0],k=x[b.identifier],e(2*Q.k),d(b,k),B(),l(v)),z=g):1<k.length&&(b=k[0],k=k[1],g=b[0]-k[0],b=b[1]-k[1],t=g*g+b*b)}function f(){for(var a,b,h,g,k=r.touches(M),m=0,y=k.length;y>m;++m,g=null)if(h=k[m],g=x[h.identifier]){if(b)break;a=h;b=g}if(g){var n=(n=h[0]-a[0])*n+(n=h[1]-a[1])*n,k=t&&Math.sqrt(n/t);a=[(a[0]+h[0])/2,(a[1]+h[1])/2];b=[(b[0]+g[0])/2,(b[1]+g[1])/2];
e(k*q)}z=null;d(a,b);l(v)}function p(){if(r.event.touches.length){for(var b=r.event.changedTouches,e=0,h=b.length;h>e;++e)delete x[b[e].identifier];for(var d in x)return void a()}r.selectAll(O).on(X,null);Pa.on(T,m).on(V,n);R();k(v)}var q,M=this,v=J.of(M,arguments),x={},t=0,X=".zoom-"+r.event.changedTouches[0].identifier,S="touchmove"+X,w="touchend"+X,O=[],Pa=r.select(M),R=Lb();Fa.call(M);h();g(v);Pa.on(T,null).on(V,h)}function p(){var a=J.of(this,arguments);w?clearTimeout(w):(v=b(x=t||r.mouse(this)),
Fa.call(this),g(a));w=setTimeout(function(){w=null;k(a)},50);B();e(Math.pow(2,.002*tc())*Q.k);d(x,v);l(a)}function q(){var a=J.of(this,arguments),h=r.mouse(this),f=b(h),m=Math.log(Q.k)/Math.LN2;g(a);e(Math.pow(2,r.event.shiftKey?Math.ceil(m)-1:Math.floor(m)+1));d(h,f);l(a);k(a)}var v,x,t,w,z,Ia,R,O,ca,Q={x:0,y:0,k:1},jb=[960,500],Qa=dg,T="mousedown.zoom",I="mousemove.zoom",L="mouseup.zoom",V="touchstart.zoom",J=C(a,"zoomstart","zoom","zoomend");return a.event=function(a){a.each(function(){var a=J.of(this,
arguments),b=Q;fb?r.select(this).transition().each("start.zoom",function(){Q=this.__chart__||{x:0,y:0,k:1};g(a)}).tween("zoom:zoom",function(){var e=jb[0],h=e/2,d=jb[1]/2,f=r.interpolateZoom([(h-Q.x)/Q.k,(d-Q.y)/Q.k,e/Q.k],[(h-b.x)/b.k,(d-b.y)/b.k,e/b.k]);return function(b){b=f(b);var g=e/b[2];this.__chart__=Q={x:h-b[0]*g,y:d-b[1]*g,k:g};l(a)}}).each("end.zoom",function(){k(a)}):(this.__chart__=Q,g(a),l(a),k(a))})},a.translate=function(b){return arguments.length?(Q={x:+b[0],y:+b[1],k:Q.k},f(),a):
[Q.x,Q.y]},a.scale=function(b){return arguments.length?(Q={x:Q.x,y:Q.y,k:+b},f(),a):Q.k},a.scaleExtent=function(b){return arguments.length?(Qa=null==b?dg:[+b[0],+b[1]],a):Qa},a.center=function(b){return arguments.length?(t=b&&[+b[0],+b[1]],a):t},a.size=function(b){return arguments.length?(jb=b&&[+b[0],+b[1]],a):jb},a.x=function(b){return arguments.length?(R=b,Ia=b.copy(),Q={x:0,y:0,k:1},a):R},a.y=function(b){return arguments.length?(ca=b,O=b.copy(),Q={x:0,y:0,k:1},a):ca},r.rebind(a,J,"on")};var tc,
dg=[0,1/0],oi="onwheel"in za?(tc=function(){return-r.event.deltaY*(r.event.deltaMode?120:1)},"wheel"):"onmousewheel"in za?(tc=function(){return r.event.wheelDelta},"mousewheel"):(tc=function(){return-r.event.detail},"MozMousePixelScroll");r.color=Xa;Xa.prototype.toString=function(){return this.rgb()+""};r.hsl=Aa;var Id=Aa.prototype=new Xa;Id.brighter=function(a){return a=Math.pow(.7,arguments.length?a:1),new Aa(this.h,this.s,this.l/a)};Id.darker=function(a){return a=Math.pow(.7,arguments.length?a:
1),new Aa(this.h,this.s,a*this.l)};Id.rgb=function(){return Nc(this.h,this.s,this.l)};r.hcl=va;var Jd=va.prototype=new Xa;Jd.brighter=function(a){return new va(this.h,this.c,Math.min(100,this.l+uc*(arguments.length?a:1)))};Jd.darker=function(a){return new va(this.h,this.c,Math.max(0,this.l-uc*(arguments.length?a:1)))};Jd.rgb=function(){return Oc(this.h,this.c,this.l).rgb()};r.lab=wa;var uc=18,ie=.95047,je=1,ke=1.08883,Kd=wa.prototype=new Xa;Kd.brighter=function(a){return new wa(Math.min(100,this.l+
uc*(arguments.length?a:1)),this.a,this.b)};Kd.darker=function(a){return new wa(Math.max(0,this.l-uc*(arguments.length?a:1)),this.a,this.b)};Kd.rgb=function(){return he(this.l,this.a,this.b)};r.rgb=ka;var vc=ka.prototype=new Xa;vc.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,e=this.g,d=this.b;return b||e||d?(b&&30>b&&(b=30),e&&30>e&&(e=30),d&&30>d&&(d=30),new ka(Math.min(255,b/a),Math.min(255,e/a),Math.min(255,d/a))):new ka(30,30,30)};vc.darker=function(a){return a=Math.pow(.7,
arguments.length?a:1),new ka(a*this.r,a*this.g,a*this.b)};vc.hsl=function(){return ee(this.r,this.g,this.b)};vc.toString=function(){return"#"+ib(this.r)+ib(this.g)+ib(this.b)};var Nb=r.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,
crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,
floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,
lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,
moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,
silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Nb.forEach(function(a,b){Nb.set(a,new ka(b>>16,255&b>>8,255&b))});r.functor=Y;r.xhr=Uc(ga);r.dsv=function(a,b){function e(a,h,g){3>arguments.length&&(g=h,h=null);var l=Ob(a,b,null==h?d:
f(h),g);return l.row=function(a){return arguments.length?l.response(null==(h=a)?d:f(a)):h},l}function d(a){return e.parse(a.responseText)}function f(a){return function(b){return e.parse(b.responseText,a)}}function g(b){return b.map(l).join(a)}function l(a){return k.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}var k=new RegExp('["'+a+"\n]"),m=a.charCodeAt(0);return e.parse=function(a,b){var h;return e.parseRows(a,function(a,e){if(h)return h(a,e-1);var d=new Function("d","return {"+a.map(function(a,b){return JSON.stringify(a)+
": d["+b+"]"}).join(",")+"}");h=b?function(a,e){return b(d(a),e)}:d})},e.parseRows=function(a,b){function e(){if(y>=k)return g;if(d)return d=!1,f;var b=y;if(34===a.charCodeAt(b)){for(var h=b;h++<k;)if(34===a.charCodeAt(h)){if(34!==a.charCodeAt(h+1))break;++h}y=h+2;var l=a.charCodeAt(h+1);return 13===l?(d=!0,10===a.charCodeAt(h+2)&&++y):10===l&&(d=!0),a.slice(b+1,h).replace(/""/g,'"')}for(;k>y;){l=a.charCodeAt(y++);h=1;if(10===l)d=!0;else if(13===l)d=!0,10===a.charCodeAt(y)&&(++y,++h);else if(l!==
m)continue;return a.slice(b,y-h)}return a.slice(b)}for(var h,d,f={},g={},l=[],k=a.length,y=0,n=0;(h=e())!==g;){for(var p=[];h!==f&&h!==g;)p.push(h),h=e();b&&null==(p=b(p,n++))||l.push(p)}return l},e.format=function(b){if(Array.isArray(b[0]))return e.formatRows(b);var d=new v,f=[];return b.forEach(function(a){for(var b in a)d.has(b)||f.push(d.add(b))}),[f.map(l).join(a)].concat(b.map(function(b){return f.map(function(a){return l(b[a])}).join(a)})).join("\n")},e.formatRows=function(a){return a.map(g).join("\n")},
e};r.csv=r.dsv(",","text/csv");r.tsv=r.dsv("\t","text/tab-separated-values");var Rb,Sb,Qb,Pb,Ha,ne=ja[I(ja,"requestAnimationFrame")]||function(a){setTimeout(a,17)};r.timer=function(a,b,e){var d=arguments.length;2>d&&(b=0);3>d&&(e=Date.now());d={c:a,t:e+b,f:!1,n:null};Sb?Sb.n=d:Rb=d;Sb=d;Qb||(Pb=clearTimeout(Pb),Qb=1,ne(Vc))};r.timer.flush=function(){le();me()};r.round=function(a,b){return b?Math.round(a*(b=Math.pow(10,b)))/b:Math.round(a)};var pi="y z a f p n \u00b5 m  k M G T P E Z Y".split(" ").map(function(a,
b){var e=Math.pow(10,3*N(8-b));return{scale:8<b?function(a){return a/e}:function(a){return a*e},symbol:a}});r.formatPrefix=function(a,b){var e=0;return a&&(0>a&&(a*=-1),b&&(a=r.round(a,Wc(a,b))),e=1+Math.floor(1E-12+Math.log(a)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((e-1)/3)))),pi[8+e/3]};var oe=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Dg=r.map({b:function(a){return a.toString(2)},c:function(a){return String.fromCharCode(a)},o:function(a){return a.toString(8)},
x:function(a){return a.toString(16)},X:function(a){return a.toString(16).toUpperCase()},g:function(a,b){return a.toPrecision(b)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return(a=r.round(a,Wc(a,b))).toFixed(Math.max(0,Math.min(20,Wc(a*(1+1E-15),b))))}}),D=r.time={},ia=Date;Ja.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},
getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Na.setUTCDate.apply(this._,arguments)},setDay:function(){Na.setUTCDay.apply(this._,arguments)},setFullYear:function(){Na.setUTCFullYear.apply(this._,
arguments)},setHours:function(){Na.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Na.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Na.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Na.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Na.setUTCSeconds.apply(this._,arguments)},setTime:function(){Na.setTime.apply(this._,arguments)}};var Na=Date.prototype;D.year=Ya(function(a){return a=D.day(a),a.setMonth(0,1),a},function(a,b){a.setFullYear(a.getFullYear()+
b)},function(a){return a.getFullYear()});D.years=D.year.range;D.years.utc=D.year.utc.range;D.day=Ya(function(a){var b=new ia(2E3,0);return b.setFullYear(a.getFullYear(),a.getMonth(),a.getDate()),b},function(a,b){a.setDate(a.getDate()+b)},function(a){return a.getDate()-1});D.days=D.day.range;D.days.utc=D.day.utc.range;D.dayOfYear=function(a){var b=D.year(a);return Math.floor((a-b-6E4*(a.getTimezoneOffset()-b.getTimezoneOffset()))/864E5)};"sunday monday tuesday wednesday thursday friday saturday".split(" ").forEach(function(a,
b){b=7-b;var e=D[a]=Ya(function(a){return(a=D.day(a)).setDate(a.getDate()-(a.getDay()+b)%7),a},function(a,b){a.setDate(a.getDate()+7*Math.floor(b))},function(a){var e=D.year(a).getDay();return Math.floor((D.dayOfYear(a)+(e+b)%7)/7)-(e!==b)});D[a+"s"]=e.range;D[a+"s"].utc=e.utc.range;D[a+"OfYear"]=function(a){var e=D.year(a).getDay();return Math.floor((D.dayOfYear(a)+(e+b)%7)/7)}});D.week=D.sunday;D.weeks=D.sunday.range;D.weeks.utc=D.sunday.utc.range;D.weekOfYear=D.sundayOfYear;var qe={"-":"",_:" ",
0:"0"},ba=/^\s*\d+/,te=/^%/;r.locale=function(a){return{numberFormat:Cg(a),timeFormat:Fg(a)}};var eg=r.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),shortDays:"Sun Mon Tue Wed Thu Fri Sat".split(" "),months:"January February March April May June July August September October November December".split(" "),shortMonths:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")});
r.format=eg.numberFormat;r.geo={};Xc.prototype={s:0,t:0,add:function(a){ue(a,this.t,wc);ue(wc.s,this.s,this);this.s?this.t+=wc.t:this.s=wc.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var wc=new Xc;r.geo.stream=function(a,b){a&&fg.hasOwnProperty(a.type)?fg[a.type](a,b):Wb(a,b)};var fg={Feature:function(a,b){Wb(a.geometry,b)},FeatureCollection:function(a,b){for(var e=a.features,d=-1,f=e.length;++d<f;)Wb(e[d].geometry,b)}},ve={Sphere:function(a,b){b.sphere()},Point:function(a,
b){a=a.coordinates;b.point(a[0],a[1],a[2])},MultiPoint:function(a,b){for(var e=a.coordinates,d=-1,f=e.length;++d<f;)a=e[d],b.point(a[0],a[1],a[2])},LineString:function(a,b){Yc(a.coordinates,b,0)},MultiLineString:function(a,b){for(var e=a.coordinates,d=-1,f=e.length;++d<f;)Yc(e[d],b,0)},Polygon:function(a,b){we(a.coordinates,b)},MultiPolygon:function(a,b){for(var e=a.coordinates,d=-1,f=e.length;++d<f;)we(e[d],b)},GeometryCollection:function(a,b){for(var e=a.geometries,d=-1,f=e.length;++d<f;)Wb(e[d],
b)}};r.geo.area=function(a){return tb=0,r.geo.stream(a,oa),tb};var tb,Za=new Xc,oa={sphere:function(){tb+=4*K},point:J,lineStart:J,lineEnd:J,polygonStart:function(){Za.reset();oa.lineStart=Ug},polygonEnd:function(){var a=2*Za;tb+=0>a?4*K+a:a;oa.lineStart=oa.lineEnd=oa.point=J}};r.geo.bounds=function(){function a(b,e){O.push(ca=[p=b,v=b]);q>e&&(q=e);e>x&&(x=e)}function b(e,d){var f=$a([e*G,d*G]);if(C){var g=kb(C,f),g=kb([g[1],-g[0],0],g);Zb(g);var g=$b(g),l=e-t,m=0<l?1:-1,n=g[0]*aa*m,l=180<N(l);l^
(n>m*t&&m*e>n)?(g=g[1]*aa,g>x&&(x=g)):(n=(n+360)%360-180,l^(n>m*t&&m*e>n))?(g=-g[1]*aa,q>g&&(q=g)):(q>d&&(q=d),d>x&&(x=d));l?t>e?k(p,e)>k(p,v)&&(v=e):k(e,v)>k(p,v)&&(p=e):v>=p?(p>e&&(p=e),e>v&&(v=e)):e>t?k(p,e)>k(p,v)&&(v=e):k(e,v)>k(p,v)&&(p=e)}else a(e,d);C=f;t=e}function e(){B.point=b}function d(){ca[0]=p;ca[1]=v;B.point=a;C=null}function f(a,e){if(C){var h=a-t;R+=180<N(h)?h+(0<h?360:-360):h}else w=a,z=e;oa.point(a,e);b(a,e)}function g(){oa.lineStart()}function l(){f(w,z);oa.lineEnd();N(R)>E&&
(p=-(v=180));ca[0]=p;ca[1]=v;C=null}function k(a,b){return 0>(b-=a)?b+360:b}function m(a,b){return a[0]-b[0]}function n(a,b){return b[0]<=b[1]?b[0]<=a&&a<=b[1]:a<b[0]||b[1]<a}var p,q,v,x,t,w,z,C,R,O,ca,B={point:a,lineStart:e,lineEnd:d,polygonStart:function(){B.point=f;B.lineStart=g;B.lineEnd=l;R=0;oa.polygonStart()},polygonEnd:function(){oa.polygonEnd();B.point=a;B.lineStart=e;B.lineEnd=d;0>Za?(p=-(v=180),q=-(x=90)):R>E?x=90:-E>R&&(q=-90);ca[0]=p;ca[1]=v}};return function(a){x=v=-(p=q=1/0);O=[];r.geo.stream(a,
B);if(a=O.length){O.sort(m);for(var b,e=1,h=O[0],d=[h];a>e;++e)b=O[e],n(b[0],h)||n(b[1],h)?(k(h[0],b[1])>k(h[0],h[1])&&(h[1]=b[1]),k(b[0],h[1])>k(h[0],h[1])&&(h[0]=b[0])):d.push(h=b);var f,g=-1/0;a=d.length-1;e=0;for(h=d[a];a>=e;h=b,++e)b=d[e],(f=k(h[1],b[0]))>g&&(g=f,p=b[0],v=h[1])}return O=ca=null,1/0===p||1/0===q?[[0/0,0/0],[0/0,0/0]]:[[p,q],[v,x]]}}();r.geo.centroid=function(a){yb=lb=Ka=La=Ba=sa=ta=ma=Ra=Sa=Ca=0;r.geo.stream(a,xa);a=Ra;var b=Sa,e=Ca,d=a*a+b*b+e*e;return jd>d&&(a=sa,b=ta,e=ma,
E>lb&&(a=Ka,b=La,e=Ba),d=a*a+b*b+e*e,jd>d)?[0/0,0/0]:[Math.atan2(b,a)*aa,hb(e/Math.sqrt(d))*aa]};var yb,lb,Ka,La,Ba,sa,ta,ma,Ra,Sa,Ca,xa={sphere:J,point:$c,lineStart:xe,lineEnd:ye,polygonStart:function(){xa.lineStart=Vg},polygonEnd:function(){xa.lineStart=xe}},Oe=Be(mb,function(a){var b,e=0/0,d=0/0,f=0/0;return{lineStart:function(){a.lineStart();b=1},point:function(g,l){var k=0<g?K:-K,m=N(g-e);if(N(m-K)<E)a.point(e,d=0<(d+l)/2?ha:-ha),a.point(f,d),a.lineEnd(),a.lineStart(),a.point(k,d),a.point(g,
d),b=0;else if(f!==k&&m>=K){N(e-f)<E&&(e-=f*E);N(g-k)<E&&(g-=k*E);var m=e,n=d,p=g,q,r,v=Math.sin(m-p);d=N(v)>E?Math.atan((Math.sin(n)*(r=Math.cos(l))*Math.sin(p)-Math.sin(l)*(q=Math.cos(n))*Math.sin(m))/(q*r*v)):(n+l)/2;a.point(f,d);a.lineEnd();a.lineStart();a.point(k,d);b=0}a.point(e=g,d=l);f=k},lineEnd:function(){a.lineEnd();e=d=0/0},clean:function(){return 2-b}}},function(a,b,e,d){null==a?(e*=ha,d.point(-K,e),d.point(0,e),d.point(K,e),d.point(K,0),d.point(K,-e),d.point(0,-e),d.point(-K,-e),d.point(-K,
0),d.point(-K,e)):N(a[0]-b[0])>E?(a=a[0]<b[0]?K:-K,e=e*a/2,d.point(-a,e),d.point(0,e),d.point(a,e)):d.point(b[0],b[1])},[-K,-K/2]),cc=1E9;r.geo.clipExtent=function(){var a,b,e,d,f,g,l={stream:function(a){return f&&(f.valid=!1),f=g(a),f.valid=!0,f},extent:function(k){return arguments.length?(g=Ee(a=+k[0][0],b=+k[0][1],e=+k[1][0],d=+k[1][1]),f&&(f.valid=!1,f=null),l):[[a,b],[e,d]]}};return l.extent([[0,0],[960,500]])};(r.geo.conicEqualArea=function(){return bd(Ge)}).raw=Ge;r.geo.albers=function(){return r.geo.conicEqualArea().rotate([96,
0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)};r.geo.albersUsa=function(){function a(h){var g=h[0];h=h[1];return b=null,e(g,h),b||(d(g,h),b)||f(g,h),b}var b,e,d,f,g=r.geo.albers(),l=r.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),k=r.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),m={point:function(a,e){b=[a,e]}};return a.invert=function(a){var b=g.scale(),e=g.translate(),d=(a[0]-e[0])/b,b=(a[1]-e[1])/b;return(.12<=b&&.234>b&&-.425<=
d&&-.214>d?l:.166<=b&&.234>b&&-.214<=d&&-.115>d?k:g).invert(a)},a.stream=function(a){var b=g.stream(a),e=l.stream(a),d=k.stream(a);return{point:function(a,h){b.point(a,h);e.point(a,h);d.point(a,h)},sphere:function(){b.sphere();e.sphere();d.sphere()},lineStart:function(){b.lineStart();e.lineStart();d.lineStart()},lineEnd:function(){b.lineEnd();e.lineEnd();d.lineEnd()},polygonStart:function(){b.polygonStart();e.polygonStart();d.polygonStart()},polygonEnd:function(){b.polygonEnd();e.polygonEnd();d.polygonEnd()}}},
a.precision=function(b){return arguments.length?(g.precision(b),l.precision(b),k.precision(b),a):g.precision()},a.scale=function(b){return arguments.length?(g.scale(b),l.scale(.35*b),k.scale(b),a.translate(g.translate())):g.scale()},a.translate=function(b){if(!arguments.length)return g.translate();var n=g.scale(),y=+b[0],p=+b[1];return e=g.translate(b).clipExtent([[y-.455*n,p-.238*n],[y+.455*n,p+.238*n]]).stream(m).point,d=l.translate([y-.307*n,p+.201*n]).clipExtent([[y-.425*n+E,p+.12*n+E],[y-.214*
n-E,p+.234*n-E]]).stream(m).point,f=k.translate([y-.205*n,p+.212*n]).clipExtent([[y-.214*n+E,p+.166*n+E],[y-.115*n-E,p+.234*n-E]]).stream(m).point,a},a.scale(1070)};var xc,dc,yc,zc,Ac,Bc,Ta={point:J,lineStart:J,lineEnd:J,polygonStart:function(){dc=0;Ta.lineStart=Zg},polygonEnd:function(){Ta.lineStart=Ta.lineEnd=Ta.point=J;xc+=N(dc/2)}},qi={point:function(a,b){yc>a&&(yc=a);a>Ac&&(Ac=a);zc>b&&(zc=b);b>Bc&&(Bc=b)},lineStart:J,lineEnd:J,polygonStart:J,polygonEnd:J},ya={point:ab,lineStart:Ie,lineEnd:Je,
polygonStart:function(){ya.lineStart=ah},polygonEnd:function(){ya.point=ab;ya.lineStart=Ie;ya.lineEnd=Je}};r.geo.path=function(){function a(b){return b&&("function"==typeof l&&f.pointRadius(+l.apply(this,arguments)),g&&g.valid||(g=d(f)),r.geo.stream(b,g)),f.result()}var b,e,d,f,g,l=4.5;return a.area=function(a){return xc=0,r.geo.stream(a,d(Ta)),xc},a.centroid=function(a){return Ka=La=Ba=sa=ta=ma=Ra=Sa=Ca=0,r.geo.stream(a,d(ya)),Ca?[Ra/Ca,Sa/Ca]:ma?[sa/ma,ta/ma]:Ba?[Ka/Ba,La/Ba]:[0/0,0/0]},a.bounds=
function(a){return Ac=Bc=-(yc=zc=1/0),r.geo.stream(a,d(qi)),[[yc,zc],[Ac,Bc]]},a.projection=function(e){return arguments.length?(d=(b=e)?e.stream||ch(e):ga,g=null,a):b},a.context=function(b){return arguments.length?(f=null==(e=b)?new $g:new bh(b),"function"!=typeof l&&f.pointRadius(l),g=null,a):e},a.pointRadius=function(b){return arguments.length?(l="function"==typeof b?b:(f.pointRadius(+b),+b),a):l},a.projection(r.geo.albersUsa()).context(null)};r.geo.transform=function(a){return{stream:function(b){b=
new Ne(b);for(var e in a)b[e]=a[e];return b}}};Ne.prototype={point:function(a,b){this.stream.point(a,b)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};r.geo.projection=Ua;r.geo.projectionMutator=cd;(r.geo.equirectangular=function(){return Ua(zb)}).raw=zb.invert=zb;r.geo.rotation=function(a){function b(e){return e=a(e[0]*
G,e[1]*G),e[0]*=aa,e[1]*=aa,e}return a=dd(a[0]%360*G,a[1]*G,2<a.length?a[2]*G:0),b.invert=function(b){return b=a.invert(b[0]*G,b[1]*G),b[0]*=aa,b[1]*=aa,b},b};Pe.invert=zb;r.geo.circle=function(){function a(){var b="function"==typeof d?d.apply(this,arguments):d,h=dd(-b[0]*G,-b[1]*G,0).invert,f=[];return e(null,null,1,{point:function(a,b){f.push(a=h(a,b));a[0]*=aa;a[1]*=aa}}),{type:"Polygon",coordinates:[f]}}var b,e,d=[0,0],f=6;return a.origin=function(b){return arguments.length?(d=b,a):d},a.angle=
function(d){return arguments.length?(e=ad((b=+d)*G,f*G),a):b},a.precision=function(d){return arguments.length?(e=ad(b*G,(f=+d)*G),a):f},a.angle(90)};r.geo.distance=function(a,b){var e,d=(b[0]-a[0])*G,f=a[1]*G,g=b[1]*G,l=Math.sin(d),d=Math.cos(d),k=Math.sin(f),f=Math.cos(f),m=Math.sin(g),g=Math.cos(g);return Math.atan2(Math.sqrt((e=g*l)*e+(e=f*m-k*g*d)*e),k*m+f*g*d)};r.geo.graticule=function(){function a(){return{type:"MultiLineString",coordinates:b()}}function b(){return r.range(Math.ceil(g/C)*C,
f,C).map(v).concat(r.range(Math.ceil(n/z)*z,m,z).map(x)).concat(r.range(Math.ceil(d/t)*t,e,t).filter(function(a){return N(a%C)>E}).map(p)).concat(r.range(Math.ceil(k/w)*w,l,w).filter(function(a){return N(a%z)>E}).map(q))}var e,d,f,g,l,k,m,n,p,q,v,x,t=10,w=t,C=90,z=360,R=2.5;return a.lines=function(){return b().map(function(a){return{type:"LineString",coordinates:a}})},a.outline=function(){return{type:"Polygon",coordinates:[v(g).concat(x(m).slice(1),v(f).reverse().slice(1),x(n).reverse().slice(1))]}},
a.extent=function(b){return arguments.length?a.majorExtent(b).minorExtent(b):a.minorExtent()},a.majorExtent=function(b){return arguments.length?(g=+b[0][0],f=+b[1][0],n=+b[0][1],m=+b[1][1],g>f&&(b=g,g=f,f=b),n>m&&(b=n,n=m,m=b),a.precision(R)):[[g,n],[f,m]]},a.minorExtent=function(b){return arguments.length?(d=+b[0][0],e=+b[1][0],k=+b[0][1],l=+b[1][1],d>e&&(b=d,d=e,e=b),k>l&&(b=k,k=l,l=b),a.precision(R)):[[d,k],[e,l]]},a.step=function(b){return arguments.length?a.majorStep(b).minorStep(b):a.minorStep()},
a.majorStep=function(b){return arguments.length?(C=+b[0],z=+b[1],a):[C,z]},a.minorStep=function(b){return arguments.length?(t=+b[0],w=+b[1],a):[t,w]},a.precision=function(b){return arguments.length?(R=+b,p=Ue(k,l,90),q=Ve(d,e,R),v=Ue(n,m,90),x=Ve(g,f,R),a):R},a.majorExtent([[-180,-90+E],[180,90-E]]).minorExtent([[-180,-80-E],[180,80+E]])};r.geo.greatArc=function(){function a(){return{type:"LineString",coordinates:[b||d.apply(this,arguments),e||f.apply(this,arguments)]}}var b,e,d=ed,f=fd;return a.distance=
function(){return r.geo.distance(b||d.apply(this,arguments),e||f.apply(this,arguments))},a.source=function(e){return arguments.length?(d=e,b="function"==typeof e?null:e,a):d},a.target=function(b){return arguments.length?(f=b,e="function"==typeof b?null:b,a):f},a.precision=function(){return arguments.length?a:0},a};r.geo.interpolate=function(a,b){return dh(a[0]*G,a[1]*G,b[0]*G,b[1]*G)};r.geo.length=function(a){return Cc=0,r.geo.stream(a,ub),Cc};var Cc,ub={sphere:J,point:J,lineStart:function(){function a(h,
f){var g=Math.sin(f*=G),l=Math.cos(f),k=N((h*=G)-b),m=Math.cos(k);Cc+=Math.atan2(Math.sqrt((k=l*Math.sin(k))*k+(k=d*g-e*l*m)*k),e*g+d*l*m);b=h;e=g;d=l}var b,e,d;ub.point=function(f,g){b=f*G;e=Math.sin(g*=G);d=Math.cos(g);ub.point=a};ub.lineEnd=function(){ub.point=ub.lineEnd=J}},lineEnd:J,polygonStart:J,polygonEnd:J},gg=Ab(function(a){return Math.sqrt(2/(1+a))},function(a){return 2*Math.asin(a/2)});(r.geo.azimuthalEqualArea=function(){return Ua(gg)}).raw=gg;var hg=Ab(function(a){return(a=Math.acos(a))&&
a/Math.sin(a)},ga);(r.geo.azimuthalEquidistant=function(){return Ua(hg)}).raw=hg;(r.geo.conicConformal=function(){return bd(We)}).raw=We;(r.geo.conicEquidistant=function(){return bd(Xe)}).raw=Xe;var ig=Ab(function(a){return 1/a},Math.atan);(r.geo.gnomonic=function(){return Ua(ig)}).raw=ig;ec.invert=function(a,b){return[a,2*Math.atan(Math.exp(b))-ha]};(r.geo.mercator=function(){return Ye(ec)}).raw=ec;var jg=Ab(function(){return 1},Math.asin);(r.geo.orthographic=function(){return Ua(jg)}).raw=jg;var kg=
Ab(function(a){return 1/(1+a)},function(a){return 2*Math.atan(a)});(r.geo.stereographic=function(){return Ua(kg)}).raw=kg;gd.invert=function(a,b){return[-b,2*Math.atan(Math.exp(a))-ha]};(r.geo.transverseMercator=function(){var a=Ye(gd),b=a.center,e=a.rotate;return a.center=function(a){return a?b([-a[1],a[0]]):(a=b(),[a[1],-a[0]])},a.rotate=function(a){return a?e([a[0],a[1],2<a.length?a[2]+90:90]):(a=e(),[a[0],a[1],a[2]-90])},e([0,0,90])}).raw=gd;r.geom={};r.geom.hull=function(a){function b(a){if(3>
a.length)return[];var h,f=Y(e),g=Y(d),l=a.length,k=[],m=[];for(h=0;l>h;h++)k.push([+f.call(this,a[h],h),+g.call(this,a[h],h),h]);k.sort(eh);for(h=0;l>h;h++)m.push([k[h][0],-k[h][1]]);var f=Ze(k),m=Ze(m),g=m[0]===f[0],l=m[m.length-1]===f[f.length-1],n=[];for(h=f.length-1;0<=h;--h)n.push(a[k[f[h]][2]]);for(h=+g;h<m.length-l;++h)n.push(a[k[m[h]][2]]);return n}var e=nb,d=Bb;return arguments.length?b(a):(b.x=function(a){return arguments.length?(e=a,b):e},b.y=function(a){return arguments.length?(d=a,b):
d},b)};r.geom.polygon=function(a){return Kb(a,Dc),a};var Dc=r.geom.polygon.prototype=[];Dc.area=function(){for(var a,b=-1,e=this.length,d=this[e-1],f=0;++b<e;)a=d,d=this[b],f+=a[1]*d[0]-a[0]*d[1];return.5*f};Dc.centroid=function(a){var b,e,d=-1,f=this.length,g=0,l=0,k=this[f-1];for(arguments.length||(a=-1/(6*this.area()));++d<f;)b=k,k=this[d],e=b[0]*k[1]-k[0]*b[1],g+=(b[0]+k[0])*e,l+=(b[1]+k[1])*e;return[g*a,l*a]};Dc.clip=function(a){for(var b,e,d,f,g,l,k=af(a),m=-1,n=this.length-af(this),p=this[n-
1];++m<n;){b=a.slice();a.length=0;f=this[m];g=b[(d=b.length-k)-1];for(e=-1;++e<d;)l=b[e],hd(l,p,f)?(hd(g,p,f)||a.push($e(g,l,p,f)),a.push(l)):hd(g,p,f)&&a.push($e(g,l,p,f)),g=l;k&&a.push(a[0]);p=f}return a};var rb,bb,pb,kd,Cb,cf=[],gf=[];ef.prototype.prepare=function(){for(var a,b=this.edges,e=b.length;e--;)a=b[e].edge,a.b&&a.a||b.splice(e,1);return b.sort(ff),b.length};hc.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?
this.edge.b:this.edge.a}};ld.prototype={insert:function(a,b){var e,d,f;if(a){if(b.P=a,b.N=a.N,a.N&&(a.N.P=b),a.N=b,a.R){for(a=a.R;a.L;)a=a.L;a.L=b}else a.R=b;e=a}else this._?(a=jf(this._),b.P=null,b.N=a,a.P=a.L=b,e=a):(b.P=b.N=null,this._=b,e=null);b.L=b.R=null;b.U=e;b.C=!0;for(a=b;e&&e.C;)d=e.U,e===d.L?(f=d.R,f&&f.C?(e.C=f.C=!1,d.C=!0,a=d):(a===e.R&&(Eb(this,e),a=e,e=a.U),e.C=!1,d.C=!0,Fb(this,d))):(f=d.L,f&&f.C?(e.C=f.C=!1,d.C=!0,a=d):(a===e.L&&(Fb(this,e),a=e,e=a.U),e.C=!1,d.C=!0,Eb(this,d))),
e=a.U;this._.C=!1},remove:function(a){a.N&&(a.N.P=a.P);a.P&&(a.P.N=a.N);a.N=a.P=null;var b,e,d,f=a.U,g=a.L,l=a.R;if(e=g?l?jf(l):g:l,f?f.L===a?f.L=e:f.R=e:this._=e,g&&l?(d=e.C,e.C=a.C,e.L=g,g.U=e,e!==l?(f=e.U,e.U=a.U,a=e.R,f.L=a,e.R=l,l.U=e):(e.U=f,f=e,a=e.R)):(d=a.C,a=e),a&&(a.U=f),!d){if(a&&a.C)return a.C=!1,void 0;do{if(a===this._)break;if(a===f.L){if(b=f.R,b.C&&(b.C=!1,f.C=!0,Eb(this,f),b=f.R),b.L&&b.L.C||b.R&&b.R.C){b.R&&b.R.C||(b.L.C=!1,b.C=!0,Fb(this,b),b=f.R);b.C=f.C;f.C=b.R.C=!1;Eb(this,f);
a=this._;break}}else if(b=f.L,b.C&&(b.C=!1,f.C=!0,Fb(this,f),b=f.L),b.L&&b.L.C||b.R&&b.R.C){b.L&&b.L.C||(b.R.C=!1,b.C=!0,Eb(this,b),b=f.L);b.C=f.C;f.C=b.L.C=!1;Fb(this,f);a=this._;break}b.C=!0;a=f;f=f.U}while(!a.C);a&&(a.C=!1)}}};r.geom.voronoi=function(a){function b(a){var d=Array(a.length),h=k[0][0],f=k[0][1],g=k[1][0],l=k[1][1];return md(e(a),k).cells.forEach(function(b,e){var k=b.edges,m=b.site;(d[e]=k.length?k.map(function(a){a=a.start();return[a.x,a.y]}):m.x>=h&&m.x<=g&&m.y>=f&&m.y<=l?[[h,l],
[g,l],[g,f],[h,f]]:[]).point=a[e]}),d}function e(a){return a.map(function(a,b){return{x:Math.round(g(a,b)/E)*E,y:Math.round(l(a,b)/E)*E,i:b}})}var d=nb,f=Bb,g=d,l=f,k=Ec;return a?b(a):(b.links=function(a){return md(e(a)).edges.filter(function(a){return a.l&&a.r}).map(function(b){return{source:a[b.l.i],target:a[b.r.i]}})},b.triangles=function(a){var b=[];return md(e(a)).cells.forEach(function(e,d){for(var h,f=e.site,g=e.edges.sort(ff),l=-1,k=g.length,m=g[k-1].edge,m=m.l===f?m.r:m.l;++l<k;)h=m,m=g[l].edge,
m=m.l===f?m.r:m.l,d<h.i&&d<m.i&&0>(f.x-m.x)*(h.y-f.y)-(f.x-h.x)*(m.y-f.y)&&b.push([a[d],a[h.i],a[m.i]])}),b},b.x=function(a){return arguments.length?(g=Y(d=a),b):d},b.y=function(a){return arguments.length?(l=Y(f=a),b):f},b.clipExtent=function(a){return arguments.length?(k=null==a?Ec:a,b):k===Ec?null:k},b.size=function(a){return arguments.length?b.clipExtent(a&&[[0,0],a]):k===Ec?null:k&&k[1]},b)};var Ec=[[-1E6,-1E6],[1E6,1E6]];r.geom.delaunay=function(a){return r.geom.voronoi().triangles(a)};r.geom.quadtree=
function(a,b,e,d,f){function g(a){function h(a,b,e,d,f,g,l,k){if(!isNaN(e)&&!isNaN(d))if(a.leaf){var m=a.x,p=a.y;if(null!=m){if(!(.01>N(m-e)+N(p-d))){var q=a.point;a.x=a.y=a.point=null;n(a,q,m,p,f,g,l,k)}n(a,b,e,d,f,g,l,k)}else a.x=e,a.y=d,a.point=b}else n(a,b,e,d,f,g,l,k)}function n(a,b,e,d,f,g,l,k){var m=.5*(f+l),p=.5*(g+k),q=e>=m,y=d>=p,r=(y<<1)+q;a.leaf=!1;a=a.nodes[r]||(a.nodes[r]=kf());q?f=m:l=m;y?g=p:k=p;h(a,b,e,d,f,g,l,k)}var p,q,r,A,v,x,t,w,C,z=Y(k),B=Y(m);if(null!=b)x=b,t=e,w=d,C=f;else if(w=
C=-(x=t=1/0),q=[],r=[],v=a.length,l)for(A=0;v>A;++A)p=a[A],p.x<x&&(x=p.x),p.y<t&&(t=p.y),p.x>w&&(w=p.x),p.y>C&&(C=p.y),q.push(p.x),r.push(p.y);else for(A=0;v>A;++A){var T=+z(p=a[A],A);p=+B(p,A);x>T&&(x=T);t>p&&(t=p);T>w&&(w=T);p>C&&(C=p);q.push(T);r.push(p)}T=w-x;p=C-t;T>p?C=t+T:w=x+p;var I=kf();if(I.add=function(a){h(I,a,+z(a,++A),+B(a,A),x,t,w,C)},I.visit=function(a){Gb(a,I,x,t,w,C)},A=-1,null==b){for(;++A<v;)h(I,a[A],q[A],r[A],x,t,w,C);--A}else a.forEach(I.add);return q=r=a=p=null,I}var l,k=nb,
m=Bb;return(l=arguments.length)?(k=kh,m=lh,3===l&&(f=e,d=b,e=b=0),g(a)):(g.x=function(a){return arguments.length?(k=a,g):k},g.y=function(a){return arguments.length?(m=a,g):m},g.extent=function(a){return arguments.length?(null==a?b=e=d=f=null:(b=+a[0][0],e=+a[0][1],d=+a[1][0],f=+a[1][1]),g):null==b?null:[[b,e],[d,f]]},g.size=function(a){return arguments.length?(null==a?b=e=d=f=null:(b=e=0,d=+a[0],f=+a[1]),g):null==b?null:[d-b,f-e]},g)};r.interpolateRgb=nd;r.interpolateObject=lf;r.interpolateNumber=
Ma;r.interpolateString=mf;var od=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,pd=new RegExp(od.source,"g");r.interpolate=cb;r.interpolators=[function(a,b){var e=typeof b;return("string"===e?Nb.has(b)||/^(#|rgb\(|hsl\()/.test(b)?nd:mf:b instanceof Xa?nd:Array.isArray(b)?ic:"object"===e&&isNaN(b)?lf:Ma)(a,b)}];r.interpolateArray=ic;var lg=function(){return ga},ri=r.map({linear:lg,poly:function(a){return function(b){return Math.pow(b,a)}},quad:function(){return nh},cubic:function(){return oh},sin:function(){return qh},
exp:function(){return rh},circle:function(){return sh},elastic:function(a,b){var e;return 2>arguments.length&&(b=.45),arguments.length?e=b/pa*Math.asin(1/a):(a=1,e=b/4),function(d){return 1+a*Math.pow(2,-10*d)*Math.sin((d-e)*pa/b)}},back:function(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}},bounce:function(){return th}}),si=r.map({"in":ga,out:nf,"in-out":of,"out-in":function(a){return of(nf(a))}});r.ease=function(a){var b=a.indexOf("-"),e=0<=b?a.slice(0,b):a,b=0<=b?a.slice(b+1):"in";
return e=ri.get(e)||lg,b=si.get(b)||ga,mh(b(e.apply(null,Zf.call(arguments,1))))};r.interpolateHcl=function(a,b){a=r.hcl(a);b=r.hcl(b);var e=a.h,d=a.c,f=a.l,g=b.h-e,l=b.c-d,k=b.l-f;return isNaN(l)&&(l=0,d=isNaN(d)?b.c:d),isNaN(g)?(g=0,e=isNaN(e)?b.h:e):180<g?g-=360:-180>g&&(g+=360),function(a){return Oc(e+g*a,d+l*a,f+k*a)+""}};r.interpolateHsl=function(a,b){a=r.hsl(a);b=r.hsl(b);var e=a.h,d=a.s,f=a.l,g=b.h-e,l=b.s-d,k=b.l-f;return isNaN(l)&&(l=0,d=isNaN(d)?b.s:d),isNaN(g)?(g=0,e=isNaN(e)?b.h:e):180<
g?g-=360:-180>g&&(g+=360),function(a){return Nc(e+g*a,d+l*a,f+k*a)+""}};r.interpolateLab=function(a,b){a=r.lab(a);b=r.lab(b);var e=a.l,d=a.a,f=a.b,g=b.l-e,l=b.a-d,k=b.b-f;return function(a){return he(e+g*a,d+l*a,f+k*a)+""}};r.interpolateRound=pf;r.transform=function(a){var b=za.createElementNS(r.ns.prefix.svg,"g");return(r.transform=function(a){if(null!=a){b.setAttribute("transform",a);var e=b.transform.baseVal.consolidate()}return new qf(e?e.matrix:ti)})(a)};qf.prototype.toString=function(){return"translate("+
this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ti={a:1,b:0,c:0,d:1,e:0,f:0};r.interpolateTransform=sf;r.layout={};r.layout.bundle=function(){return function(a){for(var b=[],e=-1,d=a.length;++e<d;)b.push(wh(a[e]));return b}};r.layout.chord=function(){function a(){var h,n,q,v,x,t={},w=[],P=r.range(g),C=[];e=[];d=[];h=0;for(v=-1;++v<g;){n=0;for(x=-1;++x<g;)n+=f[v][x];w.push(n);C.push(r.range(g));h+=n}l&&P.sort(function(a,b){return l(w[a],w[b])});k&&C.forEach(function(a,
b){a.sort(function(a,e){return k(f[b][a],f[b][e])})});h=(pa-p*g)/h;n=0;for(v=-1;++v<g;){q=n;for(x=-1;++x<g;){var z=P[v],B=C[z][x],T=f[z][B],I=n,L=n+=T*h;t[z+"-"+B]={index:z,subindex:B,startAngle:I,endAngle:L,value:T}}d[z]={index:z,startAngle:q,endAngle:n,value:(n-q)/h};n+=p}for(v=-1;++v<g;)for(x=v-1;++x<g;)h=t[v+"-"+x],n=t[x+"-"+v],(h.value||n.value)&&e.push(h.value<n.value?{source:n,target:h}:{source:h,target:n});m&&b()}function b(){e.sort(function(a,b){return m((a.source.value+a.target.value)/2,
(b.source.value+b.target.value)/2)})}var e,d,f,g,l,k,m,n={},p=0;return n.matrix=function(a){return arguments.length?(g=(f=a)&&f.length,e=d=null,n):f},n.padding=function(a){return arguments.length?(p=a,e=d=null,n):p},n.sortGroups=function(a){return arguments.length?(l=a,e=d=null,n):l},n.sortSubgroups=function(a){return arguments.length?(k=a,e=null,n):k},n.sortChords=function(a){return arguments.length?(m=a,e&&b(),n):m},n.chords=function(){return e||a(),e},n.groups=function(){return d||a(),d},n};r.layout.force=
function(){function a(b){return function(a,e,d,h){if(a.point!==b){d=a.cx-b.x;var f=a.cy-b.y;e=h-e;h=d*d+f*f;if(h>e*e/C)return t>h&&(e=a.charge/h,b.px-=d*e,b.py-=f*e),!0;a.point&&h&&t>h&&(e=a.pointCharge/h,b.px-=d*e,b.py-=f*e)}return!a.charge}}function b(a){a.px=r.event.x;a.py=r.event.y;k.resume()}var e,d,f,g,l,k={},m=r.dispatch("start","tick","end"),n=[1,1],p=.9,q=ui,v=vi,x=-30,t=wi,w=.1,C=.64,z=[],B=[];return k.tick=function(){if(.005>(d*=.99))return m.end({type:"end",alpha:d=0}),!0;var b,e,k,q,
y,v,t,F,C=z.length,ea=B.length;for(e=0;ea>e;++e)k=B[e],b=k.source,q=k.target,t=q.x-b.x,F=q.y-b.y,(y=t*t+F*F)&&(y=d*g[e]*((y=Math.sqrt(y))-f[e])/y,t*=y,F*=y,q.x-=t*(v=b.weight/(q.weight+b.weight)),q.y-=F*v,b.x+=t*(v=1-v),b.y+=F*v);if((v=d*w)&&(t=n[0]/2,F=n[1]/2,e=-1,v))for(;++e<C;)k=z[e],k.x+=(t-k.x)*v,k.y+=(F-k.y)*v;if(x)for(uf(b=r.geom.quadtree(z),d,l),e=-1;++e<C;)(k=z[e]).fixed||b.visit(a(k));for(e=-1;++e<C;)k=z[e],k.fixed?(k.x=k.px,k.y=k.py):(k.x-=(k.px-(k.px=k.x))*p,k.y-=(k.py-(k.py=k.y))*p);
m.tick({type:"tick",alpha:d})},k.nodes=function(a){return arguments.length?(z=a,k):z},k.links=function(a){return arguments.length?(B=a,k):B},k.size=function(a){return arguments.length?(n=a,k):n},k.linkDistance=function(a){return arguments.length?(q="function"==typeof a?a:+a,k):q},k.distance=k.linkDistance,k.linkStrength=function(a){return arguments.length?(v="function"==typeof a?a:+a,k):v},k.friction=function(a){return arguments.length?(p=+a,k):p},k.charge=function(a){return arguments.length?(x="function"==
typeof a?a:+a,k):x},k.chargeDistance=function(a){return arguments.length?(t=a*a,k):Math.sqrt(t)},k.gravity=function(a){return arguments.length?(w=+a,k):w},k.theta=function(a){return arguments.length?(C=a*a,k):Math.sqrt(C)},k.alpha=function(a){return arguments.length?(a=+a,d?d=0<a?a:0:0<a&&(m.start({type:"start",alpha:d=a}),r.timer(k.tick)),k):d},k.start=function(){function a(d,f){if(!e){e=Array(h);for(k=0;h>k;++k)e[k]=[];for(k=0;m>k;++k){var g=B[k];e[g.source.index].push(g.target);e[g.target.index].push(g.source)}}for(var l=
e[b],k=-1,m=l.length;++k<m;)if(!isNaN(g=l[k][d]))return g;return Math.random()*f}var b,e,d,h=z.length,m=B.length,p=n[0],r=n[1];for(b=0;h>b;++b)(d=z[b]).index=b,d.weight=0;for(b=0;m>b;++b)d=B[b],"number"==typeof d.source&&(d.source=z[d.source]),"number"==typeof d.target&&(d.target=z[d.target]),++d.source.weight,++d.target.weight;for(b=0;h>b;++b)d=z[b],isNaN(d.x)&&(d.x=a("x",p)),isNaN(d.y)&&(d.y=a("y",r)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y);if(f=[],"function"==typeof q)for(b=0;m>b;++b)f[b]=
+q.call(this,B[b],b);else for(b=0;m>b;++b)f[b]=q;if(g=[],"function"==typeof v)for(b=0;m>b;++b)g[b]=+v.call(this,B[b],b);else for(b=0;m>b;++b)g[b]=v;if(l=[],"function"==typeof x)for(b=0;h>b;++b)l[b]=+x.call(this,z[b],b);else for(b=0;h>b;++b)l[b]=x;return k.resume()},k.resume=function(){return k.alpha(.1)},k.stop=function(){return k.alpha(0)},k.drag=function(){return e||(e=r.behavior.drag().origin(ga).on("dragstart.force",xh).on("drag.force",b).on("dragend.force",yh)),arguments.length?(this.on("mouseover.force",
zh).on("mouseout.force",Ah).call(e),void 0):e},r.rebind(k,m,"on")};var ui=20,vi=1,wi=1/0;r.layout.hierarchy=function(){function a(f){var g,l=[f],k=[];for(f.depth=0;null!=(g=l.pop());)if(k.push(g),(n=e.call(a,g,g.depth))&&(m=n.length)){for(var m,n,p;0<=--m;)l.push(p=n[m]),p.parent=g,p.depth=g.depth+1;d&&(g.value=0);g.children=n}else d&&(g.value=+d.call(a,g,g.depth)||0),delete g.children;return Da(f,function(a){var e,h;b&&(e=a.children)&&e.sort(b);d&&(h=a.parent)&&(h.value+=a.value)}),k}var b=Eh,e=
Ch,d=Dh;return a.sort=function(e){return arguments.length?(b=e,a):b},a.children=function(b){return arguments.length?(e=b,a):e},a.value=function(b){return arguments.length?(d=b,a):d},a.revalue=function(b){return d&&(Ib(b,function(a){a.children&&(a.value=0)}),Da(b,function(b){var e;b.children||(b.value=+d.call(a,b,b.depth)||0);(e=b.parent)&&(e.value+=b.value)})),b},a};r.layout.partition=function(){function a(b,e,d,f){var g=b.children;if(b.x=e,b.y=b.depth*f,b.dx=d,b.dy=f,g&&(l=g.length)){var l,k,m=-1;
for(d=b.value?d/b.value:0;++m<l;)a(k=g[m],e,b=k.value*d,f),e+=b}}function b(a){a=a.children;var e=0;if(a&&(d=a.length))for(var d,h=-1;++h<d;)e=Math.max(e,b(a[h]));return 1+e}function e(g,l){var k=d.call(this,g,l);return a(k[0],0,f[0],f[1]/b(k[0])),k}var d=r.layout.hierarchy(),f=[1,1];return e.size=function(a){return arguments.length?(f=a,e):f},Hb(e,d)};r.layout.pie=function(){function a(g){var l=g.map(function(e,d){return+b.call(a,e,d)}),k=+("function"==typeof d?d.apply(this,arguments):d),m=(("function"==
typeof f?f.apply(this,arguments):f)-k)/r.sum(l),n=r.range(g.length);null!=e&&n.sort(e===mg?function(a,b){return l[b]-l[a]}:function(a,b){return e(g[a],g[b])});var p=[];return n.forEach(function(a){var b;p[a]={data:g[a],value:b=l[a],startAngle:k,endAngle:k+=b*m}}),p}var b=Number,e=mg,d=0,f=pa;return a.value=function(e){return arguments.length?(b=e,a):b},a.sort=function(b){return arguments.length?(e=b,a):e},a.startAngle=function(b){return arguments.length?(d=b,a):d},a.endAngle=function(b){return arguments.length?
(f=b,a):f},a};var mg={};r.layout.stack=function(){function a(k,m){if(!(v=k.length))return k;var n=k.map(function(e,d){return b.call(a,e,d)}),p=n.map(function(b){return b.map(function(b,e){return[g.call(a,b,e),l.call(a,b,e)]})}),q=e.call(a,p,m),n=r.permute(n,q),p=r.permute(p,q),v,x,t,w=d.call(a,p,m),C=n[0].length;for(x=0;C>x;++x)for(f.call(a,n[0][x],t=w[x],p[0][x][1]),q=1;v>q;++q)f.call(a,n[q][x],t+=p[q-1][x][1],p[q][x][1]);return k}var b=ga,e=qd,d=rd,f=Hh,g=Fh,l=Gh;return a.values=function(e){return arguments.length?
(b=e,a):b},a.order=function(b){return arguments.length?(e="function"==typeof b?b:xi.get(b)||qd,a):e},a.offset=function(b){return arguments.length?(d="function"==typeof b?b:yi.get(b)||rd,a):d},a.x=function(b){return arguments.length?(g=b,a):g},a.y=function(b){return arguments.length?(l=b,a):l},a.out=function(b){return arguments.length?(f=b,a):f},a};var xi=r.map({"inside-out":function(a){var b,e=a.length,d=a.map(Ih),f=a.map(Jh),g=r.range(e).sort(function(a,b){return d[a]-d[b]}),l=0,k=0,m=[],n=[];for(a=
0;e>a;++a)b=g[a],k>l?(l+=f[b],m.push(b)):(k+=f[b],n.push(b));return n.reverse().concat(m)},reverse:function(a){return r.range(a.length).reverse()},"default":qd}),yi=r.map({silhouette:function(a){var b,e,d,f=a.length,g=a[0].length,l=[],k=0,m=[];for(e=0;g>e;++e){for(d=b=0;f>b;b++)d+=a[b][e][1];d>k&&(k=d);l.push(d)}for(e=0;g>e;++e)m[e]=(k-l[e])/2;return m},wiggle:function(a){var b,e,d,f,g,l,k,m,n,p=a.length,q=a[0],r=q.length,v=[];v[0]=m=n=0;for(e=1;r>e;++e){for(f=b=0;p>b;++b)f+=a[b][e][1];g=b=0;for(k=
q[e][0]-q[e-1][0];p>b;++b){d=0;for(l=(a[b][e][1]-a[b][e-1][1])/(2*k);b>d;++d)l+=(a[d][e][1]-a[d][e-1][1])/k;g+=l*a[b][e][1]}v[e]=m-=f?g/f*k:0;n>m&&(n=m)}for(e=0;r>e;++e)v[e]-=n;return v},expand:function(a){var b,e,d,f=a.length,g=a[0].length,l=1/f,k=[];for(e=0;g>e;++e){for(d=b=0;f>b;b++)d+=a[b][e][1];if(d)for(b=0;f>b;b++)a[b][e][1]/=d;else for(b=0;f>b;b++)a[b][e][1]=l}for(e=0;g>e;++e)k[e]=0;return k},zero:rd});r.layout.histogram=function(){function a(h,g){var l,k,m=[],n=h.map(e,this),p=d.call(this,
n,g),q=f.call(this,p,n,g);g=-1;for(var v=n.length,x=q.length-1,t=b?1:1/v;++g<x;)l=m[g]=[],l.dx=q[g+1]-(l.x=q[g]),l.y=0;if(0<x)for(g=-1;++g<v;)k=n[g],k>=p[0]&&k<=p[1]&&(l=m[r.bisect(q,k,1,x)-1],l.y+=t,l.push(h[g]));return m}var b=!0,e=Number,d=Mh,f=Lh;return a.value=function(b){return arguments.length?(e=b,a):e},a.range=function(b){return arguments.length?(d=Y(b),a):d},a.bins=function(b){return arguments.length?(f="number"==typeof b?function(a){return vf(a,b)}:Y(b),a):f},a.frequency=function(e){return arguments.length?
(b=!!e,a):b},a};r.layout.pack=function(){function a(h,g){var l=e.call(this,h,g),k=l[0],m=f[0],n=f[1],p=null==b?Math.sqrt:"function"==typeof b?b:function(){return b};if(k.x=k.y=0,Da(k,function(a){a.r=+p(a.value)}),Da(k,yf),d){var q=d*(b?1:Math.max(2*k.r/m,2*k.r/n))/2;Da(k,function(a){a.r+=q});Da(k,yf);Da(k,function(a){a.r-=q})}return Af(k,m/2,n/2,b?1:1/Math.max(2*k.r/m,2*k.r/n)),l}var b,e=r.layout.hierarchy().sort(Nh),d=0,f=[1,1];return a.size=function(b){return arguments.length?(f=b,a):f},a.radius=
function(e){return arguments.length?(b=null==e||"function"==typeof e?e:+e,a):b},a.padding=function(b){return arguments.length?(d=+b,a):d},Hb(a,e)};r.layout.tree=function(){function a(h,n){var p=g.call(this,h,n),q=p[0],r=b(q);if(Da(r,e),r.parent.m=-r.z,Ib(r,d),m)Ib(q,f);else{var v=q,x=q,t=q;Ib(q,function(a){a.x<v.x&&(v=a);a.x>x.x&&(x=a);a.depth>t.depth&&(t=a)});var w=l(v,x)/2-v.x,C=k[0]/(x.x+l(x,v)/2+w),z=k[1]/(t.depth||1);Ib(q,function(a){a.x=(a.x+w)*C;a.y=a.depth*z})}return p}function b(a){for(var e=
{A:null,children:[a]},d=[e];null!=(a=d.pop());)for(var f,h=a.children,g=0,l=h.length;l>g;++g)d.push((h[g]=f={_:h[g],parent:a,children:(f=h[g].children)&&f.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:g}).a=f);return e.children[0]}function e(a){var b=a.children,d=a.parent.children,f=a.i?d[a.i-1]:null;if(b.length){for(var h,g=0,k=0,m=a.children,n=m.length;0<=--n;)h=m[n],h.z+=g,h.m+=g,g+=h.s+(k+=h.c);b=(b[0].z+b[b.length-1].z)/2;f?(a.z=f.z+l(a._,f._),a.m=a.z-b):a.z=b}else f&&(a.z=f.z+l(a._,f._));
b=a.parent;d=a.parent.A||d[0];if(f){for(var g=h=a,k=f,m=h.parent.children[0],n=h.m,p=g.m,q=k.m,r=m.m;k=ud(k),h=td(h),k&&h;){m=td(m);g=ud(g);g.a=a;f=k.z+q-h.z-n+l(k._,h._);if(0<f){var v=k.a.parent===a.parent?k.a:d,x=a,t=f,y=t/(x.i-v.i);x.c-=y;x.s+=t;v.c+=y;x.z+=t;x.m+=t;n+=f;p+=f}q+=k.m;n+=h.m;r+=m.m;p+=g.m}k&&!ud(g)&&(g.t=k,g.m+=q-p);h&&!td(m)&&(m.t=h,m.m+=n-r,d=a)}b.A=d}function d(a){a._.x=a.z+a.parent.m;a.m+=a.parent.m}function f(a){a.x*=k[0];a.y=a.depth*k[1]}var g=r.layout.hierarchy().sort(null).value(null),
l=Bf,k=[1,1],m=null;return a.separation=function(b){return arguments.length?(l=b,a):l},a.size=function(b){return arguments.length?(m=null==(k=b)?f:null,a):m?null:k},a.nodeSize=function(b){return arguments.length?(m=null==(k=b)?null:f,a):m?k:null},Hb(a,g)};r.layout.cluster=function(){function a(h,g){var l,k=b.call(this,h,g),m=k[0],n=0;Da(m,function(a){var b=a.children;b&&b.length?(a.x=Rh(b),a.y=Qh(b)):(a.x=l?n+=e(a,l):0,a.y=0,l=a)});var p=Cf(m),q=Df(m),r=p.x-e(p,q)/2,v=q.x+e(q,p)/2;return Da(m,f?function(a){a.x=
(a.x-m.x)*d[0];a.y=(m.y-a.y)*d[1]}:function(a){a.x=(a.x-r)/(v-r)*d[0];a.y=(1-(m.y?a.y/m.y:1))*d[1]}),k}var b=r.layout.hierarchy().sort(null).value(null),e=Bf,d=[1,1],f=!1;return a.separation=function(b){return arguments.length?(e=b,a):e},a.size=function(b){return arguments.length?(f=null==(d=b),a):f?null:d},a.nodeSize=function(b){return arguments.length?(f=null!=(d=b),a):f?d:null},Hb(a,b)};r.layout.treemap=function(){function a(b,e){for(var d,f,h=-1,g=b.length;++h<g;)f=(d=b[h]).value*(0>e?0:e),d.area=
isNaN(f)||0>=f?0:f}function b(e){var f=e.children;if(f&&f.length){var g,l=p(e),k=[],m=f.slice(),n=1/0,q="slice"===v?l.dx:"dice"===v?l.dy:"slice-dice"===v?1&e.depth?l.dy:l.dx:Math.min(l.dx,l.dy);a(m,l.dx*l.dy/e.value);for(k.area=0;0<(e=m.length);){k.push(e=m[e-1]);k.area+=e.area;var r;if(!(r="squarify"!==v)){e=q;g=void 0;var t=k.area;r=0;for(var w=1/0,A=-1,C=k.length;++A<C;)(g=k[A].area)&&(w>g&&(w=g),g>r&&(r=g));r=(g=(t*=t,e*=e,t?Math.max(e*r*x/t,t/(e*w*x)):1/0))<=n}r?(m.pop(),n=g):(k.area-=k.pop().area,
d(k,q,l,!1),q=Math.min(l.dx,l.dy),k.length=k.area=0,n=1/0)}k.length&&(d(k,q,l,!0),k.length=k.area=0);f.forEach(b)}}function e(b){var f=b.children;if(f&&f.length){var g=p(b),l=f.slice(),k=[];a(l,g.dx*g.dy/b.value);for(k.area=0;b=l.pop();)k.push(b),k.area+=b.area,null!=b.z&&(d(k,b.z?g.dx:g.dy,g,!l.length),k.length=k.area=0);f.forEach(e)}}function d(a,b,e,f){var h,g=-1,l=a.length,m=e.x,n=e.y,p=b?k(a.area/b):0;if(b==e.dx){for((f||p>e.dy)&&(p=e.dy);++g<l;)h=a[g],h.x=m,h.y=n,h.dy=p,m+=h.dx=Math.min(e.x+
e.dx-m,p?k(h.area/p):0);h.z=!0;h.dx+=e.x+e.dx-m;e.y+=p;e.dy-=p}else{for((f||p>e.dx)&&(p=e.dx);++g<l;)h=a[g],h.x=m,h.y=n,h.dx=p,n+=h.dy=Math.min(e.y+e.dy-n,p?k(h.area/p):0);h.z=!1;h.dy+=e.y+e.dy-n;e.x+=p;e.dx-=p}}function f(d){d=g||l(d);var k=d[0];return k.x=0,k.y=0,k.dx=m[0],k.dy=m[1],g&&l.revalue(k),a([k],k.dx*k.dy/k.value),(g?e:b)(k),q&&(g=d),d}var g,l=r.layout.hierarchy(),k=Math.round,m=[1,1],n=null,p=vd,q=!1,v="squarify",x=.5*(1+Math.sqrt(5));return f.size=function(a){return arguments.length?
(m=a,f):m},f.padding=function(a){function b(e){var d=a.call(f,e,e.depth);return null==d?vd(e):Ef(e,"number"==typeof d?[d,d,d,d]:d)}function e(b){return Ef(b,a)}if(!arguments.length)return n;var d;return p=null==(n=a)?vd:"function"==(d=typeof a)?b:"number"===d?(a=[a,a,a,a],e):e,f},f.round=function(a){return arguments.length?(k=a?Math.round:Number,f):k!=Number},f.sticky=function(a){return arguments.length?(q=a,g=null,f):q},f.ratio=function(a){return arguments.length?(x=a,f):x},f.mode=function(a){return arguments.length?
(v=a+"",f):v},Hb(f,l)};r.random={normal:function(a,b){var e=arguments.length;return 2>e&&(b=1),1>e&&(a=0),function(){var e,d;do e=2*Math.random()-1,d=2*Math.random()-1,d=e*e+d*d;while(!d||1<d);return a+b*e*Math.sqrt(-2*Math.log(d)/d)}},logNormal:function(){var a=r.random.normal.apply(r,arguments);return function(){return Math.exp(a())}},bates:function(a){var b=r.random.irwinHall(a);return function(){return b()/a}},irwinHall:function(a){return function(){for(var b=0,e=0;a>e;e++)b+=Math.random();return b}}};
r.scale={};var Th={floor:ga,ceil:ga};r.scale.linear=function(){return Gf([0,1],[0,1],cb,!1)};var Wh={s:1,g:1,p:1,r:1,e:1};r.scale.log=function(){return Hf(r.scale.linear().domain([0,1]),10,!0,[1,10])};var If=r.format(".0e"),Xh={floor:function(a){return-Math.ceil(-a)},ceil:function(a){return-Math.floor(-a)}};r.scale.pow=function(){return Jf(r.scale.linear(),1,[0,1])};r.scale.sqrt=function(){return r.scale.pow().exponent(.5)};r.scale.ordinal=function(){return Kf([],{t:"range",a:[[]]})};r.scale.category10=
function(){return r.scale.ordinal().range(zi)};r.scale.category20=function(){return r.scale.ordinal().range(Ai)};r.scale.category20b=function(){return r.scale.ordinal().range(Bi)};r.scale.category20c=function(){return r.scale.ordinal().range(Ci)};var zi=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Mb),Ai=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,
1556175,10410725].map(Mb),Bi=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Mb),Ci=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Mb);r.scale.quantile=function(){return Lf([],[])};r.scale.quantize=function(){return Mf(0,1,[0,1])};r.scale.threshold=
function(){return Nf([.5],[0,1])};r.scale.identity=function(){return Of([0,1])};r.svg={};r.svg.arc=function(){function a(){var h=b.apply(this,arguments),g=e.apply(this,arguments),l=d.apply(this,arguments)+db,k=f.apply(this,arguments)+db,m=(l>k&&(m=l,l=k,k=m),k-l),n=K>m?"0":"1",p=Math.cos(l),l=Math.sin(l),q=Math.cos(k),k=Math.sin(k);return m>=Di?h?"M0,"+g+"A"+g+","+g+" 0 1,1 0,"+-g+"A"+g+","+g+" 0 1,1 0,"+g+"M0,"+h+"A"+h+","+h+" 0 1,0 0,"+-h+"A"+h+","+h+" 0 1,0 0,"+h+"Z":"M0,"+g+"A"+g+","+g+" 0 1,1 0,"+
-g+"A"+g+","+g+" 0 1,1 0,"+g+"Z":h?"M"+g*p+","+g*l+"A"+g+","+g+" 0 "+n+",1 "+g*q+","+g*k+"L"+h*q+","+h*k+"A"+h+","+h+" 0 "+n+",0 "+h*p+","+h*l+"Z":"M"+g*p+","+g*l+"A"+g+","+g+" 0 "+n+",1 "+g*q+","+g*k+"L0,0Z"}var b=Yh,e=Zh,d=Pf,f=Qf;return a.innerRadius=function(e){return arguments.length?(b=Y(e),a):b},a.outerRadius=function(b){return arguments.length?(e=Y(b),a):e},a.startAngle=function(b){return arguments.length?(d=Y(b),a):d},a.endAngle=function(b){return arguments.length?(f=Y(b),a):f},a.centroid=
function(){var a=(b.apply(this,arguments)+e.apply(this,arguments))/2,h=(d.apply(this,arguments)+f.apply(this,arguments))/2+db;return[Math.cos(h)*a,Math.sin(h)*a]},a};var db=-ha,Di=pa-E;r.svg.line=function(){return Rf(ga)};var yd=r.map({linear:qa,"linear-closed":function(a){return qa(a)+"Z"},step:function(a){for(var b=0,e=a.length,d=a[0],f=[d[0],",",d[1]];++b<e;)f.push("H",(d[0]+(d=a[b])[0])/2,"V",d[1]);return 1<e&&f.push("H",d[0]),f.join("")},"step-before":zd,"step-after":Ad,basis:Sf,"basis-open":function(a){if(4>
a.length)return qa(a);for(var b,e=[],d=-1,f=a.length,g=[0],l=[0];3>++d;)b=a[d],g.push(b[0]),l.push(b[1]);e.push(ua(Wa,g)+","+ua(Wa,l));for(--d;++d<f;)b=a[d],g.shift(),g.push(b[0]),l.shift(),l.push(b[1]),Cd(e,g,l);return e.join("")},"basis-closed":function(a){for(var b,e,d=-1,f=a.length,g=f+4,l=[],k=[];4>++d;)e=a[d%f],l.push(e[0]),k.push(e[1]);b=[ua(Wa,l),",",ua(Wa,k)];for(--d;++d<g;)e=a[d%f],l.shift(),l.push(e[0]),k.shift(),k.push(e[1]),Cd(b,l,k);return b.join("")},bundle:function(a,b){var e=a.length-
1;if(e)for(var d,f,g=a[0][0],l=a[0][1],k=a[e][0]-g,m=a[e][1]-l,n=-1;++n<=e;)d=a[n],f=n/e,d[0]=b*d[0]+(1-b)*(g+f*k),d[1]=b*d[1]+(1-b)*(l+f*m);return Sf(a)},cardinal:function(a,b){return 3>a.length?qa(a):a[0]+nc(a,Bd(a,b))},"cardinal-open":function(a,b){return 4>a.length?qa(a):a[1]+nc(a.slice(1,a.length-1),Bd(a,b))},"cardinal-closed":function(a,b){return 3>a.length?qa(a):a[0]+nc((a.push(a[0]),a),Bd([a[a.length-2]].concat(a,[a[1]]),b))},monotone:function(a){if(3>a.length)a=qa(a);else{var b=a[0],e,d,
f,g,l=[],k;e=0;k=a.length-1;for(var m=[],n=a[1],p=m[0]=Dd(a[0],n);++e<k;)m[e]=(p+(p=Dd(n,n=a[e+1])))/2;k=(m[e]=p,m);m=-1;for(n=a.length-1;++m<n;)e=Dd(a[m],a[m+1]),N(e)<E?k[m]=k[m+1]=0:(d=k[m]/e,f=k[m+1]/e,g=d*d+f*f,9<g&&(g=3*e/Math.sqrt(g),k[m]=g*d,k[m+1]=g*f));for(m=-1;++m<=n;)g=(a[Math.min(n,m+1)][0]-a[Math.max(0,m-1)][0])/(6*(1+k[m]*k[m])),l.push([g||0,k[m]*g||0]);a=b+nc(a,l)}return a}});yd.forEach(function(a,b){b.key=a;b.closed=/-closed$/.test(a)});var Tf=[0,2/3,1/3,0],Uf=[0,1/3,2/3,0],Wa=[0,
1/6,2/3,1/6];r.svg.line.radial=function(){var a=Rf(Vf);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a};zd.reverse=Ad;Ad.reverse=zd;r.svg.area=function(){return Wf(ga)};r.svg.area.radial=function(){var a=Wf(Vf);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a};r.svg.chord=function(){function a(h,g){var l=b(this,d,h,g),k=b(this,f,h,g);return"M"+l.p0+e(l.r,l.p1,l.a1-
l.a0)+(l.a0==k.a0&&l.a1==k.a1?"Q 0,0 "+l.p0:"Q 0,0 "+k.p0+e(k.r,k.p1,k.a1-k.a0)+("Q 0,0 "+l.p0))+"Z"}function b(a,e,d,f){var h=e.call(a,d,f);e=g.call(a,h,f);d=l.call(a,h,f)+db;a=k.call(a,h,f)+db;return{r:e,a0:d,a1:a,p0:[e*Math.cos(d),e*Math.sin(d)],p1:[e*Math.cos(a),e*Math.sin(a)]}}function e(a,b,d){return"A"+a+","+a+" 0 "+ +(d>K)+",1 "+b}var d=ed,f=fd,g=$h,l=Pf,k=Qf;return a.radius=function(b){return arguments.length?(g=Y(b),a):g},a.source=function(b){return arguments.length?(d=Y(b),a):d},a.target=
function(b){return arguments.length?(f=Y(b),a):f},a.startAngle=function(b){return arguments.length?(l=Y(b),a):l},a.endAngle=function(b){return arguments.length?(k=Y(b),a):k},a};r.svg.diagonal=function(){function a(f,h){var g=b.call(this,f,h),l=e.call(this,f,h),k=(g.y+l.y)/2,g=[g,{x:g.x,y:k},{x:l.x,y:k},l];return g=g.map(d),"M"+g[0]+"C"+g[1]+" "+g[2]+" "+g[3]}var b=ed,e=fd,d=Xf;return a.source=function(e){return arguments.length?(b=Y(e),a):b},a.target=function(b){return arguments.length?(e=Y(b),a):
e},a.projection=function(b){return arguments.length?(d=b,a):d},a};r.svg.diagonal.radial=function(){var a=r.svg.diagonal(),b=Xf,e=a.projection;return a.projection=function(a){return arguments.length?e(ai(b=a)):b},a};r.svg.symbol=function(){function a(d,f){return(ng.get(b.call(this,d,f))||Yf)(e.call(this,d,f))}var b=ci,e=bi;return a.type=function(e){return arguments.length?(b=Y(e),a):b},a.size=function(b){return arguments.length?(e=Y(b),a):e},a};var ng=r.map({circle:Yf,cross:function(a){a=Math.sqrt(a/
5)/2;return"M"+-3*a+","+-a+"H"+-a+"V"+-3*a+"H"+a+"V"+-a+"H"+3*a+"V"+a+"H"+a+"V"+3*a+"H"+-a+"V"+a+"H"+-3*a+"Z"},diamond:function(a){a=Math.sqrt(a/(2*og));var b=a*og;return"M0,"+-a+"L"+b+",0 0,"+a+" "+-b+",0Z"},square:function(a){a=Math.sqrt(a)/2;return"M"+-a+","+-a+"L"+a+","+-a+" "+a+","+a+" "+-a+","+a+"Z"},"triangle-down":function(a){a=Math.sqrt(a/Fc);var b=a*Fc/2;return"M0,"+b+"L"+a+","+-b+" "+-a+","+-b+"Z"},"triangle-up":function(a){a=Math.sqrt(a/Fc);var b=a*Fc/2;return"M0,"+-b+"L"+a+","+b+" "+
-a+","+b+"Z"}});r.svg.symbolTypes=ng.keys();var fb,rc,Fc=Math.sqrt(3),og=Math.tan(30*G),da=[],cg=0;da.call=U.call;da.empty=U.empty;da.node=U.node;da.size=U.size;r.transition=function(a){return arguments.length?fb?a.transition():a:bg.transition()};r.transition.prototype=da;da.select=function(a){var b,e,d,f=this.id,g=[];a=gb(a);for(var l=-1,k=this.length;++l<k;){g.push(b=[]);for(var m=this[l],n=-1,p=m.length;++n<p;)(d=m[n])&&(e=a.call(d,d.__data__,n,l))?("__data__"in d&&(e.__data__=d.__data__),oc(e,
n,f,d.__transition__[f]),b.push(e)):b.push(null)}return Jb(g,f)};da.selectAll=function(a){var b,e,d,f,g=this.id,l=[];a=vb(a);for(var k=-1,m=this.length;++k<m;)for(var n=this[k],p=-1,q=n.length;++p<q;)if(b=n[p]){f=b.__transition__[g];e=a.call(b,b.__data__,p,k);l.push(b=[]);for(var r=-1,v=e.length;++r<v;)(d=e[r])&&oc(d,r,g,f),b.push(d)}return Jb(l,g)};da.filter=function(a){var b,e,d,f=[];"function"!=typeof a&&(a=Xd(a));for(var g=0,l=this.length;l>g;g++){f.push(b=[]);e=this[g];for(var k=0,m=e.length;m>
k;k++)(d=e[k])&&a.call(d,d.__data__,k,g)&&b.push(d)}return Jb(f,this.id)};da.tween=function(a,b){var e=this.id;return 2>arguments.length?this.node().__transition__[e].tween.get(a):W(this,null==b?function(b){b.__transition__[e].tween.remove(a)}:function(d){d.__transition__[e].tween.set(a,b)})};da.attr=function(a,b){function e(){this.removeAttribute(k)}function d(){this.removeAttributeNS(k.space,k.local)}function f(a){return null==a?e:(a+="",function(){var b,e=this.getAttribute(k);return e!==a&&(b=
l(e,a),function(a){this.setAttribute(k,b(a))})})}function g(a){return null==a?d:(a+="",function(){var b,e=this.getAttributeNS(k.space,k.local);return e!==a&&(b=l(e,a),function(a){this.setAttributeNS(k.space,k.local,b(a))})})}if(2>arguments.length){for(b in a)this.attr(b,a[b]);return this}var l="transform"==a?sf:cb,k=r.ns.qualify(a);return Ed(this,"attr."+a,b,k.local?g:f)};da.attrTween=function(a,b){function e(a,d){var g=b.call(this,a,d,this.getAttribute(f));return g&&function(a){this.setAttribute(f,
g(a))}}function d(a,e){var g=b.call(this,a,e,this.getAttributeNS(f.space,f.local));return g&&function(a){this.setAttributeNS(f.space,f.local,g(a))}}var f=r.ns.qualify(a);return this.tween("attr."+a,f.local?d:e)};da.style=function(a,b,e){function d(){this.style.removeProperty(a)}var f=arguments.length;if(3>f){if("string"!=typeof a){2>f&&(b="");for(e in a)this.style(e,a[e],b);return this}e=""}return Ed(this,"style."+a,b,function(b){return null==b?d:(b+="",function(){var d,f=ja.getComputedStyle(this,
null).getPropertyValue(a);return f!==b&&(d=cb(f,b),function(b){this.style.setProperty(a,d(b),e)})})})};da.styleTween=function(a,b,e){return 3>arguments.length&&(e=""),this.tween("style."+a,function(d,f){var g=b.call(this,d,f,ja.getComputedStyle(this,null).getPropertyValue(a));return g&&function(b){this.style.setProperty(a,g(b),e)}})};da.text=function(a){return Ed(this,"text",a,di)};da.remove=function(){return this.each("end.transition",function(){var a;2>this.__transition__.count&&(a=this.parentNode)&&
a.removeChild(this)})};da.ease=function(a){var b=this.id;return 1>arguments.length?this.node().__transition__[b].ease:("function"!=typeof a&&(a=r.ease.apply(r,arguments)),W(this,function(e){e.__transition__[b].ease=a}))};da.delay=function(a){var b=this.id;return 1>arguments.length?this.node().__transition__[b].delay:W(this,"function"==typeof a?function(e,d,f){e.__transition__[b].delay=+a.call(e,e.__data__,d,f)}:(a=+a,function(e){e.__transition__[b].delay=a}))};da.duration=function(a){var b=this.id;
return 1>arguments.length?this.node().__transition__[b].duration:W(this,"function"==typeof a?function(e,d,f){e.__transition__[b].duration=Math.max(1,a.call(e,e.__data__,d,f))}:(a=Math.max(1,a),function(e){e.__transition__[b].duration=a}))};da.each=function(a,b){var e=this.id;if(2>arguments.length){var d=rc,f=fb;fb=e;W(this,function(b,d,f){rc=b.__transition__[e];a.call(b,b.__data__,d,f)});rc=d;fb=f}else W(this,function(d){d=d.__transition__[e];(d.event||(d.event=r.dispatch("start","end"))).on(a,b)});
return this};da.transition=function(){for(var a,b,e,d,f=this.id,g=++cg,l=[],k=0,m=this.length;m>k;k++){l.push(a=[]);b=this[k];for(var n=0,p=b.length;p>n;n++)(e=b[n])&&(d=Object.create(e.__transition__[f]),d.delay+=d.duration,oc(e,n,g,d)),a.push(e)}return Jb(l,g)};r.svg.axis=function(){function a(h){h.each(function(){var a,h=r.select(this),n=this.__chart__||e,p=this.__chart__=e.copy(),q=null==m?p.ticks?p.ticks.apply(p,k):p.domain():m,v=null==b?p.tickFormat?p.tickFormat.apply(p,k):ga:b,x=h.selectAll(".tick").data(q,
p),q=x.enter().insert("g",".domain").attr("class","tick").style("opacity",E),t=r.transition(x.exit()).style("opacity",E).remove(),w=r.transition(x.order()).style("opacity",1),C=Math.max(f,0)+l,z=jc(p),h=h.selectAll(".domain").data([0]),h=(h.enter().append("path").attr("class","domain"),r.transition(h));q.append("line");q.append("text");var B,T,I,L,V=q.select("line"),J=w.select("line"),v=x.select("text").text(v),x=q.select("text"),P=w.select("text"),D="top"===d||"left"===d?-1:1;if("bottom"===d||"top"===
d?(a=ei,B="x",I="y",T="x2",L="y2",v.attr("dy",0>D?"0em":".71em").style("text-anchor","middle"),h.attr("d","M"+z[0]+","+D*g+"V0H"+z[1]+"V"+D*g)):(a=fi,B="y",I="x",T="y2",L="x2",v.attr("dy",".32em").style("text-anchor",0>D?"end":"start"),h.attr("d","M"+D*g+","+z[0]+"H0V"+z[1]+"H"+D*g)),V.attr(L,D*f),x.attr(I,D*C),J.attr(T,0).attr(L,D*f),P.attr(B,0).attr(I,D*C),p.rangeBand)var Fa=p,na=Fa.rangeBand()/2,n=p=function(a){return Fa(a)+na};else n.rangeBand?n=p:t.call(a,p,n);q.call(a,n,p);w.call(a,p,p)})}var b,
e=r.scale.linear(),d=pg,f=6,g=6,l=3,k=[10],m=null;return a.scale=function(b){return arguments.length?(e=b,a):e},a.orient=function(b){return arguments.length?(d=b in Ei?b+"":pg,a):d},a.ticks=function(){return arguments.length?(k=arguments,a):k},a.tickValues=function(b){return arguments.length?(m=b,a):m},a.tickFormat=function(e){return arguments.length?(b=e,a):b},a.tickSize=function(b){var e=arguments.length;return e?(f=+b,g=+arguments[e-1],a):f},a.innerTickSize=function(b){return arguments.length?
(f=+b,a):f},a.outerTickSize=function(b){return arguments.length?(g=+b,a):g},a.tickPadding=function(b){return arguments.length?(l=+b,a):l},a.tickSubdivide=function(){return arguments.length&&a},a};var pg="bottom",Ei={top:1,right:1,bottom:1,left:1};r.svg.brush=function(){function a(g){g.each(function(){var g=r.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",f).on("touchstart.brush",f),l=g.selectAll(".background").data([0]);l.enter().append("rect").attr("class",
"background").style("visibility","hidden").style("cursor","crosshair");g.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var k=g.selectAll(".resize").data(t,ga);k.exit().remove();k.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return Fi[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",6).attr("height",6).style("visibility",
"hidden");k.style("display",a.empty()?"none":null);var p,g=r.transition(g),l=r.transition(l);m&&(p=jc(m),l.attr("x",p[0]).attr("width",p[1]-p[0]),e(g));n&&(p=jc(n),l.attr("y",p[0]).attr("height",p[1]-p[0]),d(g));b(g)})}function b(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+p[+/e$/.test(a)]+","+q[+/^s/.test(a)]+")"})}function e(a){a.select(".extent").attr("x",p[0]);a.selectAll(".extent,.n>rect,.s>rect").attr("width",p[1]-p[0])}function d(a){a.select(".extent").attr("y",
q[0]);a.selectAll(".extent,.e>rect,.w>rect").attr("height",q[1]-q[0])}function f(){function t(){var a=r.mouse(I),f=!1;T&&(a[0]+=T[0],a[1]+=T[1]);na||(r.event.altKey?(z||(z=[(p[0]+p[1])/2,(q[0]+q[1])/2]),G[0]=p[+(a[0]<z[0])],G[1]=q[+(a[1]<z[1])]):z=null);E&&w(a,m,0)&&(e(J),f=!0);Fa&&w(a,n,1)&&(d(J),f=!0);f&&(b(J),V({type:"brush",mode:na?"move":"resize"}))}function w(a,b,e){var d,f,h=jc(b);b=h[0];var h=h[1],k=G[e],m=e?q:p,n=m[1]-m[0];return na&&(b-=k,h-=n+k),d=(e?x:v)?Math.max(b,Math.min(h,a[e])):a[e],
na?f=(d+=k)+n:(z&&(k=Math.max(b,Math.min(h,2*z[e]-d))),d>k?(f=d,d=k):f=k),m[0]!=d||m[1]!=f?(e?l=null:g=null,m[0]=d,m[1]=f,!0):void 0}function C(){t();J.style("pointer-events","all").selectAll(".resize").style("display",a.empty()?"none":null);r.select("body").style("cursor",null);K.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);M();V({type:"brushend"})}var z,T,I=this,L=r.select(r.event.target),
V=k.of(I,arguments),J=r.select(I),D=L.datum(),E=!/^(n|s)$/.test(D)&&m,Fa=!/^(e|w)$/.test(D)&&n,na=L.classed("extent"),M=Lb(),G=r.mouse(I),K=r.select(ja).on("keydown.brush",function(){32==r.event.keyCode&&(na||(z=null,G[0]-=p[1],G[1]-=q[1],na=2),B())}).on("keyup.brush",function(){32==r.event.keyCode&&2==na&&(G[0]+=p[1],G[1]+=q[1],na=0,B())});if(r.event.changedTouches?K.on("touchmove.brush",t).on("touchend.brush",C):K.on("mousemove.brush",t).on("mouseup.brush",C),J.interrupt().selectAll("*").interrupt(),
na)G[0]=p[0]-G[0],G[1]=q[0]-G[1];else if(D){var N=+/w$/.test(D),D=+/^n/.test(D);T=[p[1-N]-G[0],q[1-D]-G[1]];G[0]=p[N];G[1]=q[D]}else r.event.altKey&&(z=G.slice());J.style("pointer-events","none").selectAll(".resize").style("display",null);r.select("body").style("cursor",L.style("cursor"));V({type:"brushstart"});t()}var g,l,k=C(a,"brushstart","brush","brushend"),m=null,n=null,p=[0,0],q=[0,0],v=!0,x=!0,t=Ld[0];return a.event=function(a){a.each(function(){var a=k.of(this,arguments),b={x:p,y:q,i:g,j:l},
e=this.__chart__||b;this.__chart__=b;fb?r.select(this).transition().each("start.brush",function(){g=e.i;l=e.j;p=e.x;q=e.y;a({type:"brushstart"})}).tween("brush:brush",function(){var e=ic(p,b.x),d=ic(q,b.y);return g=l=null,function(f){p=b.x=e(f);q=b.y=d(f);a({type:"brush",mode:"resize"})}}).each("end.brush",function(){g=b.i;l=b.j;a({type:"brush",mode:"resize"});a({type:"brushend"})}):(a({type:"brushstart"}),a({type:"brush",mode:"resize"}),a({type:"brushend"}))})},a.x=function(b){return arguments.length?
(m=b,t=Ld[!m<<1|!n],a):m},a.y=function(b){return arguments.length?(n=b,t=Ld[!m<<1|!n],a):n},a.clamp=function(b){return arguments.length?(m&&n?(v=!!b[0],x=!!b[1]):m?v=!!b:n&&(x=!!b),a):m&&n?[v,x]:m?v:n?x:null},a.extent=function(b){var e,d,f,k,r;return arguments.length?(m&&(e=b[0],d=b[1],n&&(e=e[0],d=d[0]),g=[e,d],m.invert&&(e=m(e),d=m(d)),e>d&&(r=e,e=d,d=r),(e!=p[0]||d!=p[1])&&(p=[e,d])),n&&(f=b[0],k=b[1],m&&(f=f[1],k=k[1]),l=[f,k],n.invert&&(f=n(f),k=n(k)),f>k&&(r=f,f=k,k=r),(f!=q[0]||k!=q[1])&&(q=
[f,k])),a):(m&&(g?(e=g[0],d=g[1]):(e=p[0],d=p[1],m.invert&&(e=m.invert(e),d=m.invert(d)),e>d&&(r=e,e=d,d=r))),n&&(l?(f=l[0],k=l[1]):(f=q[0],k=q[1],n.invert&&(f=n.invert(f),k=n.invert(k)),f>k&&(r=f,f=k,k=r))),m&&n?[[e,f],[d,k]]:m?[e,d]:n&&[f,k])},a.clear=function(){return a.empty()||(p=[0,0],q=[0,0],g=l=null),a},a.empty=function(){return!!m&&p[0]==p[1]||!!n&&q[0]==q[1]},r.rebind(a,k,"on")};var Fi={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",
sw:"nesw-resize"},Ld=["n e s w nw ne se sw".split(" "),["e","w"],["n","s"],[]],Md=D.format=eg.timeFormat,qg=Md.utc,rg=qg("%Y-%m-%dT%H:%M:%S.%LZ");Md.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Fd:rg;Fd.parse=function(a){a=new Date(a);return isNaN(a)?null:a};Fd.toString=rg.toString;D.second=Ya(function(a){return new ia(1E3*Math.floor(a/1E3))},function(a,b){a.setTime(a.getTime()+1E3*Math.floor(b))},function(a){return a.getSeconds()});D.seconds=D.second.range;D.seconds.utc=
D.second.utc.range;D.minute=Ya(function(a){return new ia(6E4*Math.floor(a/6E4))},function(a,b){a.setTime(a.getTime()+6E4*Math.floor(b))},function(a){return a.getMinutes()});D.minutes=D.minute.range;D.minutes.utc=D.minute.utc.range;D.hour=Ya(function(a){var b=a.getTimezoneOffset()/60;return new ia(36E5*(Math.floor(a/36E5-b)+b))},function(a,b){a.setTime(a.getTime()+36E5*Math.floor(b))},function(a){return a.getHours()});D.hours=D.hour.range;D.hours.utc=D.hour.utc.range;D.month=Ya(function(a){return a=
D.day(a),a.setDate(1),a},function(a,b){a.setMonth(a.getMonth()+b)},function(a){return a.getMonth()});D.months=D.month.range;D.months.utc=D.month.utc.range;var pc=[1E3,5E3,15E3,3E4,6E4,3E5,9E5,18E5,36E5,108E5,216E5,432E5,864E5,1728E5,6048E5,2592E6,7776E6,31536E6],Nd=[[D.second,1],[D.second,5],[D.second,15],[D.second,30],[D.minute,1],[D.minute,5],[D.minute,15],[D.minute,30],[D.hour,1],[D.hour,3],[D.hour,6],[D.hour,12],[D.day,1],[D.day,2],[D.week,1],[D.month,1],[D.month,3],[D.year,1]],Gi=Md.multi([[".%L",
function(a){return a.getMilliseconds()}],[":%S",function(a){return a.getSeconds()}],["%I:%M",function(a){return a.getMinutes()}],["%I %p",function(a){return a.getHours()}],["%a %d",function(a){return a.getDay()&&1!=a.getDate()}],["%b %d",function(a){return 1!=a.getDate()}],["%B",function(a){return a.getMonth()}],["%Y",mb]]),gi={range:function(a,b,e){return r.range(Math.ceil(a/e)*e,+b,e).map(eb)},floor:ga,ceil:ga};Nd.year=D.year;D.scale=function(){return Gd(r.scale.linear(),Nd,Gi)};var sg=Nd.map(function(a){return[a[0].utc,
a[1]]}),Hi=qg.multi([[".%L",function(a){return a.getUTCMilliseconds()}],[":%S",function(a){return a.getUTCSeconds()}],["%I:%M",function(a){return a.getUTCMinutes()}],["%I %p",function(a){return a.getUTCHours()}],["%a %d",function(a){return a.getUTCDay()&&1!=a.getUTCDate()}],["%b %d",function(a){return 1!=a.getUTCDate()}],["%B",function(a){return a.getUTCMonth()}],["%Y",mb]]);sg.year=D.year.utc;D.scale.utc=function(){return Gd(r.scale.linear(),sg,Hi)};r.text=Uc(function(a){return a.responseText});
r.json=function(a,b){return Ob(a,"application/json",hi,b)};r.html=function(a,b){return Ob(a,"text/html",ii,b)};r.xml=Uc(function(a){return a.responseXML});"function"==typeof define&&define.amd?define(r):"object"==typeof module&&module.exports&&(module.exports=r);this.d3=r}();this.j$=this.jStat=function(g,f){function d(a,b){var e=a>b?a:b;return g.pow(10,17-~~(g.log(0<e?e:-e)*g.LOG10E))}function b(a){return"[object Function]"===q.call(a)}function a(a){return"number"==typeof a&&a===a}function e(){return new e._init(arguments)}function l(){return 0}function k(){return 1}function m(a,b){return a===b?1:0}var n=Array.prototype.concat,p=Array.prototype.slice,q=Object.prototype.toString,t=Array.isArray||function(a){return"[object Array]"===q.call(a)};e.fn=e.prototype;e._init=
function(d){var f;if(t(d[0]))if(t(d[0][0])){b(d[1])&&(d[0]=e.map(d[0],d[1]));for(f=0;f<d[0].length;f++)this[f]=d[0][f];this.length=d[0].length}else this[0]=b(d[1])?e.map(d[0],d[1]):d[0],this.length=1;else{if(a(d[0]))this[0]=e.seq.apply(null,d);else{if(d[0]instanceof e)return e(d[0].toArray());this[0]=[]}this.length=1}return this};e._init.prototype=e.prototype;e._init.constructor=e;e.utils={calcRdx:d,isArray:t,isFunction:b,isNumber:a,toVector:function(a){return n.apply([],a)}};e.extend=function(a){var b,
d;if(1===arguments.length){for(d in a)e[d]=a[d];return this}for(b=1;b<arguments.length;b++)for(d in arguments[b])a[d]=arguments[b][d];return a};e.rows=function(a){return a.length||1};e.cols=function(a){return a[0].length||1};e.dimensions=function(a){return{rows:e.rows(a),cols:e.cols(a)}};e.row=function(a,b){return a[b]};e.col=function(a,b){for(var e=Array(a.length),d=0;d<a.length;d++)e[d]=[a[d][b]];return e};e.diag=function(a){for(var b=e.rows(a),d=Array(b),f=0;f<b;f++)d[f]=[a[f][f]];return d};e.antidiag=
function(a){for(var b=e.rows(a)-1,d=Array(b),f=0;0<=b;b--,f++)d[f]=[a[f][b]];return d};e.transpose=function(a){var b=[],e,d,f,g,l;t(a[0])||(a=[a]);d=a.length;f=a[0].length;for(l=0;l<f;l++){e=Array(d);for(g=0;g<d;g++)e[g]=a[g][l];b.push(e)}return 1===b.length?b[0]:b};e.map=function(a,b,e){var d,f,g,l;t(a[0])||(a=[a]);d=a.length;f=a[0].length;g=e?a:Array(d);for(e=0;e<d;e++)for(g[e]||(g[e]=Array(f)),l=0;l<f;l++)g[e][l]=b(a[e][l],e,l);return 1===g.length?g[0]:g};e.cumreduce=function(a,b,e){var d,f,g,
l;t(a[0])||(a=[a]);d=a.length;f=a[0].length;g=e?a:Array(d);for(e=0;e<d;e++)for(g[e]||(g[e]=Array(f)),0<f&&(g[e][0]=a[e][0]),l=1;l<f;l++)g[e][l]=b(g[e][l-1],a[e][l]);return 1===g.length?g[0]:g};e.alter=function(a,b){return e.map(a,b,!0)};e.create=function(a,e,d){var f=Array(a),g,l;b(e)&&(d=e,e=a);for(g=0;g<a;g++)for(f[g]=Array(e),l=0;l<e;l++)f[g][l]=d(g,l);return f};e.zeros=function(b,d){return a(d)||(d=b),e.create(b,d,l)};e.ones=function(b,d){return a(d)||(d=b),e.create(b,d,k)};e.rand=function(b,
d){return a(d)||(d=b),e.create(b,d,g.random)};e.identity=function(b,d){return a(d)||(d=b),e.create(b,d,m)};e.symmetric=function(a){var b=a.length,e,d;if(a.length!==a[0].length)return!1;for(e=0;e<b;e++)for(d=0;d<b;d++)if(a[d][e]!==a[e][d])return!1;return!0};e.clear=function(a){return e.alter(a,l)};e.seq=function(a,e,f,g){b(g)||(g=!1);var l=[],k=d(a,e);f=(e*k-a*k)/((f-1)*k);var m=a,n;for(n=0;m<=e;n++,m=(a*k+f*k*n)/k)l.push(g?g(m,n):m);return l};var w=e.prototype;return w.length=0,w.push=Array.prototype.push,
w.sort=Array.prototype.sort,w.splice=Array.prototype.splice,w.slice=Array.prototype.slice,w.toArray=function(){return 1<this.length?p.call(this):p.call(this)[0]},w.map=function(a,b){return e(e.map(this,a,b))},w.cumreduce=function(a,b){return e(e.cumreduce(this,a,b))},w.alter=function(a){return e.alter(this,a),this},function(a){for(var b=0;b<a.length;b++)(function(a){w[a]=function(b){var d=this,f;return b?(setTimeout(function(){b.call(d,w[a].call(d))}),this):(f=e[a](this),t(f)?e(f):f)}})(a[b])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),
function(a){for(var b=0;b<a.length;b++)(function(a){w[a]=function(b,d){var f=this;return d?(setTimeout(function(){d.call(f,w[a].call(f,b))}),this):e(e[a](this,b))}})(a[b])}(["row","col"]),function(a){for(var b=0;b<a.length;b++){var e=a[b];w[e]=new Function("return jStat(jStat."+e+".apply(null, arguments));")}}(["create","zeros","ones","rand","identity"]),e}(Math);
(function(g,f){function d(a,b){return a-b}var b=g.utils.isFunction;g.sum=function(a){for(var b=0,d=a.length;0<=--d;)b+=a[d];return b};g.sumsqrd=function(a){for(var b=0,d=a.length;0<=--d;)b+=a[d]*a[d];return b};g.sumsqerr=function(a){for(var b=g.mean(a),d=0,f=a.length,n;0<=--f;)n=a[f]-b,d+=n*n;return d};g.product=function(a){for(var b=1,d=a.length;0<=--d;)b*=a[d];return b};g.min=function(a){for(var b=a[0],d=0;++d<a.length;)a[d]<b&&(b=a[d]);return b};g.max=function(a){for(var b=a[0],d=0;++d<a.length;)a[d]>
b&&(b=a[d]);return b};g.mean=function(a){return g.sum(a)/a.length};g.meansqerr=function(a){return g.sumsqerr(a)/a.length};g.geomean=function(a){return f.pow(g.product(a),1/a.length)};g.median=function(a){var b=a.length;a=a.slice().sort(d);return b&1?a[b/2|0]:(a[b/2-1]+a[b/2])/2};g.cumsum=function(a){return g.cumreduce(a,function(a,b){return a+b})};g.cumprod=function(a){return g.cumreduce(a,function(a,b){return a*b})};g.diff=function(a){var b=[],d=a.length,f;for(f=1;f<d;f++)b.push(a[f]-a[f-1]);return b};
g.mode=function(a){var b=a.length;a=a.slice().sort(d);var f=1,g=0,n=0,p=[],q;for(q=0;q<b;q++)a[q]===a[q+1]?f++:(f>g?(p=[a[q]],g=f,n=0):f===g&&(p.push(a[q]),n++),f=1);return 0===n?p[0]:p};g.range=function(a){return g.max(a)-g.min(a)};g.variance=function(a,b){return g.sumsqerr(a)/(a.length-(b?1:0))};g.stdev=function(a,b){return f.sqrt(g.variance(a,b))};g.meandev=function(a){var b=0,d=g.mean(a),m;for(m=a.length-1;0<=m;m--)b+=f.abs(a[m]-d);return b/a.length};g.meddev=function(a){var b=0,d=g.median(a),
m;for(m=a.length-1;0<=m;m--)b+=f.abs(a[m]-d);return b/a.length};g.coeffvar=function(a){return g.stdev(a)/g.mean(a)};g.quartiles=function(a){var b=a.length;a=a.slice().sort(d);return[a[f.round(b/4)-1],a[f.round(b/2)-1],a[f.round(3*b/4)-1]]};g.quantiles=function(a,b,g,m){var n=a.slice().sort(d),p=[b.length];a=a.length;var q,t,w;"undefined"==typeof g&&(g=.375);"undefined"==typeof m&&(m=.375);for(q=0;q<b.length;q++)t=b[q],w=g+t*(1-g-m),w=a*t+w,t=f.floor(f.max(1,f.min(w,a-1))),w=f.max(0,f.min(w-t,1)),
p[q]=(1-w)*n[t-1]+w*n[t];return p};g.percentileOfScore=function(a,b,d){var f=0,g=a.length,p=!1,q;"strict"===d&&(p=!0);for(q=0;q<g;q++)d=a[q],(p&&d<b||!p&&d<=b)&&f++;return f/g};g.histogram=function(a,b){var d=g.min(a),m=b||4,n=(g.max(a)-d)/m,p=a.length;b=[];var q;for(q=0;q<m;q++)b[q]=0;for(q=0;q<p;q++)b[f.min(f.floor((a[q]-d)/n),m-1)]+=1;return b};g.covariance=function(a,b){var d=g.mean(a),f=g.mean(b),n=a.length,p=Array(n),q;for(q=0;q<n;q++)p[q]=(a[q]-d)*(b[q]-f);return g.sum(p)/(n-1)};g.corrcoeff=
function(a,b){return g.covariance(a,b)/g.stdev(a,1)/g.stdev(b,1)};g.stanMoment=function(a,b){var d=g.mean(a),m=g.stdev(a),n=a.length,p=0;for(i=0;i<n;i++)p+=f.pow((a[i]-d)/m,b);return p/a.length};g.skewness=function(a){return g.stanMoment(a,3)};g.kurtosis=function(a){return g.stanMoment(a,4)-3};var a=g.prototype;(function(e){for(var d=0;d<e.length;d++)(function(e){a[e]=function(d,f){var l=[],q=0,t=this;b(d)&&(f=d,d=!1);if(f)return setTimeout(function(){f.call(t,a[e].call(t,d))}),this;if(1<this.length){for(t=
!0===d?this:this.transpose();q<t.length;q++)l[q]=g[e](t[q]);return l}return g[e](this[0],d)}})(e[d])})(["cumsum","cumprod"]);(function(e){for(var d=0;d<e.length;d++)(function(e){a[e]=function(d,f){var l=[],q=0,t=this;b(d)&&(f=d,d=!1);if(f)return setTimeout(function(){f.call(t,a[e].call(t,d))}),this;if(1<this.length){for(t=!0===d?this:this.transpose();q<t.length;q++)l[q]=g[e](t[q]);return!0===d?g[e](g.utils.toVector(l)):l}return g[e](this[0],d)}})(e[d])})("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" "));
(function(e){for(var d=0;d<e.length;d++)(function(e){a[e]=function(){var d=[],f=0,l=this,q=Array.prototype.slice.call(arguments);if(b(q[q.length-1])){var t=q[q.length-1],w=q.slice(0,q.length-1);return setTimeout(function(){t.call(l,a[e].apply(l,w))}),this}t=void 0;if(1<this.length){for(l=l.transpose();f<l.length;f++)d[f]=g[e].apply(l,[l[f]].concat(q));return d}return g[e].apply(l,[this[0]].concat(q))}})(e[d])})(["quantiles","percentileOfScore"])})(this.jStat,Math);
(function(g,f){g.gammaln=function(d){var b=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5.395239384953E-6],e=1.000000000190015,g,k;k=(g=d)+5.5;for(k-=(d+.5)*f.log(k);6>b;b++)e+=a[b]/++g;return f.log(2.5066282746310007*e/d)-k};g.gammafn=function(d){var b=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,
-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],e=!1,g=0,k=0,m=0,n,p,q,t;if(0>=d)if(t=d%1+3.6E-16)e=(d&1?-1:1)*f.PI/f.sin(f.PI*t),d=1-d;else return Infinity;q=d;1>d?p=d++:p=(d-=g=(d|0)-1)-1;for(n=0;8>n;++n)m=(m+b[n])*p,k=k*p+a[n];t=m/k+1;if(q<d)t/=q;else if(q>d)for(n=0;n<g;++n)t*=d,d++;return e&&(t=e/t),t};g.gammap=function(d,b){var a=g.gammaln(d),e=d,l=1/d,k=l,m=b+1-d,n=1/1E-30,p=1/m,q=p,t=1,w=-~(8.5*f.log(1<=d?d:1/d)+.4*d+17);if(0>
b||0>=d)return NaN;if(b<d+1){for(;t<=w;t++)l+=k*=b/++e;return l*f.exp(-b+d*f.log(b)-a)}for(;t<=w;t++)e=-t*(t-d),m+=2,p=e*p+m,n=m+e/n,p=1/p,q=q*p*n;return 1-q*f.exp(-b+d*f.log(b)-a)};g.factorialln=function(d){return 0>d?NaN:g.gammaln(d+1)};g.factorial=function(d){return 0>d?NaN:g.gammafn(d+1)};g.combination=function(d,b){return 170<d||170<b?f.exp(g.combinationln(d,b)):g.factorial(d)/g.factorial(b)/g.factorial(d-b)};g.combinationln=function(d,b){return g.factorialln(d)-g.factorialln(b)-g.factorialln(d-
b)};g.permutation=function(d,b){return g.factorial(d)/g.factorial(d-b)};g.betafn=function(d,b){return 0>=d||0>=b?void 0:170<d+b?f.exp(g.betaln(d,b)):g.gammafn(d)*g.gammafn(b)/g.gammafn(d+b)};g.betaln=function(d,b){return g.gammaln(d)+g.gammaln(b)-g.gammaln(d+b)};g.betacf=function(d,b,a){var e=1,g=b+a,k=b+1,m=b-1,n=1,p=1-g*d/k,q,t,w;1E-30>f.abs(p)&&(p=1E-30);for(w=p=1/p;100>=e&&!(q=2*e,t=e*(a-e)*d/((m+q)*(b+q)),p=1+t*p,1E-30>f.abs(p)&&(p=1E-30),n=1+t/n,1E-30>f.abs(n)&&(n=1E-30),p=1/p,w=w*p*n,t=-(b+
e)*(g+e)*d/((b+q)*(k+q)),p=1+t*p,1E-30>f.abs(p)&&(p=1E-30),n=1+t/n,1E-30>f.abs(n)&&(n=1E-30),p=1/p,q=p*n,w*=q,3E-7>f.abs(q-1));e++);return w};g.gammapinv=function(d,b){var a=0,e=b-1,l=g.gammaln(b),k,m,n,p,q;if(1<=d)return f.max(100,b+100*f.sqrt(b));if(0>=d)return 0;for(1<b?(p=f.log(e),q=f.exp(e*(p-1)-l),m=.5>d?d:1-d,n=f.sqrt(-2*f.log(m)),k=(2.30753+.27061*n)/(1+n*(.99229+.04481*n))-n,.5>d&&(k=-k),k=f.max(.001,b*f.pow(1-1/(9*b)-k/(3*f.sqrt(b)),3))):(n=1-b*(.253+.12*b),d<n?k=f.pow(d/n,1/b):k=1-f.log(1-
(d-n)/(1-n)));12>a;a++){if(0>=k)return 0;m=g.gammap(b,k)-d;1<b?n=q*f.exp(-(k-e)+e*(f.log(k)-p)):n=f.exp(-k+e*f.log(k)-l);n=m/n;k-=n/=1-.5*f.min(1,n*((b-1)/k-1));0>=k&&(k=.5*(k+n));if(f.abs(n)<1E-8*k)break}return k};g.erf=function(d){var b=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-9.46595344482036E-4,3.66839497852761E-4,4.2523324806907E-5,-2.0278578112534E-5,-1.624290004647E-6,1.30365583558E-6,1.5626441722E-8,-8.5238095915E-8,6.529054439E-9,5.059343495E-9,-9.91364156E-10,
-2.27365122E-10,9.6467911E-11,2.394038E-12,-6.886027E-12,8.94487E-13,3.13092E-13,-1.12708E-13,3.81E-16,7.106E-15,-1.523E-15,-9.4E-17,1.21E-16,-2.8E-17],a=b.length-1,e=!1,g=0,k=0,m,n,p,q;0>d&&(d=-d,e=!0);m=2/(2+d);for(n=4*m-2;0<a;a--)p=g,g=n*g-k+b[a],k=p;return q=m*f.exp(-d*d+.5*(b[0]+n*g)-k),e?q-1:1-q};g.erfc=function(d){return 1-g.erf(d)};g.erfcinv=function(d){var b=0,a,e,l;if(2<=d)return-100;if(0>=d)return 100;l=1>d?d:2-d;a=f.sqrt(-2*f.log(l/2));for(a=-.70711*((2.30753+.27061*a)/(1+a*(.99229+.04481*
a))-a);2>b;b++)e=g.erfc(a)-l,a+=e/(1.1283791670955126*f.exp(-a*a)-a*e);return 1>d?a:-a};g.ibetainv=function(d,b,a){var e=b-1,l=a-1,k=0,m,n,p,q,t,w,v,z,I;if(0>=d)return 0;if(1<=d)return 1;1<=b&&1<=a?(p=.5>d?d:1-d,q=f.sqrt(-2*f.log(p)),w=(2.30753+.27061*q)/(1+q*(.99229+.04481*q))-q,.5>d&&(w=-w),v=(w*w-3)/6,z=2/(1/(2*b-1)+1/(2*a-1)),I=w*f.sqrt(v+z)/z-(1/(2*a-1)-1/(2*b-1))*(v+5/6-2/(3*z)),w=b/(b+a*f.exp(2*I))):(m=f.log(b/(b+a)),n=f.log(a/(b+a)),q=f.exp(b*m)/b,t=f.exp(a*n)/a,I=q+t,d<q/I?w=f.pow(b*I*d,
1/b):w=1-f.pow(a*I*(1-d),1/a));for(m=-g.gammaln(b)-g.gammaln(a)+g.gammaln(b+a);10>k&&0!==w&&1!==w&&!(t=g.ibeta(w,b,a)-d,q=f.exp(e*f.log(w)+l*f.log(1-w)+m),t/=q,w-=q=t/(1-.5*f.min(1,t*(e/w-l/(1-w)))),0>=w&&(w=.5*(w+q)),1<=w&&(w=.5*(w+q+1)),f.abs(q)<1E-8*w&&0<k);k++);return w};g.ibeta=function(d,b,a){var e=0===d||1===d?0:f.exp(g.gammaln(b+a)-g.gammaln(b)-g.gammaln(a)+b*f.log(d)+a*f.log(1-d));return 0>d||1<d?!1:d<(b+1)/(b+a+2)?e*g.betacf(d,b,a)/b:1-e*g.betacf(1-d,a,b)/a};g.randn=function(d,b){var a,
e,l,k;b||(b=d);if(d)return g.create(d,b,function(){return g.randn()});do a=f.random(),e=1.7156*(f.random()-.5),l=a-.449871,k=f.abs(e)+.386595,l=l*l+k*(.196*k-.25472*l);while(.27597<l&&(.27846<l||e*e>-4*f.log(a)*a*a));return e/a};g.randg=function(d,b,a){var e=d,l,k,m;a||(a=b);d||(d=1);if(b)return l=g.zeros(b,a),l.alter(function(){return g.randg(d)}),l;1>d&&(d+=1);b=d-1/3;a=1/f.sqrt(9*b);do{do m=g.randn(),k=1+a*m;while(0>=k);k*=k*k;l=f.random()}while(l>1-.331*f.pow(m,4)&&f.log(l)>.5*m*m+b*(1-k+f.log(k)));
if(d==e)return b*k;do l=f.random();while(0===l);return f.pow(l,1/e)*b*k};(function(d){for(var b=0;b<d.length;b++)(function(a){g.fn[a]=function(){return g(g.map(this,function(b){return g[a](b)}))}})(d[b])})(["gammaln","gammafn","factorial","factorialln"]);(function(d){for(var b=0;b<d.length;b++)(function(a){g.fn[a]=function(){return g(g[a].apply(null,arguments))}})(d[b])})(["randn"])})(this.jStat,Math);
(function(g,f){(function(d){for(var b=0;b<d.length;b++)(function(a){g[a]=function(a,b,d){return this instanceof arguments.callee?(this._a=a,this._b=b,this._c=d,this):new arguments.callee(a,b,d)};g.fn[a]=function(b,d,f){b=g[a](b,d,f);return b.data=this,b};g[a].prototype.sample=function(b){var d=this._a,f=this._b,m=this._c;return b?g.alter(b,function(){return g[a].sample(d,f,m)}):g[a].sample(d,f,m)};(function(b){for(var d=0;d<b.length;d++)(function(b){g[a].prototype[b]=function(e){var d=this._a,f=this._b,
l=this._c;return!e&&0!==e&&(e=this.data),"number"!=typeof e?g.fn.map.call(e,function(e){return g[a][b](e,d,f,l)}):g[a][b](e,d,f,l)}})(b[d])})(["pdf","cdf","inv"]);(function(b){for(var d=0;d<b.length;d++)(function(b){g[a].prototype[b]=function(){return g[a][b](this._a,this._b,this._c)}})(b[d])})(["mean","median","mode","variance"])})(d[b])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" "));
g.extend(g.beta,{pdf:function(d,b,a){return 1<d||0>d?0:1==b&&1==a?1:512>b||512>a?f.pow(d,b-1)*f.pow(1-d,a-1)/g.betafn(b,a):f.exp((b-1)*f.log(d)+(a-1)*f.log(1-d)-g.betaln(b,a))},cdf:function(d,b,a){return 1<d||0>d?1*(1<d):g.ibeta(d,b,a)},inv:function(d,b,a){return g.ibetainv(d,b,a)},mean:function(d,b){return d/(d+b)},median:function(d,b){throw Error("median not yet implemented");},mode:function(d,b){return d*b/(f.pow(d+b,2)*(d+b+1))},sample:function(d,b){var a=g.randg(d);return a/(a+g.randg(b))},variance:function(d,
b){return d*b/(f.pow(d+b,2)*(d+b+1))}});g.extend(g.centralF,{pdf:function(d,b,a){var e,l,k;return 0>d?void 0:2>=b?f.sqrt(f.pow(b*d,b)*f.pow(a,a)/f.pow(b*d+a,b+a))/(d*g.betafn(b/2,a/2)):(e=b*d/(a+d*b),l=a/(a+d*b),k=b*l/2,k*g.binomial.pdf((b-2)/2,(b+a-2)/2,e))},cdf:function(d,b,a){return g.ibeta(b*d/(b*d+a),b/2,a/2)},inv:function(d,b,a){return a/(b*(1/g.ibetainv(d,b/2,a/2)-1))},mean:function(d,b){return 2<b?b/(b-2):void 0},mode:function(d,b){return 2<d?b*(d-2)/(d*(b+2)):void 0},sample:function(d,b){var a=
2*g.randg(d/2),e=2*g.randg(b/2);return a/d/(e/b)},variance:function(d,b){return 4>=b?void 0:2*b*b*(d+b-2)/(d*(b-2)*(b-2)*(b-4))}});g.extend(g.cauchy,{pdf:function(d,b,a){return a/(f.pow(d-b,2)+f.pow(a,2))/f.PI},cdf:function(d,b,a){return f.atan((d-b)/a)/f.PI+.5},inv:function(d,b,a){return b+a*f.tan(f.PI*(d-.5))},median:function(d,b){return d},mode:function(d,b){return d},sample:function(d,b){return g.randn()*f.sqrt(1/(2*g.randg(.5)))*b+d}});g.extend(g.chisquare,{pdf:function(d,b){return 0===d?0:f.exp((b/
2-1)*f.log(d)-d/2-b/2*f.log(2)-g.gammaln(b/2))},cdf:function(d,b){return g.gammap(b/2,d/2)},inv:function(d,b){return 2*g.gammapinv(d,.5*b)},mean:function(d){return d},median:function(d){return d*f.pow(1-2/(9*d),3)},mode:function(d){return 0<d-2?d-2:0},sample:function(d){return 2*g.randg(d/2)},variance:function(d){return 2*d}});g.extend(g.exponential,{pdf:function(d,b){return 0>d?0:b*f.exp(-b*d)},cdf:function(d,b){return 0>d?0:1-f.exp(-b*d)},inv:function(d,b){return-f.log(1-d)/b},mean:function(d){return 1/
d},median:function(d){return 1/d*f.log(2)},mode:function(d){return 0},sample:function(d){return-1/d*f.log(f.random())},variance:function(d){return f.pow(d,-2)}});g.extend(g.gamma,{pdf:function(d,b,a){return f.exp((b-1)*f.log(d)-d/a-g.gammaln(b)-b*f.log(a))},cdf:function(d,b,a){return g.gammap(b,d/a)},inv:function(d,b,a){return g.gammapinv(d,b)*a},mean:function(d,b){return d*b},mode:function(d,b){return 1<d?(d-1)*b:void 0},sample:function(d,b){return g.randg(d)*b},variance:function(d,b){return d*b*
b}});g.extend(g.invgamma,{pdf:function(d,b,a){return f.exp(-(b+1)*f.log(d)-a/d-g.gammaln(b)+b*f.log(a))},cdf:function(d,b,a){return 1-g.gammap(b,a/d)},inv:function(d,b,a){return a/g.gammapinv(1-d,b)},mean:function(d,b){return 1<d?b/(d-1):void 0},mode:function(d,b){return b/(d+1)},sample:function(d,b){return b/g.randg(d)},variance:function(d,b){return 2>=d?void 0:b*b/((d-1)*(d-1)*(d-2))}});g.extend(g.kumaraswamy,{pdf:function(d,b,a){return f.exp(f.log(b)+f.log(a)+(b-1)*f.log(d)+(a-1)*f.log(1-f.pow(d,
b)))},cdf:function(d,b,a){return 1-f.pow(1-f.pow(d,b),a)},mean:function(d,b){return b*g.gammafn(1+1/d)*g.gammafn(b)/g.gammafn(1+1/d+b)},median:function(d,b){return f.pow(1-f.pow(2,-1/b),1/d)},mode:function(d,b){return 1<=d&&1<=b&&1!==d&&1!==b?f.pow((d-1)/(d*b-1),1/d):void 0},variance:function(d,b){throw Error("variance not yet implemented");}});g.extend(g.lognormal,{pdf:function(d,b,a){return f.exp(-f.log(d)-.5*f.log(2*f.PI)-f.log(a)-f.pow(f.log(d)-b,2)/(2*a*a))},cdf:function(d,b,a){return.5+.5*g.erf((f.log(d)-
b)/f.sqrt(2*a*a))},inv:function(d,b,a){return f.exp(-1.4142135623730951*a*g.erfcinv(2*d)+b)},mean:function(d,b){return f.exp(d+b*b/2)},median:function(d,b){return f.exp(d)},mode:function(d,b){return f.exp(d-b*b)},sample:function(d,b){return f.exp(g.randn()*b+d)},variance:function(d,b){return(f.exp(b*b)-1)*f.exp(2*d+b*b)}});g.extend(g.normal,{pdf:function(d,b,a){return f.exp(-.5*f.log(2*f.PI)-f.log(a)-f.pow(d-b,2)/(2*a*a))},cdf:function(d,b,a){return.5*(1+g.erf((d-b)/f.sqrt(2*a*a)))},inv:function(d,
b,a){return-1.4142135623730951*a*g.erfcinv(2*d)+b},mean:function(d,b){return d},median:function(d,b){return d},mode:function(d,b){return d},sample:function(d,b){return g.randn()*b+d},variance:function(d,b){return b*b}});g.extend(g.pareto,{pdf:function(d,b,a){return d<b?void 0:a*f.pow(b,a)/f.pow(d,a+1)},cdf:function(d,b,a){return 1-f.pow(b/d,a)},mean:function(d,b){return 1>=b?void 0:b*f.pow(d,b)/(b-1)},median:function(d,b){return d*b*f.SQRT2},mode:function(d,b){return d},variance:function(d,b){return 2>=
b?void 0:d*d*b/(f.pow(b-1,2)*(b-2))}});g.extend(g.studentt,{pdf:function(d,b){return g.gammafn((b+1)/2)/(f.sqrt(b*f.PI)*g.gammafn(b/2))*f.pow(1+d*d/b,-((b+1)/2))},cdf:function(d,b){var a=b/2;return g.ibeta((d+f.sqrt(d*d+b))/(2*f.sqrt(d*d+b)),a,a)},inv:function(d,b){var a=g.ibetainv(2*f.min(d,1-d),.5*b,.5);return a=f.sqrt(b*(1-a)/a),.5<d?a:-a},mean:function(d){return 1<d?0:void 0},median:function(d){return 0},mode:function(d){return 0},sample:function(d){return g.randn()*f.sqrt(d/(2*g.randg(d/2)))},
variance:function(d){return 2<d?d/(d-2):1<d?Infinity:void 0}});g.extend(g.weibull,{pdf:function(d,b,a){return 0>d?0:a/b*f.pow(d/b,a-1)*f.exp(-f.pow(d/b,a))},cdf:function(d,b,a){return 0>d?0:1-f.exp(-f.pow(d/b,a))},inv:function(d,b,a){return b*f.pow(-f.log(1-d),1/a)},mean:function(d,b){return d*g.gammafn(1+1/b)},median:function(d,b){return d*f.pow(f.log(2),1/b)},mode:function(d,b){return 1>=b?void 0:d*f.pow((b-1)/b,1/b)},sample:function(d,b){return d*f.pow(-f.log(f.random()),1/b)},variance:function(d,
b){return d*d*g.gammafn(1+2/b)-f.pow(this.mean(d,b),2)}});g.extend(g.uniform,{pdf:function(d,b,a){return d<b||d>a?0:1/(a-b)},cdf:function(d,b,a){return d<b?0:d<a?(d-b)/(a-b):1},inv:function(d,b,a){return b+d*(a-b)},mean:function(d,b){return.5*(d+b)},median:function(d,b){return g.mean(d,b)},mode:function(d,b){throw Error("mode is not yet implemented");},sample:function(d,b){return d/2+b/2+(b/2-d/2)*(2*f.random()-1)},variance:function(d,b){return f.pow(b-d,2)/12}});g.extend(g.binomial,{pdf:function(d,
b,a){return 0===a||1===a?b*a===d?1:0:g.combination(b,d)*f.pow(a,d)*f.pow(1-a,b-d)},cdf:function(d,b,a){var e=[],f=0;if(0>d)return 0;if(d<b){for(;f<=d;f++)e[f]=g.binomial.pdf(f,b,a);return g.sum(e)}return 1}});g.extend(g.negbin,{pdf:function(d,b,a){return d!==d|0?!1:0>d?0:g.combination(d+b-1,b-1)*f.pow(1-a,d)*f.pow(a,b)},cdf:function(d,b,a){var e=0,f=0;if(0>d)return 0;for(;f<=d;f++)e+=g.negbin.pdf(f,b,a);return e}});g.extend(g.hypgeom,{pdf:function(d,b,a,e){if(d!==d|0)return!1;if(0>d||d<a-(b-e)||d>
e||d>a)return 0;if(2*a>b)return 2*e>b?g.hypgeom.pdf(b-a-e+d,b,b-a,b-e):g.hypgeom.pdf(e-d,b,b-a,e);if(2*e>b)return g.hypgeom.pdf(a-d,b,a,b-e);if(a<e)return g.hypgeom.pdf(d,b,e,a);for(var l=1,k=0,m=0;m<d;m++){for(;1<l&&k<e;)l*=1-a/(b-k),k++;l*=(e-m)*(a-m)/((m+1)*(b-a-e+m+1))}for(;k<e;k++)l*=1-a/(b-k);return f.min(1,f.max(0,l))},cdf:function(d,b,a,e){if(0>d||d<a-(b-e))return 0;if(d>=e||d>=a)return 1;if(2*a>b)return 2*e>b?g.hypgeom.cdf(b-a-e+d,b,b-a,b-e):1-g.hypgeom.cdf(e-d-1,b,b-a,e);if(2*e>b)return 1-
g.hypgeom.cdf(a-d-1,b,a,b-e);if(a<e)return g.hypgeom.cdf(d,b,e,a);for(var l=1,k=1,m=0,n=0;n<d;n++){for(;1<l&&m<e;){var p=1-a/(b-m),k=k*p,l=l*p;m++}k*=(e-n)*(a-n)/((n+1)*(b-a-e+n+1));l+=k}for(;m<e;m++)l*=1-a/(b-m);return f.min(1,f.max(0,l))}});g.extend(g.poisson,{pdf:function(d,b){return f.pow(b,d)*f.exp(-b)/g.factorial(d)},cdf:function(d,b){var a=[],e=0;if(0>d)return 0;for(;e<=d;e++)a.push(g.poisson.pdf(e,b));return g.sum(a)},mean:function(d){return d},variance:function(d){return d},sample:function(d){var b=
1,a=0;d=f.exp(-d);do a++,b*=f.random();while(b>d);return a-1}});g.extend(g.triangular,{pdf:function(d,b,a,e){return a<=b||e<b||e>a?void 0:d<b||d>a?0:d<=e?2*(d-b)/((a-b)*(e-b)):2*(a-d)/((a-b)*(a-e))},cdf:function(d,b,a,e){return a<=b||e<b||e>a?void 0:d<b?0:d<=e?f.pow(d-b,2)/((a-b)*(e-b)):1-f.pow(a-d,2)/((a-b)*(a-e))},mean:function(d,b,a){return(d+b+a)/3},median:function(d,b,a){if(a<=(d+b)/2)return b-f.sqrt((b-d)*(b-a))/f.sqrt(2);if(a>(d+b)/2)return d+f.sqrt((b-d)*(a-d))/f.sqrt(2)},mode:function(d,
b,a){return a},sample:function(d,b,a){var e=f.random();return e<(a-d)/(b-d)?d+f.sqrt(e*(b-d)*(a-d)):b-f.sqrt((1-e)*(b-d)*(b-a))},variance:function(d,b,a){return(d*d+b*b+a*a-d*b-d*a-b*a)/18}})})(this.jStat,Math);
(function(g,f){var d=Array.prototype.push,b=g.utils.isArray;g.extend({add:function(a,e){return b(e)?(b(e[0])||(e=[e]),g.map(a,function(a,b,d){return a+e[b][d]})):g.map(a,function(a){return a+e})},subtract:function(a,e){return b(e)?(b(e[0])||(e=[e]),g.map(a,function(a,b,d){return a-e[b][d]||0})):g.map(a,function(a){return a-e})},divide:function(a,e){return b(e)?(b(e[0])||(e=[e]),g.multiply(a,g.inv(e))):g.map(a,function(a){return a/e})},multiply:function(a,e){var d,f,m,n,p=a.length,q=a[0].length,t=
g.zeros(p,m=b(e)?e[0].length:q),w=0;if(b(e)){for(;w<m;w++)for(d=0;d<p;d++){for(f=n=0;f<q;f++)n+=a[d][f]*e[f][w];t[d][w]=n}return 1===p&&1===w?t[0][0]:t}return g.map(a,function(a){return a*e})},dot:function(a,e){b(a[0])||(a=[a]);b(e[0])||(e=[e]);for(var d=1===a[0].length&&1!==a.length?g.transpose(a):a,f=1===e[0].length&&1!==e.length?g.transpose(e):e,m=[],n=0,p=d.length,q=d[0].length,t,w;n<p;n++){m[n]=[];for(w=t=0;w<q;w++)t+=d[n][w]*f[n][w];m[n]=t}return 1===m.length?m[0]:m},pow:function(a,b){return g.map(a,
function(a){return f.pow(a,b)})},exp:function(a){return g.map(a,function(a){return f.exp(a)})},log:function(a){return g.map(a,function(a){return f.log(a)})},abs:function(a){return g.map(a,function(a){return f.abs(a)})},norm:function(a,e){var d=0,g=0;isNaN(e)&&(e=2);for(b(a[0])&&(a=a[0]);g<a.length;g++)d+=f.pow(f.abs(a[g]),e);return f.pow(d,1/e)},angle:function(a,b){return f.acos(g.dot(a,b)/(g.norm(a)*g.norm(b)))},aug:function(a,b){for(var f=a.slice(),g=0;g<f.length;g++)d.apply(f[g],b[g]);return f},
inv:function(a){var b=a.length,d=a[0].length,f=g.identity(b,d);a=g.gauss_jordan(a,f);for(var f=[],m=0,n;m<b;m++)for(f[m]=[],n=d;n<a[0].length;n++)f[m][n-d]=a[m][n];return f},det:function(a){var b=a.length,d=2*b,f=Array(d),g=b-1,n=d-1,p=g-b+1,q=n,t=0,w=0,v;if(2===b)return a[0][0]*a[1][1]-a[0][1]*a[1][0];for(;t<d;t++)f[t]=1;for(t=0;t<b;t++){for(v=0;v<b;v++)f[0>p?p+b:p]*=a[t][v],f[q<b?q+b:q]*=a[t][v],p++,q--;p=--g-b+1;q=--n}for(t=0;t<b;t++)w+=f[t];for(;t<d;t++)w-=f[t];return w},gauss_elimination:function(a,
b){var d=0,k=0,m=a.length,n=a[0].length,p=1,q=0,t=[],w;a=g.aug(a,b);w=a[0].length;for(d=0;d<m;d++){p=a[d][d];k=d;for(q=d+1;q<n;q++)p<f.abs(a[q][d])&&(p=a[q][d],k=q);if(k!=d)for(q=0;q<w;q++)p=a[d][q],a[d][q]=a[k][q],a[k][q]=p;for(k=d+1;k<m;k++)for(p=a[k][d]/a[d][d],q=d;q<w;q++)a[k][q]-=p*a[d][q]}for(d=m-1;0<=d;d--){q=0;for(k=d+1;k<=m-1;k++)q+=t[k]*a[d][k];t[d]=(a[d][w-1]-q)/a[d][d]}return t},gauss_jordan:function(a,b){for(var d=g.aug(a,b),k=d.length,m=d[0].length,n=0;n<k;n++){for(var p=n,q=n+1;q<k;q++)f.abs(d[q][n])>
f.abs(d[p][n])&&(p=q);q=d[n];d[n]=d[p];d[p]=q;for(q=n+1;q<k;q++)for(c=d[q][n]/d[n][n],p=n;p<m;p++)d[q][p]-=d[n][p]*c}for(n=k-1;0<=n;n--){c=d[n][n];for(q=0;q<n;q++)for(p=m-1;p>n-1;p--)d[q][p]-=d[n][p]*d[q][n]/c;d[n][n]/=c;for(p=k;p<m;p++)d[n][p]/=c}return d},lu:function(a,b){throw Error("lu not yet implemented");},cholesky:function(a,b){throw Error("cholesky not yet implemented");},gauss_jacobi:function(a,b,d,k){for(var m=0,n=0,p=a.length,q=[],t=[],w=[];m<p;m++)for(q[m]=[],t[m]=[],w[m]=[],n=0;n<p;n++)m>
n?(q[m][n]=a[m][n],t[m][n]=w[m][n]=0):m<n?(t[m][n]=a[m][n],q[m][n]=w[m][n]=0):(w[m][n]=a[m][n],q[m][n]=t[m][n]=0);a=g.multiply(g.multiply(g.inv(w),g.add(q,t)),-1);w=g.multiply(g.inv(w),b);b=d;d=g.add(g.multiply(a,d),w);for(m=2;f.abs(g.norm(g.subtract(d,b)))>k;)b=d,d=g.add(g.multiply(a,b),w),m++;return d},gauss_seidel:function(a,b,d,k){for(var m=0,n=a.length,p=[],q=[],t=[],w;m<n;m++)for(p[m]=[],q[m]=[],t[m]=[],w=0;w<n;w++)m>w?(p[m][w]=a[m][w],q[m][w]=t[m][w]=0):m<w?(q[m][w]=a[m][w],p[m][w]=t[m][w]=
0):(t[m][w]=a[m][w],p[m][w]=q[m][w]=0);a=g.multiply(g.multiply(g.inv(g.add(t,p)),q),-1);p=g.multiply(g.inv(g.add(t,p)),b);b=d;d=g.add(g.multiply(a,d),p);for(m=2;f.abs(g.norm(g.subtract(d,b)))>k;)b=d,d=g.add(g.multiply(a,b),p),m+=1;return d},SOR:function(a,b,d,k,m){for(var n=0,p=a.length,q=[],t=[],w=[],v;n<p;n++)for(q[n]=[],t[n]=[],w[n]=[],v=0;v<p;v++)n>v?(q[n][v]=a[n][v],t[n][v]=w[n][v]=0):n<v?(t[n][v]=a[n][v],q[n][v]=w[n][v]=0):(w[n][v]=a[n][v],q[n][v]=t[n][v]=0);a=g.multiply(g.inv(g.add(w,g.multiply(q,
m))),g.subtract(g.multiply(w,1-m),g.multiply(t,m)));m=g.multiply(g.multiply(g.inv(g.add(w,g.multiply(q,m))),b),m);b=d;d=g.add(g.multiply(a,d),m);for(n=2;f.abs(g.norm(g.subtract(d,b)))>k;)b=d,d=g.add(g.multiply(a,b),m),n++;return d},householder:function(a){for(var b=a.length,d=a[0].length,k=0,m=[],n=[],p;k<b-1;k++){n=0;for(m=k+1;m<d;m++)n+=a[m][k]*a[m][k];m=0<a[k+1][k]?-1:1;n=m*f.sqrt(n);p=f.sqrt((n*n-a[k+1][k]*n)/2);m=g.zeros(b,1);m[k+1][0]=(a[k+1][k]-n)/(2*p);for(n=k+2;n<b;n++)m[n][0]=a[n][k]/(2*
p);n=g.subtract(g.identity(b,d),g.multiply(g.multiply(m,g.transpose(m)),2));a=g.multiply(n,g.multiply(a,n))}return a},QR:function(a,b){for(var d=a.length,k=a[0].length,m=0,n=[],p=[],q=[],t;m<d-1;m++){p=0;for(n=m+1;n<k;n++)p+=a[n][m]*a[n][m];n=0<a[m+1][m]?-1:1;p=n*f.sqrt(p);t=f.sqrt((p*p-a[m+1][m]*p)/2);n=g.zeros(d,1);n[m+1][0]=(a[m+1][m]-p)/(2*t);for(p=m+2;p<d;p++)n[p][0]=a[p][m]/(2*t);p=g.subtract(g.identity(d,k),g.multiply(g.multiply(n,g.transpose(n)),2));a=g.multiply(p,a);b=g.multiply(p,b)}for(m=
d-1;0<=m;m--){for(n=m+1;n<=k-1;n++);q[m]=b[m][0]/a[m][m]}return q},jacobi:function(a){for(var b=1,d=0,k=a.length,m=g.identity(k,k),n=[],p,q,t,w,v;1===b;){d++;w=a[0][1];b=0;t=1;for(p=0;p<k;p++)for(q=0;q<k;q++)p!=q&&w<f.abs(a[p][q])&&(w=f.abs(a[p][q]),b=p,t=q);a[b][b]===a[t][t]?v=0<a[b][t]?f.PI/4:-f.PI/4:v=f.atan(2*a[b][t]/(a[b][b]-a[t][t]))/2;p=g.identity(k,k);p[b][b]=f.cos(v);p[b][t]=-f.sin(v);p[t][b]=f.sin(v);p[t][t]=f.cos(v);m=g.multiply(m,p);a=g.multiply(g.multiply(g.inv(p),a),p);b=0;for(p=1;p<
k;p++)for(q=1;q<k;q++)p!=q&&.001<f.abs(a[p][q])&&(b=1)}for(p=0;p<k;p++)n.push(a[p][p]);return[m,n]},rungekutta:function(a,b,d,f,g,n){var p,q,t;if(2===n)for(;f<=d;)p=b*a(f,g),q=b*a(f+b,g+p),g+=(p+q)/2,f+=b;if(4===n)for(;f<=d;)p=b*a(f,g),q=b*a(f+b/2,g+p/2),n=b*a(f+b/2,g+q/2),t=b*a(f+b,g+n),g+=(p+2*q+2*n+t)/6,f+=b;return g},romberg:function(a,b,d,g){for(var m=0,n=(d-b)/2,p=[],q=[],t=[],w,v,z;m<g/2;){z=a(b);v=b;for(w=0;v<=d;v+=n,w++)p[w]=v;w=p.length;for(v=1;v<w-1;v++)z+=(0!==v%2?4:2)*a(p[v]);z=n/3*(z+
a(d));t[m]=z;n/=2;m++}a=t.length;for(w=1;1!==a;){for(v=0;v<a-1;v++)q[v]=(f.pow(4,w)*t[v+1]-t[v])/(f.pow(4,w)-1);a=q.length;t=q;q=[];w++}return t},richardson:function(a,b,d,g){function m(a,b){for(var e=0,d=a.length,f;e<d;e++)a[e]===b&&(f=e);return f}for(var n=f.abs(d-a[m(a,d)+1]),p=0,q=[],t=[],w,v;g>=n;)w=m(a,d+g),v=m(a,d),q[p]=(b[w]-2*b[v]+b[2*v-w])/(g*g),g/=2,p++;b=q.length;for(a=1;1!=b;){for(d=0;d<b-1;d++)t[d]=(f.pow(4,a)*q[d+1]-q[d])/(f.pow(4,a)-1);b=t.length;q=t;t=[];a++}return q},simpson:function(a,
b,d,f){f=(d-b)/f;var g=a(b),n=[],p=b,q=0;for(b=1;p<=d;p+=f,q++)n[q]=p;for(p=n.length;b<p-1;b++)g+=(0!==b%2?4:2)*a(n[b]);return f/3*(g+a(d))},hermite:function(a,b,d,f){for(var g=a.length,n=0,p=0,q=[],t=[],w=[],v=[],z;p<g;p++){q[p]=1;for(z=0;z<g;z++)p!=z&&(q[p]*=(f-a[z])/(a[p]-a[z]));for(z=t[p]=0;z<g;z++)p!=z&&(t[p]+=1/(a[p]-a[z]));w[p]=(1-2*(f-a[p])*t[p])*q[p]*q[p];v[p]=(f-a[p])*q[p]*q[p];n+=w[p]*b[p]+v[p]*d[p]}return n},lagrange:function(a,b,d){for(var f=0,g=0,n,p,q=a.length;g<q;g++){p=b[g];for(n=
0;n<q;n++)g!=n&&(p*=(d-a[n])/(a[g]-a[n]));f+=p}return f},cubic_spline:function(a,b,d){for(var f=a.length,m=0,n=[],p=[],q=[],t=[],w=[],v=[],z=[];m<f-1;m++)w[m]=a[m+1]-a[m];q[0]=0;for(m=1;m<f-1;m++)q[m]=3/w[m]*(b[m+1]-b[m])-3/w[m-1]*(b[m]-b[m-1]);for(m=1;m<f-1;m++)n[m]=[],p[m]=[],n[m][m-1]=w[m-1],n[m][m]=2*(w[m-1]+w[m]),n[m][m+1]=w[m],p[m][0]=q[m];t=g.multiply(g.inv(n),p);for(m=0;m<f-1;m++)v[m]=(b[m+1]-b[m])/w[m]-w[m]*(t[m+1][0]+2*t[m][0])/3,z[m]=(t[m+1][0]-t[m][0])/(3*w[m]);for(m=0;m<f&&!(a[m]>d);m++);
return--m,b[m]+(d-a[m])*v[m]+g.sq(d-a[m])*t[m]+(d-a[m])*g.sq(d-a[m])*z[m]},gauss_quadrature:function(){throw Error("gauss_quadrature not yet implemented");},PCA:function(a){var b=a.length,d=a[0].length,f=0,m,n,p=[],q=[];m=[];for(var t=[],w=[],v=[],v=[],q=[],f=[],z=[],f=0;f<b;f++)p[f]=g.sum(a[f])/d;for(f=0;f<d;f++)for(v[f]=[],m=0;m<b;m++)v[f][m]=a[m][f]-p[m];v=g.transpose(v);for(f=0;f<b;f++)for(q[f]=[],m=0;m<b;m++)q[f][m]=g.dot([v[f]],[v[m]])/(d-1);m=g.jacobi(q);f=m[0];q=m[1];z=g.transpose(f);for(f=
0;f<q.length;f++)for(m=f;m<q.length;m++)q[f]<q[m]&&(n=q[f],q[f]=q[m],q[m]=n,t=z[f],z[f]=z[m],z[m]=t);v=g.transpose(v);for(f=0;f<b;f++)for(w[f]=[],m=0;m<v.length;m++)w[f][m]=g.dot([z[f]],[v[m]]);return[a,q,z,w]}});(function(a){for(var b=0;b<a.length;b++)(function(a){g.fn[a]=function(b,d){var e=this;return d?(setTimeout(function(){d.call(e,g.fn[a].call(e,b))},15),this):"number"==typeof g[a](this,b)?g[a](this,b):g(g[a](this,b))}})(a[b])})("add divide multiply subtract dot pow exp log abs norm angle".split(" "))})(this.jStat,
Math);
(function(g,f){var d=[].slice,b=g.utils.isNumber;g.extend({zscore:function(){var a=d.call(arguments);return b(a[1])?(a[0]-a[1])/a[2]:(a[0]-g.mean(a[1]))/g.stdev(a[1],a[2])},ztest:function(){var a=d.call(arguments);if(4===a.length){if(b(a[1])){var e=g.zscore(a[0],a[1],a[2]);return 1===a[3]?g.normal.cdf(-f.abs(e),0,1):2*g.normal.cdf(-f.abs(e),0,1)}e=a[0];return 1===a[2]?g.normal.cdf(-f.abs(e),0,1):2*g.normal.cdf(-f.abs(e),0,1)}e=g.zscore(a[0],a[1],a[3]);return 1===a[1]?g.normal.cdf(-f.abs(e),0,1):2*
g.normal.cdf(-f.abs(e),0,1)}});g.extend(g.fn,{zscore:function(a,b){return(a-this.mean())/this.stdev(b)},ztest:function(a,b,d){a=f.abs(this.zscore(a,d));return 1===b?g.normal.cdf(-a,0,1):2*g.normal.cdf(-a,0,1)}});g.extend({tscore:function(){var a=d.call(arguments);return 4===a.length?(a[0]-a[1])/(a[2]/f.sqrt(a[3])):(a[0]-g.mean(a[1]))/(g.stdev(a[1],!0)/f.sqrt(a[1].length))},ttest:function(){var a=d.call(arguments),e;return 5===a.length?(e=f.abs(g.tscore(a[0],a[1],a[2],a[3])),1===a[4]?g.studentt.cdf(-e,
a[3]-1):2*g.studentt.cdf(-e,a[3]-1)):b(a[1])?(e=f.abs(a[0]),1==a[2]?g.studentt.cdf(-e,a[1]-1):2*g.studentt.cdf(-e,a[1]-1)):(e=f.abs(g.tscore(a[0],a[1])),1==a[2]?g.studentt.cdf(-e,a[1].length-1):2*g.studentt.cdf(-e,a[1].length-1))}});g.extend(g.fn,{tscore:function(a){return(a-this.mean())/(this.stdev(!0)/f.sqrt(this.cols()))},ttest:function(a,b){return 1===b?1-g.studentt.cdf(f.abs(this.tscore(a)),this.cols()-1):2*g.studentt.cdf(-f.abs(this.tscore(a)),this.cols()-1)}});g.extend({anovafscore:function(){var a=
d.call(arguments),b,l,k,m,n,p;if(1===a.length){b=Array(a[0].length);for(n=0;n<a[0].length;n++)b[n]=a[0][n];a=b}if(2===a.length)return g.variance(a[0])/g.variance(a[1]);l=[];for(n=0;n<a.length;n++)l=l.concat(a[n]);k=g.mean(l);for(n=b=0;n<a.length;n++)b+=a[n].length*f.pow(g.mean(a[n])-k,2);b/=a.length-1;for(n=m=0;n<a.length;n++)for(k=g.mean(a[n]),p=0;p<a[n].length;p++)m+=f.pow(a[n][p]-k,2);return m/=l.length-a.length,b/m},anovaftest:function(){var a=d.call(arguments),e,f,k,m;if(b(a[0]))return 1-g.centralF.cdf(a[0],
a[1],a[2]);anovafscore=g.anovafscore(a);e=a.length-1;for(m=k=0;m<a.length;m++)k+=a[m].length;return f=k-e-1,1-g.centralF.cdf(anovafscore,e,f)},ftest:function(a,b,d){return 1-g.centralF.cdf(a,b,d)}});g.extend(g.fn,{anovafscore:function(){return g.anovafscore(this.toArray())},anovaftes:function(){var a=0,b;for(b=0;b<this.length;b++)a+=this[b].length;return g.ftest(this.anovafscore(),this.length-1,a-this.length)}});g.extend({normalci:function(){var a=d.call(arguments),b=Array(2),l;return 4===a.length?
l=f.abs(g.normal.inv(a[1]/2,0,1)*a[2]/f.sqrt(a[3])):l=f.abs(g.normal.inv(a[1]/2,0,1)*g.stdev(a[2])/f.sqrt(a[2].length)),b[0]=a[0]-l,b[1]=a[0]+l,b},tci:function(){var a=d.call(arguments),b=Array(2),l;return 4===a.length?l=f.abs(g.studentt.inv(a[1]/2,a[3]-1)*a[2]/f.sqrt(a[3])):l=f.abs(g.studentt.inv(a[1]/2,a[2].length-1)*g.stdev(a[2],!0)/f.sqrt(a[2].length)),b[0]=a[0]-l,b[1]=a[0]+l,b},significant:function(a,b){return a<b}});g.extend(g.fn,{normalci:function(a,b){return g.normalci(a,b,this.toArray())},
tci:function(a,b){return g.tci(a,b,this.toArray())}})})(this.jStat,Math);var utils=utils||{};
(function(g){g.htmlNamespaceUri="http://www.w3.org/1999/xhtml";g.svgNamespaceUri="http://www.w3.org/2000/svg";g.xlinkUri="http://www.w3.org/1999/xlink";g.hasOwnProperty=function(f,d){var b=f.__proto__||f.constructor.prototype;return d in f&&(!(d in b)||b[d]!==f[d])};g.shuffleArray=function(f){for(var d=f.length,b,a;0!==d;)a=Math.floor(Math.random()*d),--d,b=f[d],f[d]=f[a],f[a]=b;return f};g.isObjInArray=function(f,d){var b=!1;0<=f.indexOf(d)&&(b=!0);return b};g.removeA=function(f){for(var d,b=arguments,
a=b.length,e;1<a&&f.length;)for(d=b[--a];-1!==(e=f.indexOf(d));)f.splice(e,1);return f};g.getKeys=function(f){var d=[],b;for(b in f)d.push(b);return d};g.eliminateDuplicates=function(f){for(var d=[],b=0;b<f.length;b++){var a=f[b];g.isObjInArray(d,a)||d.push(a)}return d};g.keepReplicates=function(f,d,b){for(var a={},e=0;e<f.length;e++){var g=f[e];g in a||(a[g]=0);a[g]++}d=null==d?2:d;f=[];for(g in a)null!=b&&b?a[g]<d&&f.push(g):a[g]>=d&&f.push(g);return f};g.beginsWith=function(f,d){return 0===f.indexOf(d)};
g.endsWith=function(f,d){return-1!==f.indexOf(d,f.length-d.length)};g.lengthOfLongestString=function(f){var d=[],b;for(b in f)d.push(f[b].length);return Math.max.apply(null,d)};g.isNumerical=function(f){return null==f||""===f||isNaN(f)?!1:!0};g.getListBoxSelectedValues=function(f){for(var d=[],b=0;b<f.length;b++){var a=f[b];a.selected&&d.push(a.value)}return d};g.linearInterpolation=function(f,d,b){return(b-d)*f+d};g.rangeLimit=function(f,d,b){"undefined"===typeof d&&(d=-1);"undefined"===typeof b&&
(b=1);return f<d?d:f>b?b:f};g.extractFromJq=function(f){return f.get(0)};g.convertToJq=function(f){$(f);return f};g.extractFromD3=function(f){return f.node()};g.convertToD3=function(f){return d3.select(f)};g.sort_by=function(f,d,b){var a=b?function(a){return b(a[f])}:function(a){return a[f]};d=[-1,1][+!!d];return function(b,f){return b=a(b),f=a(f),d*((b>f)-(f>b))}};g.compareAsNumeric=function(f,d){var b=parseFloat(f),a=parseFloat(d);if(utils.isNumerical(b)&&utils.isNumerical(a)){if(b<a)return-1;if(b>
a)return 1}else if(b==b||a==a){if(b!=b)return-1;if(a!=a)return 1}return 0};g.compareAsString=function(f,d){var b=new String(f),a=new String(d);return"null"==b&&"null"!=a?1:"null"!=b&&"null"==a?-1:b.localeCompare(a)};g.compareAsDate=function(f,d){var b=f,a=d;null==b?b="1000":""==b&&(b="1001");null==a?a="1000":""==a&&(a="1001");return new Date(b)-new Date(a)};g.rgbComponentToHex=function(f){f=f.toString(16);return 1==f.length?"0"+f:f};g.rgbToHex=function(f,d,b){return"#"+this.rgbComponentToHex(f)+this.rgbComponentToHex(d)+
this.rgbComponentToHex(b)};g.centeredRgbaColorMapper=function(f,d,b,a){var e=null,g=null==d?0:d,k=null==b?-1.96:b,m=null==a?1.96:a;return e=function(a){var b=1,d=169,e=169,w=169;a=parseFloat(a);null!=a&&a==a&&(a>g?(d=255,w=e=0,a>m?b=1:(b=(a-g)/(m-g),b=Math.abs(b),f&&(b=Math.log(b)))):a<g?(e=d=0,w=255,a<k?b=1:(b=(a-g)/(k-g),b=Math.abs(b),f&&(b=Math.log(b)))):(w=e=d=255,b=1));return"rgba("+d+","+e+","+w+","+b+")"}};g.setupQuantileColorMapper=function(f,d){var b=d;null==b&&(b="rgb(255,255,217) rgb(237,248,177) rgb(199,233,180) rgb(127,205,187) rgb(65,182,196) rgb(29,145,192) rgb(34,94,168) rgb(37,52,148) rgb(8,29,88)".split(" "));
var a=b.length;return d3.scale.quantile().domain([0,a-1,d3.max(f,function(a){return parseFloat(a)})]).range(b)};g.getXmlDom_url=function(f){xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");xmlhttp.open("GET",f,!1);xmlhttp.send();return xmlDoc=xmlhttp.responseXML};g.getXmlDom_string=function(f){window.DOMParser?(parser=new DOMParser,xmlDoc=parser.parseFromString(f,"text/xml")):(xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.async=!1,xmlDoc.loadXML(f));return xmlDoc};
g.getDateTime=function(){var f=new Date,d=f.getFullYear(),b=f.getMonth()+1,a=f.getDate(),e=f.getHours(),g=f.getMinutes(),f=f.getSeconds();1==b.toString().length&&(b="0"+b);1==a.toString().length&&(a="0"+a);1==e.toString().length&&(e="0"+e);1==g.toString().length&&(g="0"+g);1==f.toString().length&&(f="0"+f);return d+"/"+b+"/"+a+" "+e+":"+g+":"+f};g.todaysDate=function(){var f=new Date,d=f.getDate();f.getDay();var b=f.getMonth()+1,f=f.getYear();return[,"January","February","March","April","May","June",
"July","August","September","October","November","December"][b]+" "+d+", "+(1E3>f?f+1900:f)};g.pushElemToBack=function(f){var d=f.parentNode;d.insertBefore(f,d.firstChild);return f};g.pullElemToFront=function(f){f.parentNode.appendChild(f);return f};g.removeElemById=function(f){f=document.getElementById(f);f.parentNode.removeChild(f)};g.removeChildElems=function(f){for(;f.firstChild;)f.removeChild(f.firstChild);return f};g.createDivElement=function(f,d){var b=document.createElement("div");null!=f&&
(b.id=f);null!=d&&(b.className=d);return b};g.setElemAttributes=function(f,d,b){b="undefined"===typeof b?null:b;if(null!=d)for(var a in d)f.setAttributeNS(b,a,d[a]);return f};g.swapContainingDivs=function(f,d){var b=d.parentNode;document.getElementById(f.parentNode.id).appendChild(d);document.getElementById(b.id).appendChild(f)};g.simpleAsyncGet=function(f,d){var b=new XMLHttpRequest,b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");b.onreadystatechange=function(){this.readyState===
(this.DONE||4)&&(200==this.status?d(this.responseText):400==this.status?console.log("There was an error 400"):console.log("status was not 200",this.status))};b.open("GET",f,!0);b.setRequestHeader("X-Requested-With","XMLHttpRequest");b.send(null)};g.getResponse=function(f){var d=null,b=null,b=new XMLHttpRequest;b.open("GET",f,!1);b.onload=function(){d=b.status;200!=d&&console.log("xhr status: "+d+" for "+f)};b.send(null);var a=null;200==d&&(a=b.responseText);return a};g.loadNewSettings=function(f){f=
window.location.pathname+"?query="+JSON.stringify(f);window.open(f,"_self")};g.getQueryObj=function(){var f={};location.search.slice(1).split("&").forEach(function(d){d=d.split("=");f[d[0]]=decodeURIComponent(d[1])||""});return f};g.getQueryStringParameterByName=function(f){f=f.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");f=(new RegExp("[\\?&]"+f+"=([^&#]*)")).exec(location.search);return null==f?"":decodeURIComponent(f[1].replace(/\+/g," "))};g.parseJson=function(f){return JSON.parse(f)};g.serializeJson=
function(f,d){return d?JSON.stringify(f,null,"\t"):JSON.stringify(f)};g.prettyJson=function(f){return this.serializeJson(f,!0)};g.bottomRoundedRectSvgPath=function(f,d,b,a,e){f=""+("M"+f+","+d)+("h"+b);f+="v"+(a-e);f+="a"+e+","+e+" 0 0 1 "+-1*e+","+e;f+="h"+-1*(b-2*e);f+="a"+e+","+e+" 0 0 1 "+-1*e+","+-1*e;f+="v"+-1*(a-e);return f+="z"};g.allRoundedRectSvgPath=function(f,d,b,a,e){f=""+("M"+f+","+(d+e))+("a"+e+","+e+" 0 0 1 "+e+","+-1*e);f+="h"+(b-2*e);f+="a"+e+","+e+" 0 0 1 "+e+","+e;f+="v"+(a-2*
e);f+="a"+e+","+e+" 0 0 1 "+-1*e+","+e;f+="h"+-1*(b-2*e);f+="a"+e+","+e+" 0 0 1 "+-1*e+","+-1*e;f+="v"+-1*(a-2*e);return f+="z"};g.allAngledRectSvgPath=function(f,d,b,a){var e=b>a?b/8:a/8;f=""+("M"+(f+e)+","+d)+("h"+(b-2*e));f+="l"+e+","+e;f+="v"+(a-2*e);f+="l"+-1*e+","+e;f+="h"+-1*(b-2*e);f+="l"+-1*e+","+-1*e;f+="v"+-1*(a-2*e);return f+="z"};g.createSvgRingElement=function(f,d,b,a){function e(a,b,d,e){e=(e-90)*Math.PI/180;return{x:a+d*Math.cos(e),y:b+d*Math.sin(e)}}f=function(a,b,d,f,g){var l=e(a,
b,d,g);a=e(a,b,d,f);return["M",l.x,l.y,"A",d,d,0,180>=g-f?"0":"1",0,a.x,a.y].join(" ")}(f,d,b,0,359.9);d=document.createElementNS(this.svgNamespaceUri,"path");d.setAttributeNS(null,"d",f);if(null!=a)for(var g in a)d.setAttributeNS(null,g,a[g]);return d};g.createSvgCircleElement=function(f,d,b,a){var e=document.createElementNS(this.svgNamespaceUri,"circle");e.setAttributeNS(null,"cx",f);e.setAttributeNS(null,"cy",d);e.setAttributeNS(null,"r",b);if(null!=a)for(var g in a)e.setAttributeNS(null,g,a[g]);
return e};g.createSvgRectElement=function(f,d,b,a,e,g,k){var m=document.createElementNS(this.svgNamespaceUri,"rect");m.setAttributeNS(null,"x",f);m.setAttributeNS(null,"y",d);m.setAttributeNS(null,"rx",b);m.setAttributeNS(null,"ry",a);m.setAttributeNS(null,"width",e);m.setAttributeNS(null,"height",g);if(null!=k)for(var n in k)m.setAttributeNS(null,n,k[n]);return m};g.createSVGPolygonElement=function(f){var d=document.createElementNS(this.svgNamespaceUri,"polygon");if(null!=f)for(var b in f)d.setAttributeNS(null,
b,f[b]);return d};g.createSvgImageElement=function(f,d,b,a,e,g){var k=document.createElementNS(this.svgNamespaceUri,"image");k.setAttributeNS(this.xlinkUri,"href",f);k.setAttributeNS(null,"x",d);k.setAttributeNS(null,"y",b);k.setAttributeNS(null,"width",a);k.setAttributeNS(null,"height",e);if(null!=g)for(var m in g)k.setAttributeNS(null,m,g[m]);return k};g.setCookie=function(f,d,b){if(b){var a=new Date;a.setTime(a.getTime()+864E5*b);b="; expires="+a.toGMTString()}else b="";document.cookie=f+"="+d+
b+"; path=/"};g.getCookie=function(f){f+="=";for(var d=document.cookie.split(";"),b=0;b<d.length;b++){for(var a=d[b];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(f))return a.substring(f.length,a.length)}return null};g.deleteCookie=function(f){this.setCookie(f,"",-1)};g.getNormalizedVector=function(f){var d=[],b=jStat.min(f),a=jStat.max(f);if(0>b||0==a){console.log("min:"+b+"\tmax:"+a);if(0>b)return null;if(0==a)return f}for(b=0;b<f.length;b++)d.push(f[b]/a);return d};g.computeMarginalEntropy=
function(f,d){for(var b=0,a=[],e=d(f),g=0;g<e.length;g++)a.push({bin:g,count:e[g].length});for(g=0;g<a.length;g++)e=a[g],e.probability=e.count/f.length,e.prod=0==e.probability?0:e.probability*Math.log2(e.probability),b+=e.prod;return-1*b};g.computeJointEntropy=function(f,d,b){if(f.length!=d.length)return null;var a=function(a,b){for(var d=null,e=0;e<a.length;e++){var f=a[e];b>=f.x&&b<f.x+f.dx&&(d=e)}null==d&&(f=a[a.length-1],b-f.x-f.dx<f.dx&&(d=a.length-1));return d},e=b(f),l=b(d);b={};for(var k=
0;k<e.length;k++)for(var m=0;m<l.length;m++){var n=k+"_"+m;b[n]=0}for(k=0;k<f.length;k++)n=a(e,f[k]),m=a(l,d[k]),n=n+"_"+m,b[n]++;d=0;a=g.getKeys(b);for(k=0;k<a.length;k++)n=a[k],e=b[n]/f.length,e=0==e?0:e*Math.log2(e),d+=e;return-1*d};g.mutualInformation=function(f,d,b){b="undefined"===typeof b?f.length:b;var a=d3.layout.histogram().bins(b).frequency(!1);b=g.computeMarginalEntropy(f,a);var e=g.computeMarginalEntropy(d,a);f=g.computeJointEntropy(f,d,a);return b+e-f}})(utils);var eventData=eventData||{};
(function(g){g.getEventElems=function(f,d){var b=[];f.find("event").each(function(a,e){var f=e.getAttribute("type");void 0===d||null===d?b.push(e):f===d&&b.push(e)});return b};g.getEventParentChildren=function(f,d){var b={parent:null,children:[]},a=g.getEventElems(f,d);$(a).each(function(a,d){if("event"!==d.tagName)return"continue";b.parent=d.parentNode.getAttribute("type");$(d.children).each(function(a,d){"event"===d.tagName&&b.children.push(d.getAttribute("type"))})});return b};g.tracebackToRoot=
function(f,d){for(var b=[],a=g.getEventElems(f,d),e=0;e<a.length;e++){var l=a[e],k=[];b.push(k);l=l.getAttribute("type");for(l=g.getEventParentChildren(f,l).parent;void 0!==l&&null!==l;)k.push(l),l=g.getEventParentChildren(f,l).parent}return b};g.OD_eventAlbum=function(){this.album={};this.datatypeSuffixMapping={};this.pivot={};this.getSuffixedEventId=function(f,d){return f+(d in this.datatypeSuffixMapping?this.datatypeSuffixMapping[d]:"")};this.addEvent=function(f,d){var b=new g.OD_event(f);this.album[f.id]=
b;"datatype"in f&&"geneSuffix"in f&&(this.datatypeSuffixMapping[f.datatype]=f.geneSuffix);b.data.setData(d,"numeric"==f.allowedValues||"expression"==f.allowedValues);return b};this.deleteEvent=function(f){delete this.album[f]};this.getAllEventIds=function(){var f=[],d=this.getEventIdsByType(),b;for(b in d)f=f.concat(d[b]);return f};this.getEventIdsByType=function(){for(var f={},d=utils.getKeys(this.album),b=0;b<d.length;b++){var a=d[b],e=this.getEvent(a).metadata.datatype;utils.hasOwnProperty(f,e)||
(f[e]=[]);f[e].push(a)}return f};this.getEventData=function(f){for(var d={},b=utils.getKeys(this.album),a=0;a<b.length;a++){var e=b[a],g=this.getEvent(e).data.getData(f);d[e]=g}return d};this.getAllDataAsList=function(){for(var f=[],d=this.getEventData(),b=utils.getKeys(d),a=0;a<b.length;a++){for(var e=b[a],g=d[e].slice(),k=0;k<g.length;k++)g[k].eventId=e;f=f.concat(g)}return f};this.getAllSampleIds=function(){for(var f=[],d=utils.getKeys(this.album),b=0;b<d.length;b++)var a=this.getEvent(d[b]).data.getAllSampleIds(),
f=f.concat(a);return utils.eliminateDuplicates(f)};this.selectSamples=function(f){var d=this.getAllSampleIds();if(0==f.length)return d;for(var b in f)var a=f[b].value,d=this.getEvent(f[b].eventId).data.selectIds(a,d);return d};this.getEvent=function(f){var d=this.album[f];"undefined"===typeof d&&console.log("getEvent got undefined eventObj for: "+f);return d};this.getAllChildren=function(f,d){for(var b="undefined"===typeof d?[]:d,a=[],e=0;e<f.length;e++)var g=this.getEvent(f[e]).metadata,a=a.concat(getKeys(g.children));
if(0==a.length)return b;b=b.concat(a);return this.getAllChildren(a,b)};this.setPivotScores_dict=function(f,d){this.pivot=null==d?{}:{event:f,scores:d};return this};this.setPivotScores_array=function(f,d){null==d?this.pivot={}:(d=d.sort(utils.sort_by("score")),this.pivot={event:f,scores:d});return this};this.getPivotSortedEvents=function(f){if("undefined"===typeof this.pivot.scores||null==this.pivot.scores)return console.log("getPivotSortedEvents found no pivot scores"),[];for(var d=[],b={},a=0,e=
this.pivot.scores.length;a<e;a++){var g=this.pivot.scores[a],k=g.eventId1,m=g.eventId2,g=g.score;if(k===f)k=m;else if(m!==f)continue;utils.hasOwnProperty(b,k)||(d.push({key:k,val:parseFloat(g)}),b[k]=1)}return d=d.sort(utils.sort_by("val"))};this.getGroupedPivotSorts=function(f,d){console.log("getGroupedPivotSorts");for(var b=["expression data","expression signature"],a={},b=this.getPivotSortedEvents(f),e=[],g=0;g<b.length;g++)e.push(b[g].key);var g=this.getEventIdsByType(),b=utils.getKeys(g),b=utils.removeA(b,
"clinical data"),k;for(k in g){var m=[],n=g[k];if(0==e.length)console.log("pivotSortedEvents.length == 0 for "+k),a[k]=n;else{for(var p=0;p<e.length;p++){var q=this.getSuffixedEventId(e[p],k);utils.isObjInArray(n,q)&&m.push(q)}utils.isObjInArray(b,k)||(m=m.concat(n),m=utils.eliminateDuplicates(m));a[k]=m}}return a};this.getAllPivotScores=function(f,d){var b={},a=this.getEventIdsByType();if(!utils.hasOwnProperty(a,f))return b;for(var a=a[f],e=0;e<a.length;e++){var g=a[e],k=this.pivotSort(g,d);b[g]=
k}return b};this.pivotSort_2=function(f,d){for(var b=this.pivotSort(f,jStat.corrcoeff),a={},e=0;e<b.length;e++){var g=b[e],k=g.event;a[k]=0>g.score?-1:1}for(var b=this.pivotSort(f,d),m=[],n=[],e=0;e<b.length;e++)g=b[e],k=g.event,0>a[k]?n.push(g):m.push(g);m.sort(utils.sort_by("score"));n.sort(utils.sort_by("score"),!0);return m.concat(n)};this.pivotSort=function(f,d){console.log("eventAlbum.pivotSort:",f);"undefined"===typeof d&&(console.log("using default scoringAlgorithm, jStat.corrcoeff"),d=jStat.corrcoeff);
var b=this.getEvent(f);if(null==b)return console.log("eventObj not found for",f),null;for(var a=b.data.getAllSampleIds(),e=b.data.getNullSamples(),a=utils.keepReplicates(a.concat(e),2,!0),e=this.getEventIdsByType()[b.metadata.datatype],g=[],k=0;k<e.length;k++){var m=e[k],n=this.getEvent(m),p=n.data.getAllSampleIds(),q=n.data.getNullSamples(),p=utils.keepReplicates(p.concat(q),2,!0),p=utils.keepReplicates(p.concat(a)),q=b.data.getData(p),n=n.data.getData(p);if(0<n.length){var t=[],w=[],v=null;null==
v&&(v=utils.hasOwnProperty(q[0],"val_orig")?"val_orig":"val");for(var z=null,I=0;I<p.length;I++)null==z&&(z=utils.hasOwnProperty(n[I],"val_orig")?"val_orig":"val"),t.push(q[I][v]),w.push(n[I][z]);p=d(t,w);g.push({event:m,score:p})}else console.log("eventData2 is empty")}g.sort(utils.sort_by("score"));return g};this.multisortEvents=function(f,d){console.log("multisortEvents");console.log("rowSortSteps",f);console.log("colSortSteps",d);var b=this.getEventIdsByType();console.log("groupedEvents",b);var a=
[],e;for(e in b)if("datatype label"!==e){var g=b[e];g.unshift(e+"(+)");g.push(e+"(-)");a=a.concat(g)}g=[];if(null!=d){for(var k=d.getSteps(),m=0;m<k.length;m++){e=k[m];var n=e.name;g.push(n)}g.reverse()}var p=g.slice(0),p=p.concat(a),p=utils.eliminateDuplicates(p);if(null!=f)for(k=f.getSteps().reverse(),m=0;m<k.length;m++){e=k[m];n=e.name;a=e.reverse;n=this.getEvent(n);e=n.metadata.datatype;var q=n.metadata.scoredDatatype;if(null==q)console.log("no scored datatype to sort");else if(n=n.metadata.sortSignatureVector(),
a&&n.reverse(),utils.hasOwnProperty(b,q)){m=b[q].slice(0);k=[];p=[];for(a=0;a<n.length;a++){var t=this.getSuffixedEventId(n[a],q),w=m.indexOf(t);0<=w&&p.push(t);0<=w&&!utils.isObjInArray(g,t)&&(k.push(t),delete m[w]);utils.isObjInArray(g,t)&&delete m[w]}console.log("scoredEventSigWeightOverlap",p.length,p);for(var v in m)k.push(m[v]);a=g.slice(0);for(e in b)if(e===q)a=a.concat(k);else{var g=b[e],z;for(z in g)n=g[z],utils.isObjInArray(a,n)||a.push(n)}p=a;console.log("rowNames.length",p.length,p);break}else console.log(q+
" group has no events")}return p};this.multisortSamples=function(f){var d=this.getAllSampleIds();if(null==f)return console.log("multisortSamples got null steps"),d;console.log("multisortSamples using steps:",f.getSteps());var b=f.getSteps().slice();b.reverse();var a=this;d.sort(function(d,f){for(var g=0,m=0;m<b.length;m++){var n=b[m].name,p=b[m].reverse,q=a.getEvent(n);if(void 0==q||null==q){for(var t in a.datatypeSuffixMapping){var w=n+a.datatypeSuffixMapping[t],q=a.getEvent(w);if(void 0!=q&&null!=
q){n=w;break}}if(void 0==q||null==q){console.log("no event found for sorting: "+n);continue}}g=q.metadata.allowedValues;n=q.data.getData([d,f]);q=n[0].val;w=n[1].val;n=null;n="numeric"==g?utils.compareAsNumeric:"categoric"==g?utils.compareAsString:"expression"==g?utils.compareAsNumeric:"date"==g?utils.compareAsDate:utils.compareAsString;g=n(q,w);n==utils.compareAsNumeric&&(g*=-1);p&&(g*=-1);if(0!=g)break}return g});return d};this.zScoreExpressionRescaling=function(){console.log("zScoreExpressionRescaling");
var f=this.getEventIdsByType();if(!utils.hasOwnProperty(f,"expression data"))return console.log("no expression"),null;for(var f=f["expression data"],d={},b={stats:d},a=[],e=0;e<f.length;e++){var g=f[e],k=this.getEvent(g).data.getStats();d[g]={};d[g]=k;for(var k=this.getEvent(g).data.getData(),m=0;m<k.length;m++){var n=k[m];utils.hasOwnProperty(n,"val_orig")&&(n.val=n.val_orig);var p=n.val;n.val_orig=p;utils.isNumerical(p)&&(n.val=(p-d[g].mean)/d[g].sd,a.push(n.val))}}b.maxVal=jStat.max(a);b.minVal=
jStat.min(a);return b};this.betweenMeansExpressionRescaling=function(f,d,b){console.log("betweenMeansExpressionRescaling",f,d,b);d=this.getEvent(f).data.selectIds(d);var a=null;null==b?(a=this.getEvent(f).data.selectIds(b),a=a.concat(d),a=utils.eliminateDuplicates(a)):a=this.getEvent(f).data.selectIds(b);f=this.getEventIdsByType();if(!utils.hasOwnProperty(f,"expression data"))return console.log("no expression"),null;f=f["expression data"];b={};for(var e={meanVals:b},g=[],k=0;k<f.length;k++){var m=
f[k];b[m]={};b[m].group1=this.getEvent(m).data.getStats(d).mean;b[m].group2=this.getEvent(m).data.getStats(a).mean;for(var n=(b[m].group2-b[m].group1)/2,m=this.getEvent(m).data.getData(),p=0;p<m.length;p++){var q=m[p];utils.hasOwnProperty(q,"val_orig")&&(q.val=q.val_orig);var t=q.val;q.val_orig=t;utils.isNumerical(t)&&(q.val=t-n,g.push(q.val))}}e.maxVal=jStat.max(g);e.minVal=jStat.min(g);return e};this.yuliaExpressionRescaling=function(f,d){console.log("yuliaExpressionRescaling",f,d);var b=this.getEvent(f).data.selectIds(d),
a=this.getEventIdsByType();if(!utils.hasOwnProperty(a,"expression data"))return console.log("no expression"),null;for(var a=a["expression data"],e={},g={meanVals:e},k=[],m=0;m<a.length;m++){var n=a[m];e[n]=this.getEvent(n).data.getStats(b).mean;for(var p=this.getEvent(n).data.getData(),q=0;q<p.length;q++){var t=p[q];utils.hasOwnProperty(t,"val_orig")&&(t.val=t.val_orig);var w=t.val;t.val_orig=w;utils.isNumerical(w)&&(t.val=w-e[n],k.push(t.val))}}g.maxVal=jStat.max(k);g.minVal=jStat.min(k);return g};
this.eventwiseMedianRescaling=function(){console.log("eventwiseMedianRescaling");var f=this.getEventIdsByType();if(!utils.hasOwnProperty(f,"expression data"))return console.log("no expression"),null;for(var f=f["expression data"],d={},b={stats:d},a=[],e=0;e<f.length;e++){var g=f[e];this.getEvent(g);var k=this.getEvent(g).data.getStats();d[g]={};d[g]=k;for(var k=this.getEvent(g).data.getData(),m=0;m<k.length;m++){var n=k[m];utils.hasOwnProperty(n,"val_orig")&&(n.val=n.val_orig);var p=n.val;n.val_orig=
p;utils.isNumerical(p)&&(n.val=p-d[g].median,a.push(n.val))}}b.maxVal=jStat.max(a);b.minVal=jStat.min(a);return b};this.samplewiseMedianRescaling=function(){console.log("samplewiseMedianRescaling");var f=this.getEventIdsByType();if(!utils.hasOwnProperty(f,"expression data"))return console.log("no expression"),null;for(var f=f["expression data"],d={},b={stats:d},a=[],e=this.getAllSampleIds(),g=0;g<e.length;g++){var k=e[g];d[k]={};for(var m=this.getEventData([k]),n=[],p=0;p<f.length;p++){var q=f[p];
if(utils.hasOwnProperty(m,q)){if(q=m[q][0],q.id===k){utils.hasOwnProperty(q,"val_orig")&&(q.val=q.val_orig);var t=q.val;q.val_orig=t;utils.isNumerical(t)&&n.push(t)}}else console.log(q+" was not found for "+k)}n=jStat.median(n);d[k]["samplewise median"]=n;if(isNaN(n))console.log("sample median for "+k+" is NaN.");else for(p=0;p<f.length;p++)q=f[p],utils.hasOwnProperty(m,q)?(q=m[q][0],q.id===k&&(utils.hasOwnProperty(q,"val_orig")&&(q.val=q.val_orig),t=q.val,q.val_orig=t,utils.isNumerical(t)&&(q.val=
t-d[k]["samplewise median"],a.push(t)))):console.log(q+" was not found for "+k)}b.maxVal=jStat.max(a);b.minVal=jStat.min(a);return b};this.bivariateNormalization=function(){};this.fillInMissingSamples=function(f){for(var d=this.getAllSampleIds(),b=this.getEventIdsByType(),a=0,e=utils.getKeys(b).length;a<e;a++)for(var g=utils.getKeys(b)[a],k=0;k<b[g].length;k++){var m=b[g][k],n=this.getEvent(m).data.getAllSampleIds();if(0!=d.length-n.length){for(var n=utils.keepReplicates(d.concat(n),2,!0),p={},q=
0;q<n.length;q++)p[n[q]]=f;this.getEvent(m).data.setData(p)}}return this};this.fillInDatatypeLabelEvents=function(f){for(var d=this.getEventIdsByType(),d=utils.getKeys(d),b=0,a=d.length;b<a;b++){var e=d[b];"datatype label"!==e&&(this.addEvent({id:e+"(+)",name:e+"(+)",displayName:e+"(+)",description:null,datatype:"datatype label",allowedValues:null},{}),this.addEvent({id:e+"(-)",name:e+"(-)",displayName:e+"(-)",description:null,datatype:"datatype label",allowedValues:null},{}))}this.fillInMissingSamples(f)}};
g.OD_event=function(f){this.metadata=new g.OD_eventMetadata(f);this.data=new g.OD_eventDataCollection};g.OD_eventMetadata=function(f){this.id=f.id;this.name=f.name;this.displayName=f.displayName;this.description=f.description;this.datatype=f.datatype;this.allowedValues=f.allowedValues;this.minAllowedVal=f.minAllowedVal;this.maxAllowedVal=f.maxAllowedVal;this.weightedGeneVector=[];this.setScoreRange=function(d,b){this.minAllowedVal=d;this.maxAllowedVal=b};this.setWeightVector=function(d,b){this.weightedGeneVector=
d;this.scoredDatatype=b;return this};this.sortSignatureVector=function(d){var b=this.weightedGeneVector.slice(0);b.sort(function(a,b){return utils.compareAsNumeric(a.weight,b.weight)});for(var a=[],e=0;e<b.length;e++)a.push(b[e].gene);d||a.reverse();return a}};g.OD_eventDataCollection=function(){function f(d,b){this.id=d;this.val=b}this.dataCollection=[];this.getPercentNullData=function(){var d=this.getValueCounts(),b=0;null in d&&(b=this.getAllSampleIds().length,b=d[null]/b);return b};this.getValueCounts=
function(d){var b={};d=this.getData(d);for(var a=0;a<d.length;a++){var e=d[a].val;utils.hasOwnProperty(b,e)||(b[e]=0);b[e]+=1}return b};this.getValues=function(d){var b=this.getValueCounts(),b=utils.getKeys(b);null!=d&&1==d&&(b=utils.eliminateDuplicates(b));return b};this.setData=function(d,b){for(var a in d){var e=d[a];"NaN"!=e&&"null"!=e&&""!=e&&"N/A"!=e&&(null!=b&&1==b&&(e=parseFloat(e)),this.dataCollection.push(new f(a,e)))}return this};this.getData=function(d){var b=this.getAllSampleIds(!0);
null==d&&(d=utils.getKeys(b));for(var a=[],e=0;e<d.length;e++){var g=d[e];g in b?a.push(this.dataCollection[b[g]]):a.push(new f(g,null))}return a};this.getAllSampleIds=function(d){for(var b={},a=0;a<this.dataCollection.length;a++)b[this.dataCollection[a].id]=a;return d?b:utils.getKeys(b)};this.getNullSamples=function(d){var b=[];d=this.getData(d);for(var a=0;a<d.length;a++){var e=d[a];null==e.val&&b.push(e.id)}return b};this.sortSamples=function(d,b){var a=this.getData(d),e=compareSamplesAsStrings;
b=null==b?"categoric":b.toLowerCase();"numeric"==b||"expression"==b?e=compareSamplesAsNumeric:"date"==b&&(e=compareSamplesAsDate);a.sort(e);for(var e=[],f=0;f<a.length;f++)e.push(a[f].id);return e};this.selectIds=function(d,b){for(var a=[],e=null==b?this.getData():this.getData(b),f=0;f<e.length;f++){var g=e[f];g.val==d&&a.push(g.id)}return a};this.getStats=function(d,b){"undefined"===typeof b&&(b=3);var a={min:0,max:0,mean:0,median:0,sd:0,meddev:0,meandev:0,percentNullData:0};a.percentNullData=this.getPercentNullData();
a.percentNullData=a.percentNullData.toPrecision(b);if(1==a.percentNullData)return a;var e=this.getAllSampleIds(!0);null==d&&(d=utils.getKeys(e));for(var f=[],g=0;g<d.length;g++){var m=d[g];if(m in e){var m=this.dataCollection[e[m]],n=null,n=utils.hasOwnProperty(m,"val_orig")?m.val_orig:m.val;utils.isNumerical(n)&&f.push(n)}}a.mean=jStat.mean(f).toPrecision(b);a.sd=jStat.stdev(f).toPrecision(b);a.median=jStat.median(f).toPrecision(b);a.meddev=jStat.meddev(f).toPrecision(b);a.meandev=jStat.meandev(f).toPrecision(b);
a.min=jStat.min(f).toPrecision(b);a.max=jStat.max(f).toPrecision(b);return a}};g.sortingSteps=function(f){this.steps=[];null!=f&&(this.steps=f);this.getSteps=function(){return this.steps};this.getIndex=function(d){for(var b=0;b<this.steps.length;b++)if(this.steps[b].name==d)return b;return-1};this.addStep=function(d,b){var a=this.getIndex(d);0<=a?(a=this.steps.splice(a,1)[0],b||(a.reverse=!a.reverse),this.steps.push(a)):this.steps.push({name:d,reverse:!1})};this.removeStep=function(d){d=this.getIndex(d);
0<=d&&this.steps.splice(d,1)};this.clearSteps=function(){this.steps.splice(0,this.steps.length)}};g.sampleSelectionCriteria=function(){this.criteria=[];this.getCriteria=function(){return this.criteria};this.addCriteria=function(f,d){var b={eventId:f,value:d},a;for(a in this.criteria)if(JSON.stringify(this.criteria[a])==JSON.stringify(b))return;this.criteria.push(b)};this.removeCriteria=function(f,d){for(var b=0;b<this.criteria.length;b++)if(this.criteria[b].eventId==f&&this.criteria[b].value==d){this.criteria.splice(b,
1);break}};this.clearCriteria=function(){this.criteria.splice(0,this.criteria.length)}}})(eventData);var medbookDataLoader=medbookDataLoader||{};
(function(g){g.transposeClinicalData=function(f,d){for(var b={},a=0;a<f.length;a++){var e=f[a],g=e[d],k;for(k in e)k in b||(b[k]={}),b[k][g]=e[k]}return b};g.getClinicalData=function(f,d){for(var b=utils.getResponse(f).split("\n"),a=[],e=[],l=[],k=0;k<b.length;k++){var m=b[k];utils.beginsWith(m,"#")?e.push(m):utils.beginsWith(m,"STRING")?l=m.split("\t"):a.push(m)}b=d3.tsv.parse(a.join("\n"));a=this.transposeClinicalData(b,"SAMPLE_ID");delete a.SAMPLE_ID;e=utils.getKeys(a);for(k=0;k<e.length;k++){var m=
e[k],n=a[m],p=l[k+1],q="categoric";"number"==p.toLowerCase()?q="numeric":"date"==p.toLowerCase()&&(q="date");g.loadEventBySampleData(d,m,"","clinical data",q,n)}return b};g.getMutationData=function(f,d){for(var b=utils.getResponse(f),a=d3.tsv.parse(b),b={},e=0;e<a.length;e++){var g=a[e],k=g.Hugo_Symbol,g=g.Tumor_Sample_Barcode,g=g.replace(/_/g,"-"),g=g.replace(/[A-Z]$/,"");utils.hasOwnProperty(b,k)||(b[k]={},b[k].metadata={id:k+"_mut",name:null,displayName:null,description:null,datatype:"mutation data",
allowedValues:"categoric"},b[k].data={});b[k].data[g]=!0}a=utils.getKeys(b);for(e=0;e<a.length;e++)k=b[a[e]],d.addEvent(k.metadata,k.data);return b};g.getExpressionData=function(f,d){g.getGeneBySampleData(f,d,"_mRNA","expression data","numeric")};g.getViperData=function(f,d){g.getGeneBySampleData(f,d,"_viper","viper data","numeric")};g.getGeneBySampleData=function(f,d,b,a,e){f=utils.getResponse(f);f=d3.tsv.parse(f);for(var l in f){var k=f[l],m=k[""];delete k[""];g.loadEventBySampleData(d,m,b,a,e,
k)}};g.loadEventBySampleData=function(f,d,b,a,e,g){return f.addEvent({geneSuffix:b,id:d+b,name:a+" for "+d,displayName:d,description:null,datatype:a,allowedValues:e},g)};g.mongoClinicalData=function(f,d){for(var b=0;b<f.length;b++){var a=f[b],e=null;if(utils.hasOwnProperty(a,"sample"))e=a.sample;else if(hasOwnProperty(a,"Sample"))e=a.Sample;else if(hasOwnProperty(a,"Patient ID"))e=a["Patient ID"];else if(hasOwnProperty(a,"Patient ID "))e=a["Patient ID "];else{console.log("no sample ID found in clinical doc: "+
prettyJson(a));continue}e=e.trim();if("Patient ID"!==e&&"Patient ID "!==e)for(var l=utils.getKeys(a),k=0;k<l.length;k++){var m=l[k];if(!utils.isObjInArray(["_id","sample","Sample"],m)){var n=d.getEvent(m);null==n&&(n=g.loadEventBySampleData(d,m,"","clinical data","categoric",[]));var p={};p[e]=a[m];n.data.setData(p)}}}return n};g.mongoExpressionData=function(f,d){for(var b=0;b<f.length;b++){var a=f[b],e=null;if(utils.hasOwnProperty(a,"gene"))e=a.gene;else if(utils.hasOwnProperty(a,"id"))e=a.id;else{console.log("no gene identifier found in expression doc: "+
utils.prettyJson(a));continue}var e=e.trim(),l=e+"_mRNA";utils.getKeys(a);var k=a.samples,a={},m;for(m in k)a[m]=k[m].rsem_quan_log2;l=d.getEvent(l);null==l?g.loadEventBySampleData(d,e,"_mRNA","expression data","numeric",a):l.data.setData(a)}};g.mongoExpressionData_old=function(f,d){for(var b=0;b<f.length;b++){var a=f[b],e=null;if(utils.hasOwnProperty(a,"gene"))e=a.gene;else if(utils.hasOwnProperty(a,"id"))e=a.id;else{console.log("no gene identifier found in expression doc: "+utils.prettyJson(a));
continue}for(var e=e.trim(),l=e+"_mRNA",k=utils.getKeys(a),m=0;m<k.length;m++){var n=k[m];if(!utils.isObjInArray(["_id","gene","id"],n)){var p=d.getEvent(l);null==p&&(p=g.loadEventBySampleData(d,e,"_mRNA","expression data","numeric",[]));var q={};q[n]=parseFloat(a[n]);p.data.setData(q)}}}return p};g.getSignature=function(f,d){var b=utils.getResponse(f),b=d3.tsv.parse(b),a=f.split("/").pop(),e=d.getEvent(a);null==e&&(d.addEvent({id:a,name:null,displayName:null,description:null,datatype:"expression signature",
allowedValues:"numeric",weightedGeneVector:b},[]),e=d.getEvent(a));return e};g.loadSignatureObj=function(f,d){for(var b={},a=0;a<f.length;a++){var e=f[a],l=e.id,k=e.name,e=e.val;utils.hasOwnProperty(b,k)||(b[k]={});b[k][l]=e}l=utils.getKeys(b);for(a=0;a<l.length;a++){var k=l[a],e=b[k],m;m=k.split("_v");m.pop();m=m.join("_v");m=utils.endsWith(m,"_kinase_viper")?"kinase target activity":utils.endsWith(m,"_tf_viper")||utils.beginsWith(m,"tf_viper_")?"tf target activity":"expression signature";var n=
d.getEvent(k);null==n&&(n=g.loadEventBySampleData(d,k,"",m,"numeric",{}),n.metadata.setWeightVector([],"expression data"));n.data.setData(e)}};g.loadSignatureWeightsObj=function(f,d){var b=f.name+"_v"+f.version,a;a=utils.endsWith(f.name,"_kinase_viper")?"kinase target activity":utils.endsWith(f.name,"_tf_viper")||utils.beginsWith(f.name,"tf_viper_")?"tf target activity":"expression signature";for(var e=d.getEvent(b),l=[],k=f.signature,m=utils.getKeys(k),n=0;n<m.length;n++){var p=m[n];l.push({gene:p,
weight:k[p].weight})}null==e&&(e=g.loadEventBySampleData(d,b,"",a,"numeric",[]));e.metadata.setWeightVector(l,"expression data");return e};g.loadBmegSignatureWeightsAsSamples=function(f,d){var b=utils.getKeys(f.query.weights),a=f.features,e=[],l=[],k;for(k in a)e.push({gene:k,weight:a[k]}),l.push(k);var l=utils.eliminateDuplicates(l),m=f.signatures,a={},n={},p;for(p in m){k=m[p];n[p]=k.score;var q=k.weights;k=b.slice(0);k=k.concat(utils.getKeys(q));k=utils.eliminateDuplicates(k);for(var t=0,w=k.length;t<
w;t++){var v=k[t];if(utils.isObjInArray(b,v)||utils.isObjInArray(l,v)){var z=q[v];"undefined"!==typeof z&&(utils.hasOwnProperty(a,v)||(a[v]={}),a[v][p]=z)}}}console.log("num genes:"+utils.getKeys(a).length);g.loadEventBySampleData(d,"query_score","","signature query score","numeric",n).metadata.setWeightVector(e,"signature weight");k=utils.getKeys(a);for(b=0;b<k.length;b++)v=k[b],e=v+"_weight",l=d.getEvent(e),null==l?(l=g.loadEventBySampleData(d,v,"_weight","signature weight","numeric",a[v]),l.metadata.setScoreRange(-1,
1)):console.log("loadBmegSignatureWeightsAsSamples:","existing event for: "+e)};g.loadPivotScores=function(f,d){for(var b=[],a=0;a<f.length;a++){var e=f[a],g=e.name_1,k=function(a,b,d){var e;"signature"===b?e=a+"_v"+d:"expression"===b&&(e=a);return e},g=k(g,e.datatype_1,e.version_1),m=e.name_2,m=k(m,e.datatype_2,e.version_2);b.push({eventId1:g,eventId2:m,score:e.score})}d.setPivotScores_array(null,b)}})(medbookDataLoader);u=utils;observation_deck="undefined"===typeof observation_deck?{}:observation_deck;
(function(g){g.buildObservationDeck=function(d,g){g=f(g);g.containerDivId=d.id;Z(d,g);b("hugoSearch","HUGO symbol",g.geneQueryUrl,function(a){var b=l();utils.hasOwnProperty(b,"hugoSearch")||(b.hugoSearch=[]);b.hugoSearch.push(a);b.hugoSearch=utils.eliminateDuplicates(b.hugoSearch);e(b);console.log("settings",b);b=m("geneList");console.log("sessionGeneList",b);console.log("button clicked in hugoSearch",a)});b("sigSearch","signature name",g.sigQueryUrl,function(a){var b=l();utils.hasOwnProperty(b,"sigSearch")||
(b.sigSearch=[]);b.sigSearch.push(a);b.sigSearch=utils.eliminateDuplicates(b.sigSearch);e(b);console.log("button clicked in sigSearch",a)});a(g);return g};var f=function(a){var b=l();a.querySettings=b;b=null;"pivot_event"in a&&null!=a.pivot_event&&(a.querySettings.pivot_event=a.pivot_event);"eventAlbum"in a?b=a.eventAlbum:(b=new eventData.OD_eventAlbum,a.eventAlbum=b);var d=medbookDataLoader;if("pivotScores"in a){var e=a.pivotScores;"object"in e&&d.loadPivotScores(e.object,b)}delete a.pivotScores;
"dataUrl"in a&&(e=a.dataUrl,"clinicalUrl"in e&&d.getClinicalData(e.clinicalUrl,b),"expressionUrl"in e&&d.getExpressionData(e.expressionUrl,b),"mutationUrl"in e&&d.getMutationData(e.mutationUrl,b));"mongoData"in a&&(e=a.mongoData,"clinical"in e&&d.mongoClinicalData(e.clinical,b),"expression"in e&&d.mongoExpressionData(e.expression,b));delete a.mongoData;if("signature"in a&&(e=a.signature,"expression"in e)){var f=e.expression;if("file"in f)for(var g=f.file,e=0;e<g.length;e++){var k=g[e];console.log(k);
d.getSignature(k,b)}if("object"in f)for(f=f.object,e=0;e<f.length;e++)g=f[e],d.loadSignatureObj(g,b)}delete a.signature;if("signature_index"in a&&(e=a.signature_index,"expression"in e&&(e=e.expression,"object"in e)))for(f=e.object,e=0;e<f.length;e++)g=f[e],d.loadSignatureWeightsObj(g,b);delete a.signature_index;"bmegSigServiceData"in a&&(console.log("bmegSigServiceData in config"),d.loadBmegSignatureWeightsAsSamples(a.bmegSigServiceData,b));delete a.bmegSigServiceData;"displayedSamples"in a||(a.displayedSamples=
[]);var b=a.eventAlbum.getEventIdsByType(),m;for(m in b);if("deleteEvents"in a)for(m=a.deleteEvents,e=0;e<m.length;e++)a.eventAlbum.deleteEvent(m[e]);return a};g.getCookieEvents=function(){var a=[],b=l();if("undefined"===typeof b||null==b||0==utils.getKeys(b).length)return[];utils.hasOwnProperty(b,"pivot_sort")&&a.push(b.pivot_sort.pivot_event);if(utils.hasOwnProperty(b,"colSort"))for(var d=b.colSort.steps,e=0;e<d.length;e++)a.push(d[e].name);utils.hasOwnProperty(b,"required events")&&(a=a.concat(b["required events"]));
d=[];for(e=0;e<a.length;e++){var f=a[e];utils.endsWith(f,"_mRNA")&&d.push(f.replace("_mRNA",""))}utils.hasOwnProperty(b,"hugoSearch")&&(d=d.concat(b.hugoSearch));return utils.eliminateDuplicates(d)};var d=function(a){var b=a.placeholderText,d=utils.createDivElement(a.title);d.style.display="none";var e=document.createElement("input");d.appendChild(e);utils.setElemAttributes(e,{type:"text",placeholder:b});b=document.createElement("button");d.appendChild(b);utils.setElemAttributes(b,{type:"button",
style:"float: right"});b.innerHTML="select";b.onclick=function(){a.selectionCallback(e.value);$(d).dialog("close")};for(b=0;9>b;b++)d.appendChild(document.createElement("br"));$(e).typeahead({hint:!0,highlight:!0,minLength:2},{name:"dataset",source:a.bloodhoundObj,limit:99});return d},b=function(a,b,e,f){var g=document.getElementsByTagName("body")[0];a=d({title:a,placeholderText:b,bloodhoundObj:new Bloodhound({datumTokenizer:Bloodhound.tokenizers.whitespace,queryTokenizer:Bloodhound.tokenizers.whitespace,
remote:{url:e+"%VALUE",wildcard:"%VALUE",transform:function(a){console.log("response",a);a=a.items;for(var b=[],d=0,e=a.length;d<e;d++)b.push(a[d].id);return b=utils.eliminateDuplicates(b)}}}),selectionCallback:f});g.appendChild(a)},a=function(a){for(var b=[".typeLabel",".colLabel",".rowLabel",".mrna_exp",".categoric"],d=0;d<b.length;d++)$.contextMenu("destroy",b[d]);w(a);t(a);v(a);I(a);z(a);J(a)},e=function(a){utils.setCookie("od_config",JSON.stringify(a))},l=function(){var a=utils.getCookie("od_config");
return utils.parseJson(a)||{}},k=function(a,b){if("undefined"!==typeof Session)return a&&Session.set(a,b),!0;console.log("no session object for setting");return!1},m=function(a){var b=null;"undefined"!==typeof Session?a&&(b=Session.get(a)):console.log("no session object for getting");return b},n=function(a,b,d){var e=m("subscriptionPaging");e||(e={});utils.hasOwnProperty(e,a)||(e[a]={head:0,tail:0});if(!b||!d)return e[a];var f;"down"===d?f=--e[a][b]:"up"===d?f=++e[a][b]:"0"===d&&(f=e[a][b]=0);0>f&&
(e[a][b]=0);k("subscriptionPaging",e)},p=function(a,b,d,f){d=d||"colSort";f=f||!1;var g=b.querySettings;b=d in g?new eventData.sortingSteps(g[d].steps):new eventData.sortingSteps;b.addStep(a,f);g[d]=b;e(g)},q=function(a){return{name:"reset",icon:null,disabled:!1,callback:function(b,d){var e="dataUrl eventAlbum mongoData containerDivId signature rowTitleCallback columnTitleCallback".split(" ");utils.deleteCookie("od_config");for(var f=utils.getKeys(a),l=0;l<f.length;l++){var m=f[l];utils.isObjInArray(e,
m)||delete a[m]}console.log("remaining config",a);e=["pivotSettings","subscriptionPaging","geneList"];if("undefined"!==typeof Session)for(f=0,l=e.length;f<l;f++)delete Session.keys[e[f]];else console.log("no session object to reset");k("pivotSettings","");e=document.getElementById(a.containerDivId);g.buildObservationDeck(e,a)}}},t=function(a){var b=a.columnTitleCallback;$.contextMenu({selector:".colLabel",trigger:"left",build:function(d,e){var f=d[0].getAttribute("sample");return{items:{title:{name:f,
icon:null,disabled:null==b,callback:function(d,e){null==b?console.log("default titleCallback for column",f):b(f,a)}},reset:q(a)}}}})},w=function(a){var b=a.datatypeTitleCallback;$.contextMenu({selector:".typeLabel",trigger:"left",callback:function(a,b){console.log("elem",this[0])},build:function(d,f){var k=d[0].getAttribute("eventId");utils.endsWith(k,"(+)");var l=k.split("(");l.pop();var m=l.join("(");return{items:{title:{name:function(){return m},icon:null,disabled:!1,callback:function(d,e){null==
b?(console.log("datatype",m),console.log("default titleCallback for datatype",m)):b(k,a)}},sep1:"---------",toggle_datatype_visibility:{name:function(){return"toggle visibility"},icon:null,disabled:null,callback:function(b,d){"hiddenDatatypes"in a.querySettings||(a.querySettings.hiddenDatatypes=[]);var f=a.querySettings.hiddenDatatypes;utils.isObjInArray(f,m)?utils.removeA(f,m):f.push(m);e(a.querySettings);f=document.getElementById(a.containerDivId);g.buildObservationDeck(f,a)}},test_fold:{name:"dev_features",
disabled:function(){return"true"!==utils.getQueryStringParameterByName("dev_mode").toLowerCase()},items:{hugoSearch:{name:"HUGO search",icon:null,disabled:!1,callback:function(a,b){var d=document.getElementById("hugoSearch");d.style.display="block";$(d).dialog({title:"HUGO search",buttons:{close:function(){$(this).dialog("close")}}})}},sigSearch:{name:"signature search",icon:null,disabled:!1,callback:function(a,b){var d=document.getElementById("sigSearch");d.style.display="block";$(d).dialog({title:"signature search",
buttons:{close:function(){$(this).dialog("close")}}})}}}},reset:q(a)}}}})},v=function(a){var b=a.rowTitleCallback;$.contextMenu({selector:".rowLabel",trigger:"left",callback:function(a,b){console.log("elem",this[0])},build:function(d,f){var l=d[0].getAttribute("eventId"),m=a.eventAlbum.getEvent(l),n=m.metadata.datatype,t=["expression signature","kinase target activity","tf target activity"];return{items:{title:{name:m.metadata.displayName,icon:null,disabled:function(){var a=!0;null!=b&&utils.isObjInArray(["expression data",
"clinical data","expression signature","kinase target activity","tf target activity"],n)&&(a=!1);return a},callback:function(d,e){null==b?console.log("default titleCallback for row",l):b(l,a)}},sep1:"---------",set_pivot:{name:function(){return"set as pivot"},icon:null,disabled:function(a,b){utils.isObjInArray(t,n);return!1},callback:function(b,d){if("undefined"!==typeof Session){var f=l,q="";utils.isObjInArray(["expression signature","kinase target activity","tf target activity"],n)?(f=f.split("_v"),
q=f.pop(),f=f.join("_v"),n="signature"):"expression data"===n?(f=m.metadata.displayName,q=1,n="expression"):"clinical data"===n&&(f=l,q=1,n="clinical");q={name:f,datatype:n,version:q};f=a.querySettings;f.pivot_event={id:l,datatype:n};var t=[];"pivot_sort_list"in f&&(t=f.pivot_sort_list);t.push("expression data");f.pivot_sort_list=utils.eliminateDuplicates(t);e(f);p(l,a,"colSort",!0);console.log("writing pivotSettings to Session",q);k("pivotSettings",q)}else console.log("no Session object. Writing pivotSettings to querySettings."),
f=a.querySettings,f.pivot_event={id:l,datatype:n},e(f),p(l,a,"colSort",!0),q=document.getElementById(a.containerDivId),g.buildObservationDeck(q,a)}},sort_fold:{name:"sort...",items:{sort:{name:"samples by this event",icon:null,disabled:!1,callback:function(b,d){p(l,a,"colSort",!1);var e=document.getElementById(a.containerDivId);g.buildObservationDeck(e,a)}}}},hide_fold:{name:"hide...",items:{hide_null_samples:{name:"null samples in this event",icon:null,disabled:!1,callback:function(b,d){var f=a.querySettings;
f["required events"]=[l];e(f);f=document.getElementById(a.containerDivId);g.buildObservationDeck(f,a)}},hide_event:{name:"this event",icon:null,disabled:!1,callback:function(b,d){var f=a.querySettings,k=f.hiddenEvents||[];k.push(l);f.hiddenEvents=utils.eliminateDuplicates(k);e(f);f=document.getElementById(a.containerDivId);g.buildObservationDeck(f,a)}}}},sep2:"---------",reset:q(a)}}}})},z=function(a){var b=a.columnTitleCallback;$.contextMenu({selector:".mrna_exp",trigger:"left",callback:function(a,
b){},build:function(d,f){var k=d[0],l=k.getAttribute("eventId"),m=k.getAttribute("sampleId");return{items:{title:{name:l+" for "+m,icon:null,disabled:!0},sep1:"---------",sample_link_out:{name:"go to details for "+m,icon:null,disabled:!1,callback:function(d,e){b(m,a)}},rescaling_fold:{name:"normalize coloring...",items:{"samplewise median rescaling":{name:"over each column",icon:null,disabled:!1,callback:function(b,d){var f=a.querySettings;f["expression rescaling"]={method:"samplewiseMedianRescaling"};
e(f);f=document.getElementById(a.containerDivId);g.buildObservationDeck(f,a)}},"eventwise median rescaling":{name:"over each row",icon:null,disabled:!1,callback:function(b,d){var f=a.querySettings;f["expression rescaling"]={method:"eventwiseMedianRescaling"};e(f);f=document.getElementById(a.containerDivId);g.buildObservationDeck(f,a)}}}},sep2:"---------",reset:q(a)}}}})},I=function(a){var b=a.columnTitleCallback;$.contextMenu({selector:".categoric",trigger:"left",callback:function(a,b){},build:function(d,
f){var k=d[0],l=k.getAttribute("eventId"),m=k.getAttribute("sampleId");return{items:{title:{name:l+" for "+m,icon:null,disabled:!0},sep1:"---------",sample_link_out:{name:"go to details for "+m,icon:null,disabled:!1,callback:function(d,e){b(m,a)}},"yulia expression rescaling":{name:"rescale mRNA values using this category",icon:null,disabled:!1,callback:function(b,d){var f=this[0],k=f.getAttribute("eventId");f.getAttribute("sampleId");f=f.getAttribute("val");console.log("key:",b,"eventId:",k,"val:",
f);console.log("href",window.location.href);console.log("host",window.location.host);console.log("pathname",window.location.pathname);console.log("search",window.location.search);var l=a.querySettings;l["expression rescaling"]={method:"yulia_rescaling",eventId:k,val:f};e(l);k=document.getElementById(a.containerDivId);g.buildObservationDeck(k,a)}},sep2:"---------",reset:q(a)}}}})},J=function(a){var b=a.columnTitleCallback;$.contextMenu({selector:".signature",trigger:"left",callback:function(a,b){},
build:function(d,e){var f=d[0],g=f.getAttribute("eventId"),k=f.getAttribute("sampleId");return{items:{title:{name:g+" for "+k,icon:null,disabled:!0},sep1:"---------",sample_link_out:{name:"go to details for "+k,icon:null,disabled:!1,callback:function(d,e){b(k,a)}},sep2s:"---------",reset:q(a)}}}})},Z=function(a,b){console.log("*** BEGIN DRAWMATRIX ***");var d=utils.removeChildElems(a),e=b.eventAlbum;e.fillInMissingSamples(null);e.fillInDatatypeLabelEvents("black");var f=e.getEventIdsByType(),g=d3.scale.category10(),
k=[],l;for(l in f)g(l),k=k.concat(f[l]);var m=b.querySettings,p=function(a,b){var d=a.getEventIdsByType(),e=null;utils.hasOwnProperty(d,"expression data")&&utils.hasOwnProperty(b,"expression rescaling")?(d=b["expression rescaling"],"yulia_rescaling"===d.method?e=a.yuliaExpressionRescaling(d.eventId,d.val):"eventwiseMedianRescaling"===d.method?e=a.eventwiseMedianRescaling():"zScoreExpressionRescaling"===d.method?e=a.zScoreExpressionRescaling():"samplewiseMedianRescaling"===d.method&&(e=a.samplewiseMedianRescaling())):
utils.hasOwnProperty(d,"expression data")?e=a.eventwiseMedianRescaling():console.log("no expression data rescaling");return e}(e,m),q=function(a,b){var d=utils.centeredRgbaColorMapper(!1);null!=a&&(d=utils.centeredRgbaColorMapper(!1,0,a.minVal,a.maxVal));for(var e={},f=0;f<k.length;f++){var g=k[f],l=b.getEvent(g).metadata.allowedValues;if("categoric"==l)e[g]=d3.scale.category10();else if("numeric"==l){var m=b.getEvent(g),l=m.metadata.minAllowedVal,m=m.metadata.maxAllowedVal;if("undefined"!=typeof l&&
"undefined"!=typeof m)e[g]=utils.centeredRgbaColorMapper(!1,0,l,m);else{for(var m=b.getEvent(g).data.getValues(),l=[],n=0;n<m.length;n++){var p=m[n];utils.isNumerical(p)&&l.push(p)}m=Math.min.apply(null,l);l=Math.max.apply(null,l);e[g]=utils.centeredRgbaColorMapper(!1,0,m,l)}}else e[g]="expression"==l?d:d3.scale.category10()}return e}(p,e),f=function(a){var b=null;if("colSort"in a)for(var b=new eventData.sortingSteps(a.colSort.steps),d=b.getSteps().length-1;0<=d;d--){var f=b.steps[d].name;e.getEvent(f)||
(console.log(f,"not found, skip sorting by that event"),b.removeStep(f))}utils.hasOwnProperty(a,"pivot_sort")&&(a=a.pivot_sort.pivot_event,null==b&&(b=new eventData.sortingSteps),e.getEvent(a)&&b.addStep(a,!0));return b}(m);console.log("colSortSteps",f);var t=function(a){var b=null;if("rowSort"in a)for(b=new eventData.sortingSteps(a.rowSort.steps),a=b.getSteps().length-1;0<=a;a--){var d=b.steps[a].name;e.getEvent(d)||(console.log(d,"not found, skip sorting by that event"),b.removeStep(d))}return b}(m);
l=function(a,d,e){var f=null,f=d.multisortSamples(e);e=[];if("required events"in a){a=a["required events"][0];console.log("requiredEventId",a);try{var g=d.getEvent(a).data.getNullSamples();e=e.concat(g)}catch(k){console.log("ERROR while getting samples to hide in eventID:",a,"error.message ->",k.message)}finally{console.log("samplesToHide",e)}}e=utils.eliminateDuplicates(e);d=[];for(g=0;g<f.length;g++)a=f[g],utils.isObjInArray(b.displayedSamples,a)?d.push(a):utils.isObjInArray(e,a)||0==b.displayedSamples.length&&
d.push(a);return d}(m,e,f);var v={},w;for(w in l){var z=l[w];v[z]=w}var f=function(a,b,d,e){d=b.multisortEvents(e,d);if(utils.hasOwnProperty(a,"pivot_sort_list")){console.log("querySettings has a pivot_sort_list of datatypes",a.pivot_sort_list);d=[];e=[];var f=a.pivot_event.id;b.getEvent(f);var f=b.getGroupedPivotSorts(f,!0),g;for(g in f){var k;"datatype label"===g?k=[]:(k=f[g],k.unshift(g+"(+)"),k.push(g+"(-)"));e=e.concat(k)}d=e.concat(d);d=utils.eliminateDuplicates(d)}else console.log("querySettings has NO pivot_sort_list of datatypes");
f=a.hiddenDatatypes||[];k=a.hiddenEvents||[];var l=[],m=b.getAllEventIds();for(e=0;e<d.length;e++){var n=d[e];utils.isObjInArray(m,n)&&(g=b.getEvent(n).metadata.datatype,utils.isObjInArray(f,g)||utils.isObjInArray(k,n)||l.push(n))}d=l;g=null;null!=a.pivot_event&&(g=a.pivot_event.id,console.log("moving pivot event to top:",g),d.unshift(g),d=utils.eliminateDuplicates(d));a=[];e=0;for(g=d.length;e<g;e++)f=d[e],b.getEvent(f)?a.push(f):console.log("eventObj not found for",f);return a}(m,e,f,t),I=null;
null!=m.pivot_event&&(I=m.pivot_event.id,console.log("moving pivot event to top:",I),f.unshift(I),f=utils.eliminateDuplicates(f));var J={};for(w in f)z=f[w],J[z]=w;utils.lengthOfLongestString(l);w=utils.lengthOfLongestString(f);console.log("longestRowName",w);z={top:10,right:0,bottom:0,left:1<w?8*(w+1):15};w=document.documentElement.clientWidth;var W=Math.floor((w-z.left-z.right)/(l.length>f.length?l.length:f.length)),W=13<W?W:13;console.log("gridSize",W,"margin",z);m=z.top+z.bottom+W*f.length;d=
d3.select(d).append("svg").attr({width:w+0,height:m,viewBox:"0 0 "+w+" "+m,perserveAspectRatio:"xMinYMin meet"}).append("g").attr({transform:"translate("+z.left+","+z.top+")"});utils.createSvgRectElement(0,0,0,0,w,m,{fill:"white","class":"primer"});d.append("rect").attr({x:0,y:0,rx:0,ry:0,width:W*l.length,height:W*f.length,fill:"white","class":"primer"});w=-6;m=W/1.5;d.selectAll(".rowLabel").data(f).enter().append("text").text(function(a){a=e.getEvent(a);var b=a.metadata.displayName;"datatype label"===
a.metadata.datatype&&(b=b.toUpperCase());return b}).attr({x:0,y:function(a,b){return b*W},transform:"translate("+w+", "+m+")","class":function(a,b){var d;"datatype label"===e.getEvent(a).metadata.datatype?d="typeLabel mono axis unselectable":(d="rowLabel mono axis unselectable",a===I&&(d+=" pivotEvent"));return d},eventId:function(a,b){return a},datatype:function(a,b){return e.getEvent(a).metadata.datatype}}).style("text-anchor","end").style("fill",function(a){a=e.getEvent(a).metadata.datatype;return"datatype label"===
a?"black":g(a)}).append("title").text(function(a,b){var d=e.getEvent(a),f="event: "+a+"\ndatatype: "+d.metadata.datatype;"numeric"===d.metadata.allowedValues&&null!=p&&utils.hasOwnProperty(p,"stats")&&"undefined"!==typeof p.stats[a]&&(f=f+"\nraw data stats: "+utils.prettyJson(p.stats[a]));return f});w=Math.floor(W/5);m=-1*Math.floor(W/3);d.selectAll(".colLabel").data(l).enter().append("text").text(function(a){return a}).attr({y:function(a,b){return(b+1)*W},x:0,transform:"rotate(-90) translate("+w+
", "+m+")","class":function(a,b){return"colLabel mono axis unselectable hidden"},sample:function(a,b){return a}}).style("text-anchor","start").append("title").text(function(a){return"sample: "+a});l=e.getAllDataAsList();m=[];for(w=0;w<l.length;w++)z=l[w],utils.isObjInArray(f,z.eventId)&&m.push(z);d.selectAll(".cell").data(m).enter().append(function(a,b){var d=function(a,b,d,e){var f=[];f.push(d/2+a+","+(0+b));f.push(d+a+","+(e+b));f.push(0+a+","+(e+b));return f},f=function(a,b,d,e){var f=[];f.push(d/
2+a+","+(e+b));f.push(d+a+","+(0+b));f.push(0+a+","+(0+b));return f},k=document.createElementNS(utils.svgNamespaceUri,"g");k.setAttributeNS(null,"class","cell");var l=a.id;if(!utils.hasOwnProperty(v,l))return k;var m=v[a.id]*W,p=J[a.eventId]*W,t=4,w=4,x=W,z=W,B={"class":"bordered"},I=a.eventId;if(null==I||null==a.val)B.fill="lightgrey",k.appendChild(utils.createSvgRectElement(m,p,t,w,x,z,B));if(null==I||null==a.val)return k;var B=a.val,m=v[a.id]*W,p=J[a.eventId]*W,w=t=4,z=x=W,B={stroke:"#E6E6E6",
"stroke-width":"2px",fill:(0,q[a.eventId])(B)},L;if("categoric"===e.getEvent(a.eventId).metadata.allowedValues)B["class"]="categoric",B.eventId=a.eventId,B.sampleId=a.id,B.val=a.val,L=utils.createSvgRectElement(m,p,t,w,x,z,B);else if("expression data"===e.getEvent(a.eventId).metadata.datatype)B["class"]="mrna_exp",B.eventId=a.eventId,B.sampleId=a.id,B.val=a.val,L=utils.createSvgRectElement(m,p,t,w,x,z,B);else if(utils.isObjInArray(["expression signature","kinase target activity","tf target activity"],
e.getEvent(a.eventId).metadata.datatype))B["class"]="signature",B.eventId=a.eventId,B.sampleId=a.id,B.val=a.val,L=utils.createSvgRectElement(m,p,t,w,x,z,B);else if("datatype label"===e.getEvent(a.eventId).metadata.datatype){L=a.eventId;var V,Z;utils.endsWith(L,"(+)")?(V=L.replace("(+)",""),Z="head"):(V=L.replace("(-)",""),Z="tail");B["class"]="datatype";B.eventId=V;B.fill=g(V);L=v[l];0==L?(B["stroke-width"]="0px",k.onclick=function(){n(V,Z,"head"===Z?"down":"up")},B.points=d(m,p,x,z).join(" "),L=
utils.createSVGPolygonElement(B)):1==L?(B["stroke-width"]="0px",k.onclick=function(){n(V,Z,"head"===Z?"up":"down")},B.points=f(m,p,x,z).join(" "),L=utils.createSVGPolygonElement(B)):2==L?(L=document.createElementNS(utils.svgNamespaceUri,"g"),B["stroke-width"]="0px",k.onclick=function(){n(V,Z,"0")},"head"===Z?(l=utils.createSvgRectElement(m,p,0,0,x,2,B),B.points=d(m,p,x,z).join(" ")):(l=utils.createSvgRectElement(m,p+z-3,0,0,x,2,B),B.points=f(m,p+1,x,z-2).join(" ")),d=utils.createSVGPolygonElement(B),
L.appendChild(l),L.appendChild(d)):(B["stroke-width"]="0px",B.fill=g(V),L=utils.createSvgRectElement(m,1+p+z/2,0,0,x,2,B))}k.appendChild(L);return k}).append("title").text(function(a){var b=a.eventId,d=e.getEvent(b).metadata.datatype,f=a.id;if("datatype label"===d){a=v[f];utils.endsWith(b,"(+)")?(d=b.replace("(+)",""),b="head"):(d=b.replace("(-)",""),b="tail");var f="head"===b?"":"ANTI-",g="";0==a?g="show "+d+" events "+("head"===b?"MORE":"LESS")+" "+f+"CORRELATED to pivot event":1==a?g="show "+d+
" events "+("head"===b?"LESS":"MORE")+" "+f+"CORRELATED to pivot event":2==a&&(g="show TOP "+d+" events "+f+"CORRELATED to pivot event")}else g="event: "+a.eventId+"\nsample: "+a.id+"\nvalue: "+a.val;return g});console.log("*** END DRAWMATRIX ***");return b}})(observation_deck);
