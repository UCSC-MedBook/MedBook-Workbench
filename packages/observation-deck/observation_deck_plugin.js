(function(h,g){function e(a){a=a.split(/\s+/);for(var d=[],f=0,e;e=a[f];f++)e=e[0].toUpperCase(),d.push(e);return d}function d(a){return a.id&&h('label[for="'+a.id+'"]').val()||a.name}function a(e,f,l){l||(l=0);f.each(function(){var f=h(this),n=this,m=this.nodeName.toLowerCase(),q,p;"label"==m&&f.find("input, textarea, select").length&&(q=f.text(),f=f.children().first(),n=f.get(0),m=n.nodeName.toLowerCase());switch(m){case "menu":p={name:f.attr("label"),items:{}};l=a(p.items,f.children(),l);break;
case "a":case "button":p={name:f.text(),disabled:!!f.attr("disabled"),callback:function(){return function(){f.click()}}()};break;case "menuitem":case "command":switch(f.attr("type")){case g:case "command":case "menuitem":p={name:f.attr("label"),disabled:!!f.attr("disabled"),callback:function(){return function(){f.click()}}()};break;case "checkbox":p={type:"checkbox",disabled:!!f.attr("disabled"),name:f.attr("label"),selected:!!f.attr("checked")};break;case "radio":p={type:"radio",disabled:!!f.attr("disabled"),
name:f.attr("label"),radio:f.attr("radiogroup"),value:f.attr("id"),selected:!!f.attr("checked")};break;default:p=g}break;case "hr":p="-------";break;case "input":switch(f.attr("type")){case "text":p={type:"text",name:q||d(n),disabled:!!f.attr("disabled"),value:f.val()};break;case "checkbox":p={type:"checkbox",name:q||d(n),disabled:!!f.attr("disabled"),selected:!!f.attr("checked")};break;case "radio":p={type:"radio",name:q||d(n),disabled:!!f.attr("disabled"),radio:!!f.attr("name"),value:f.val(),selected:!!f.attr("checked")};
break;default:p=g}break;case "select":p={type:"select",name:q||d(n),disabled:!!f.attr("disabled"),selected:f.val(),options:{}};f.children().each(function(){p.options[this.value]=h(this).text()});break;case "textarea":p={type:"textarea",name:q||d(n),disabled:!!f.attr("disabled"),value:f.val()};break;case "label":break;default:p={type:"html",html:f.clone(!0)}}p&&(l++,e["key"+l]=p)});return l}h.support.htmlMenuitem="HTMLMenuItemElement"in window;h.support.htmlCommand="HTMLCommandElement"in window;h.support.eventSelectstart=
"onselectstart"in document.documentElement;if(!h.ui||!h.ui.widget){var f=h.cleanData;h.cleanData=function(a){for(var d=0,e;null!=(e=a[d]);d++)try{h(e).triggerHandler("remove")}catch(g){}f(a)}}var l=null,n=!1,m=h(window),q=0,p={},r={},w={},y={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,determinePosition:function(a){if(h.ui&&h.ui.position)a.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");
else{var d=this.offset();d.top+=this.outerHeight();d.left+=this.outerWidth()/2-a.outerWidth()/2;a.css(d)}},position:function(a,d,f){if(d||f){d="maintain"===d&&"maintain"===f?a.$menu.position():{top:f,left:d};f=m.scrollTop()+m.height();var e=m.scrollLeft()+m.width(),g=a.$menu.height(),h=a.$menu.width();d.top+g>f&&(d.top-=g);d.left+h>e&&(d.left-=h);a.$menu.css(d)}else a.determinePosition.call(this,a.$menu)},positionSubmenu:function(a){if(h.ui&&h.ui.position)a.css("display","block").position({my:"left top",
at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var d={top:0,left:this.outerWidth()};a.css(d)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:h.noop,hide:h.noop},callback:null,items:{}},x=null,z=null,F=null,M,H=function(a){for(var d=0;d=Math.max(d,parseInt(a.css("z-index"),10)||0),a=a.parent(),a&&a.length&&!(-1<"html body".indexOf(a.prop("nodeName").toLowerCase())););return d},A={abortevent:function(a){a.preventDefault();a.stopImmediatePropagation()},
contextmenu:function(a){var d=h(this);a.preventDefault();a.stopImmediatePropagation();if(!("right"!=a.data.trigger&&a.originalEvent||d.hasClass("context-menu-active")||d.hasClass("context-menu-disabled"))){l=d;if(a.data.build){var f=a.data.build(l,a);if(!1===f)return;a.data=h.extend(!0,{},y,a.data,f||{});if(!a.data.items||h.isEmptyObject(a.data.items))throw window.console&&(console.error||console.log)("No items specified to show in contextMenu"),Error("No Items specified");a.data.$trigger=l;R.create(a.data)}R.show.call(d,
a.data,a.pageX,a.pageY)}},click:function(a){a.preventDefault();a.stopImmediatePropagation();h(this).trigger(h.Event("contextmenu",{data:a.data,pageX:a.pageX,pageY:a.pageY}))},mousedown:function(a){var d=h(this);l&&l.length&&!l.is(d)&&l.data("contextMenu").$menu.trigger("contextmenu:hide");2==a.button&&(l=d.data("contextMenuActive",!0))},mouseup:function(a){var d=h(this);d.data("contextMenuActive")&&l&&l.length&&l.is(d)&&!d.hasClass("context-menu-disabled")&&(a.preventDefault(),a.stopImmediatePropagation(),
l=d,d.trigger(h.Event("contextmenu",{data:a.data,pageX:a.pageX,pageY:a.pageY})));d.removeData("contextMenuActive")},mouseenter:function(a){var d=h(this),f=h(a.relatedTarget),e=h(document);f.is(".context-menu-list")||f.closest(".context-menu-list").length||l&&l.length||(z=a.pageX,F=a.pageY,M=a.data,e.on("mousemove.contextMenuShow",A.mousemove),x=setTimeout(function(){x=null;e.off("mousemove.contextMenuShow");l=d;d.trigger(h.Event("contextmenu",{data:M,pageX:z,pageY:F}))},a.data.delay))},mousemove:function(a){z=
a.pageX;F=a.pageY},mouseleave:function(a){a=h(a.relatedTarget);if(!a.is(".context-menu-list")&&!a.closest(".context-menu-list").length){try{clearTimeout(x)}catch(d){}x=null}},layerClick:function(a){var d=h(this).data("contextMenuRoot"),f=a.button,e=a.pageX,g=a.pageY,l,n;a.preventDefault();a.stopImmediatePropagation();setTimeout(function(){var p,q="left"==d.trigger&&0===f||"right"==d.trigger&&2===f;document.elementFromPoint&&(d.$layer.hide(),l=document.elementFromPoint(e-m.scrollLeft(),g-m.scrollTop()),
d.$layer.show());if(d.reposition&&q)if(document.elementFromPoint){if(d.$trigger.is(l)||d.$trigger.has(l).length){d.position.call(d.$trigger,d,e,g);return}}else if(n=d.$trigger.offset(),p=h(window),n.top+=p.scrollTop(),n.top<=a.pageY&&(n.left+=p.scrollLeft(),n.left<=a.pageX&&(n.bottom=n.top+d.$trigger.outerHeight(),n.bottom>=a.pageY&&(n.right=n.left+d.$trigger.outerWidth(),n.right>=a.pageX)))){d.position.call(d.$trigger,d,e,g);return}if(l&&q)d.$trigger.one("contextmenu:hidden",function(){h(l).contextMenu({x:e,
y:g})});d.$menu.trigger("contextmenu:hide")},50)},keyStop:function(a,d){d.isInput||a.preventDefault();a.stopPropagation()},key:function(a){var d=l.data("contextMenu")||{};switch(a.keyCode){case 9:case 38:if(A.keyStop(a,d),d.isInput){if(9==a.keyCode&&a.shiftKey){a.preventDefault();d.$selected&&d.$selected.find("input, textarea, select").blur();d.$menu.trigger("prevcommand");return}if(38==a.keyCode&&"checkbox"==d.$selected.find("input, textarea, select").prop("type")){a.preventDefault();return}}else if(9!=
a.keyCode||a.shiftKey){d.$menu.trigger("prevcommand");return}case 40:A.keyStop(a,d);if(d.isInput){if(9==a.keyCode){a.preventDefault();d.$selected&&d.$selected.find("input, textarea, select").blur();d.$menu.trigger("nextcommand");return}if(40==a.keyCode&&"checkbox"==d.$selected.find("input, textarea, select").prop("type")){a.preventDefault();return}}else{d.$menu.trigger("nextcommand");return}break;case 37:A.keyStop(a,d);if(d.isInput||!d.$selected||!d.$selected.length)break;if(!d.$selected.parent().hasClass("context-menu-root")){a=
d.$selected.parent().parent();d.$selected.trigger("contextmenu:blur");d.$selected=a;return}break;case 39:A.keyStop(a,d);if(d.isInput||!d.$selected||!d.$selected.length)break;var f=d.$selected.data("contextMenu")||{};if(f.$menu&&d.$selected.hasClass("context-menu-submenu")){d.$selected=null;f.$selected=null;f.$menu.trigger("nextcommand");return}break;case 35:case 36:d.$selected&&d.$selected.find("input, textarea, select").length||((d.$selected&&d.$selected.parent()||d.$menu).children(":not(.disabled, .not-selectable)")[36==
a.keyCode?"first":"last"]().trigger("contextmenu:focus"),a.preventDefault());return;case 13:A.keyStop(a,d);if(d.isInput){if(d.$selected&&!d.$selected.is("textarea, select")){a.preventDefault();return}break}d.$selected&&d.$selected.trigger("mouseup");return;case 32:case 33:case 34:A.keyStop(a,d);return;case 27:A.keyStop(a,d);d.$menu.trigger("contextmenu:hide");return;default:if(f=String.fromCharCode(a.keyCode).toUpperCase(),d.accesskeys[f]){d.accesskeys[f].$node.trigger(d.accesskeys[f].$menu?"contextmenu:focus":
"mouseup");return}}a.stopPropagation();d.$selected&&d.$selected.trigger(a)},prevItem:function(a){a.stopPropagation();var d=h(this).data("contextMenu")||{};if(d.$selected){var f=d.$selected,d=d.$selected.parent().data("contextMenu")||{};d.$selected=f}for(var f=d.$menu.children(),e=d.$selected&&d.$selected.prev().length?d.$selected.prev():f.last(),g=e;e.hasClass("disabled")||e.hasClass("not-selectable");)if(e=e.prev().length?e.prev():f.last(),e.is(g))return;d.$selected&&A.itemMouseleave.call(d.$selected.get(0),
a);A.itemMouseenter.call(e.get(0),a);a=e.find("input, textarea, select");a.length&&a.focus()},nextItem:function(a){a.stopPropagation();var d=h(this).data("contextMenu")||{};if(d.$selected){var f=d.$selected,d=d.$selected.parent().data("contextMenu")||{};d.$selected=f}for(var f=d.$menu.children(),e=d.$selected&&d.$selected.next().length?d.$selected.next():f.first(),g=e;e.hasClass("disabled")||e.hasClass("not-selectable");)if(e=e.next().length?e.next():f.first(),e.is(g))return;d.$selected&&A.itemMouseleave.call(d.$selected.get(0),
a);A.itemMouseenter.call(e.get(0),a);a=e.find("input, textarea, select");a.length&&a.focus()},focusInput:function(a){a=h(this).closest(".context-menu-item");var d=a.data(),f=d.contextMenu,d=d.contextMenuRoot;d.$selected=f.$selected=a;d.isInput=f.isInput=!0},blurInput:function(a){a=h(this).closest(".context-menu-item").data();a.contextMenuRoot.isInput=a.contextMenu.isInput=!1},menuMouseenter:function(a){h(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(a){var d=h(this).data().contextMenuRoot;
d.$layer&&d.$layer.is(a.relatedTarget)&&(d.hovering=!1)},itemMouseenter:function(a){var d=h(this),f=d.data(),e=f.contextMenu,f=f.contextMenuRoot;f.hovering=!0;a&&f.$layer&&f.$layer.is(a.relatedTarget)&&(a.preventDefault(),a.stopImmediatePropagation());(e.$menu?e:f).$menu.children(".hover").trigger("contextmenu:blur");d.hasClass("disabled")||d.hasClass("not-selectable")?e.$selected=null:d.trigger("contextmenu:focus")},itemMouseleave:function(a){var d=h(this),f=d.data(),e=f.contextMenu,f=f.contextMenuRoot;
f!==e&&f.$layer&&f.$layer.is(a.relatedTarget)?(f.$selected&&f.$selected.trigger("contextmenu:blur"),a.preventDefault(),a.stopImmediatePropagation(),f.$selected=e.$selected=e.$node):d.trigger("contextmenu:blur")},itemClick:function(a){var d=h(this),f=d.data(),e=f.contextMenuRoot,g=f.contextMenuKey;if(f.contextMenu.items[g]&&!d.is(".disabled, .context-menu-submenu, .context-menu-separator, .not-selectable")){a.preventDefault();a.stopImmediatePropagation();if(h.isFunction(e.callbacks[g])&&Object.prototype.hasOwnProperty.call(e.callbacks,
g))a=e.callbacks[g];else if(h.isFunction(e.callback))a=e.callback;else return;!1!==a.call(e.$trigger,g,e)?e.$menu.trigger("contextmenu:hide"):e.$menu.parent().length&&R.update.call(e.$trigger,e)}},inputClick:function(a){a.stopImmediatePropagation()},hideMenu:function(a,d){var f=h(this).data("contextMenuRoot");R.hide.call(f.$trigger,f,d&&d.force)},focusItem:function(a){a.stopPropagation();a=h(this);var d=a.data(),f=d.contextMenu,d=d.contextMenuRoot;a.addClass("hover").siblings(".hover").trigger("contextmenu:blur");
f.$selected=d.$selected=a;f.$node&&d.positionSubmenu.call(f.$node,f.$menu)},blurItem:function(a){a.stopPropagation();a=h(this);var d=a.data().contextMenu;a.removeClass("hover");d.$selected=null}},R={show:function(a,d,f){var e=h(this),g={};h("#context-menu-layer").trigger("mousedown");a.$trigger=e;if(!1===a.events.show.call(e,a))l=null;else if(R.update.call(e,a),a.position.call(e,a,d,f),a.zIndex&&(g.zIndex=H(e)+a.zIndex),R.layer.call(a.$menu,a,g.zIndex),a.$menu.find("ul").css("zIndex",g.zIndex+1),
a.$menu.css(g)[a.animation.show](a.animation.duration,function(){e.trigger("contextmenu:visible")}),e.data("contextMenu",a).addClass("context-menu-active"),h(document).off("keydown.contextMenu").on("keydown.contextMenu",A.key),a.autoHide)h(document).on("mousemove.contextMenuAutoHide",function(d){var f=e.offset();f.right=f.left+e.outerWidth();f.bottom=f.top+e.outerHeight();!a.$layer||a.hovering||d.pageX>=f.left&&d.pageX<=f.right&&d.pageY>=f.top&&d.pageY<=f.bottom||a.$menu.trigger("contextmenu:hide")})},
hide:function(a,d){var f=h(this);a||(a=f.data("contextMenu")||{});if(d||!a.events||!1!==a.events.hide.call(f,a)){f.removeData("contextMenu").removeClass("context-menu-active");if(a.$layer){setTimeout(function(a){return function(){a.remove()}}(a.$layer),10);try{delete a.$layer}catch(e){a.$layer=null}}l=null;a.$menu.find(".hover").trigger("contextmenu:blur");a.$selected=null;h(document).off(".contextMenuAutoHide").off("keydown.contextMenu");a.$menu&&a.$menu[a.animation.hide](a.animation.duration,function(){a.build&&
(a.$menu.remove(),h.each(a,function(d,f){switch(d){case "ns":case "selector":case "build":case "trigger":return!0;default:a[d]=g;try{delete a[d]}catch(e){}return!0}}));setTimeout(function(){f.trigger("contextmenu:hidden")},10)})}},create:function(a,d){d===g&&(d=a);a.$menu=h('<ul class="context-menu-list"></ul>').addClass(a.className||"").data({contextMenu:a,contextMenuRoot:d});h.each(["callbacks","commands","inputs"],function(f,e){a[e]={};d[e]||(d[e]={})});d.accesskeys||(d.accesskeys={});h.each(a.items,
function(f,g){var l=h('<li class="context-menu-item"></li>').addClass(g.className||""),n=null,m=null;l.on("click",h.noop);g.$node=l.data({contextMenu:a,contextMenuRoot:d,contextMenuKey:f});if(g.accesskey)for(var p=e(g.accesskey),q=0,r;r=p[q];q++)if(!d.accesskeys[r]){d.accesskeys[r]=g;g._name=g.name.replace(new RegExp("("+r+")","i"),'<span class="context-menu-accesskey">$1</span>');break}if("string"==typeof g)l.addClass("context-menu-separator not-selectable");else if(g.type&&w[g.type])w[g.type].call(l,
g,a,d),h.each([a,d],function(a,d){d.commands[f]=g;h.isFunction(g.callback)&&(d.callbacks[f]=g.callback)});else{"html"==g.type?l.addClass("context-menu-html not-selectable"):g.type?(n=h("<label></label>").appendTo(l),h("<span></span>").html(g._name||g.name).appendTo(n),l.addClass("context-menu-input"),a.hasTypes=!0,h.each([a,d],function(a,d){d.commands[f]=g;d.inputs[f]=g})):g.items&&(g.type="sub");switch(g.type){case "text":m=h('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+
f).val(g.value||"").appendTo(n);break;case "textarea":m=h('<textarea name=""></textarea>').attr("name","context-menu-input-"+f).val(g.value||"").appendTo(n);g.height&&m.height(g.height);break;case "checkbox":m=h('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+f).val(g.value||"").prop("checked",!!g.selected).prependTo(n);break;case "radio":m=h('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+g.radio).val(g.value||"").prop("checked",
!!g.selected).prependTo(n);break;case "select":m=h('<select name="">').attr("name","context-menu-input-"+f).appendTo(n);g.options&&(h.each(g.options,function(a,d){h("<option></option>").val(a).text(d).appendTo(m)}),m.val(g.selected));break;case "sub":h("<span></span>").html(g._name||g.name).appendTo(l);g.appendTo=g.$node;R.create(g,d);l.data("contextMenu",g).addClass("context-menu-submenu");g.callback=null;break;case "html":h(g.html).appendTo(l);break;default:h.each([a,d],function(a,d){d.commands[f]=
g;h.isFunction(g.callback)&&(d.callbacks[f]=g.callback)}),h("<span></span>").html(g._name||g.name||"").appendTo(l)}if(g.type&&"sub"!=g.type&&"html"!=g.type&&(m.on("focus",A.focusInput).on("blur",A.blurInput),g.events))m.on(g.events,a);g.icon&&l.addClass("icon icon-"+g.icon)}g.$input=m;g.$label=n;l.appendTo(a.$menu);if(!a.hasTypes&&h.support.eventSelectstart)l.on("selectstart.disableTextSelect",A.abortevent)});a.$node||a.$menu.css("display","none").addClass("context-menu-root");a.$menu.appendTo(a.appendTo||
document.body)},resize:function(a,d){a.css({position:"absolute",display:"block"});a.data("width",Math.ceil(a.width())+1);a.css({position:"static",minWidth:"0px",maxWidth:"100000px"});a.find("> li > ul").each(function(){R.resize(h(this),!0)});d||a.find("ul").andSelf().css({position:"",display:"",minWidth:"",maxWidth:""}).width(function(){return h(this).data("width")})},update:function(a,d){var f=this;d===g&&(d=a,R.resize(a.$menu));a.$menu.children().each(function(){var e=h(this),g=e.data("contextMenuKey"),
l=a.items[g],g=h.isFunction(l.disabled)&&l.disabled.call(f,g,d)||!0===l.disabled;e[g?"addClass":"removeClass"]("disabled");if(l.type)switch(e.find("input, select, textarea").prop("disabled",g),l.type){case "text":case "textarea":l.$input.val(l.value||"");break;case "checkbox":case "radio":l.$input.val(l.value||"").prop("checked",!!l.selected);break;case "select":l.$input.val(l.selected||"")}l.$menu&&R.update.call(f,l,d)})},layer:function(a,d){var f=a.$layer=h('<div id="context-menu-layer" style="position:fixed; z-index:'+
d+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:m.height(),width:m.width(),display:"block"}).data("contextMenuRoot",a).insertBefore(this).on("contextmenu",A.abortevent).on("mousedown",A.layerClick);h.support.fixedPosition||f.css({position:"absolute",height:h(document).height()});return f}};h.fn.contextMenu=function(a){a===g?this.first().trigger("contextmenu"):a.x&&a.y?this.first().trigger(h.Event("contextmenu",{pageX:a.x,pageY:a.y})):"hide"===
a?(a=this.data("contextMenu").$menu)&&a.trigger("contextmenu:hide"):"destroy"===a?h.contextMenu("destroy",{context:this}):h.isPlainObject(a)?(a.context=this,h.contextMenu("create",a)):a?this.removeClass("context-menu-disabled"):a||this.addClass("context-menu-disabled");return this};h.contextMenu=function(a,d){"string"!=typeof a&&(d=a,a="create");"string"==typeof d?d={selector:d}:d===g&&(d={});var f=h.extend(!0,{},y,d||{}),e=h(document),l=e,m=!1;f.context&&f.context.length?(l=h(f.context).first(),
f.context=l.get(0),m=f.context!==document):f.context=document;switch(a){case "create":if(!f.selector)throw Error("No selector specified");if(f.selector.match(/.context-menu-(list|item|input)($|\s)/))throw Error('Cannot bind to selector "'+f.selector+'" as it contains a reserved className');if(!f.build&&(!f.items||h.isEmptyObject(f.items)))throw Error("No Items specified");q++;f.ns=".contextMenu"+q;m||(p[f.selector]=f.ns);r[f.ns]=f;f.trigger||(f.trigger="right");n||(e.on({"contextmenu:hide.contextMenu":A.hideMenu,
"prevcommand.contextMenu":A.prevItem,"nextcommand.contextMenu":A.nextItem,"contextmenu.contextMenu":A.abortevent,"mouseenter.contextMenu":A.menuMouseenter,"mouseleave.contextMenu":A.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",A.inputClick).on({"mouseup.contextMenu":A.itemClick,"contextmenu:focus.contextMenu":A.focusItem,"contextmenu:blur.contextMenu":A.blurItem,"contextmenu.contextMenu":A.abortevent,"mouseenter.contextMenu":A.itemMouseenter,"mouseleave.contextMenu":A.itemMouseleave},
".context-menu-item"),n=!0);l.on("contextmenu"+f.ns,f.selector,f,A.contextmenu);if(m)l.on("remove"+f.ns,function(){h(this).contextMenu("destroy")});switch(f.trigger){case "hover":l.on("mouseenter"+f.ns,f.selector,f,A.mouseenter).on("mouseleave"+f.ns,f.selector,f,A.mouseleave);break;case "left":l.on("click"+f.ns,f.selector,f,A.click)}f.build||R.create(f);break;case "destroy":var x;if(m){var w=f.context;h.each(r,function(a,d){if(d.context!==w)return!0;x=h(".context-menu-list").filter(":visible");x.length&&
x.data().contextMenuRoot.$trigger.is(h(d.context).find(d.selector))&&x.trigger("contextmenu:hide",{force:!0});try{r[d.ns].$menu&&r[d.ns].$menu.remove(),delete r[d.ns]}catch(f){r[d.ns]=null}h(d.context).off(d.ns);return!0})}else if(!f.selector)e.off(".contextMenu .contextMenuAutoHide"),h.each(r,function(a,d){h(d.context).off(d.ns)}),p={},r={},q=0,n=!1,h("#context-menu-layer, .context-menu-list").remove();else if(p[f.selector]){x=h(".context-menu-list").filter(":visible");x.length&&x.data().contextMenuRoot.$trigger.is(f.selector)&&
x.trigger("contextmenu:hide",{force:!0});try{r[p[f.selector]].$menu&&r[p[f.selector]].$menu.remove(),delete r[p[f.selector]]}catch(z){r[p[f.selector]]=null}e.off(p[f.selector])}break;case "html5":(!h.support.htmlCommand&&!h.support.htmlMenuitem||"boolean"==typeof d&&d)&&h('menu[type="context"]').each(function(){this.id&&h.contextMenu({selector:"[contextmenu="+this.id+"]",items:h.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw Error('Unknown operation "'+a+'"');}return this};
h.contextMenu.setInputValues=function(a,d){d===g&&(d={});h.each(a.inputs,function(a,f){switch(f.type){case "text":case "textarea":f.value=d[a]||"";break;case "checkbox":f.selected=d[a]?!0:!1;break;case "radio":f.selected=(d[f.radio]||"")==f.value?!0:!1;break;case "select":f.selected=d[a]||""}})};h.contextMenu.getInputValues=function(a,d){d===g&&(d={});h.each(a.inputs,function(a,f){switch(f.type){case "text":case "textarea":case "select":d[a]=f.$input.val();break;case "checkbox":d[a]=f.$input.prop("checked");
break;case "radio":f.$input.prop("checked")&&(d[f.radio]=f.value)}});return d};h.contextMenu.fromMenu=function(d){d=h(d);var f={};a(f,d.children());return f};h.contextMenu.defaults=y;h.contextMenu.types=w;h.contextMenu.handle=A;h.contextMenu.op=R;h.contextMenu.menus=r})(jQuery);!function(){function h(b,k){return k>b?-1:b>k?1:b>=k?0:0/0}function g(b){return null===b?0/0:+b}function e(b){return!isNaN(b)}function d(b){return{left:function(k,t,a,d){3>arguments.length&&(a=0);for(4>arguments.length&&(d=k.length);d>a;){var G=a+d>>>1;0>b(k[G],t)?a=G+1:d=G}return a},right:function(k,t,a,d){3>arguments.length&&(a=0);for(4>arguments.length&&(d=k.length);d>a;){var G=a+d>>>1;0<b(k[G],t)?d=G:a=G+1}return a}}}function a(b){return b.length}function f(b,k){for(var t in k)Object.defineProperty(b.prototype,
t,{value:k[t],enumerable:!1})}function l(){this._=Object.create(null)}function n(b){return(b+="")===vg||b[0]===Gc?Gc+b:b}function m(b){return(b+="")[0]===Gc?b.slice(1):b}function q(b){return n(b)in this._}function p(b){return(b=n(b))in this._&&delete this._[b]}function r(){var b=[],k;for(k in this._)b.push(m(k));return b}function w(){var b=0,k;for(k in this._)++b;return b}function y(){for(var b in this._)return!1;return!0}function x(){this._=Object.create(null)}function z(b,k,t){return function(){var a=
t.apply(k,arguments);return a===k?b:a}}function F(b,k){if(k in b)return k;k=k.charAt(0).toUpperCase()+k.slice(1);for(var t=0,a=Ud.length;a>t;++t){var d=Ud[t]+k;if(d in b)return d}}function M(){}function H(){}function A(b){function k(){for(var k,a=t,d=-1,O=a.length;++d<O;)(k=a[d].on)&&k.apply(this,arguments);return b}var t=[],a=new l;return k.on=function(k,d){var f,e=a.get(k);return 2>arguments.length?e&&e.on:(e&&(e.on=null,t=t.slice(0,f=t.indexOf(e)).concat(t.slice(f+1)),a.remove(k)),d&&t.push(a.set(k,
{on:d})),b)},k}function R(){v.event.preventDefault()}function Na(){for(var b,k=v.event;b=k.sourceEvent;)k=b;return k}function Wa(b){for(var k=new H,t=0,a=arguments.length;++t<a;)k[arguments[t]]=A(k);return k.of=function(t,a){return function(d){try{var O=d.sourceEvent=v.event;d.target=b;v.event=d;k[d.type].apply(t,a)}finally{v.event=O}}},k}function ea(b){return Jb(b,K),b}function W(b){return"function"==typeof b?b:function(){return Hc(b,this)}}function ba(b){return"function"==typeof b?b:function(){return Ic(b,
this)}}function gb(b,k){function t(){this.removeAttribute(b)}function a(){this.removeAttributeNS(b.space,b.local)}function d(){this.setAttribute(b,k)}function G(){this.setAttributeNS(b.space,b.local,k)}function f(){var t=k.apply(this,arguments);null==t?this.removeAttribute(b):this.setAttribute(b,t)}function e(){var t=k.apply(this,arguments);null==t?this.removeAttributeNS(b.space,b.local):this.setAttributeNS(b.space,b.local,t)}return b=v.ns.qualify(b),null==k?b.local?a:t:"function"==typeof k?b.local?
e:f:b.local?G:d}function Pd(b){return b.trim().replace(/\s+/g," ")}function Qd(b){return new RegExp("(?:^|\\s+)"+v.requote(b)+"(?:\\s+|$)","g")}function Rd(b,k){function t(){for(var t=-1;++t<d;)b[t](this,k)}function a(){for(var t=-1,O=k.apply(this,arguments);++t<d;)b[t](this,O)}b=(b+"").trim().split(/^|\s+/).map(ug);var d=b.length;return"function"==typeof k?a:t}function ug(b){var k=Qd(b);return function(t,a){if(d=t.classList)return a?d.add(b):d.remove(b);var d=t.getAttribute("class")||"";a?(k.lastIndex=
0,k.test(d)||t.setAttribute("class",Pd(d+" "+b))):t.setAttribute("class",Pd(d.replace(k," ")))}}function Sd(b,k,t){function a(){this.style.removeProperty(b)}function d(){this.style.setProperty(b,k,t)}function G(){var a=k.apply(this,arguments);null==a?this.style.removeProperty(b):this.style.setProperty(b,a,t)}return null==k?a:"function"==typeof k?G:d}function Td(b,k){function t(){delete this[b]}function a(){this[b]=k}function d(){var t=k.apply(this,arguments);null==t?delete this[b]:this[b]=t}return null==
k?t:"function"==typeof k?d:a}function Wd(b){return"function"==typeof b?b:(b=v.ns.qualify(b)).local?function(){return this.ownerDocument.createElementNS(b.space,b.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,b)}}function Xd(b){return function(){return Yd(this,b)}}function wg(b){return arguments.length||(b=h),function(k,t){return k&&t?b(k.__data__,t.__data__):!k-!t}}function Ea(b,k){for(var t=0,a=b.length;a>t;t++)for(var d,G=b[t],f=0,e=G.length;e>f;f++)(d=G[f])&&k(d,
f,t);return b}function Zd(b){return Jb(b,Fa),b}function xg(b){var k,t;return function(a,d,f){a=b[f].update;var e=a.length;f!=t&&(t=f,k=0);for(d>=k&&(k=d+1);!(d=a[k])&&++k<e;);return d}}function Kb(){var b=this.__transition__;b&&++b.active}function $d(b,k,t){function a(){var k=this[e];k&&(this.removeEventListener(b,k,k.$),delete this[e])}function d(){var f=h(k,Oa(arguments));a.call(this);this.addEventListener(b,this[e]=f,f.$=t);f._=k}function f(){var k,t=new RegExp("^__on([^.]+)"+v.requote(b)+"$"),
a;for(a in this)if(k=a.match(t)){var d=this[a];this.removeEventListener(k[1],d,d.$);delete this[a]}}var e="__on"+b,g=b.indexOf("."),h=ae;0<g&&(b=b.slice(0,g));var l=Jc.get(b);return l&&(b=l,h=yg),g?k?d:a:k?M:f}function ae(b,k){return function(t){var a=v.event;v.event=t;k[0]=this.__data__;try{b.apply(this,k)}finally{v.event=a}}}function yg(b,k){var t=ae(b,k);return function(b){var k=b.relatedTarget;k&&(k===this||8&k.compareDocumentPosition(this))||t.call(this,b)}}function Lb(){var b=".dragsuppress-"+
++zg,k="click"+b,t=v.select(ha).on("touchmove"+b,R).on("dragstart"+b,R).on("selectstart"+b,R);if(vb){var a=Ga.style,d=a[vb];a[vb]="none"}return function(f){function e(){t.on(k,null)}t.on(b,null);vb&&(a[vb]=d);f&&(t.on(k,function(){R();e()},!0),setTimeout(e,0))}}function Kc(b,k){k.changedTouches&&(k=k.changedTouches[0]);var t=b.ownerSVGElement||b;if(t.createSVGPoint){var a=t.createSVGPoint();if(0>Lc&&(ha.scrollX||ha.scrollY)){var t=v.select("body").append("svg").style({position:"absolute",top:0,left:0,
margin:0,padding:0,border:"none"},"important"),d=t[0][0].getScreenCTM();Lc=!(d.f||d.e);t.remove()}return Lc?(a.x=k.pageX,a.y=k.pageY):(a.x=k.clientX,a.y=k.clientY),a=a.matrixTransform(b.getScreenCTM().inverse()),[a.x,a.y]}t=b.getBoundingClientRect();return[k.clientX-t.left-b.clientLeft,k.clientY-t.top-b.clientTop]}function Ag(){return v.event.changedTouches[0].identifier}function Bg(){return v.event.target}function Cg(){return ha}function Mc(b,k,t){return(k[0]-b[0])*(t[1]-b[1])-(k[1]-b[1])*(t[0]-
b[0])}function be(b){return 1<b?0:-1>b?J:Math.acos(b)}function hb(b){return 1<b?da:-1>b?-da:Math.asin(b)}function ce(b){return((b=Math.exp(b))+1/b)/2}function de(b){return(b=Math.sin(b/2))*b}function Xa(){}function za(b,k,t){return this instanceof za?(this.h=+b,this.s=+k,void(this.l=+t)):2>arguments.length?b instanceof za?new za(b.h,b.s,b.l):ee(""+b,fe,za):new za(b,k,t)}function Nc(b,k,t){function a(b){return 360<b?b-=360:0>b&&(b+=360),60>b?d+(f-d)*b/60:180>b?f:240>b?d+(f-d)*(240-b)/60:d}var d,f;
return b=isNaN(b)?0:0>(b%=360)?b+360:b,k=isNaN(k)?0:0>k?0:1<k?1:k,t=0>t?0:1<t?1:t,f=.5>=t?t*(1+k):t+k-t*k,d=2*t-f,new ia(Math.round(255*a(b+120)),Math.round(255*a(b)),Math.round(255*a(b-120)))}function ua(b,k,t){return this instanceof ua?(this.h=+b,this.c=+k,void(this.l=+t)):2>arguments.length?b instanceof ua?new ua(b.h,b.c,b.l):b instanceof va?ge(b.l,b.a,b.b):ge((b=he((b=v.rgb(b)).r,b.g,b.b)).l,b.a,b.b):new ua(b,k,t)}function Oc(b,k,t){return isNaN(b)&&(b=0),isNaN(k)&&(k=0),new va(t,Math.cos(b*=
I)*k,Math.sin(b)*k)}function va(b,k,t){return this instanceof va?(this.l=+b,this.a=+k,void(this.b=+t)):2>arguments.length?b instanceof va?new va(b.l,b.a,b.b):b instanceof ua?Oc(b.h,b.c,b.l):he((b=ia(b)).r,b.g,b.b):new va(b,k,t)}function ie(b,k,t){b=(b+16)/116;k=b+k/500;t=b-t/200;return k=Pc(k)*je,b=Pc(b)*ke,t=Pc(t)*le,new ia(Qc(3.2404542*k-1.5371385*b-.4985314*t),Qc(-.969266*k+1.8760108*b+.041556*t),Qc(.0556434*k-.2040259*b+1.0572252*t))}function ge(b,k,t){return 0<b?new ua(Math.atan2(t,k)*U,Math.sqrt(k*
k+t*t),b):new ua(0/0,0/0,b)}function Pc(b){return.206893034<b?b*b*b:(b-4/29)/7.787037}function Rc(b){return.008856<b?Math.pow(b,1/3):7.787037*b+4/29}function Qc(b){return Math.round(255*(.00304>=b?12.92*b:1.055*Math.pow(b,1/2.4)-.055))}function ia(b,k,t){return this instanceof ia?(this.r=~~b,this.g=~~k,void(this.b=~~t)):2>arguments.length?b instanceof ia?new ia(b.r,b.g,b.b):ee(""+b,ia,Nc):new ia(b,k,t)}function Mb(b){return new ia(b>>16,255&b>>8,255&b)+""}function ib(b){return 16>b?"0"+Math.max(0,
b).toString(16):Math.min(255,b).toString(16)}function ee(b,k,t){var a,d,f,e=0,g=0,h=0;if(a=/([a-z]+)\((.*)\)/i.exec(b))switch(d=a[2].split(","),a[1]){case "hsl":return t(parseFloat(d[0]),parseFloat(d[1])/100,parseFloat(d[2])/100);case "rgb":return k(Sc(d[0]),Sc(d[1]),Sc(d[2]))}return(f=Nb.get(b))?k(f.r,f.g,f.b):(null==b||"#"!==b.charAt(0)||isNaN(f=parseInt(b.slice(1),16))||(4===b.length?(e=(3840&f)>>4,e|=e>>4,g=240&f,g|=g>>4,h=15&f,h|=h<<4):7===b.length&&(e=(16711680&f)>>16,g=(65280&f)>>8,h=255&f)),
k(e,g,h))}function fe(b,k,t){var a,d,f=Math.min(b/=255,k/=255,t/=255),e=Math.max(b,k,t),g=e-f,h=(e+f)/2;return g?(d=.5>h?g/(e+f):g/(2-e-f),a=b==e?(k-t)/g+(t>k?6:0):k==e?(t-b)/g+2:(b-k)/g+4,a*=60):(a=0/0,d=0<h&&1>h?0:a),new za(a,d,h)}function he(b,k,t){b=Tc(b);k=Tc(k);t=Tc(t);var a=Rc((.4124564*b+.3575761*k+.1804375*t)/je),d=Rc((.2126729*b+.7151522*k+.072175*t)/ke);b=Rc((.0193339*b+.119192*k+.9503041*t)/le);return va(116*d-16,500*(a-d),200*(d-b))}function Tc(b){return.04045>=(b/=255)?b/12.92:Math.pow((b+
.055)/1.055,2.4)}function Sc(b){var k=parseFloat(b);return"%"===b.charAt(b.length-1)?Math.round(2.55*k):k}function S(b){return"function"==typeof b?b:function(){return b}}function ca(b){return b}function Uc(b){return function(k,t,a){return 2===arguments.length&&"function"==typeof t&&(a=t,t=null),Ob(k,t,b,a)}}function Ob(b,k,t,a){function d(){var b,k=h.status,a;if(a=!k)a=(a=h.responseType)&&"text"!==a?h.response:h.responseText;if(a||200<=k&&300>k||304===k){try{b=t.call(f,h)}catch(O){return e.error.call(f,
O),void 0}e.load.call(f,b)}else e.error.call(f,h)}var f={},e=v.dispatch("beforesend","progress","load","error"),g={},h=new XMLHttpRequest,l=null;return!ha.XDomainRequest||"withCredentials"in h||!/^(http(s)?:)?\/\//.test(b)||(h=new XDomainRequest),"onload"in h?h.onload=h.onerror=d:h.onreadystatechange=function(){3<h.readyState&&d()},h.onprogress=function(b){var k=v.event;v.event=b;try{e.progress.call(f,h)}finally{v.event=k}},f.header=function(b,k){return b=(b+"").toLowerCase(),2>arguments.length?g[b]:
(null==k?delete g[b]:g[b]=k+"",f)},f.mimeType=function(b){return arguments.length?(k=null==b?null:b+"",f):k},f.responseType=function(b){return arguments.length?(l=b,f):l},f.response=function(b){return t=b,f},["get","post"].forEach(function(b){f[b]=function(){return f.send.apply(f,[b].concat(Oa(arguments)))}}),f.send=function(t,a,d){if(2===arguments.length&&"function"==typeof a&&(d=a,a=null),h.open(t,b,!0),null==k||"accept"in g||(g.accept=k+",*/*"),h.setRequestHeader)for(var O in g)h.setRequestHeader(O,
g[O]);return null!=k&&h.overrideMimeType&&h.overrideMimeType(k),null!=l&&(h.responseType=l),null!=d&&f.on("error",d).on("load",function(b){d(null,b)}),e.beforesend.call(f,h),h.send(null==a?null:a),f},f.abort=function(){return h.abort(),f},v.rebind(f,e,"on"),null==a?f:f.get(Dg(a))}function Dg(b){return 1===b.length?function(k,t){b(null==k?t:null)}:b}function Vc(){var b=me(),b=ne()-b;24<b?(isFinite(b)&&(clearTimeout(Pb),Pb=setTimeout(Vc,b)),Qb=0):(Qb=1,oe(Vc))}function me(){var b=Date.now();for(Ha=
Rb;Ha;)b>=Ha.t&&(Ha.f=Ha.c(b-Ha.t)),Ha=Ha.n;return b}function ne(){for(var b,k=Rb,t=1/0;k;)k.f?k=b?b.n=k.n:Rb=k.n:(k.t<t&&(t=k.t),k=(b=k).n);return Sb=b,t}function Wc(b,k){return k-(b?Math.ceil(Math.log(b)/Math.LN10):1)}function Eg(b){var k=b.decimal,t=b.thousands,a=b.grouping,d=b.currency,f=a&&t?function(b,k){for(var d=b.length,f=[],G=0,e=a[0],E=0;0<d&&0<e&&(E+e+1>k&&(e=Math.max(1,k-E)),f.push(b.substring(d-=e,d+e)),!((E+=e+1)>k));)e=a[G=(G+1)%a.length];return f.reverse().join(t)}:ca;return function(b){b=
pe.exec(b);var t=b[1]||" ",a=b[2]||">",O=b[3]||"-",e=b[4]||"",g=b[5],h=+b[6],l=b[7],n=b[8],m=b[9],p=1,q="",r="",x=!1,w=!0;switch(n&&(n=+n.substring(1)),(g||"0"===t&&"="===a)&&(g=t="0",a="="),m){case "n":l=!0;m="g";break;case "%":p=100;r="%";m="f";break;case "p":p=100;r="%";m="r";break;case "b":case "o":case "x":case "X":"#"===e&&(q="0"+m.toLowerCase());case "c":w=!1;case "d":x=!0;n=0;break;case "s":p=-1,m="r"}"$"===e&&(q=d[0],r=d[1]);"r"!=m||n||(m="g");null!=n&&("g"==m?n=Math.max(1,Math.min(21,n)):
("e"==m||"f"==m)&&(n=Math.max(0,Math.min(20,n))));var m=Fg.get(m)||Gg,y=g&&l;return function(b){var d=r;if(x&&b%1)return"";var e=0>b||0===b&&0>1/b?(b=-b,"-"):"-"===O?"":O;0>p?(d=v.formatPrefix(b,n),b=d.scale(b),d=d.symbol+r):b*=p;b=m(b,n);var E,Z,T=b.lastIndexOf(".");0>T?(T=w?b.lastIndexOf("e"):-1,0>T?(E=b,Z=""):(E=b.substring(0,T),Z=b.substring(T))):(E=b.substring(0,T),Z=k+b.substring(T+1));!g&&l&&(E=f(E,1/0));var T=q.length+E.length+Z.length+(y?0:e.length),z=h>T?Array(T=h-T+1).join(t):"";return y&&
(E=f(z+E,z.length?h-Z.length:1/0)),e+=q,b=E+Z,("<"===a?e+b+z:">"===a?z+e+b:"^"===a?z.substring(0,T>>=1)+e+b+z.substring(T):e+(y?b:z+b))+d}}}function Gg(b){return b+""}function Ia(){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):arguments[0])}function Ya(b,k,t){function a(k){var t=b(k),d=f(t,1);return d-k>k-t?t:d}function d(t){return k(t=b(new ga(t-1)),1),t}function f(b,t){return k(b=new ga(+b),t),b}function e(b,a,f){b=d(b);var O=[];if(1<f)for(;a>b;)t(b)%f||O.push(new Date(+b)),
k(b,1);else for(;a>b;)O.push(new Date(+b)),k(b,1);return O}b.floor=b;b.round=a;b.ceil=d;b.offset=f;b.range=e;var g=b.utc=Tb(b);return g.floor=g,g.round=Tb(a),g.ceil=Tb(d),g.offset=Tb(f),g.range=function(b,k,t){try{ga=Ia;var a=new Ia;return a._=b,e(a,k,t)}finally{ga=Date}},b}function Tb(b){return function(k,t){try{ga=Ia;var a=new Ia;return a._=k,b(a,t)._}finally{ga=Date}}}function Ig(b){function k(b){function k(t){for(var d,f,O,G=[],e=-1,E=0;++e<a;)37===b.charCodeAt(e)&&(G.push(b.slice(E,e)),null!=
(f=re[d=b.charAt(++e)])&&(d=b.charAt(++e)),(O=w[d])&&(d=O(t,null==f?"e"===d?" ":"0":f)),G.push(d),E=e+1);return G.push(b.slice(E,e)),G.join("")}var a=b.length;return k.parse=function(k){var a={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(t(a,b,k,0)!=k.length)return null;"p"in a&&(a.H=a.H%12+12*a.p);k=null!=a.Z&&ga!==Ia;var d=new (k?Ia:ga);return"j"in a?d.setFullYear(a.y,0,a.j):"w"in a&&("W"in a||"U"in a)?(d.setFullYear(a.y,0,1),d.setFullYear(a.y,0,"W"in a?(a.w+6)%7+7*a.W-(d.getDay()+5)%7:a.w+7*a.U-(d.getDay()+
6)%7)):d.setFullYear(a.y,a.m,a.d),d.setHours(a.H+(0|a.Z/100),a.M+a.Z%100,a.S,a.L),k?d._:d},k.toString=function(){return b},k}function t(b,k,t,a){for(var d,f,O,G=0,e=k.length,E=t.length;e>G;){if(a>=E)return-1;if(d=k.charCodeAt(G++),37===d){if(O=k.charAt(G++),f=y[O in re?k.charAt(G++):O],!f||0>(a=f(b,t,a)))return-1}else if(d!=t.charCodeAt(a++))return-1}return a}var a=b.dateTime,d=b.date,f=b.time,e=b.periods,g=b.days,h=b.shortDays,l=b.months,n=b.shortMonths;k.utc=function(b){function t(b){try{ga=Ia;
var k=new ga;return k._=b,a(k)}finally{ga=Date}}var a=k(b);return t.parse=function(b){try{ga=Ia;var k=a.parse(b);return k&&k._}finally{ga=Date}},t.toString=a.toString,t};k.multi=k.utc.multi=Jg;var m=v.map(),p=Ub(g),q=Vb(g),r=Ub(h),fa=Vb(h),x=Ub(l),V=Vb(l),N=Ub(n),P=Vb(n);e.forEach(function(b,k){m.set(b.toLowerCase(),k)});var w={a:function(b){return h[b.getDay()]},A:function(b){return g[b.getDay()]},b:function(b){return n[b.getMonth()]},B:function(b){return l[b.getMonth()]},c:k(a),d:function(b,k){return ja(b.getDate(),
k,2)},e:function(b,k){return ja(b.getDate(),k,2)},H:function(b,k){return ja(b.getHours(),k,2)},I:function(b,k){return ja(b.getHours()%12||12,k,2)},j:function(b,k){return ja(1+B.dayOfYear(b),k,3)},L:function(b,k){return ja(b.getMilliseconds(),k,3)},m:function(b,k){return ja(b.getMonth()+1,k,2)},M:function(b,k){return ja(b.getMinutes(),k,2)},p:function(b){return e[+(12<=b.getHours())]},S:function(b,k){return ja(b.getSeconds(),k,2)},U:function(b,k){return ja(B.sundayOfYear(b),k,2)},w:function(b){return b.getDay()},
W:function(b,k){return ja(B.mondayOfYear(b),k,2)},x:k(d),X:k(f),y:function(b,k){return ja(b.getFullYear()%100,k,2)},Y:function(b,k){return ja(b.getFullYear()%1E4,k,4)},Z:Kg,"%":function(){return"%"}},y={a:function(b,k,t){r.lastIndex=0;return(k=r.exec(k.slice(t)))?(b.w=fa.get(k[0].toLowerCase()),t+k[0].length):-1},A:function(b,k,t){p.lastIndex=0;return(k=p.exec(k.slice(t)))?(b.w=q.get(k[0].toLowerCase()),t+k[0].length):-1},b:function(b,k,t){N.lastIndex=0;return(k=N.exec(k.slice(t)))?(b.m=P.get(k[0].toLowerCase()),
t+k[0].length):-1},B:function(b,k,t){x.lastIndex=0;return(k=x.exec(k.slice(t)))?(b.m=V.get(k[0].toLowerCase()),t+k[0].length):-1},c:function(b,k,a){return t(b,w.c.toString(),k,a)},d:se,e:se,H:te,I:te,j:Lg,L:Mg,m:Ng,M:Og,p:function(b,k,t){k=m.get(k.slice(t,t+=2).toLowerCase());return null==k?-1:(b.p=k,t)},S:Pg,U:Qg,w:Rg,W:Sg,x:function(b,k,a){return t(b,w.x.toString(),k,a)},X:function(b,k,a){return t(b,w.X.toString(),k,a)},y:Tg,Y:Ug,Z:Vg,"%":Wg};return k}function ja(b,k,t){var a=0>b?"-":"";b=(a?-b:
b)+"";var d=b.length;return a+(t>d?Array(t-d+1).join(k)+b:b)}function Ub(b){return new RegExp("^(?:"+b.map(v.requote).join("|")+")","i")}function Vb(b){for(var k=new l,t=-1,a=b.length;++t<a;)k.set(b[t].toLowerCase(),t);return k}function Rg(b,k,t){X.lastIndex=0;return(k=X.exec(k.slice(t,t+1)))?(b.w=+k[0],t+k[0].length):-1}function Qg(b,k,t){X.lastIndex=0;return(k=X.exec(k.slice(t)))?(b.U=+k[0],t+k[0].length):-1}function Sg(b,k,t){X.lastIndex=0;return(k=X.exec(k.slice(t)))?(b.W=+k[0],t+k[0].length):
-1}function Ug(b,k,t){X.lastIndex=0;return(k=X.exec(k.slice(t,t+4)))?(b.y=+k[0],t+k[0].length):-1}function Tg(b,k,t){X.lastIndex=0;if(k=X.exec(k.slice(t,t+2))){var a=+k[0];b=(b.y=a+(68<a?1900:2E3),t+k[0].length)}else b=-1;return b}function Vg(b,k,t){return/^[+-]\d{4}$/.test(k=k.slice(t,t+5))?(b.Z=-k,t+5):-1}function Ng(b,k,t){X.lastIndex=0;return(k=X.exec(k.slice(t,t+2)))?(b.m=k[0]-1,t+k[0].length):-1}function se(b,k,t){X.lastIndex=0;return(k=X.exec(k.slice(t,t+2)))?(b.d=+k[0],t+k[0].length):-1}function Lg(b,
k,t){X.lastIndex=0;return(k=X.exec(k.slice(t,t+3)))?(b.j=+k[0],t+k[0].length):-1}function te(b,k,t){X.lastIndex=0;return(k=X.exec(k.slice(t,t+2)))?(b.H=+k[0],t+k[0].length):-1}function Og(b,k,t){X.lastIndex=0;return(k=X.exec(k.slice(t,t+2)))?(b.M=+k[0],t+k[0].length):-1}function Pg(b,k,t){X.lastIndex=0;return(k=X.exec(k.slice(t,t+2)))?(b.S=+k[0],t+k[0].length):-1}function Mg(b,k,t){X.lastIndex=0;return(k=X.exec(k.slice(t,t+3)))?(b.L=+k[0],t+k[0].length):-1}function Kg(b){var k=b.getTimezoneOffset();
b=0<k?"-":"+";var t=0|L(k)/60,k=L(k)%60;return b+ja(t,"0",2)+ja(k,"0",2)}function Wg(b,k,t){ue.lastIndex=0;return(b=ue.exec(k.slice(t,t+1)))?t+b[0].length:-1}function Jg(b){for(var k=b.length,t=-1;++t<k;)b[t][0]=this(b[t][0]);return function(k){for(var t=0,a=b[t];!a[1](k);)a=b[++t];return a[0](k)}}function Yc(){}function ve(b,k,t){var a=t.s=b+k,d=a-b;t.t=b-(a-d)+(k-d)}function Wb(b,k){b&&we.hasOwnProperty(b.type)&&we[b.type](b,k)}function Zc(b,k,t){var a=-1,d=b.length-t;for(k.lineStart();++a<d;)t=
b[a],k.point(t[0],t[1],t[2]);k.lineEnd()}function xe(b,k){var t=-1,a=b.length;for(k.polygonStart();++t<a;)Zc(b[t],k,1);k.polygonEnd()}function Xg(){function b(b,k){b*=I;k=k*I/2+J/4;var t=b-a,e=0<=t?1:-1,g=e*t,t=Math.cos(k),h=Math.sin(k),l=f*h,n=d*t+l*Math.cos(g),e=l*e*Math.sin(g);Za.add(Math.atan2(e,n));a=b;d=t;f=h}var k,t,a,d,f;ma.point=function(e,g){ma.point=b;a=(k=e)*I;d=Math.cos(g=(t=g)*I/2+J/4);f=Math.sin(g)};ma.lineEnd=function(){b(k,t)}}function $a(b){var k=b[0];b=b[1];var t=Math.cos(b);return[t*
Math.cos(k),t*Math.sin(k),Math.sin(b)]}function Xb(b,k){return b[0]*k[0]+b[1]*k[1]+b[2]*k[2]}function kb(b,k){return[b[1]*k[2]-b[2]*k[1],b[2]*k[0]-b[0]*k[2],b[0]*k[1]-b[1]*k[0]]}function $c(b,k){b[0]+=k[0];b[1]+=k[1];b[2]+=k[2]}function Yb(b,k){return[b[0]*k,b[1]*k,b[2]*k]}function Zb(b){var k=Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);b[0]/=k;b[1]/=k;b[2]/=k}function $b(b){return[Math.atan2(b[1],b[0]),hb(b[2])]}function ac(b,k){return L(b[0]-k[0])<C&&L(b[1]-k[1])<C}function ad(b,k){b*=I;var t=Math.cos(k*=
I);wb(t*Math.cos(b),t*Math.sin(b),Math.sin(k))}function wb(b,k,t){++xb;Ja+=(b-Ja)/xb;Ka+=(k-Ka)/xb;Ba+=(t-Ba)/xb}function ye(){function b(b,d){b*=I;var f=Math.cos(d*=I),e=f*Math.cos(b),f=f*Math.sin(b),g=Math.sin(d),h=Math.atan2(Math.sqrt((h=t*g-a*f)*h+(h=a*e-k*g)*h+(h=k*f-t*e)*h),k*e+t*f+a*g);lb+=h;pa+=h*(k+(k=e));qa+=h*(t+(t=f));ka+=h*(a+(a=g));wb(k,t,a)}var k,t,a;wa.point=function(d,f){d*=I;var e=Math.cos(f*=I);k=e*Math.cos(d);t=e*Math.sin(d);a=Math.sin(f);wa.point=b;wb(k,t,a)}}function ze(){wa.point=
ad}function Yg(){function b(b,k){b*=I;var t=Math.cos(k*=I),e=t*Math.cos(b),t=t*Math.sin(b),g=Math.sin(k),h=d*g-f*t,l=f*e-a*g,n=a*t-d*e,m=Math.sqrt(h*h+l*l+n*n),p=a*e+d*t+f*g,q=m&&-be(p)/m,m=Math.atan2(m,p);Qa+=q*h;Ra+=q*l;Ca+=q*n;lb+=m;pa+=m*(a+(a=e));qa+=m*(d+(d=t));ka+=m*(f+(f=g));wb(a,d,f)}var k,t,a,d,f;wa.point=function(e,g){k=e;t=g;wa.point=b;e*=I;var h=Math.cos(g*=I);a=h*Math.cos(e);d=h*Math.sin(e);f=Math.sin(g);wb(a,d,f)};wa.lineEnd=function(){b(k,t);wa.lineEnd=ze;wa.point=ad}}function mb(){return!0}
function Ae(b,k,t,a,d){var f=[],e=[];if(b.forEach(function(b){if(!(0>=(k=b.length-1))){var k,a=b[0],t=b[k];if(ac(a,t)){d.lineStart();for(t=0;k>t;++t)d.point((a=b[t])[0],a[1]);return d.lineEnd(),void 0}k=new bc(a,b,null,!0);a=new bc(a,null,k,!1);k.o=a;f.push(k);e.push(a);k=new bc(t,b,null,!1);a=new bc(t,null,k,!0);k.o=a;f.push(k);e.push(a)}}),e.sort(k),Be(f),Be(e),f.length){b=0;k=t;for(t=e.length;t>b;++b)e[b].e=k=!k;for(var g,h=f[0];;){for(var l=h,n=!0;l.v;)if((l=l.n)===h)return;k=l.z;d.lineStart();
do{if(l.v=l.o.v=!0,l.e){if(n)for(b=0,t=k.length;t>b;++b)d.point((g=k[b])[0],g[1]);else a(l.x,l.n.x,1,d);l=l.n}else{if(n)for(k=l.p.z,b=k.length-1;0<=b;--b)d.point((g=k[b])[0],g[1]);else a(l.x,l.p.x,-1,d);l=l.p}l=l.o;k=l.z;n=!n}while(!l.v);d.lineEnd()}}}function Be(b){if(k=b.length){for(var k,a,d=0,f=b[0];++d<k;)f.n=a=b[d],a.p=f,f=a;f.n=a=b[0];a.p=f}}function bc(b,k,a,d){this.x=b;this.z=k;this.o=a;this.e=d;this.v=!1;this.n=this.p=null}function Ce(b,k,a,d){return function(f,e){function g(k,a){var t=
f(k,a);b(k=t[0],a=t[1])&&e.point(k,a)}function h(b,k){var a=f(b,k);w.point(a[0],a[1])}function l(){N.point=h;w.lineStart()}function n(){N.point=g;w.lineEnd()}function m(b,k){fa.push([b,k]);var a=f(b,k);y.point(a[0],a[1])}function p(){y.lineStart();fa=[]}function q(){m(fa[0][0],fa[0][1]);y.lineEnd();var b;b=y.clean();var k=P.buffer(),a=k.length;if(fa.pop(),x.push(fa),fa=null,a)if(1&b){b=k[0];var t,a=b.length-1,k=-1;if(0<a){D||(e.polygonStart(),D=!0);for(e.lineStart();++k<a;)e.point((t=b[k])[0],t[1]);
e.lineEnd()}}else 1<a&&2&b&&k.push(k.pop().concat(k.shift())),r.push(k.filter(Zg))}var r,x,fa,w=k(e),V=f.invert(d[0],d[1]),N={point:g,lineStart:l,lineEnd:n,polygonStart:function(){N.point=m;N.lineStart=p;N.lineEnd=q;r=[];x=[]},polygonEnd:function(){N.point=g;N.lineStart=l;N.lineEnd=n;r=v.merge(r);var b,k=V;b=x;var d=k[0],f=k[1],O=[Math.sin(d),-Math.cos(d),0],E=0,h=0;Za.reset();for(var Y=0,m=b.length;m>Y;++Y){var p=b[Y],q=p.length;if(q)for(var T=p[0],sa=T[0],k=T[1]/2+J/4,Pa=Math.sin(k),fa=Math.cos(k),
P=1;;){P===q&&(P=0);var k=p[P],w=k[0],y=k[1]/2+J/4,qe=Math.sin(y),y=Math.cos(y),Q=w-sa,z=0<=Q?1:-1,F=z*Q,A=F>J,Pa=Pa*qe;if(Za.add(Math.atan2(Pa*z*Math.sin(F),fa*y+Pa*Math.cos(F))),E+=A?Q+z*na:Q,A^sa>=d^w>=d)T=kb($a(T),$a(k)),Zb(T),sa=kb(O,T),Zb(sa),sa=(A^0<=Q?-1:1)*hb(sa[2]),(f>sa||f===sa&&(T[0]||T[1]))&&(h+=A^0<=Q?1:-1);if(!P++)break;sa=w;Pa=qe;fa=y;T=k}}b=(-C>E||C>E&&0>Za)^1&h;r.length?(D||(e.polygonStart(),D=!0),Ae(r,$g,b,a,e)):b&&(D||(e.polygonStart(),D=!0),e.lineStart(),a(null,null,1,e),e.lineEnd());
D&&(e.polygonEnd(),D=!1);r=x=null},sphere:function(){e.polygonStart();e.lineStart();a(null,null,1,e);e.lineEnd();e.polygonEnd()}},P=De(),y=k(P),D=!1;return N}}function Zg(b){return 1<b.length}function De(){var b,k=[];return{lineStart:function(){k.push(b=[])},point:function(k,a){b.push([k,a])},lineEnd:M,buffer:function(){var a=k;return k=[],b=null,a},rejoin:function(){1<k.length&&k.push(k.pop().concat(k.shift()))}}}function $g(b,k){return(0>(b=b.x)[0]?b[1]-da-C:da-b[1])-(0>(k=k.x)[0]?k[1]-da-C:da-
k[1])}function ah(b){function k(b,k){return Math.cos(b)*Math.cos(k)>f}function a(b,k,t){var d=$a(b),e=$a(k),O=[1,0,0],e=kb(d,e),G=Xb(e,e),d=e[0],g=G-d*d;if(!g)return!t&&b;G=f*G/g;g=-f*d/g;d=kb(O,e);O=Yb(O,G);e=Yb(e,g);$c(O,e);e=Xb(O,d);G=Xb(d,d);g=e*e-G*(Xb(O,O)-1);if(!(0>g)){var h=Math.sqrt(g),g=Yb(d,(-e-h)/G);if($c(g,O),g=$b(g),!t)return g;var l;t=b[0];var Y=k[0];b=b[1];k=k[1];t>Y&&(l=t,t=Y,Y=l);var n=Y-t,Z=L(n-J)<C,m=Z||C>n;if(!Z&&b>k&&(l=b,b=k,k=l),m?Z?0<b+k^g[1]<(L(g[0]-t)<C?b:k):b<=g[1]&&g[1]<=
k:n>J^(t<=g[0]&&g[0]<=Y))return l=Yb(d,(-e+h)/G),$c(l,O),[g,$b(l)]}}function d(k,a){var t=e?b:J-b,f=0;return-t>k?f|=1:k>t&&(f|=2),-t>a?f|=4:a>t&&(f|=8),f}var f=Math.cos(b),e=0<f,g=L(f)>C,h=bd(b,6*I);return Ce(k,function(b){var f,E,h,l,Y;return{lineStart:function(){l=h=!1;Y=1},point:function(n,m){var p,q=[n,m],r=k(n,m),v=e?r?0:d(n,m):r?d(n+(0>n?J:-J),m):0;if(!f&&(l=h=r)&&b.lineStart(),r!==h&&(p=a(f,q),(ac(f,p)||ac(q,p))&&(q[0]+=C,q[1]+=C,r=k(q[0],q[1]))),r!==h)Y=0,r?(b.lineStart(),p=a(q,f),b.point(p[0],
p[1])):(p=a(f,q),b.point(p[0],p[1]),b.lineEnd()),f=p;else if(g&&f&&e^r){var x;v&E||!(x=a(q,f,!0))||(Y=0,e?(b.lineStart(),b.point(x[0][0],x[0][1]),b.point(x[1][0],x[1][1]),b.lineEnd()):(b.point(x[1][0],x[1][1]),b.lineEnd(),b.lineStart(),b.point(x[0][0],x[0][1])))}!r||f&&ac(f,q)||b.point(q[0],q[1]);f=q;h=r;E=v},lineEnd:function(){h&&b.lineEnd();f=null},clean:function(){return Y|(l&&h)<<1}}},h,e?[0,-b]:[-J,b-J])}function Ee(b,k,a,d){return function(f){var e,g=f.a,h=f.b,l=g.x,g=g.y,n=0,m=1,q=h.x-l,h=
h.y-g;if(e=b-l,q||!(0<e)){if(e/=q,0>q){if(n>e)return;m>e&&(m=e)}else if(0<q){if(e>m)return;e>n&&(n=e)}if(e=a-l,q||!(0>e)){if(e/=q,0>q){if(e>m)return;e>n&&(n=e)}else if(0<q){if(n>e)return;m>e&&(m=e)}if(e=k-g,h||!(0<e)){if(e/=h,0>h){if(n>e)return;m>e&&(m=e)}else if(0<h){if(e>m)return;e>n&&(n=e)}if(e=d-g,h||!(0>e)){if(e/=h,0>h){if(e>m)return;e>n&&(n=e)}else if(0<h){if(n>e)return;m>e&&(m=e)}return 0<n&&(f.a={x:l+n*q,y:g+n*h}),1>m&&(f.b={x:l+m*q,y:g+m*h}),f}}}}}}function Fe(b,k,a,d){function f(d,e){return L(d[0]-
b)<C?0<e?0:3:L(d[0]-a)<C?0<e?2:1:L(d[1]-k)<C?0<e?1:0:0<e?3:2}function e(b,k){return g(b.x,k.x)}function g(b,k){var a=f(b,1),t=f(k,1);return a!==t?a-t:0===a?k[1]-b[1]:1===a?b[0]-k[0]:2===a?b[1]-k[1]:k[0]-b[0]}return function(h){function l(e,G,h,Y){var n=0,m=0;if(null==e||(n=f(e,h))!==(m=f(G,h))||0>g(e,G)^0<h){do Y.point(0===n||3===n?b:a,1<n?d:k);while((n=(n+h+4)%4)!==m)}else Y.point(G[0],G[1])}function n(f,e){f>=b&&a>=f&&e>=k&&d>=e&&h.point(f,e)}function m(f,e){f=Math.max(-cc,Math.min(cc,f));e=Math.max(-cc,
Math.min(cc,e));var g=f>=b&&a>=f&&e>=k&&d>=e;if(p&&r.push([f,e]),Q)x=f,fa=e,w=g,Q=!1,g&&(h.lineStart(),h.point(f,e));else if(g&&P)h.point(f,e);else{var G={a:{x:y,y:N},b:{x:f,y:e}};Hg(G)?(P||(h.lineStart(),h.point(G.a.x,G.a.y)),h.point(G.b.x,G.b.y),g||h.lineEnd(),D=!1):g&&(h.lineStart(),h.point(f,e),D=!1)}y=f;N=e;P=g}var q,p,r,x,fa,w,y,N,P,Q,D,z=h,la=De(),Hg=Ee(b,k,a,d),Xc={point:n,lineStart:function(){Xc.point=m;p&&p.push(r=[]);Q=!0;P=!1;y=N=0/0},lineEnd:function(){q&&(m(x,fa),w&&P&&la.rejoin(),q.push(la.buffer()));
Xc.point=n;P&&h.lineEnd()},polygonStart:function(){h=la;q=[];p=[];D=!0},polygonEnd:function(){h=z;q=v.merge(q);var k;k=[b,d];for(var a=0,t=p.length,f=k[1],g=0;t>g;++g)for(var E,n=1,m=p[g],Z=m.length,ta=m[0];Z>n;++n)E=m[n],ta[1]<=f?E[1]>f&&0<Mc(ta,E,k)&&++a:E[1]<=f&&0>Mc(ta,E,k)&&--a,ta=E;k=0!==a;a=D&&k;t=q.length;(a||t)&&(h.polygonStart(),a&&(h.lineStart(),l(null,null,1,h),h.lineEnd()),t&&Ae(q,e,k,l,h),h.polygonEnd());q=p=r=null}};return Xc}}function Ge(b,k){function a(t,d){return t=b(t,d),k(t[0],
t[1])}return b.invert&&k.invert&&(a.invert=function(a,t){return a=k.invert(a,t),a&&b.invert(a[0],a[1])}),a}function cd(b){var k=0,a=J/3,d=dd(b);b=d(k,a);return b.parallels=function(b){return arguments.length?d(k=b[0]*J/180,a=b[1]*J/180):[k/J*180,a/J*180]},b}function He(b,k){function a(b,k){var t=Math.sqrt(e-2*f*Math.sin(k))/f;return[t*Math.sin(b*=f),g-t*Math.cos(b)]}var d=Math.sin(b),f=(d+Math.sin(k))/2,e=1+d*(2*f-d),g=Math.sqrt(e)/f;return a.invert=function(b,k){var a=g-k;return[Math.atan2(b,a)/
f,hb((e-(b*b+a*a)*f*f)/(2*f))]},a}function bh(){function b(b,k){dc+=f*b-d*k;d=b;f=k}var k,a,d,f;Sa.point=function(e,g){Sa.point=b;k=d=e;a=f=g};Sa.lineEnd=function(){b(k,a)}}function ch(){function b(b,k){g.push("M",b,",",k,e)}function k(b,k){g.push("M",b,",",k);h.point=a}function a(b,k){g.push("L",b,",",k)}function d(){h.point=b}function f(){g.push("Z")}var e=Ie(4.5),g=[],h={point:b,lineStart:function(){h.point=k},lineEnd:d,polygonStart:function(){h.lineEnd=f},polygonEnd:function(){h.lineEnd=d;h.point=
b},pointRadius:function(b){return e=Ie(b),h},result:function(){if(g.length){var b=g.join("");return g=[],b}}};return h}function Ie(b){return"m0,"+b+"a"+b+","+b+" 0 1,1 0,"+-2*b+"a"+b+","+b+" 0 1,1 0,"+2*b+"z"}function ab(b,k){Ja+=b;Ka+=k;++Ba}function Je(){function b(b,d){var f=b-k,e=d-a,f=Math.sqrt(f*f+e*e);pa+=f*(k+b)/2;qa+=f*(a+d)/2;ka+=f;ab(k=b,a=d)}var k,a;xa.point=function(d,f){xa.point=b;ab(k=d,a=f)}}function Ke(){xa.point=ab}function dh(){function b(b,k){var a=b-d,t=k-f,a=Math.sqrt(a*a+t*
t);pa+=a*(d+b)/2;qa+=a*(f+k)/2;ka+=a;a=f*b-d*k;Qa+=a*(d+b);Ra+=a*(f+k);Ca+=3*a;ab(d=b,f=k)}var k,a,d,f;xa.point=function(e,g){xa.point=b;ab(k=d=e,a=f=g)};xa.lineEnd=function(){b(k,a)}}function eh(b){function k(k,a){b.moveTo(k,a);b.arc(k,a,g,0,na)}function a(k,t){b.moveTo(k,t);h.point=d}function d(k,a){b.lineTo(k,a)}function f(){h.point=k}function e(){b.closePath()}var g=4.5,h={point:k,lineStart:function(){h.point=a},lineEnd:f,polygonStart:function(){h.lineEnd=e},polygonEnd:function(){h.lineEnd=f;
h.point=k},pointRadius:function(b){return g=b,h},result:M};return h}function Le(b){function k(b){return(h?d:a)(b)}function a(k){return Me(k,function(a,t){a=b(a,t);k.point(a[0],a[1])})}function d(k){function a(t,d){t=b(t,d);k.point(t[0],t[1])}function t(){x=0/0;A.point=e;k.lineStart()}function e(a,t){var d=$a([a,t]),g=b(a,t);f(x,w,v,y,z,F,x=g[0],w=g[1],v=a,y=d[0],z=d[1],F=d[2],h,k);k.point(x,w)}function g(){A.point=a;k.lineEnd()}function O(){t();A.point=G;A.lineEnd=l}function G(b,k){e(n=b,k);m=x;Z=
w;q=y;p=z;r=F;A.point=e}function l(){f(x,w,v,y,z,F,m,Z,n,q,p,r,h,k);A.lineEnd=g;g()}var n,m,Z,q,p,r,v,x,w,y,z,F,A={point:a,lineStart:t,lineEnd:g,polygonStart:function(){k.polygonStart();A.lineStart=O},polygonEnd:function(){k.polygonEnd();A.lineStart=t}};return A}function f(k,a,t,d,O,h,l,n,Y,m,q,p,r,v){var x=l-k,w=n-a,y=x*x+w*w;if(y>4*e&&r--){var z=d+m,F=O+q,A=h+p,M=Math.sqrt(z*z+F*F+A*A),jb=Math.asin(A/=M),B=L(L(A)-1)<C||L(t-Y)<C?(t+Y)/2:Math.atan2(F,z),H=b(B,jb),jb=H[0],H=H[1],ba=jb-k,I=H-a,J=w*
ba-x*I;(J*J/y>e||.3<L((x*ba+w*I)/y-.5)||g>d*m+O*q+h*p)&&(f(k,a,t,d,O,h,jb,H,B,z/=M,F/=M,A,r,v),v.point(jb,H),f(jb,H,B,z,F,A,l,n,Y,m,q,p,r,v))}}var e=.5,g=Math.cos(30*I),h=16;return k.precision=function(b){return arguments.length?(h=0<(e=b*b)&&16,k):Math.sqrt(e)},k}function fh(b){var k=Le(function(k,a){return b([k*U,a*U])});return function(b){return Ne(k(b))}}function Oe(b){this.stream=b}function Me(b,k){return{point:k,sphere:function(){b.sphere()},lineStart:function(){b.lineStart()},lineEnd:function(){b.lineEnd()},
polygonStart:function(){b.polygonStart()},polygonEnd:function(){b.polygonEnd()}}}function Ta(b){return dd(function(){return b})()}function dd(b){function k(b){return b=h(b[0]*I,b[1]*I),[b[0]*p+l,n-b[1]*p]}function a(b){return b=h.invert((b[0]-l)/p,(n-b[1])/p),b&&[b[0]*U,b[1]*U]}function d(){h=Ge(g=ed(V,N,P),e);var b=e(w,y);return l=r-b[0]*p,n=x+b[1]*p,f()}function f(){return m&&(m.valid=!1,m=null),k}var e,g,h,l,n,m,q=Le(function(b,k){return b=e(b,k),[b[0]*p+l,n-b[1]*p]}),p=150,r=480,x=250,w=0,y=0,
V=0,N=0,P=0,Q=Pe,z=ca,Aa=null,la=null;return k.stream=function(b){return m&&(m.valid=!1),m=Ne(Q(g,q(z(b)))),m.valid=!0,m},k.clipAngle=function(b){return arguments.length?(Q=null==b?(Aa=b,Pe):ah((Aa=+b)*I),f()):Aa},k.clipExtent=function(b){return arguments.length?(la=b,z=b?Fe(b[0][0],b[0][1],b[1][0],b[1][1]):ca,f()):la},k.scale=function(b){return arguments.length?(p=+b,d()):p},k.translate=function(b){return arguments.length?(r=+b[0],x=+b[1],d()):[r,x]},k.center=function(b){return arguments.length?
(w=b[0]%360*I,y=b[1]%360*I,d()):[w*U,y*U]},k.rotate=function(b){return arguments.length?(V=b[0]%360*I,N=b[1]%360*I,P=2<b.length?b[2]%360*I:0,d()):[V*U,N*U,P*U]},v.rebind(k,q,"precision"),function(){return e=b.apply(this,arguments),k.invert=e.invert&&a,d()}}function Ne(b){return Me(b,function(k,a){b.point(k*I,a*I)})}function yb(b,k){return[b,k]}function Qe(b,k){return[b>J?b-na:-J>b?b+na:b,k]}function ed(b,k,a){return b?k||a?Ge(Re(b),Se(k,a)):Re(b):k||a?Se(k,a):Qe}function Te(b){return function(k,a){return k+=
b,[k>J?k-na:-J>k?k+na:k,a]}}function Re(b){var k=Te(b);return k.invert=Te(-b),k}function Se(b,k){function a(b,k){var t=Math.cos(k),h=Math.cos(b)*t,t=Math.sin(b)*t,l=Math.sin(k),n=l*d+h*f;return[Math.atan2(t*e-n*g,h*d-l*f),hb(n*e+t*g)]}var d=Math.cos(b),f=Math.sin(b),e=Math.cos(k),g=Math.sin(k);return a.invert=function(b,k){var a=Math.cos(k),t=Math.cos(b)*a,a=Math.sin(b)*a,h=Math.sin(k),l=h*e-a*g;return[Math.atan2(a*e+h*g,t*d+l*f),hb(l*d-t*f)]},a}function bd(b,k){var a=Math.cos(b),d=Math.sin(b);return function(f,
e,g,h){var l=g*k;null!=f?(f=Ue(a,f),e=Ue(a,e),(0<g?e>f:f>e)&&(f+=g*na)):(f=b+g*na,e=b-.5*l);for(var n;0<g?f>e:e>f;f-=l)h.point((n=$b([a,-d*Math.cos(f),-d*Math.sin(f)]))[0],n[1])}}function Ue(b,k){var a=$a(k);a[0]-=b;Zb(a);var d=be(-a[1]);return((0>-a[2]?-d:d)+2*Math.PI-C)%(2*Math.PI)}function Ve(b,k,a){var d=v.range(b,k-C,a).concat(k);return function(b){return d.map(function(k){return[b,k]})}}function We(b,k,a){var d=v.range(b,k-C,a).concat(k);return function(b){return d.map(function(k){return[k,
b]})}}function fd(b){return b.source}function gd(b){return b.target}function gh(b,k,a,d){var f=Math.cos(k),e=Math.sin(k),g=Math.cos(d),h=Math.sin(d),l=f*Math.cos(b),n=f*Math.sin(b),m=g*Math.cos(a),q=g*Math.sin(a),p=2*Math.asin(Math.sqrt(de(d-k)+f*g*de(a-b))),r=1/Math.sin(p);a=p?function(b){var k=Math.sin(b*=p)*r,a=Math.sin(p-b)*r;b=a*l+k*m;var d=a*n+k*q,k=a*e+k*h;return[Math.atan2(d,b)*U,Math.atan2(k,Math.sqrt(b*b+d*d))*U]}:function(){return[b*U,k*U]};return a.distance=p,a}function zb(b,k){function a(k,
d){var t=Math.cos(k),f=Math.cos(d),t=b(t*f);return[t*f*Math.sin(k),t*Math.sin(d)]}return a.invert=function(b,a){var d=Math.sqrt(b*b+a*a),t=k(d),f=Math.sin(t),t=Math.cos(t);return[Math.atan2(b*f,d*t),Math.asin(d&&a*f/d)]},a}function Xe(b,k){function a(b,k){0<e?-da+C>k&&(k=-da+C):k>da-C&&(k=da-C);var d=e/Math.pow(Math.tan(J/4+k/2),f);return[d*Math.sin(f*b),e-d*Math.cos(f*b)]}var d=Math.cos(b),f=b===k?Math.sin(b):Math.log(d/Math.cos(k))/Math.log(Math.tan(J/4+k/2)/Math.tan(J/4+b/2)),e=d*Math.pow(Math.tan(J/
4+b/2),f)/f;return f?(a.invert=function(b,k){var a=e-k,d=(0<f?1:0>f?-1:0)*Math.sqrt(b*b+a*a);return[Math.atan2(b,a)/f,2*Math.atan(Math.pow(e/d,1/f))-da]},a):ec}function Ye(b,k){function a(b,k){var d=e-k;return[d*Math.sin(f*b),e-d*Math.cos(f*b)]}var d=Math.cos(b),f=b===k?Math.sin(b):(d-Math.cos(k))/(k-b),e=d/f+b;return L(f)<C?yb:(a.invert=function(b,k){var a=e-k;return[Math.atan2(b,a)/f,e-(0<f?1:0>f?-1:0)*Math.sqrt(b*b+a*a)]},a)}function ec(b,k){return[b,Math.log(Math.tan(J/4+k/2))]}function Ze(b){var k,
a=Ta(b),d=a.scale,f=a.translate,e=a.clipExtent;return a.scale=function(){var b=d.apply(a,arguments);return b===a?k?a.clipExtent(null):a:b},a.translate=function(){var b=f.apply(a,arguments);return b===a?k?a.clipExtent(null):a:b},a.clipExtent=function(b){var g=e.apply(a,arguments);if(g===a){if(k=null==b){var h=J*d(),l=f();e([[l[0]-h,l[1]-h],[l[0]+h,l[1]+h]])}}else k&&(g=null);return g},a.clipExtent(null)}function hd(b,k){return[Math.log(Math.tan(J/4+k/2)),-b]}function nb(b){return b[0]}function Ab(b){return b[1]}
function $e(b){for(var k=b.length,a=[0,1],d=2,f=2;k>f;f++){for(;1<d&&0>=Mc(b[a[d-2]],b[a[d-1]],b[f]);)--d;a[d++]=f}return a.slice(0,d)}function hh(b,k){return b[0]-k[0]||b[1]-k[1]}function id(b,k,a){return(a[0]-k[0])*(b[1]-k[1])<(a[1]-k[1])*(b[0]-k[0])}function af(b,k,a,d){var f=b[0],e=a[0],g=k[0]-f,h=d[0]-e;b=b[1];a=a[1];k=k[1]-b;d=d[1]-a;e=(h*(b-a)-d*(f-e))/(d*g-h*k);return[f+e*g,b+e*k]}function bf(b){var k=b[0];b=b[b.length-1];return!(k[0]-b[0]||k[1]-b[1])}function ih(){fc(this);this.edge=this.site=
this.circle=null}function cf(b){var k=df.pop()||new ih;return k.site=b,k}function jd(b){ob(b);pb.remove(b);df.push(b);fc(b)}function ef(b,k){var a=b.site,d=a.x,f=a.y,e=f-k;if(!e)return d;var g=b.P;if(!g)return-1/0;var a=g.site,g=a.x,a=a.y,h=a-k;if(!h)return g;var l=g-d,n=1/e-1/h,m=l/h;return n?(-m+Math.sqrt(m*m-2*n*(l*l/(-2*h)-a+h/2+f-e/2)))/n+d:(d+g)/2}function ff(b){this.site=b;this.edges=[]}function gf(b,k){return k.angle-b.angle}function jh(){fc(this);this.x=this.y=this.arc=this.site=this.cy=
null}function qb(b){var k=b.P,a=b.N;if(k&&a){var d=k.site,k=b.site,f=a.site;if(d!==f){var a=k.x,e=k.y,g=d.x-a,h=d.y-e,d=f.x-a,f=f.y-e,l=2*(g*f-h*d);if(!(l>=-kd)){var n=g*g+h*h,m=d*d+f*f,h=(f*n-h*m)/l,g=(g*m-d*n)/l,f=g+e,e=hf.pop()||new jh;e.arc=b;e.site=k;e.x=h+a;e.y=f+Math.sqrt(h*h+g*g);e.cy=f;b.circle=e;b=null;for(k=Bb._;k;)if(e.y<k.y||e.y===k.y&&e.x<=k.x){if(!k.L){b=k.P;break}k=k.L}else{if(!k.R){b=k;break}k=k.R}Bb.insert(b,e);b||(ld=e)}}}}function ob(b){var k=b.circle;k&&(k.P||(ld=k.N),Bb.remove(k),
hf.push(k),fc(k),b.circle=null)}function kh(b,k){var a=b.b;if(a)return!0;var d,f,e=b.a,a=k[0][0],g=k[1][0],h=k[0][1],l=k[1][1],n=b.l,m=b.r,q=n.x,n=n.y,p=m.x,m=m.y;f=(q+p)/2;if(m===n){if(a>f||f>=g)return;if(q>p){if(e){if(e.y>=l)return}else e={x:f,y:h};a={x:f,y:l}}else{if(e){if(e.y<h)return}else e={x:f,y:l};a={x:f,y:h}}}else if(d=(q-p)/(m-n),f=(n+m)/2-d*f,-1>d||1<d)if(q>p){if(e){if(e.y>=l)return}else e={x:(h-f)/d,y:h};a={x:(l-f)/d,y:l}}else{if(e){if(e.y<h)return}else e={x:(l-f)/d,y:l};a={x:(h-f)/d,
y:h}}else if(m>n){if(e){if(e.x>=g)return}else e={x:a,y:d*a+f};a={x:g,y:d*g+f}}else{if(e){if(e.x<a)return}else e={x:g,y:d*g+f};a={x:a,y:d*a+f}}return b.a=e,b.b=a,!0}function jf(b,k){this.l=b;this.r=k;this.a=this.b=null}function Cb(b,k,a,d){var f=new jf(b,k);return rb.push(f),a&&gc(f,b,k,a),d&&gc(f,k,b,d),bb[b.i].edges.push(new hc(f,b,k)),bb[k.i].edges.push(new hc(f,k,b)),f}function lh(b,k,a){b=new jf(b,null);return b.a=k,b.b=a,rb.push(b),b}function gc(b,k,a,d){b.a||b.b?b.l===a?b.b=d:b.a=d:(b.a=d,b.l=
k,b.r=a)}function hc(b,k,a){var d=b.a,f=b.b;this.edge=b;this.site=k;this.angle=a?Math.atan2(a.y-k.y,a.x-k.x):b.l===k?Math.atan2(f.x-d.x,d.y-f.y):Math.atan2(d.x-f.x,f.y-d.y)}function md(){this._=null}function fc(b){b.U=b.C=b.L=b.R=b.P=b.N=null}function Db(b,k){var a=k.R,d=k.U;d?d.L===k?d.L=a:d.R=a:b._=a;a.U=d;k.U=a;k.R=a.L;k.R&&(k.R.U=k);a.L=k}function Eb(b,k){var a=k.L,d=k.U;d?d.L===k?d.L=a:d.R=a:b._=a;a.U=d;k.U=a;k.L=a.R;k.L&&(k.L.U=k);a.R=k}function kf(b){for(;b.L;)b=b.L;return b}function nd(b,
k){var a,d,f,e=b.sort(mh).pop();rb=[];bb=Array(b.length);pb=new md;for(Bb=new md;;)if(f=ld,e&&(!f||e.y<f.y||e.y===f.y&&e.x<f.x)){if(e.x!==a||e.y!==d){bb[e.i]=new ff(e);a=e;for(var g=d=void 0,h=void 0,l=void 0,n=a.x,m=a.y,q=pb._;q;)if(h=ef(q,m)-n,h>C)q=q.L;else{var p;var r=q;p=m;var v=r.N;v?p=ef(v,p):(r=r.site,p=r.y===p?r.x:1/0);if(l=n-p,!(l>C)){h>-C?(d=q.P,g=q):l>-C?(d=q,g=q.N):d=g=q;break}if(!q.R){d=q;break}q=q.R}h=cf(a);if(pb.insert(d,h),d||g)if(d===g)ob(d),g=cf(d.site),pb.insert(h,g),h.edge=g.edge=
Cb(d.site,h.site),qb(d),qb(g);else if(g){ob(d);ob(g);l=d.site;m=l.x;q=l.y;p=a.x-m;var r=a.y-q,n=g.site,v=n.x-m,x=n.y-q,w=2*(p*x-r*v),y=p*p+r*r,N=v*v+x*x,m={x:(x*y-r*N)/w+m,y:(p*N-v*y)/w+q};gc(g.edge,l,n,m);h.edge=Cb(l,a,null,m);g.edge=Cb(a,n,null,m);qb(d);qb(g)}else h.edge=Cb(d.site,h.site);a=e.x;d=e.y}e=b.pop()}else{if(!f)break;n=f.arc;g=n.circle;l=g.x;m=g.cy;g={x:l,y:m};p=n.P;q=n.N;h=[n];jd(n);for(n=p;n.circle&&L(l-n.circle.x)<C&&L(m-n.circle.cy)<C;)p=n.P,h.unshift(n),jd(n),n=p;h.unshift(n);ob(n);
for(p=q;p.circle&&L(l-p.circle.x)<C&&L(m-p.circle.cy)<C;)q=p.N,h.push(p),jd(p),p=q;h.push(p);ob(p);l=void 0;m=h.length;for(l=1;m>l;++l)p=h[l],n=h[l-1],gc(p.edge,n.site,p.site,g);n=h[0];p=h[m-1];p.edge=Cb(n.site,p.site,null,g);qb(n);qb(p)}if(k){e=rb;a=Ee(k[0][0],k[0][1],k[1][0],k[1][1]);for(d=e.length;d--;)f=e[d],(!kh(f,k)||!a(f)||L(f.a.x-f.b.x)<C&&L(f.a.y-f.b.y)<C)&&(f.a=f.b=null,e.splice(d,1));var P,n=k[0][0],m=k[1][0],q=k[0][1];p=k[1][1];r=bb;for(v=r.length;v--;)if(P=r[v],P&&P.prepare())for(g=P.edges,
h=g.length,d=0;h>d;)l=g[d].end(),e=l.x,a=l.y,x=g[++d%h].start(),f=x.x,x=x.y,(L(e-f)>C||L(a-x)>C)&&(g.splice(d,0,new hc(lh(P.site,l,L(e-n)<C&&p-a>C?{x:n,y:L(f-n)<C?x:p}:L(a-p)<C&&m-e>C?{x:L(x-p)<C?f:m,y:p}:L(e-m)<C&&a-q>C?{x:m,y:L(f-m)<C?x:q}:L(a-q)<C&&e-n>C?{x:L(x-q)<C?f:n,y:q}:null),P.site,null)),++h)}P={cells:bb,edges:rb};return pb=Bb=rb=bb=null,P}function mh(b,k){return k.y-b.y||k.x-b.x}function nh(b){return b.x}function oh(b){return b.y}function lf(){return{leaf:!0,nodes:[],point:null,x:null,
y:null}}function Fb(b,k,a,d,f,e){if(!b(k,a,d,f,e)){var g=.5*(a+f),h=.5*(d+e);k=k.nodes;k[0]&&Fb(b,k[0],a,d,g,h);k[1]&&Fb(b,k[1],g,d,f,h);k[2]&&Fb(b,k[2],a,h,g,e);k[3]&&Fb(b,k[3],g,h,f,e)}}function od(b,k){b=v.rgb(b);k=v.rgb(k);var a=b.r,d=b.g,f=b.b,e=k.r-a,g=k.g-d,h=k.b-f;return function(b){return"#"+ib(Math.round(a+e*b))+ib(Math.round(d+g*b))+ib(Math.round(f+h*b))}}function mf(b,k){var a,d={},f={};for(a in b)a in k?d[a]=cb(b[a],k[a]):f[a]=b[a];for(a in k)a in b||(f[a]=k[a]);return function(b){for(a in d)f[a]=
d[a](b);return f}}function La(b,k){return b=+b,k=+k,function(a){return b*(1-a)+k*a}}function nf(b,k){var a,d,f,e=pd.lastIndex=qd.lastIndex=0,g=-1,h=[],l=[];b+="";for(k+="";(a=pd.exec(b))&&(d=qd.exec(k));)(f=d.index)>e&&(f=k.slice(e,f),h[g]?h[g]+=f:h[++g]=f),(a=a[0])===(d=d[0])?h[g]?h[g]+=d:h[++g]=d:(h[++g]=null,l.push({i:g,x:La(a,d)})),e=qd.lastIndex;return e<k.length&&(f=k.slice(e),h[g]?h[g]+=f:h[++g]=f),2>h.length?l[0]?(k=l[0].x,function(b){return k(b)+""}):function(){return k}:(k=l.length,function(b){for(var a,
d=0;k>d;++d)h[(a=l[d]).i]=a.x(b);return h.join("")})}function cb(b,k){for(var a,d=v.interpolators.length;0<=--d&&!(a=v.interpolators[d](b,k)););return a}function ic(b,k){var a,d=[],f=[],e=b.length,g=k.length,h=Math.min(b.length,k.length);for(a=0;h>a;++a)d.push(cb(b[a],k[a]));for(;e>a;++a)f[a]=b[a];for(;g>a;++a)f[a]=k[a];return function(b){for(a=0;h>a;++a)f[a]=d[a](b);return f}}function ph(b){return function(k){return 0>=k?0:1<=k?1:b(k)}}function of(b){return function(k){return 1-b(1-k)}}function pf(b){return function(k){return.5*
(.5>k?b(2*k):2-b(2-2*k))}}function qh(b){return b*b}function rh(b){return b*b*b}function sh(b){if(0>=b)return 0;if(1<=b)return 1;var k=b*b,a=k*b;return 4*(.5>b?a:3*(b-k)+a-.75)}function th(b){return 1-Math.cos(b*da)}function uh(b){return Math.pow(2,10*(b-1))}function vh(b){return 1-Math.sqrt(1-b*b)}function wh(b){return 1/2.75>b?7.5625*b*b:2/2.75>b?7.5625*(b-=1.5/2.75)*b+.75:2.5/2.75>b?7.5625*(b-=2.25/2.75)*b+.9375:7.5625*(b-=2.625/2.75)*b+.984375}function qf(b,k){return k-=b,function(a){return Math.round(b+
k*a)}}function rf(b){var k=[b.a,b.b],a=[b.c,b.d],d=sf(k),f=k[0]*a[0]+k[1]*a[1],e;e=-f;e=(a[0]+=e*k[0],a[1]+=e*k[1],a);e=sf(e)||0;k[0]*a[1]<a[0]*k[1]&&(k[0]*=-1,k[1]*=-1,d*=-1,f*=-1);this.rotate=(d?Math.atan2(k[1],k[0]):Math.atan2(-a[0],a[1]))*U;this.translate=[b.e,b.f];this.scale=[d,e];this.skew=e?Math.atan2(f,e)*U:0}function sf(b){var k=Math.sqrt(b[0]*b[0]+b[1]*b[1]);return k&&(b[0]/=k,b[1]/=k),k}function tf(b,k){var a,d=[],f=[],e=v.transform(b),g=v.transform(k),h=e.translate,l=g.translate,n=e.rotate,
m=g.rotate,p=e.skew,q=g.skew,e=e.scale,g=g.scale;return h[0]!=l[0]||h[1]!=l[1]?(d.push("translate(",null,",",null,")"),f.push({i:1,x:La(h[0],l[0])},{i:3,x:La(h[1],l[1])})):l[0]||l[1]?d.push("translate("+l+")"):d.push(""),n!=m?(180<n-m?m+=360:180<m-n&&(n+=360),f.push({i:d.push(d.pop()+"rotate(",null,")")-2,x:La(n,m)})):m&&d.push(d.pop()+"rotate("+m+")"),p!=q?f.push({i:d.push(d.pop()+"skewX(",null,")")-2,x:La(p,q)}):q&&d.push(d.pop()+"skewX("+q+")"),e[0]!=g[0]||e[1]!=g[1]?(a=d.push(d.pop()+"scale(",
null,",",null,")"),f.push({i:a-4,x:La(e[0],g[0])},{i:a-2,x:La(e[1],g[1])})):(1!=g[0]||1!=g[1])&&d.push(d.pop()+"scale("+g+")"),a=f.length,function(b){for(var k,e=-1;++e<a;)d[(k=f[e]).i]=k.x(b);return d.join("")}}function xh(b,k){return k=(k-=b=+b)||1/k,function(a){return(a-b)/k}}function yh(b,k){return k=(k-=b=+b)||1/k,function(a){return Math.max(0,Math.min(1,(a-b)/k))}}function zh(b){var k=b.source;b=b.target;var a;var d=b;if(k===d)a=k;else{a=uf(k);for(var d=uf(d),f=a.pop(),e=d.pop(),g=null;f===
e;)g=f,f=a.pop(),e=d.pop();a=g}for(d=[k];k!==a;)k=k.parent,d.push(k);for(k=d.length;b!==a;)d.splice(k,0,b),b=b.parent;return d}function uf(b){for(var k=[],a=b.parent;null!=a;)k.push(b),b=a,a=a.parent;return k.push(b),k}function Ah(b){b.fixed|=2}function Bh(b){b.fixed&=-7}function Ch(b){b.fixed|=4;b.px=b.x;b.py=b.y}function Dh(b){b.fixed&=-5}function vf(b,k,a){var d=0,f=0;if(b.charge=0,!b.leaf)for(var e,g=b.nodes,h=g.length,l=-1;++l<h;)e=g[l],null!=e&&(vf(e,k,a),b.charge+=e.charge,d+=e.charge*e.cx,
f+=e.charge*e.cy);b.point&&(b.leaf||(b.point.x+=Math.random()-.5,b.point.y+=Math.random()-.5),k*=a[b.point.index],b.charge+=b.pointCharge=k,d+=k*b.point.x,f+=k*b.point.y);b.cx=d/b.charge;b.cy=f/b.charge}function Gb(b,k){return v.rebind(b,k,"sort","children","value"),b.nodes=b,b.links=Eh,b}function Hb(b,k){for(var a=[b];null!=(b=a.pop());)if(k(b),(f=b.children)&&(d=f.length))for(var d,f;0<=--d;)a.push(f[d])}function Da(b,k){for(var a=[b],d=[];null!=(b=a.pop());)if(d.push(b),(e=b.children)&&(f=e.length))for(var f,
e,g=-1;++g<f;)a.push(e[g]);for(;null!=(b=d.pop());)k(b)}function Fh(b){return b.children}function Gh(b){return b.value}function Hh(b,k){return k.value-b.value}function Eh(b){return v.merge(b.map(function(b){return(b.children||[]).map(function(a){return{source:b,target:a}})}))}function Ih(b){return b.x}function Jh(b){return b.y}function Kh(b,k,a){b.y0=k;b.y=a}function rd(b){return v.range(b.length)}function sd(b){var k=-1;b=b[0].length;for(var a=[];++k<b;)a[k]=0;return a}function Lh(b){for(var k,a=
1,d=0,f=b[0][1],e=b.length;e>a;++a)(k=b[a][1])>f&&(d=a,f=k);return d}function Mh(b){return b.reduce(Nh,0)}function Nh(b,k){return b+k[1]}function Oh(b,k){return wf(b,Math.ceil(Math.log(k.length)/Math.LN2+1))}function wf(b,k){for(var a=-1,d=+b[0],f=(b[1]-d)/k,e=[];++a<=k;)e[a]=f*a+d;return e}function Ph(b){return[v.min(b),v.max(b)]}function Qh(b,k){return b.value-k.value}function td(b,k){var a=b._pack_next;b._pack_next=k;k._pack_prev=b;k._pack_next=a;a._pack_prev=k}function xf(b,k){b._pack_next=k;
k._pack_prev=b}function yf(b,k){var a=k.x-b.x,d=k.y-b.y,f=b.r+k.r;return.999*f*f>a*a+d*d}function zf(b){function k(b){m=Math.min(b.x-b.r,m);p=Math.max(b.x+b.r,p);q=Math.min(b.y-b.r,q);r=Math.max(b.y+b.r,r)}if((a=b.children)&&(n=a.length)){var a,d,f,e,g,h,l,n,m=1/0,p=-1/0,q=1/0,r=-1/0;if(a.forEach(Rh),d=a[0],d.x=-d.r,d.y=0,k(d),1<n&&(f=a[1],f.x=f.r,f.y=0,k(f),2<n))for(e=a[2],Af(d,f,e),k(e),td(d,e),d._pack_prev=e,td(e,f),f=d._pack_next,g=3;n>g;g++){Af(d,f,e=a[g]);var v=0,x=1,w=1;for(h=f._pack_next;h!==
f;h=h._pack_next,x++)if(yf(h,e)){v=1;break}if(1==v)for(l=d._pack_prev;l!==h._pack_prev&&!yf(l,e);l=l._pack_prev,w++);v?(w>x||x==w&&f.r<d.r?xf(d,f=h):xf(d=l,f),g--):(td(d,e),f=e,k(e))}d=(m+p)/2;f=(q+r)/2;for(g=h=0;n>g;g++)e=a[g],e.x-=d,e.y-=f,h=Math.max(h,e.r+Math.sqrt(e.x*e.x+e.y*e.y));b.r=h;a.forEach(Sh)}}function Rh(b){b._pack_next=b._pack_prev=b}function Sh(b){delete b._pack_next;delete b._pack_prev}function Bf(b,k,a,d){var f=b.children;if(b.x=k+=d*b.x,b.y=a+=d*b.y,b.r*=d,f){b=-1;for(var e=f.length;++b<
e;)Bf(f[b],k,a,d)}}function Af(b,k,a){var d=b.r+a.r,f=k.x-b.x,e=k.y-b.y;if(d&&(f||e)){var g=k.r+a.r,h=f*f+e*e,g=g*g,d=d*d;k=.5+(d-g)/(2*h);g=Math.sqrt(Math.max(0,2*g*(d+h)-(d-=h)*d-g*g))/(2*h);a.x=b.x+k*f+g*e;a.y=b.y+k*e-g*f}else a.x=b.x+d,a.y=b.y}function Cf(b,k){return b.parent==k.parent?1:2}function ud(b){var k=b.children;return k.length?k[0]:b.t}function vd(b){var k,a=b.children;return(k=a.length)?a[k-1]:b.t}function Th(b){return 1+v.max(b,function(b){return b.y})}function Uh(b){return b.reduce(function(b,
a){return b+a.x},0)/b.length}function Df(b){var k=b.children;return k&&k.length?Df(k[0]):b}function Ef(b){var k,a=b.children;return a&&(k=a.length)?Ef(a[k-1]):b}function wd(b){return{x:b.x,y:b.y,dx:b.dx,dy:b.dy}}function Ff(b,k){var a=b.x+k[3],d=b.y+k[0],f=b.dx-k[1]-k[3],e=b.dy-k[0]-k[2];return 0>f&&(a+=f/2,f=0),0>e&&(d+=e/2,e=0),{x:a,y:d,dx:f,dy:e}}function sb(b){var k=b[0];b=b[b.length-1];return b>k?[k,b]:[b,k]}function jc(b){return b.rangeExtent?b.rangeExtent():sb(b.range())}function Vh(b,k,a,
d){var f=a(b[0],b[1]),e=d(k[0],k[1]);return function(b){return e(f(b))}}function kc(b,k){var a,d=0,f=b.length-1,e=b[d],g=b[f];return e>g&&(a=d,d=f,f=a,a=e,e=g,g=a),b[d]=k.floor(e),b[f]=k.ceil(g),b}function Gf(b){return b?{floor:function(k){return Math.floor(k/b)*b},ceil:function(k){return Math.ceil(k/b)*b}}:Wh}function Xh(b,k,a,d){var f=[],e=[],g=0,h=Math.min(b.length,k.length)-1;for(b[h]<b[0]&&(b=b.slice().reverse(),k=k.slice().reverse());++g<=h;)f.push(a(b[g-1],b[g])),e.push(d(k[g-1],k[g]));return function(k){var a=
v.bisect(b,k,1,h)-1;return e[a](f[a](k))}}function Hf(b,k,a,d){function f(){var l=2<Math.min(b.length,k.length)?Xh:Vh,n=d?yh:xh;return g=l(b,k,n,a),h=l(k,b,n,cb),e}function e(b){return g(b)}var g,h;return e.invert=function(b){return h(b)},e.domain=function(k){return arguments.length?(b=k.map(Number),f()):b},e.range=function(b){return arguments.length?(k=b,f()):k},e.rangeRound=function(b){return e.range(b).interpolate(qf)},e.clamp=function(b){return arguments.length?(d=b,f()):d},e.interpolate=function(b){return arguments.length?
(a=b,f()):a},e.ticks=function(k){return v.range.apply(v,Ua(b,k))},e.tickFormat=function(k,a){return xd(b,k,a)},e.nice=function(k){return kc(b,Gf(Ua(b,k)[2])),f()},e.copy=function(){return Hf(b,k,a,d)},f()}function yd(b,k){return v.rebind(b,k,"range","rangeRound","interpolate","clamp")}function Ua(b,k){null==k&&(k=10);var a=sb(b),d=a[1]-a[0],f=Math.pow(10,Math.floor(Math.log(d/k)/Math.LN10)),d=k/d*f;return.15>=d?f*=10:.35>=d?f*=5:.75>=d&&(f*=2),a[0]=Math.ceil(a[0]/f)*f,a[1]=Math.floor(a[1]/f)*f+.5*
f,a[2]=f,a}function xd(b,k,a){b=Ua(b,k);if(a){k=pe.exec(a);if(k.shift(),"s"===k[8]){var d=v.formatPrefix(Math.max(L(b[0]),L(b[1])));return k[7]||(k[7]="."+lc(d.scale(b[2]))),k[8]="f",a=v.format(k.join("")),function(b){return a(d.scale(b))+d.symbol}}k[7]||(k[7]="."+Yh(k[8],b));a=k.join("")}else a=",."+lc(b[2])+"f";return v.format(a)}function lc(b){return-Math.floor(Math.log(b)/Math.LN10+.01)}function Yh(b,k){var a=lc(k[2]);return b in Zh?Math.abs(a-lc(Math.max(L(k[0]),L(k[1]))))+ +("e"!==b):a-2*("%"===
b)}function If(b,k,a,d){function f(b){return(a?Math.log(0>b?0:b):-Math.log(0<b?0:-b))/Math.log(k)}function e(b){return a?Math.pow(k,b):-Math.pow(k,-b)}function g(k){return b(f(k))}return g.invert=function(k){return e(b.invert(k))},g.domain=function(k){return arguments.length?(a=0<=k[0],b.domain((d=k.map(Number)).map(f)),g):d},g.base=function(a){return arguments.length?(k=+a,b.domain(d.map(f)),g):k},g.nice=function(){var k=kc(d.map(f),a?Math:$h);return b.domain(k),d=k.map(e),g},g.ticks=function(){var b=
sb(d),g=[],h=b[0],b=b[1],l=Math.floor(f(h)),n=Math.ceil(f(b)),m=k%1?2:k;if(isFinite(n-l)){if(a){for(;n>l;l++)for(var p=1;m>p;p++)g.push(e(l)*p);g.push(e(l))}else for(g.push(e(l));l++<n;)for(p=m-1;0<p;p--)g.push(e(l)*p);for(l=0;g[l]<h;l++);for(n=g.length;g[n-1]>b;n--);g=g.slice(l,n)}return g},g.tickFormat=function(b,k){if(!arguments.length)return Jf;2>arguments.length?k=Jf:"function"!=typeof k&&(k=v.format(k));var d,h=Math.max(.1,b/g.ticks().length),l=a?(d=1E-12,Math.ceil):(d=-1E-12,Math.floor);return function(b){return b/
e(l(f(b)+d))<=h?k(b):""}},g.copy=function(){return If(b.copy(),k,a,d)},yd(g,b)}function Kf(b,k,a){function d(k){return b(f(k))}var f=mc(k),e=mc(1/k);return d.invert=function(k){return e(b.invert(k))},d.domain=function(k){return arguments.length?(b.domain((a=k.map(Number)).map(f)),d):a},d.ticks=function(b){return v.range.apply(v,Ua(a,b))},d.tickFormat=function(b,k){return xd(a,b,k)},d.nice=function(b){return d.domain(kc(a,Gf(Ua(a,b)[2])))},d.exponent=function(g){return arguments.length?(f=mc(k=g),
e=mc(1/k),b.domain(a.map(f)),d):k},d.copy=function(){return Kf(b.copy(),k,a)},yd(d,b)}function mc(b){return function(k){return 0>k?-Math.pow(-k,b):Math.pow(k,b)}}function Lf(b,k){function a(d){return e[((f.get(d)||("range"===k.t?f.set(d,b.push(d)):0/0))-1)%e.length]}function d(a,k){return v.range(b.length).map(function(b){return a+k*b})}var f,e,g;return a.domain=function(d){if(!arguments.length)return b;b=[];f=new l;for(var e,g=-1,h=d.length;++g<h;)f.has(e=d[g])||f.set(e,b.push(e));return a[k.t].apply(a,
k.a)},a.range=function(b){return arguments.length?(e=b,g=0,k={t:"range",a:arguments},a):e},a.rangePoints=function(f,h){2>arguments.length&&(h=0);var l=f[0],n=f[1],m=(n-l)/(Math.max(1,b.length-1)+h);return e=d(2>b.length?(l+n)/2:l+m*h/2,m),g=0,k={t:"rangePoints",a:arguments},a},a.rangeBands=function(f,h,l){2>arguments.length&&(h=0);3>arguments.length&&(l=h);var n=f[1]<f[0],m=f[n-0],E=(f[1-n]-m)/(b.length-h+2*l);return e=d(m+E*l,E),n&&e.reverse(),g=E*(1-h),k={t:"rangeBands",a:arguments},a},a.rangeRoundBands=
function(f,h,l){2>arguments.length&&(h=0);3>arguments.length&&(l=h);var n=f[1]<f[0],m=f[n-0],E=f[1-n],p=Math.floor((E-m)/(b.length-h+2*l));return e=d(m+Math.round((E-m-(b.length-h)*p)/2),p),n&&e.reverse(),g=Math.round(p*(1-h)),k={t:"rangeRoundBands",a:arguments},a},a.rangeBand=function(){return g},a.rangeExtent=function(){return sb(k.a[0])},a.copy=function(){return Lf(b,k)},a.domain(b)}function Mf(b,a){function d(){var e=0,g=a.length;for(l=[];++e<g;)l[e-1]=v.quantile(b,e/g);return f}function f(b){return isNaN(b=
+b)?void 0:a[v.bisect(l,b)]}var l;return f.domain=function(a){return arguments.length?(b=a.map(g).filter(e).sort(h),d()):b},f.range=function(b){return arguments.length?(a=b,d()):a},f.quantiles=function(){return l},f.invertExtent=function(d){return d=a.indexOf(d),0>d?[0/0,0/0]:[0<d?l[d-1]:b[0],d<l.length?l[d]:b[b.length-1]]},f.copy=function(){return Mf(b,a)},d()}function Nf(b,a,d){function f(a){return d[Math.max(0,Math.min(h,Math.floor(g*(a-b))))]}function e(){return g=d.length/(a-b),h=d.length-1,
f}var g,h;return f.domain=function(d){return arguments.length?(b=+d[0],a=+d[d.length-1],e()):[b,a]},f.range=function(b){return arguments.length?(d=b,e()):d},f.invertExtent=function(a){return a=d.indexOf(a),a=0>a?0/0:a/g+b,[a,a+1/g]},f.copy=function(){return Nf(b,a,d)},e()}function Of(b,a){function d(f){return f>=f?a[v.bisect(b,f)]:void 0}return d.domain=function(a){return arguments.length?(b=a,d):b},d.range=function(b){return arguments.length?(a=b,d):a},d.invertExtent=function(d){return d=a.indexOf(d),
[b[d-1],b[d]]},d.copy=function(){return Of(b,a)},d}function Pf(b){function a(b){return+b}return a.invert=a,a.domain=a.range=function(d){return arguments.length?(b=d.map(a),a):b},a.ticks=function(a){return v.range.apply(v,Ua(b,a))},a.tickFormat=function(a,k){return xd(b,a,k)},a.copy=function(){return Pf(b)},a}function ai(b){return b.innerRadius}function bi(b){return b.outerRadius}function Qf(b){return b.startAngle}function Rf(b){return b.endAngle}function Sf(b){function a(k){function h(){m.push("M",
g(b(p),l))}for(var n,m=[],p=[],q=-1,r=k.length,v=S(d),Z=S(f);++q<r;)e.call(this,n=k[q],q)?p.push([+v.call(this,n,q),+Z.call(this,n,q)]):p.length&&(h(),p=[]);return p.length&&h(),m.length?m.join(""):null}var d=nb,f=Ab,e=mb,g=oa,h=g.key,l=.7;return a.x=function(b){return arguments.length?(d=b,a):d},a.y=function(b){return arguments.length?(f=b,a):f},a.defined=function(b){return arguments.length?(e=b,a):e},a.interpolate=function(b){return arguments.length?(h="function"==typeof b?g=b:(g=zd.get(b)||oa).key,
a):h},a.tension=function(b){return arguments.length?(l=b,a):l},a}function oa(b){return b.join("L")}function Ad(b){for(var a=0,d=b.length,f=b[0],e=[f[0],",",f[1]];++a<d;)e.push("V",(f=b[a])[1],"H",f[0]);return e.join("")}function Bd(b){for(var a=0,d=b.length,f=b[0],e=[f[0],",",f[1]];++a<d;)e.push("H",(f=b[a])[0],"V",f[1]);return e.join("")}function nc(b,a){if(1>a.length||b.length!=a.length&&b.length!=a.length+2)return oa(b);var d=b.length!=a.length,f="",e=b[0],g=b[1],h=a[0],l=h,n=1;if(d&&(f+="Q"+(g[0]-
2*h[0]/3)+","+(g[1]-2*h[1]/3)+","+g[0]+","+g[1],e=b[1],n=2),1<a.length)for(l=a[1],g=b[n],n++,f+="C"+(e[0]+h[0])+","+(e[1]+h[1])+","+(g[0]-l[0])+","+(g[1]-l[1])+","+g[0]+","+g[1],e=2;e<a.length;e++,n++)g=b[n],l=a[e],f+="S"+(g[0]-l[0])+","+(g[1]-l[1])+","+g[0]+","+g[1];d&&(d=b[n],f+="Q"+(g[0]+2*l[0]/3)+","+(g[1]+2*l[1]/3)+","+d[0]+","+d[1]);return f}function Cd(b,a){for(var d,f=[],e=(1-a)/2,g=b[0],h=b[1],l=1,n=b.length;++l<n;)d=g,g=h,h=b[l],f.push([e*(h[0]-d[0]),e*(h[1]-d[1])]);return f}function Tf(b){if(3>
b.length)return oa(b);var a=1,d=b.length,f=b[0],e=f[0],g=f[1],h=[e,e,e,(f=b[1])[0]],l=[g,g,g,f[1]],e=[e,",",g,"L",ra(Va,h),",",ra(Va,l)];for(b.push(b[d-1]);++a<=d;)f=b[a],h.shift(),h.push(f[0]),l.shift(),l.push(f[1]),Dd(e,h,l);return b.pop(),e.push("L",f),e.join("")}function ra(b,a){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]*a[3]}function Dd(b,a,d){b.push("C",ra(Uf,a),",",ra(Uf,d),",",ra(Vf,a),",",ra(Vf,d),",",ra(Va,a),",",ra(Va,d))}function Ed(b,a){return(a[1]-b[1])/(a[0]-b[0])}function Wf(b){for(var a,
d,f,e=-1,g=b.length;++e<g;)a=b[e],d=a[0],f=a[1]+db,a[0]=d*Math.cos(f),a[1]=d*Math.sin(f);return b}function Xf(b){function a(k){function n(){x.push("M",l(b(P),q),p,m(b(w.reverse()),q),"Z")}for(var r,v,Vd,x=[],w=[],P=[],y=-1,z=k.length,Aa=S(d),la=S(e),F=d===f?function(){return v}:S(f),A=e===g?function(){return Vd}:S(g);++y<z;)h.call(this,r=k[y],y)?(w.push([v=+Aa.call(this,r,y),Vd=+la.call(this,r,y)]),P.push([+F.call(this,r,y),+A.call(this,r,y)])):w.length&&(n(),w=[],P=[]);return w.length&&n(),x.length?
x.join(""):null}var d=nb,f=nb,e=0,g=Ab,h=mb,l=oa,n=l.key,m=l,p="L",q=.7;return a.x=function(b){return arguments.length?(d=f=b,a):f},a.x0=function(b){return arguments.length?(d=b,a):d},a.x1=function(b){return arguments.length?(f=b,a):f},a.y=function(b){return arguments.length?(e=g=b,a):g},a.y0=function(b){return arguments.length?(e=b,a):e},a.y1=function(b){return arguments.length?(g=b,a):g},a.defined=function(b){return arguments.length?(h=b,a):h},a.interpolate=function(b){return arguments.length?(n=
"function"==typeof b?l=b:(l=zd.get(b)||oa).key,m=l.reverse||l,p=l.closed?"M":"L",a):n},a.tension=function(b){return arguments.length?(q=b,a):q},a}function ci(b){return b.radius}function Yf(b){return[b.x,b.y]}function di(b){return function(){var a=b.apply(this,arguments),d=a[0],a=a[1]+db;return[d*Math.cos(a),d*Math.sin(a)]}}function ei(){return 64}function fi(){return"circle"}function Zf(b){b=Math.sqrt(b/J);return"M0,"+b+"A"+b+","+b+" 0 1,1 0,"+-b+"A"+b+","+b+" 0 1,1 0,"+b+"Z"}function Ib(b,a){return Jb(b,
aa),b.id=a,b}function Fd(b,a,d,f){var e=b.id;return Ea(b,"function"==typeof d?function(b,g,h){b.__transition__[e].tween.set(a,f(d.call(b,b.__data__,g,h)))}:(d=f(d),function(b){b.__transition__[e].tween.set(a,d)}))}function gi(b){return null==b&&(b=""),function(){this.textContent=b}}function oc(b,a,d,f){var e=b.__transition__||(b.__transition__={active:0,count:0}),g=e[d];if(!g){var h=f.time,g=e[d]={tween:new l,time:h,ease:f.ease,delay:f.delay,duration:f.duration};++e.count;v.timer(function(f){function l(f){return e.active>
d?m():(e.active=d,g.event&&g.event.start.call(b,O,a),g.tween.forEach(function(d,f){(f=f.call(b,O,a))&&w.push(f)}),v.timer(function(){return x.c=n(f||1)?mb:n,1},0,h),void 0)}function n(f){if(e.active!==d)return m();f/=r;for(var h=p(f),l=w.length;0<l;)w[--l].call(b,h);return 1<=f?(g.event&&g.event.end.call(b,O,a),m()):void 0}function m(){return--e.count?delete e[d]:delete b.__transition__,1}var O=b.__data__,p=g.ease,q=g.delay,r=g.duration,x=Ha,w=[];return x.t=q+h,f>=q?l(f-q):(x.c=l,void 0)},0,h)}}function hi(b,
a,d){b.attr("transform",function(b){var f=a(b);return"translate("+(isFinite(f)?f:d(b))+",0)"})}function ii(b,a,d){b.attr("transform",function(b){var f=a(b);return"translate(0,"+(isFinite(f)?f:d(b))+")"})}function Gd(b){return b.toISOString()}function Hd(b,a,d){function f(a){return b(a)}function e(b,d){var f=(b[1]-b[0])/d,g=v.bisect(pc,f);return g==pc.length?[a.year,Ua(b.map(function(b){return b/31536E6}),d)[2]]:g?a[f/pc[g-1]<pc[g]/f?g-1:g]:[ji,Ua(b,d)[2]]}return f.invert=function(a){return eb(b.invert(a))},
f.domain=function(a){return arguments.length?(b.domain(a),f):b.domain().map(eb)},f.nice=function(b,a){function k(d){return!isNaN(d)&&!b.range(d,eb(+d+1),a).length}var d=f.domain(),g=sb(d),g=null==b?e(g,10):"number"==typeof b&&e(g,b);return g&&(b=g[0],a=g[1]),f.domain(kc(d,1<a?{floor:function(a){for(;k(a=b.floor(a));)a=eb(a-1);return a},ceil:function(a){for(;k(a=b.ceil(a));)a=eb(+a+1);return a}}:b))},f.ticks=function(b,a){var k=sb(f.domain()),d=null==b?e(k,10):"number"==typeof b?e(k,b):!b.range&&[{range:b},
a];return d&&(b=d[0],a=d[1]),b.range(k[0],eb(+k[1]+1),1>a?1:a)},f.tickFormat=function(){return d},f.copy=function(){return Hd(b.copy(),a,d)},yd(f,b)}function eb(b){return new Date(b)}function ki(b){return JSON.parse(b.responseText)}function li(b){var a=ya.createRange();return a.selectNode(ya.body),a.createContextualFragment(b.responseText)}var v={version:"3.4.13"};Date.now||(Date.now=function(){return+new Date});var $f=[].slice,Oa=function(b){return $f.call(b)},ya=document,Ga=ya.documentElement,ha=
window;try{Oa(Ga.childNodes)[0].nodeType}catch(Li){Oa=function(b){for(var a=b.length,d=Array(a);a--;)d[a]=b[a];return d}}try{ya.createElement("div").style.setProperty("opacity",0,"")}catch(Mi){var qc=ha.Element.prototype,mi=qc.setAttribute,ni=qc.setAttributeNS,ag=ha.CSSStyleDeclaration.prototype,oi=ag.setProperty;qc.setAttribute=function(b,a){mi.call(this,b,a+"")};qc.setAttributeNS=function(b,a,d){ni.call(this,b,a,d+"")};ag.setProperty=function(b,a,d){oi.call(this,b,a+"",d)}}v.ascending=h;v.descending=
function(b,a){return b>a?-1:a>b?1:a>=b?0:0/0};v.min=function(b,a){var d,f,e=-1,g=b.length;if(1===arguments.length){for(;++e<g&&!(null!=(d=b[e])&&d>=d);)d=void 0;for(;++e<g;)null!=(f=b[e])&&d>f&&(d=f)}else{for(;++e<g&&!(null!=(d=a.call(b,b[e],e))&&d>=d);)d=void 0;for(;++e<g;)null!=(f=a.call(b,b[e],e))&&d>f&&(d=f)}return d};v.max=function(b,a){var d,f,e=-1,g=b.length;if(1===arguments.length){for(;++e<g&&!(null!=(d=b[e])&&d>=d);)d=void 0;for(;++e<g;)null!=(f=b[e])&&f>d&&(d=f)}else{for(;++e<g&&!(null!=
(d=a.call(b,b[e],e))&&d>=d);)d=void 0;for(;++e<g;)null!=(f=a.call(b,b[e],e))&&f>d&&(d=f)}return d};v.extent=function(b,a){var d,f,e,g=-1,h=b.length;if(1===arguments.length){for(;++g<h&&!(null!=(d=e=b[g])&&d>=d);)d=e=void 0;for(;++g<h;)null!=(f=b[g])&&(d>f&&(d=f),f>e&&(e=f))}else{for(;++g<h&&!(null!=(d=e=a.call(b,b[g],g))&&d>=d);)d=void 0;for(;++g<h;)null!=(f=a.call(b,b[g],g))&&(d>f&&(d=f),f>e&&(e=f))}return[d,e]};v.sum=function(b,a){var d,f=0,g=b.length,h=-1;if(1===arguments.length)for(;++h<g;)e(d=
+b[h])&&(f+=d);else for(;++h<g;)e(d=+a.call(b,b[h],h))&&(f+=d);return f};v.mean=function(b,a){var d,f=0,h=b.length,l=-1,n=h;if(1===arguments.length)for(;++l<h;)e(d=g(b[l]))?f+=d:--n;else for(;++l<h;)e(d=g(a.call(b,b[l],l)))?f+=d:--n;return n?f/n:void 0};v.quantile=function(b,a){var d=(b.length-1)*a+1,f=Math.floor(d),e=+b[f-1];return(d-=f)?e+d*(b[f]-e):e};v.median=function(b,a){var d,f=[],l=b.length,n=-1;if(1===arguments.length)for(;++n<l;)e(d=g(b[n]))&&f.push(d);else for(;++n<l;)e(d=g(a.call(b,b[n],
n)))&&f.push(d);return f.length?v.quantile(f.sort(h),.5):void 0};var bg=d(h);v.bisectLeft=bg.left;v.bisect=v.bisectRight=bg.right;v.bisector=function(b){return d(1===b.length?function(a,d){return h(b(a),d)}:b)};v.shuffle=function(b){for(var a,d,f=b.length;f;)d=0|Math.random()*f--,a=b[f],b[f]=b[d],b[d]=a;return b};v.permute=function(b,a){for(var d=a.length,f=Array(d);d--;)f[d]=b[a[d]];return f};v.pairs=function(b){for(var a=0,d=b.length-1,f=b[0],e=Array(0>d?0:d);d>a;)e[a]=[f,f=b[++a]];return e};v.zip=
function(){if(!(e=arguments.length))return[];for(var b=-1,d=v.min(arguments,a),f=Array(d);++b<d;)for(var e,g=-1,h=f[b]=Array(e);++g<e;)h[g]=arguments[g][b];return f};v.transpose=function(b){return v.zip.apply(v,b)};v.keys=function(b){var a=[],d;for(d in b)a.push(d);return a};v.values=function(b){var a=[],d;for(d in b)a.push(b[d]);return a};v.entries=function(b){var a=[],d;for(d in b)a.push({key:d,value:b[d]});return a};v.merge=function(b){var a,d,f,e=b.length;a=-1;for(var g=0;++a<e;)g+=b[a].length;
for(d=Array(g);0<=--e;)for(f=b[e],a=f.length;0<=--a;)d[--g]=f[a];return d};var L=Math.abs;v.range=function(b,a,d){if(3>arguments.length&&(d=1,2>arguments.length&&(a=b,b=0)),1/0===(a-b)/d)throw Error("infinite range");var f,e=[],g;f=L(d);for(g=1;f*g%1;)g*=10;var h=-1;if(b*=g,a*=g,d*=g,0>d)for(;(f=b+d*++h)>a;)e.push(f/g);else for(;(f=b+d*++h)<a;)e.push(f/g);return e};v.map=function(b){var a=new l;if(b instanceof l)b.forEach(function(b,d){a.set(b,d)});else for(var d in b)a.set(d,b[d]);return a};var vg=
"__proto__",Gc="\x00";f(l,{has:q,get:function(b){return this._[n(b)]},set:function(b,a){return this._[n(b)]=a},remove:p,keys:r,values:function(){var b=[],a;for(a in this._)b.push(this._[a]);return b},entries:function(){var b=[],a;for(a in this._)b.push({key:m(a),value:this._[a]});return b},size:w,empty:y,forEach:function(b){for(var a in this._)b.call(this,m(a),this._[a])}});v.nest=function(){function b(a,k,h){if(h>=g.length)return f?f.call(e,k):d?k.sort(d):k;for(var n,m,p,q,r=-1,v=k.length,x=g[h++],
Z=new l;++r<v;)(q=Z.get(n=x(m=k[r])))?q.push(m):Z.set(n,[m]);return a?(m=a(),p=function(d,k){m.set(d,b(a,k,h))}):(m={},p=function(d,k){m[d]=b(a,k,h)}),Z.forEach(p),m}function a(b,d){if(d>=g.length)return b;var f=[],e=h[d++];return b.forEach(function(b,e){f.push({key:b,values:a(e,d)})}),e?f.sort(function(b,a){return e(b.key,a.key)}):f}var d,f,e={},g=[],h=[];return e.map=function(a,d){return b(d,a,0)},e.entries=function(d){return a(b(v.map,d,0),0)},e.key=function(b){return g.push(b),e},e.sortKeys=function(b){return h[g.length-
1]=b,e},e.sortValues=function(b){return d=b,e},e.rollup=function(b){return f=b,e},e};v.set=function(b){var a=new x;if(b)for(var d=0,f=b.length;f>d;++d)a.add(b[d]);return a};f(x,{has:q,add:function(b){return this._[n(b+="")]=!0,b},remove:p,values:r,size:w,empty:y,forEach:function(b){for(var a in this._)b.call(this,m(a))}});v.behavior={};v.rebind=function(b,a){for(var d,f=1,e=arguments.length;++f<e;)b[d=arguments[f]]=z(b,a,a[d]);return b};var Ud="webkit ms moz Moz o O".split(" ");v.dispatch=function(){for(var b=
new H,a=-1,d=arguments.length;++a<d;)b[arguments[a]]=A(b);return b};H.prototype.on=function(b,a){var d=b.indexOf("."),f="";if(0<=d&&(f=b.slice(d+1),b=b.slice(0,d)),b)return 2>arguments.length?this[b].on(f):this[b].on(f,a);if(2===arguments.length){if(null==a)for(b in this)this.hasOwnProperty(b)&&this[b].on(f,null);return this}};v.event=null;v.requote=function(b){return b.replace(pi,"\\$&")};var pi=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,Jb={}.__proto__?function(b,a){b.__proto__=a}:function(b,a){for(var d in a)b[d]=
a[d]},Hc=function(b,a){return a.querySelector(b)},Ic=function(b,a){return a.querySelectorAll(b)},qi=Ga.matches||Ga[F(Ga,"matchesSelector")],Yd=function(b,a){return qi.call(b,a)};"function"==typeof Sizzle&&(Hc=function(b,a){return Sizzle(b,a)[0]||null},Ic=Sizzle,Yd=Sizzle.matchesSelector);v.selection=function(){return cg};var K=v.selection.prototype=[];K.select=function(b){var a,d,f,e,g=[];b=W(b);for(var h=-1,l=this.length;++h<l;){g.push(a=[]);a.parentNode=(f=this[h]).parentNode;for(var n=-1,m=f.length;++n<
m;)(e=f[n])?(a.push(d=b.call(e,e.__data__,n,h)),d&&"__data__"in e&&(d.__data__=e.__data__)):a.push(null)}return ea(g)};K.selectAll=function(b){var a,d,f=[];b=ba(b);for(var e=-1,g=this.length;++e<g;)for(var h=this[e],l=-1,n=h.length;++l<n;)(d=h[l])&&(f.push(a=Oa(b.call(d,d.__data__,l,e))),a.parentNode=d);return ea(f)};var Id={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};
v.ns={prefix:Id,qualify:function(b){var a=b.indexOf(":"),d=b;return 0<=a&&(d=b.slice(0,a),b=b.slice(a+1)),Id.hasOwnProperty(d)?{space:Id[d],local:b}:b}};K.attr=function(b,a){if(2>arguments.length){if("string"==typeof b){var d=this.node();return b=v.ns.qualify(b),b.local?d.getAttributeNS(b.space,b.local):d.getAttribute(b)}for(a in b)this.each(gb(a,b[a]));return this}return this.each(gb(b,a))};K.classed=function(b,a){if(2>arguments.length){if("string"==typeof b){var d=this.node(),f=(b=(b+"").trim().split(/^|\s+/)).length,
e=-1;if(a=d.classList)for(;++e<f;){if(!a.contains(b[e]))return!1}else for(a=d.getAttribute("class");++e<f;)if(!Qd(b[e]).test(a))return!1;return!0}for(a in b)this.each(Rd(a,b[a]));return this}return this.each(Rd(b,a))};K.style=function(b,a,d){var f=arguments.length;if(3>f){if("string"!=typeof b){2>f&&(a="");for(d in b)this.each(Sd(d,b[d],a));return this}if(2>f)return ha.getComputedStyle(this.node(),null).getPropertyValue(b);d=""}return this.each(Sd(b,a,d))};K.property=function(b,a){if(2>arguments.length){if("string"==
typeof b)return this.node()[b];for(a in b)this.each(Td(a,b[a]));return this}return this.each(Td(b,a))};K.text=function(b){return arguments.length?this.each("function"==typeof b?function(){var a=b.apply(this,arguments);this.textContent=null==a?"":a}:null==b?function(){this.textContent=""}:function(){this.textContent=b}):this.node().textContent};K.html=function(b){return arguments.length?this.each("function"==typeof b?function(){var a=b.apply(this,arguments);this.innerHTML=null==a?"":a}:null==b?function(){this.innerHTML=
""}:function(){this.innerHTML=b}):this.node().innerHTML};K.append=function(b){return b=Wd(b),this.select(function(){return this.appendChild(b.apply(this,arguments))})};K.insert=function(b,a){return b=Wd(b),a=W(a),this.select(function(){return this.insertBefore(b.apply(this,arguments),a.apply(this,arguments)||null)})};K.remove=function(){return this.each(function(){var b=this.parentNode;b&&b.removeChild(this)})};K.data=function(b,a){function d(b,f){var e,g,h,t=b.length,q=f.length,O=Math.min(t,q),G=
Array(q),r=Array(q),E=Array(t);if(a){var v,O=new l,x=Array(t);for(e=-1;++e<t;)O.has(v=a.call(g=b[e],g.__data__,e))?E[e]=g:O.set(v,g),x[e]=v;for(e=-1;++e<q;)(g=O.get(v=a.call(f,h=f[e],e)))?!0!==g&&(G[e]=g,g.__data__=h):r[e]={__data__:h},O.set(v,!0);for(e=-1;++e<t;)!0!==O.get(x[e])&&(E[e]=b[e])}else{for(e=-1;++e<O;)g=b[e],h=f[e],g?(g.__data__=h,G[e]=g):r[e]={__data__:h};for(;q>e;++e)r[e]={__data__:f[e]};for(;t>e;++e)E[e]=b[e]}r.update=G;r.parentNode=G.parentNode=E.parentNode=b.parentNode;n.push(r);
m.push(G);p.push(E)}var f,e,g=-1,h=this.length;if(!arguments.length){for(b=Array(h=(f=this[0]).length);++g<h;)(e=f[g])&&(b[g]=e.__data__);return b}var n=Zd([]),m=ea([]),p=ea([]);if("function"==typeof b)for(;++g<h;)d(f=this[g],b.call(f,f.parentNode.__data__,g));else for(;++g<h;)d(f=this[g],b);return m.enter=function(){return n},m.exit=function(){return p},m};K.datum=function(b){return arguments.length?this.property("__data__",b):this.property("__data__")};K.filter=function(b){var a,d,f,e=[];"function"!=
typeof b&&(b=Xd(b));for(var g=0,h=this.length;h>g;g++){e.push(a=[]);a.parentNode=(d=this[g]).parentNode;for(var l=0,n=d.length;n>l;l++)(f=d[l])&&b.call(f,f.__data__,l,g)&&a.push(f)}return ea(e)};K.order=function(){for(var b=-1,a=this.length;++b<a;)for(var d,f=this[b],e=f.length-1,g=f[e];0<=--e;)(d=f[e])&&(g&&g!==d.nextSibling&&g.parentNode.insertBefore(d,g),g=d);return this};K.sort=function(b){b=wg.apply(this,arguments);for(var a=-1,d=this.length;++a<d;)this[a].sort(b);return this.order()};K.each=
function(b){return Ea(this,function(a,d,f){b.call(a,a.__data__,d,f)})};K.call=function(b){var a=Oa(arguments);return b.apply(a[0]=this,a),this};K.empty=function(){return!this.node()};K.node=function(){for(var b=0,a=this.length;a>b;b++)for(var d=this[b],f=0,e=d.length;e>f;f++){var g=d[f];if(g)return g}return null};K.size=function(){var b=0;return Ea(this,function(){++b}),b};var Fa=[];v.selection.enter=Zd;v.selection.enter.prototype=Fa;Fa.append=K.append;Fa.empty=K.empty;Fa.node=K.node;Fa.call=K.call;
Fa.size=K.size;Fa.select=function(b){for(var a,d,f,e,g,h=[],l=-1,n=this.length;++l<n;){f=(e=this[l]).update;h.push(a=[]);a.parentNode=e.parentNode;for(var m=-1,p=e.length;++m<p;)(g=e[m])?(a.push(f[m]=d=b.call(e.parentNode,g.__data__,m,l)),d.__data__=g.__data__):a.push(null)}return ea(h)};Fa.insert=function(b,a){return 2>arguments.length&&(a=xg(this)),K.insert.call(this,b,a)};K.transition=function(){for(var b,a,d=fb||++dg,f=[],e=rc||{time:Date.now(),ease:sh,delay:0,duration:250},g=-1,h=this.length;++g<
h;){f.push(b=[]);for(var l=this[g],n=-1,m=l.length;++n<m;)(a=l[n])&&oc(a,n,d,e),b.push(a)}return Ib(f,d)};K.interrupt=function(){return this.each(Kb)};v.select=function(b){b=["string"==typeof b?Hc(b,ya):b];return b.parentNode=Ga,ea([b])};v.selectAll=function(b){b=Oa("string"==typeof b?Ic(b,ya):b);return b.parentNode=Ga,ea([b])};var cg=v.select(Ga);K.on=function(b,a,d){var f=arguments.length;if(3>f){if("string"!=typeof b){2>f&&(a=!1);for(d in b)this.each($d(d,b[d],a));return this}if(2>f)return(f=this.node()["__on"+
b])&&f._;d=!1}return this.each($d(b,a,d))};var Jc=v.map({mouseenter:"mouseover",mouseleave:"mouseout"});Jc.forEach(function(b){"on"+b in ya&&Jc.remove(b)});var vb="onselectstart"in ya?null:F(Ga.style,"userSelect"),zg=0;v.mouse=function(b){return Kc(b,Na())};var Lc=/WebKit/.test(ha.navigator.userAgent)?-1:0;v.touch=function(b,a,d){if(3>arguments.length&&(d=a,a=Na().changedTouches),a)for(var f,e=0,g=a.length;g>e;++e)if((f=a[e]).identifier===d)return Kc(b,f)};v.behavior.drag=function(){function b(){this.on("mousedown.drag",
e).on("touchstart.drag",g)}function a(b,k,e,g,h){return function(){var a,l=v.event.target,n=this.parentNode,m=d.of(this,arguments),p=0,q=b(),r=".drag"+(null==q?"":"-"+q),G=v.select(e()).on(g+r,function(){var b,d,f=k(n,q);f&&(b=f[0]-x[0],d=f[1]-x[1],p=p|b|d,x=f,m({type:"drag",x:f[0]+a[0],y:f[1]+a[1],dx:b,dy:d}))}).on(h+r,function(){k(n,q)&&(G.on(g+r,null).on(h+r,null),E(p&&v.event.target===l),m({type:"dragend"}))}),E=Lb(),x=k(n,q);f?(a=f.apply(this,arguments),a=[a.x-x[0],a.y-x[1]]):a=[0,0];m({type:"dragstart"})}}
var d=Wa(b,"drag","dragstart","dragend"),f=null,e=a(M,v.mouse,Cg,"mousemove","mouseup"),g=a(Ag,v.touch,Bg,"touchmove","touchend");return b.origin=function(a){return arguments.length?(f=a,b):f},v.rebind(b,d,"on")};v.touches=function(b,a){return 2>arguments.length&&(a=Na().touches),a?Oa(a).map(function(a){var d=Kc(b,a);return d.identifier=a.identifier,d}):[]};var J=Math.PI,na=2*J,da=J/2,C=1E-6,kd=C*C,I=J/180,U=180/J,sc=Math.SQRT2;v.interpolateZoom=function(b,a){function d(b){var a=b*x;if(v){b=ce(r);
var k=g/(2*p),h,t=sc*a+r;h=((t=Math.exp(2*t))-1)/(t+1);h*=b;var m=r,t=((m=Math.exp(m))-1/m)/2,k=k*(h-t);return[f+k*l,e+k*n,g*b/ce(sc*a+r)]}return[f+b*l,e+b*n,g*Math.exp(sc*a)]}var f=b[0],e=b[1],g=b[2],h=a[2],l=a[0]-f,n=a[1]-e,m=l*l+n*n,p=Math.sqrt(m),q=(h*h-g*g+4*m)/(4*g*p),m=(h*h-g*g-4*m)/(4*h*p),r=Math.log(Math.sqrt(q*q+1)-q),v=Math.log(Math.sqrt(m*m+1)-m)-r,x=(v||Math.log(h/g))/sc;return d.duration=1E3*x,d};v.behavior.zoom=function(){function b(b){b.on(F,n).on(ri+".zoom",p).on("dblclick.zoom",
q).on(C,m)}function a(b){return[(b[0]-D.x)/D.k,(b[1]-D.y)/D.k]}function d(b){D.k=Math.max(la[0],Math.min(la[1],b))}function f(b,a){a=[a[0]*D.k+D.x,a[1]*D.k+D.y];D.x+=b[0]-a[0];D.y+=b[1]-a[1]}function e(){N&&N.domain(V.range().map(function(b){return(b-D.x)/D.k}).map(V.invert));Q&&Q.domain(P.range().map(function(b){return(b-D.y)/D.k}).map(P.invert))}function g(b){b({type:"zoomstart"})}function h(b){e();b({type:"zoom",scale:D.k,translate:[D.x,D.y]})}function l(b){b({type:"zoomend"})}function n(){var b=
this,d=v.event.target,e=B.of(b,arguments),t=0,m=v.select(ha).on(A,function(){t=1;f(v.mouse(b),p);h(e)}).on(M,function(){m.on(A,null).on(M,null);q(t&&v.event.target===d);l(e)}),p=a(v.mouse(b)),q=Lb();Kb.call(b);g(e)}function m(){function b(){var d=v.touches(E);return r=D.k,d.forEach(function(b){b.identifier in w&&(w[b.identifier]=a(b))}),d}function e(){var a=v.event.target;v.select(a).on(P,p).on(sa,q);Pa.push(a);for(var a=v.event.changedTouches,k=0,g=a.length;g>k;++k)w[a[k].identifier]=null;g=b();
k=Date.now();1===g.length?(500>k-z&&(a=g[0],g=w[a.identifier],d(2*D.k),f(a,g),R(),h(x)),z=k):1<g.length&&(a=g[0],g=g[1],k=a[0]-g[0],a=a[1]-g[1],T=k*k+a*a)}function p(){for(var b,a,k,e,g=v.touches(E),l=0,n=g.length;n>l;++l,e=null)if(k=g[l],e=w[k.identifier]){if(a)break;b=k;a=e}if(e){var m=(m=k[0]-b[0])*m+(m=k[1]-b[1])*m,g=T&&Math.sqrt(m/T);b=[(b[0]+k[0])/2,(b[1]+k[1])/2];a=[(a[0]+e[0])/2,(a[1]+e[1])/2];d(g*r)}z=null;f(b,a);h(x)}function q(){if(v.event.touches.length){for(var a=v.event.changedTouches,
d=0,f=a.length;f>d;++d)delete w[a[d].identifier];for(var k in w)return void b()}v.selectAll(Pa).on(y,null);N.on(F,n).on(C,m);fa();l(x)}var r,E=this,x=B.of(E,arguments),w={},T=0,y=".zoom-"+v.event.changedTouches[0].identifier,P="touchmove"+y,sa="touchend"+y,Pa=[],N=v.select(E),fa=Lb();Kb.call(E);e();g(x);N.on(F,null).on(C,e)}function p(){var b=B.of(this,arguments);y?clearTimeout(y):(r=a(x=w||v.mouse(this)),Kb.call(this),g(b));y=setTimeout(function(){y=null;l(b)},50);R();d(Math.pow(2,.002*tc())*D.k);
f(x,r);h(b)}function q(){var b=B.of(this,arguments),e=v.mouse(this),n=a(e),m=Math.log(D.k)/Math.LN2;g(b);d(Math.pow(2,v.event.shiftKey?Math.ceil(m)-1:Math.floor(m)+1));f(e,n);h(b);l(b)}var r,x,w,y,z,V,N,P,Q,D={x:0,y:0,k:1},Aa=[960,500],la=eg,F="mousedown.zoom",A="mousemove.zoom",M="mouseup.zoom",C="touchstart.zoom",B=Wa(b,"zoomstart","zoom","zoomend");return b.event=function(b){b.each(function(){var b=B.of(this,arguments),a=D;fb?v.select(this).transition().each("start.zoom",function(){D=this.__chart__||
{x:0,y:0,k:1};g(b)}).tween("zoom:zoom",function(){var d=Aa[0],f=d/2,k=Aa[1]/2,e=v.interpolateZoom([(f-D.x)/D.k,(k-D.y)/D.k,d/D.k],[(f-a.x)/a.k,(k-a.y)/a.k,d/a.k]);return function(a){a=e(a);var g=d/a[2];this.__chart__=D={x:f-a[0]*g,y:k-a[1]*g,k:g};h(b)}}).each("end.zoom",function(){l(b)}):(this.__chart__=D,g(b),h(b),l(b))})},b.translate=function(a){return arguments.length?(D={x:+a[0],y:+a[1],k:D.k},e(),b):[D.x,D.y]},b.scale=function(a){return arguments.length?(D={x:D.x,y:D.y,k:+a},e(),b):D.k},b.scaleExtent=
function(a){return arguments.length?(la=null==a?eg:[+a[0],+a[1]],b):la},b.center=function(a){return arguments.length?(w=a&&[+a[0],+a[1]],b):w},b.size=function(a){return arguments.length?(Aa=a&&[+a[0],+a[1]],b):Aa},b.x=function(a){return arguments.length?(N=a,V=a.copy(),D={x:0,y:0,k:1},b):N},b.y=function(a){return arguments.length?(Q=a,P=a.copy(),D={x:0,y:0,k:1},b):Q},v.rebind(b,B,"on")};var tc,eg=[0,1/0],ri="onwheel"in ya?(tc=function(){return-v.event.deltaY*(v.event.deltaMode?120:1)},"wheel"):"onmousewheel"in
ya?(tc=function(){return v.event.wheelDelta},"mousewheel"):(tc=function(){return-v.event.detail},"MozMousePixelScroll");v.color=Xa;Xa.prototype.toString=function(){return this.rgb()+""};v.hsl=za;var Jd=za.prototype=new Xa;Jd.brighter=function(b){return b=Math.pow(.7,arguments.length?b:1),new za(this.h,this.s,this.l/b)};Jd.darker=function(b){return b=Math.pow(.7,arguments.length?b:1),new za(this.h,this.s,b*this.l)};Jd.rgb=function(){return Nc(this.h,this.s,this.l)};v.hcl=ua;var Kd=ua.prototype=new Xa;
Kd.brighter=function(b){return new ua(this.h,this.c,Math.min(100,this.l+uc*(arguments.length?b:1)))};Kd.darker=function(b){return new ua(this.h,this.c,Math.max(0,this.l-uc*(arguments.length?b:1)))};Kd.rgb=function(){return Oc(this.h,this.c,this.l).rgb()};v.lab=va;var uc=18,je=.95047,ke=1,le=1.08883,Ld=va.prototype=new Xa;Ld.brighter=function(b){return new va(Math.min(100,this.l+uc*(arguments.length?b:1)),this.a,this.b)};Ld.darker=function(b){return new va(Math.max(0,this.l-uc*(arguments.length?b:
1)),this.a,this.b)};Ld.rgb=function(){return ie(this.l,this.a,this.b)};v.rgb=ia;var vc=ia.prototype=new Xa;vc.brighter=function(b){b=Math.pow(.7,arguments.length?b:1);var a=this.r,d=this.g,f=this.b;return a||d||f?(a&&30>a&&(a=30),d&&30>d&&(d=30),f&&30>f&&(f=30),new ia(Math.min(255,a/b),Math.min(255,d/b),Math.min(255,f/b))):new ia(30,30,30)};vc.darker=function(b){return b=Math.pow(.7,arguments.length?b:1),new ia(b*this.r,b*this.g,b*this.b)};vc.hsl=function(){return fe(this.r,this.g,this.b)};vc.toString=
function(){return"#"+ib(this.r)+ib(this.g)+ib(this.b)};var Nb=v.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,
darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,
gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,
lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,
orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,
tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Nb.forEach(function(b,a){Nb.set(b,new ia(a>>16,255&a>>8,255&a))});v.functor=S;v.xhr=Uc(ca);v.dsv=function(b,a){function d(b,g,h){3>arguments.length&&(h=g,g=null);var l=Ob(b,a,null==g?f:e(g),h);return l.row=function(b){return arguments.length?l.response(null==(g=b)?f:e(b)):g},l}function f(b){return d.parse(b.responseText)}
function e(b){return function(a){return d.parse(a.responseText,b)}}function g(a){return a.map(h).join(b)}function h(b){return l.test(b)?'"'+b.replace(/\"/g,'""')+'"':b}var l=new RegExp('["'+b+"\n]"),n=b.charCodeAt(0);return d.parse=function(b,a){var f;return d.parseRows(b,function(b,d){if(f)return f(b,d-1);var k=new Function("d","return {"+b.map(function(b,a){return JSON.stringify(b)+": d["+a+"]"}).join(",")+"}");f=a?function(b,d){return a(k(b),d)}:k})},d.parseRows=function(b,a){function d(){if(t>=
l)return g;if(k)return k=!1,e;var a=t;if(34===b.charCodeAt(a)){for(var f=a;f++<l;)if(34===b.charCodeAt(f)){if(34!==b.charCodeAt(f+1))break;++f}t=f+2;var h=b.charCodeAt(f+1);return 13===h?(k=!0,10===b.charCodeAt(f+2)&&++t):10===h&&(k=!0),b.slice(a+1,f).replace(/""/g,'"')}for(;l>t;){h=b.charCodeAt(t++);f=1;if(10===h)k=!0;else if(13===h)k=!0,10===b.charCodeAt(t)&&(++t,++f);else if(h!==n)continue;return b.slice(a,t-f)}return b.slice(a)}for(var f,k,e={},g={},h=[],l=b.length,t=0,m=0;(f=d())!==g;){for(var p=
[];f!==e&&f!==g;)p.push(f),f=d();a&&null==(p=a(p,m++))||h.push(p)}return h},d.format=function(a){if(Array.isArray(a[0]))return d.formatRows(a);var f=new x,k=[];return a.forEach(function(b){for(var a in b)f.has(a)||k.push(f.add(a))}),[k.map(h).join(b)].concat(a.map(function(a){return k.map(function(b){return h(a[b])}).join(b)})).join("\n")},d.formatRows=function(b){return b.map(g).join("\n")},d};v.csv=v.dsv(",","text/csv");v.tsv=v.dsv("\t","text/tab-separated-values");var Rb,Sb,Qb,Pb,Ha,oe=ha[F(ha,
"requestAnimationFrame")]||function(b){setTimeout(b,17)};v.timer=function(b,a,d){var f=arguments.length;2>f&&(a=0);3>f&&(d=Date.now());f={c:b,t:d+a,f:!1,n:null};Sb?Sb.n=f:Rb=f;Sb=f;Qb||(Pb=clearTimeout(Pb),Qb=1,oe(Vc))};v.timer.flush=function(){me();ne()};v.round=function(b,a){return a?Math.round(b*(a=Math.pow(10,a)))/a:Math.round(b)};var si="y z a f p n \u00b5 m  k M G T P E Z Y".split(" ").map(function(b,a){var d=Math.pow(10,3*L(8-a));return{scale:8<a?function(b){return b/d}:function(b){return b*
d},symbol:b}});v.formatPrefix=function(b,a){var d=0;return b&&(0>b&&(b*=-1),a&&(b=v.round(b,Wc(b,a))),d=1+Math.floor(1E-12+Math.log(b)/Math.LN10),d=Math.max(-24,Math.min(24,3*Math.floor((d-1)/3)))),si[8+d/3]};var pe=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Fg=v.map({b:function(b){return b.toString(2)},c:function(b){return String.fromCharCode(b)},o:function(b){return b.toString(8)},x:function(b){return b.toString(16)},X:function(b){return b.toString(16).toUpperCase()},
g:function(b,a){return b.toPrecision(a)},e:function(b,a){return b.toExponential(a)},f:function(b,a){return b.toFixed(a)},r:function(b,a){return(b=v.round(b,Wc(b,a))).toFixed(Math.max(0,Math.min(20,Wc(b*(1+1E-15),a))))}}),B=v.time={},ga=Date;Ia.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},
getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Ma.setUTCDate.apply(this._,arguments)},setDay:function(){Ma.setUTCDay.apply(this._,arguments)},setFullYear:function(){Ma.setUTCFullYear.apply(this._,arguments)},setHours:function(){Ma.setUTCHours.apply(this._,
arguments)},setMilliseconds:function(){Ma.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Ma.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Ma.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Ma.setUTCSeconds.apply(this._,arguments)},setTime:function(){Ma.setTime.apply(this._,arguments)}};var Ma=Date.prototype;B.year=Ya(function(b){return b=B.day(b),b.setMonth(0,1),b},function(b,a){b.setFullYear(b.getFullYear()+a)},function(b){return b.getFullYear()});B.years=
B.year.range;B.years.utc=B.year.utc.range;B.day=Ya(function(b){var a=new ga(2E3,0);return a.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),a},function(b,a){b.setDate(b.getDate()+a)},function(b){return b.getDate()-1});B.days=B.day.range;B.days.utc=B.day.utc.range;B.dayOfYear=function(b){var a=B.year(b);return Math.floor((b-a-6E4*(b.getTimezoneOffset()-a.getTimezoneOffset()))/864E5)};"sunday monday tuesday wednesday thursday friday saturday".split(" ").forEach(function(b,a){a=7-a;var d=B[b]=
Ya(function(b){return(b=B.day(b)).setDate(b.getDate()-(b.getDay()+a)%7),b},function(b,a){b.setDate(b.getDate()+7*Math.floor(a))},function(b){var d=B.year(b).getDay();return Math.floor((B.dayOfYear(b)+(d+a)%7)/7)-(d!==a)});B[b+"s"]=d.range;B[b+"s"].utc=d.utc.range;B[b+"OfYear"]=function(b){var d=B.year(b).getDay();return Math.floor((B.dayOfYear(b)+(d+a)%7)/7)}});B.week=B.sunday;B.weeks=B.sunday.range;B.weeks.utc=B.sunday.utc.range;B.weekOfYear=B.sundayOfYear;var re={"-":"",_:" ",0:"0"},X=/^\s*\d+/,
ue=/^%/;v.locale=function(b){return{numberFormat:Eg(b),timeFormat:Ig(b)}};var fg=v.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),shortDays:"Sun Mon Tue Wed Thu Fri Sat".split(" "),months:"January February March April May June July August September October November December".split(" "),shortMonths:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")});
v.format=fg.numberFormat;v.geo={};Yc.prototype={s:0,t:0,add:function(b){ve(b,this.t,wc);ve(wc.s,this.s,this);this.s?this.t+=wc.t:this.s=wc.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var wc=new Yc;v.geo.stream=function(b,a){b&&gg.hasOwnProperty(b.type)?gg[b.type](b,a):Wb(b,a)};var gg={Feature:function(b,a){Wb(b.geometry,a)},FeatureCollection:function(b,a){for(var d=b.features,f=-1,e=d.length;++f<e;)Wb(d[f].geometry,a)}},we={Sphere:function(b,a){a.sphere()},Point:function(b,
a){b=b.coordinates;a.point(b[0],b[1],b[2])},MultiPoint:function(b,a){for(var d=b.coordinates,f=-1,e=d.length;++f<e;)b=d[f],a.point(b[0],b[1],b[2])},LineString:function(b,a){Zc(b.coordinates,a,0)},MultiLineString:function(b,a){for(var d=b.coordinates,f=-1,e=d.length;++f<e;)Zc(d[f],a,0)},Polygon:function(b,a){xe(b.coordinates,a)},MultiPolygon:function(b,a){for(var d=b.coordinates,f=-1,e=d.length;++f<e;)xe(d[f],a)},GeometryCollection:function(b,a){for(var d=b.geometries,f=-1,e=d.length;++f<e;)Wb(d[f],
a)}};v.geo.area=function(b){return tb=0,v.geo.stream(b,ma),tb};var tb,Za=new Yc,ma={sphere:function(){tb+=4*J},point:M,lineStart:M,lineEnd:M,polygonStart:function(){Za.reset();ma.lineStart=Xg},polygonEnd:function(){var b=2*Za;tb+=0>b?4*J+b:b;ma.lineStart=ma.lineEnd=ma.point=M}};v.geo.bounds=function(){function b(b,a){P.push(Q=[p=b,r=b]);q>a&&(q=a);a>x&&(x=a)}function a(d,f){var k=$a([d*I,f*I]);if(V){var e=kb(V,k),e=kb([e[1],-e[0],0],e);Zb(e);var e=$b(e),g=d-w,h=0<g?1:-1,n=e[0]*U*h,g=180<L(g);g^(n>
h*w&&h*d>n)?(e=e[1]*U,e>x&&(x=e)):(n=(n+360)%360-180,g^(n>h*w&&h*d>n))?(e=-e[1]*U,q>e&&(q=e)):(q>f&&(q=f),f>x&&(x=f));g?w>d?l(p,d)>l(p,r)&&(r=d):l(d,r)>l(p,r)&&(p=d):r>=p?(p>d&&(p=d),d>r&&(r=d)):d>w?l(p,d)>l(p,r)&&(r=d):l(d,r)>l(p,r)&&(p=d)}else b(d,f);V=k;w=d}function d(){D.point=a}function f(){Q[0]=p;Q[1]=r;D.point=b;V=null}function e(b,d){if(V){var f=b-w;N+=180<L(f)?f+(0<f?360:-360):f}else y=b,z=d;ma.point(b,d);a(b,d)}function g(){ma.lineStart()}function h(){e(y,z);ma.lineEnd();L(N)>C&&(p=-(r=
180));Q[0]=p;Q[1]=r;V=null}function l(b,a){return 0>(a-=b)?a+360:a}function n(b,a){return b[0]-a[0]}function m(b,a){return a[0]<=a[1]?a[0]<=b&&b<=a[1]:b<a[0]||a[1]<b}var p,q,r,x,w,y,z,V,N,P,Q,D={point:b,lineStart:d,lineEnd:f,polygonStart:function(){D.point=e;D.lineStart=g;D.lineEnd=h;N=0;ma.polygonStart()},polygonEnd:function(){ma.polygonEnd();D.point=b;D.lineStart=d;D.lineEnd=f;0>Za?(p=-(r=180),q=-(x=90)):N>C?x=90:-C>N&&(q=-90);Q[0]=p;Q[1]=r}};return function(b){x=r=-(p=q=1/0);P=[];v.geo.stream(b,
D);if(b=P.length){P.sort(n);for(var a,d=1,f=P[0],k=[f];b>d;++d)a=P[d],m(a[0],f)||m(a[1],f)?(l(f[0],a[1])>l(f[0],f[1])&&(f[1]=a[1]),l(a[0],f[1])>l(f[0],f[1])&&(f[0]=a[0])):k.push(f=a);var e,g=-1/0;b=k.length-1;d=0;for(f=k[b];b>=d;f=a,++d)a=k[d],(e=l(f[1],a[0]))>g&&(g=e,p=a[0],r=f[1])}return P=Q=null,1/0===p||1/0===q?[[0/0,0/0],[0/0,0/0]]:[[p,q],[r,x]]}}();v.geo.centroid=function(b){xb=lb=Ja=Ka=Ba=pa=qa=ka=Qa=Ra=Ca=0;v.geo.stream(b,wa);b=Qa;var a=Ra,d=Ca,f=b*b+a*a+d*d;return kd>f&&(b=pa,a=qa,d=ka,C>
lb&&(b=Ja,a=Ka,d=Ba),f=b*b+a*a+d*d,kd>f)?[0/0,0/0]:[Math.atan2(a,b)*U,hb(d/Math.sqrt(f))*U]};var xb,lb,Ja,Ka,Ba,pa,qa,ka,Qa,Ra,Ca,wa={sphere:M,point:ad,lineStart:ye,lineEnd:ze,polygonStart:function(){wa.lineStart=Yg},polygonEnd:function(){wa.lineStart=ye}},Pe=Ce(mb,function(b){var a,d=0/0,f=0/0,e=0/0;return{lineStart:function(){b.lineStart();a=1},point:function(g,h){var l=0<g?J:-J,n=L(g-d);if(L(n-J)<C)b.point(d,f=0<(f+h)/2?da:-da),b.point(e,f),b.lineEnd(),b.lineStart(),b.point(l,f),b.point(g,f),a=
0;else if(e!==l&&n>=J){L(d-e)<C&&(d-=e*C);L(g-l)<C&&(g-=l*C);var n=d,m=f,p=g,q,r,v=Math.sin(n-p);f=L(v)>C?Math.atan((Math.sin(m)*(r=Math.cos(h))*Math.sin(p)-Math.sin(h)*(q=Math.cos(m))*Math.sin(n))/(q*r*v)):(m+h)/2;b.point(e,f);b.lineEnd();b.lineStart();b.point(l,f);a=0}b.point(d=g,f=h);e=l},lineEnd:function(){b.lineEnd();d=f=0/0},clean:function(){return 2-a}}},function(b,a,d,f){null==b?(d*=da,f.point(-J,d),f.point(0,d),f.point(J,d),f.point(J,0),f.point(J,-d),f.point(0,-d),f.point(-J,-d),f.point(-J,
0),f.point(-J,d)):L(b[0]-a[0])>C?(b=b[0]<a[0]?J:-J,d=d*b/2,f.point(-b,d),f.point(0,d),f.point(b,d)):f.point(a[0],a[1])},[-J,-J/2]),cc=1E9;v.geo.clipExtent=function(){var b,a,d,f,e,g,h={stream:function(b){return e&&(e.valid=!1),e=g(b),e.valid=!0,e},extent:function(l){return arguments.length?(g=Fe(b=+l[0][0],a=+l[0][1],d=+l[1][0],f=+l[1][1]),e&&(e.valid=!1,e=null),h):[[b,a],[d,f]]}};return h.extent([[0,0],[960,500]])};(v.geo.conicEqualArea=function(){return cd(He)}).raw=He;v.geo.albers=function(){return v.geo.conicEqualArea().rotate([96,
0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)};v.geo.albersUsa=function(){function b(b){var g=b[0];b=b[1];return a=null,d(g,b),a||(f(g,b),a)||e(g,b),a}var a,d,f,e,g=v.geo.albers(),h=v.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=v.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),n={point:function(b,d){a=[b,d]}};return b.invert=function(b){var a=g.scale(),d=g.translate(),f=(b[0]-d[0])/a,a=(b[1]-d[1])/a;return(.12<=a&&.234>a&&-.425<=
f&&-.214>f?h:.166<=a&&.234>a&&-.214<=f&&-.115>f?l:g).invert(b)},b.stream=function(b){var a=g.stream(b),d=h.stream(b),f=l.stream(b);return{point:function(b,e){a.point(b,e);d.point(b,e);f.point(b,e)},sphere:function(){a.sphere();d.sphere();f.sphere()},lineStart:function(){a.lineStart();d.lineStart();f.lineStart()},lineEnd:function(){a.lineEnd();d.lineEnd();f.lineEnd()},polygonStart:function(){a.polygonStart();d.polygonStart();f.polygonStart()},polygonEnd:function(){a.polygonEnd();d.polygonEnd();f.polygonEnd()}}},
b.precision=function(a){return arguments.length?(g.precision(a),h.precision(a),l.precision(a),b):g.precision()},b.scale=function(a){return arguments.length?(g.scale(a),h.scale(.35*a),l.scale(a),b.translate(g.translate())):g.scale()},b.translate=function(a){if(!arguments.length)return g.translate();var k=g.scale(),m=+a[0],p=+a[1];return d=g.translate(a).clipExtent([[m-.455*k,p-.238*k],[m+.455*k,p+.238*k]]).stream(n).point,f=h.translate([m-.307*k,p+.201*k]).clipExtent([[m-.425*k+C,p+.12*k+C],[m-.214*
k-C,p+.234*k-C]]).stream(n).point,e=l.translate([m-.205*k,p+.212*k]).clipExtent([[m-.214*k+C,p+.166*k+C],[m-.115*k-C,p+.234*k-C]]).stream(n).point,b},b.scale(1070)};var xc,dc,yc,zc,Ac,Bc,Sa={point:M,lineStart:M,lineEnd:M,polygonStart:function(){dc=0;Sa.lineStart=bh},polygonEnd:function(){Sa.lineStart=Sa.lineEnd=Sa.point=M;xc+=L(dc/2)}},ti={point:function(b,a){yc>b&&(yc=b);b>Ac&&(Ac=b);zc>a&&(zc=a);a>Bc&&(Bc=a)},lineStart:M,lineEnd:M,polygonStart:M,polygonEnd:M},xa={point:ab,lineStart:Je,lineEnd:Ke,
polygonStart:function(){xa.lineStart=dh},polygonEnd:function(){xa.point=ab;xa.lineStart=Je;xa.lineEnd=Ke}};v.geo.path=function(){function b(b){return b&&("function"==typeof h&&e.pointRadius(+h.apply(this,arguments)),g&&g.valid||(g=f(e)),v.geo.stream(b,g)),e.result()}var a,d,f,e,g,h=4.5;return b.area=function(b){return xc=0,v.geo.stream(b,f(Sa)),xc},b.centroid=function(b){return Ja=Ka=Ba=pa=qa=ka=Qa=Ra=Ca=0,v.geo.stream(b,f(xa)),Ca?[Qa/Ca,Ra/Ca]:ka?[pa/ka,qa/ka]:Ba?[Ja/Ba,Ka/Ba]:[0/0,0/0]},b.bounds=
function(b){return Ac=Bc=-(yc=zc=1/0),v.geo.stream(b,f(ti)),[[yc,zc],[Ac,Bc]]},b.projection=function(d){return arguments.length?(f=(a=d)?d.stream||fh(d):ca,g=null,b):a},b.context=function(a){return arguments.length?(e=null==(d=a)?new ch:new eh(a),"function"!=typeof h&&e.pointRadius(h),g=null,b):d},b.pointRadius=function(a){return arguments.length?(h="function"==typeof a?a:(e.pointRadius(+a),+a),b):h},b.projection(v.geo.albersUsa()).context(null)};v.geo.transform=function(b){return{stream:function(a){a=
new Oe(a);for(var d in b)a[d]=b[d];return a}}};Oe.prototype={point:function(b,a){this.stream.point(b,a)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};v.geo.projection=Ta;v.geo.projectionMutator=dd;(v.geo.equirectangular=function(){return Ta(yb)}).raw=yb.invert=yb;v.geo.rotation=function(b){function a(d){return d=b(d[0]*
I,d[1]*I),d[0]*=U,d[1]*=U,d}return b=ed(b[0]%360*I,b[1]*I,2<b.length?b[2]*I:0),a.invert=function(a){return a=b.invert(a[0]*I,a[1]*I),a[0]*=U,a[1]*=U,a},a};Qe.invert=yb;v.geo.circle=function(){function b(){var b="function"==typeof f?f.apply(this,arguments):f,a=ed(-b[0]*I,-b[1]*I,0).invert,e=[];return d(null,null,1,{point:function(b,d){e.push(b=a(b,d));b[0]*=U;b[1]*=U}}),{type:"Polygon",coordinates:[e]}}var a,d,f=[0,0],e=6;return b.origin=function(a){return arguments.length?(f=a,b):f},b.angle=function(f){return arguments.length?
(d=bd((a=+f)*I,e*I),b):a},b.precision=function(f){return arguments.length?(d=bd(a*I,(e=+f)*I),b):e},b.angle(90)};v.geo.distance=function(b,a){var d,f=(a[0]-b[0])*I,e=b[1]*I,g=a[1]*I,h=Math.sin(f),f=Math.cos(f),l=Math.sin(e),e=Math.cos(e),n=Math.sin(g),g=Math.cos(g);return Math.atan2(Math.sqrt((d=g*h)*d+(d=e*n-l*g*f)*d),l*n+e*g*f)};v.geo.graticule=function(){function b(){return{type:"MultiLineString",coordinates:a()}}function a(){return v.range(Math.ceil(g/z)*z,e,z).map(r).concat(v.range(Math.ceil(m/
V)*V,n,V).map(x)).concat(v.range(Math.ceil(f/w)*w,d,w).filter(function(b){return L(b%z)>C}).map(p)).concat(v.range(Math.ceil(l/y)*y,h,y).filter(function(b){return L(b%V)>C}).map(q))}var d,f,e,g,h,l,n,m,p,q,r,x,w=10,y=w,z=90,V=360,N=2.5;return b.lines=function(){return a().map(function(b){return{type:"LineString",coordinates:b}})},b.outline=function(){return{type:"Polygon",coordinates:[r(g).concat(x(n).slice(1),r(e).reverse().slice(1),x(m).reverse().slice(1))]}},b.extent=function(a){return arguments.length?
b.majorExtent(a).minorExtent(a):b.minorExtent()},b.majorExtent=function(a){return arguments.length?(g=+a[0][0],e=+a[1][0],m=+a[0][1],n=+a[1][1],g>e&&(a=g,g=e,e=a),m>n&&(a=m,m=n,n=a),b.precision(N)):[[g,m],[e,n]]},b.minorExtent=function(a){return arguments.length?(f=+a[0][0],d=+a[1][0],l=+a[0][1],h=+a[1][1],f>d&&(a=f,f=d,d=a),l>h&&(a=l,l=h,h=a),b.precision(N)):[[f,l],[d,h]]},b.step=function(a){return arguments.length?b.majorStep(a).minorStep(a):b.minorStep()},b.majorStep=function(a){return arguments.length?
(z=+a[0],V=+a[1],b):[z,V]},b.minorStep=function(a){return arguments.length?(w=+a[0],y=+a[1],b):[w,y]},b.precision=function(a){return arguments.length?(N=+a,p=Ve(l,h,90),q=We(f,d,N),r=Ve(m,n,90),x=We(g,e,N),b):N},b.majorExtent([[-180,-90+C],[180,90-C]]).minorExtent([[-180,-80-C],[180,80+C]])};v.geo.greatArc=function(){function b(){return{type:"LineString",coordinates:[a||f.apply(this,arguments),d||e.apply(this,arguments)]}}var a,d,f=fd,e=gd;return b.distance=function(){return v.geo.distance(a||f.apply(this,
arguments),d||e.apply(this,arguments))},b.source=function(d){return arguments.length?(f=d,a="function"==typeof d?null:d,b):f},b.target=function(a){return arguments.length?(e=a,d="function"==typeof a?null:a,b):e},b.precision=function(){return arguments.length?b:0},b};v.geo.interpolate=function(b,a){return gh(b[0]*I,b[1]*I,a[0]*I,a[1]*I)};v.geo.length=function(b){return Cc=0,v.geo.stream(b,ub),Cc};var Cc,ub={sphere:M,point:M,lineStart:function(){function b(b,e){var g=Math.sin(e*=I),h=Math.cos(e),l=
L((b*=I)-a),n=Math.cos(l);Cc+=Math.atan2(Math.sqrt((l=h*Math.sin(l))*l+(l=f*g-d*h*n)*l),d*g+f*h*n);a=b;d=g;f=h}var a,d,f;ub.point=function(e,g){a=e*I;d=Math.sin(g*=I);f=Math.cos(g);ub.point=b};ub.lineEnd=function(){ub.point=ub.lineEnd=M}},lineEnd:M,polygonStart:M,polygonEnd:M},hg=zb(function(b){return Math.sqrt(2/(1+b))},function(b){return 2*Math.asin(b/2)});(v.geo.azimuthalEqualArea=function(){return Ta(hg)}).raw=hg;var ig=zb(function(b){return(b=Math.acos(b))&&b/Math.sin(b)},ca);(v.geo.azimuthalEquidistant=
function(){return Ta(ig)}).raw=ig;(v.geo.conicConformal=function(){return cd(Xe)}).raw=Xe;(v.geo.conicEquidistant=function(){return cd(Ye)}).raw=Ye;var jg=zb(function(b){return 1/b},Math.atan);(v.geo.gnomonic=function(){return Ta(jg)}).raw=jg;ec.invert=function(b,a){return[b,2*Math.atan(Math.exp(a))-da]};(v.geo.mercator=function(){return Ze(ec)}).raw=ec;var kg=zb(function(){return 1},Math.asin);(v.geo.orthographic=function(){return Ta(kg)}).raw=kg;var lg=zb(function(b){return 1/(1+b)},function(b){return 2*
Math.atan(b)});(v.geo.stereographic=function(){return Ta(lg)}).raw=lg;hd.invert=function(b,a){return[-a,2*Math.atan(Math.exp(b))-da]};(v.geo.transverseMercator=function(){var b=Ze(hd),a=b.center,d=b.rotate;return b.center=function(b){return b?a([-b[1],b[0]]):(b=a(),[b[1],-b[0]])},b.rotate=function(b){return b?d([b[0],b[1],2<b.length?b[2]+90:90]):(b=d(),[b[0],b[1],b[2]-90])},d([0,0,90])}).raw=hd;v.geom={};v.geom.hull=function(b){function a(b){if(3>b.length)return[];var e,k=S(d),g=S(f),h=b.length,l=
[],n=[];for(e=0;h>e;e++)l.push([+k.call(this,b[e],e),+g.call(this,b[e],e),e]);l.sort(hh);for(e=0;h>e;e++)n.push([l[e][0],-l[e][1]]);var k=$e(l),n=$e(n),g=n[0]===k[0],h=n[n.length-1]===k[k.length-1],m=[];for(e=k.length-1;0<=e;--e)m.push(b[l[k[e]][2]]);for(e=+g;e<n.length-h;++e)m.push(b[l[n[e]][2]]);return m}var d=nb,f=Ab;return arguments.length?a(b):(a.x=function(b){return arguments.length?(d=b,a):d},a.y=function(b){return arguments.length?(f=b,a):f},a)};v.geom.polygon=function(b){return Jb(b,Dc),
b};var Dc=v.geom.polygon.prototype=[];Dc.area=function(){for(var b,a=-1,d=this.length,f=this[d-1],e=0;++a<d;)b=f,f=this[a],e+=b[1]*f[0]-b[0]*f[1];return.5*e};Dc.centroid=function(b){var a,d,f=-1,e=this.length,g=0,h=0,l=this[e-1];for(arguments.length||(b=-1/(6*this.area()));++f<e;)a=l,l=this[f],d=a[0]*l[1]-l[0]*a[1],g+=(a[0]+l[0])*d,h+=(a[1]+l[1])*d;return[g*b,h*b]};Dc.clip=function(b){for(var a,d,f,e,g,h,l=bf(b),n=-1,m=this.length-bf(this),p=this[m-1];++n<m;){a=b.slice();b.length=0;e=this[n];g=a[(f=
a.length-l)-1];for(d=-1;++d<f;)h=a[d],id(h,p,e)?(id(g,p,e)||b.push(af(g,h,p,e)),b.push(h)):id(g,p,e)&&b.push(af(g,h,p,e)),g=h;l&&b.push(b[0]);p=e}return b};var rb,bb,pb,ld,Bb,df=[],hf=[];ff.prototype.prepare=function(){for(var b,a=this.edges,d=a.length;d--;)b=a[d].edge,b.b&&b.a||a.splice(d,1);return a.sort(gf),a.length};hc.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};md.prototype={insert:function(b,
a){var d,f,e;if(b){if(a.P=b,a.N=b.N,b.N&&(b.N.P=a),b.N=a,b.R){for(b=b.R;b.L;)b=b.L;b.L=a}else b.R=a;d=b}else this._?(b=kf(this._),a.P=null,a.N=b,b.P=b.L=a,d=b):(a.P=a.N=null,this._=a,d=null);a.L=a.R=null;a.U=d;a.C=!0;for(b=a;d&&d.C;)f=d.U,d===f.L?(e=f.R,e&&e.C?(d.C=e.C=!1,f.C=!0,b=f):(b===d.R&&(Db(this,d),b=d,d=b.U),d.C=!1,f.C=!0,Eb(this,f))):(e=f.L,e&&e.C?(d.C=e.C=!1,f.C=!0,b=f):(b===d.L&&(Eb(this,d),b=d,d=b.U),d.C=!1,f.C=!0,Db(this,f))),d=b.U;this._.C=!1},remove:function(b){b.N&&(b.N.P=b.P);b.P&&
(b.P.N=b.N);b.N=b.P=null;var a,d,f,e=b.U,g=b.L,h=b.R;if(d=g?h?kf(h):g:h,e?e.L===b?e.L=d:e.R=d:this._=d,g&&h?(f=d.C,d.C=b.C,d.L=g,g.U=d,d!==h?(e=d.U,d.U=b.U,b=d.R,e.L=b,d.R=h,h.U=d):(d.U=e,e=d,b=d.R)):(f=b.C,b=d),b&&(b.U=e),!f){if(b&&b.C)return b.C=!1,void 0;do{if(b===this._)break;if(b===e.L){if(a=e.R,a.C&&(a.C=!1,e.C=!0,Db(this,e),a=e.R),a.L&&a.L.C||a.R&&a.R.C){a.R&&a.R.C||(a.L.C=!1,a.C=!0,Eb(this,a),a=e.R);a.C=e.C;e.C=a.R.C=!1;Db(this,e);b=this._;break}}else if(a=e.L,a.C&&(a.C=!1,e.C=!0,Eb(this,
e),a=e.L),a.L&&a.L.C||a.R&&a.R.C){a.L&&a.L.C||(a.R.C=!1,a.C=!0,Db(this,a),a=e.L);a.C=e.C;e.C=a.L.C=!1;Eb(this,e);b=this._;break}a.C=!0;b=e;e=e.U}while(!b.C);b&&(b.C=!1)}}};v.geom.voronoi=function(b){function a(b){var f=Array(b.length),e=l[0][0],k=l[0][1],g=l[1][0],h=l[1][1];return nd(d(b),l).cells.forEach(function(a,d){var l=a.edges,n=a.site;(f[d]=l.length?l.map(function(b){b=b.start();return[b.x,b.y]}):n.x>=e&&n.x<=g&&n.y>=k&&n.y<=h?[[e,h],[g,h],[g,k],[e,k]]:[]).point=b[d]}),f}function d(b){return b.map(function(b,
a){return{x:Math.round(g(b,a)/C)*C,y:Math.round(h(b,a)/C)*C,i:a}})}var f=nb,e=Ab,g=f,h=e,l=Ec;return b?a(b):(a.links=function(b){return nd(d(b)).edges.filter(function(b){return b.l&&b.r}).map(function(a){return{source:b[a.l.i],target:b[a.r.i]}})},a.triangles=function(b){var a=[];return nd(d(b)).cells.forEach(function(d,f){for(var e,k=d.site,g=d.edges.sort(gf),h=-1,l=g.length,n=g[l-1].edge,n=n.l===k?n.r:n.l;++h<l;)e=n,n=g[h].edge,n=n.l===k?n.r:n.l,f<e.i&&f<n.i&&0>(k.x-n.x)*(e.y-k.y)-(k.x-e.x)*(n.y-
k.y)&&a.push([b[f],b[e.i],b[n.i]])}),a},a.x=function(b){return arguments.length?(g=S(f=b),a):f},a.y=function(b){return arguments.length?(h=S(e=b),a):e},a.clipExtent=function(b){return arguments.length?(l=null==b?Ec:b,a):l===Ec?null:l},a.size=function(b){return arguments.length?a.clipExtent(b&&[[0,0],b]):l===Ec?null:l&&l[1]},a)};var Ec=[[-1E6,-1E6],[1E6,1E6]];v.geom.delaunay=function(b){return v.geom.voronoi().triangles(b)};v.geom.quadtree=function(b,a,d,f,e){function g(b){function m(b,a,d,f,e,k,g,
h){if(!isNaN(d)&&!isNaN(f))if(b.leaf){var l=b.x,n=b.y;if(null!=l){if(!(.01>L(l-d)+L(n-f))){var t=b.point;b.x=b.y=b.point=null;p(b,t,l,n,e,k,g,h)}p(b,a,d,f,e,k,g,h)}else b.x=d,b.y=f,b.point=a}else p(b,a,d,f,e,k,g,h)}function p(b,a,d,f,e,k,g,h){var l=.5*(e+g),n=.5*(k+h),t=d>=l,q=f>=n,r=(q<<1)+t;b.leaf=!1;b=b.nodes[r]||(b.nodes[r]=lf());t?e=l:g=l;q?k=n:h=n;m(b,a,d,f,e,k,g,h)}var q,r,v,x,G,w,y,z,Q,D=S(l),F=S(n);if(null!=a)w=a,y=d,z=f,Q=e;else if(z=Q=-(w=y=1/0),r=[],v=[],G=b.length,h)for(x=0;G>x;++x)q=
b[x],q.x<w&&(w=q.x),q.y<y&&(y=q.y),q.x>z&&(z=q.x),q.y>Q&&(Q=q.y),r.push(q.x),v.push(q.y);else for(x=0;G>x;++x){var A=+D(q=b[x],x);q=+F(q,x);w>A&&(w=A);y>q&&(y=q);A>z&&(z=A);q>Q&&(Q=q);r.push(A);v.push(q)}A=z-w;q=Q-y;A>q?Q=y+A:z=w+q;var M=lf();if(M.add=function(b){m(M,b,+D(b,++x),+F(b,x),w,y,z,Q)},M.visit=function(b){Fb(b,M,w,y,z,Q)},x=-1,null==a){for(;++x<G;)m(M,b[x],r[x],v[x],w,y,z,Q);--x}else b.forEach(M.add);return r=v=b=q=null,M}var h,l=nb,n=Ab;return(h=arguments.length)?(l=nh,n=oh,3===h&&(e=
d,f=a,d=a=0),g(b)):(g.x=function(b){return arguments.length?(l=b,g):l},g.y=function(b){return arguments.length?(n=b,g):n},g.extent=function(b){return arguments.length?(null==b?a=d=f=e=null:(a=+b[0][0],d=+b[0][1],f=+b[1][0],e=+b[1][1]),g):null==a?null:[[a,d],[f,e]]},g.size=function(b){return arguments.length?(null==b?a=d=f=e=null:(a=d=0,f=+b[0],e=+b[1]),g):null==a?null:[f-a,e-d]},g)};v.interpolateRgb=od;v.interpolateObject=mf;v.interpolateNumber=La;v.interpolateString=nf;var pd=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,
qd=new RegExp(pd.source,"g");v.interpolate=cb;v.interpolators=[function(b,a){var d=typeof a;return("string"===d?Nb.has(a)||/^(#|rgb\(|hsl\()/.test(a)?od:nf:a instanceof Xa?od:Array.isArray(a)?ic:"object"===d&&isNaN(a)?mf:La)(b,a)}];v.interpolateArray=ic;var mg=function(){return ca},ui=v.map({linear:mg,poly:function(b){return function(a){return Math.pow(a,b)}},quad:function(){return qh},cubic:function(){return rh},sin:function(){return th},exp:function(){return uh},circle:function(){return vh},elastic:function(b,
a){var d;return 2>arguments.length&&(a=.45),arguments.length?d=a/na*Math.asin(1/b):(b=1,d=a/4),function(f){return 1+b*Math.pow(2,-10*f)*Math.sin((f-d)*na/a)}},back:function(b){return b||(b=1.70158),function(a){return a*a*((b+1)*a-b)}},bounce:function(){return wh}}),vi=v.map({"in":ca,out:of,"in-out":pf,"out-in":function(b){return pf(of(b))}});v.ease=function(b){var a=b.indexOf("-"),d=0<=a?b.slice(0,a):b,a=0<=a?b.slice(a+1):"in";return d=ui.get(d)||mg,a=vi.get(a)||ca,ph(a(d.apply(null,$f.call(arguments,
1))))};v.interpolateHcl=function(b,a){b=v.hcl(b);a=v.hcl(a);var d=b.h,f=b.c,e=b.l,g=a.h-d,h=a.c-f,l=a.l-e;return isNaN(h)&&(h=0,f=isNaN(f)?a.c:f),isNaN(g)?(g=0,d=isNaN(d)?a.h:d):180<g?g-=360:-180>g&&(g+=360),function(b){return Oc(d+g*b,f+h*b,e+l*b)+""}};v.interpolateHsl=function(b,a){b=v.hsl(b);a=v.hsl(a);var d=b.h,f=b.s,e=b.l,g=a.h-d,h=a.s-f,l=a.l-e;return isNaN(h)&&(h=0,f=isNaN(f)?a.s:f),isNaN(g)?(g=0,d=isNaN(d)?a.h:d):180<g?g-=360:-180>g&&(g+=360),function(b){return Nc(d+g*b,f+h*b,e+l*b)+""}};
v.interpolateLab=function(b,a){b=v.lab(b);a=v.lab(a);var d=b.l,f=b.a,e=b.b,g=a.l-d,h=a.a-f,l=a.b-e;return function(b){return ie(d+g*b,f+h*b,e+l*b)+""}};v.interpolateRound=qf;v.transform=function(b){var a=ya.createElementNS(v.ns.prefix.svg,"g");return(v.transform=function(b){if(null!=b){a.setAttribute("transform",b);var d=a.transform.baseVal.consolidate()}return new rf(d?d.matrix:wi)})(b)};rf.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+
")scale("+this.scale+")"};var wi={a:1,b:0,c:0,d:1,e:0,f:0};v.interpolateTransform=tf;v.layout={};v.layout.bundle=function(){return function(b){for(var a=[],d=-1,f=b.length;++d<f;)a.push(zh(b[d]));return a}};v.layout.chord=function(){function b(){var b,m,q,r,x,w={},y=[],z=v.range(g),ta=[];d=[];f=[];b=0;for(r=-1;++r<g;){m=0;for(x=-1;++x<g;)m+=e[r][x];y.push(m);ta.push(v.range(g));b+=m}h&&z.sort(function(b,a){return h(y[b],y[a])});l&&ta.forEach(function(b,a){b.sort(function(b,d){return l(e[a][b],e[a][d])})});
b=(na-p*g)/b;m=0;for(r=-1;++r<g;){q=m;for(x=-1;++x<g;){var Q=z[r],D=ta[Q][x],A=e[Q][D],F=m,M=m+=A*b;w[Q+"-"+D]={index:Q,subindex:D,startAngle:F,endAngle:M,value:A}}f[Q]={index:Q,startAngle:q,endAngle:m,value:(m-q)/b};m+=p}for(r=-1;++r<g;)for(x=r-1;++x<g;)b=w[r+"-"+x],m=w[x+"-"+r],(b.value||m.value)&&d.push(b.value<m.value?{source:m,target:b}:{source:b,target:m});n&&a()}function a(){d.sort(function(b,a){return n((b.source.value+b.target.value)/2,(a.source.value+a.target.value)/2)})}var d,f,e,g,h,l,
n,m={},p=0;return m.matrix=function(b){return arguments.length?(g=(e=b)&&e.length,d=f=null,m):e},m.padding=function(b){return arguments.length?(p=b,d=f=null,m):p},m.sortGroups=function(b){return arguments.length?(h=b,d=f=null,m):h},m.sortSubgroups=function(b){return arguments.length?(l=b,d=null,m):l},m.sortChords=function(b){return arguments.length?(n=b,d&&a(),m):n},m.chords=function(){return d||b(),d},m.groups=function(){return f||b(),f},m};v.layout.force=function(){function b(b){return function(a,
d,f,e){if(a.point!==b){f=a.cx-b.x;var g=a.cy-b.y;d=e-d;e=f*f+g*g;if(e>d*d/z)return w>e&&(d=a.charge/e,b.px-=f*d,b.py-=g*d),!0;a.point&&e&&w>e&&(d=a.pointCharge/e,b.px-=f*d,b.py-=g*d)}return!a.charge}}function a(b){b.px=v.event.x;b.py=v.event.y;l.resume()}var d,f,e,g,h,l={},n=v.dispatch("start","tick","end"),m=[1,1],p=.9,q=xi,r=yi,x=-30,w=zi,y=.1,z=.64,A=[],N=[];return l.tick=function(){if(.005>(f*=.99))return n.end({type:"end",alpha:f=0}),!0;var a,d,k,l,q,t,r,w,z=A.length,Y=N.length;for(d=0;Y>d;++d)k=
N[d],a=k.source,l=k.target,r=l.x-a.x,w=l.y-a.y,(q=r*r+w*w)&&(q=f*g[d]*((q=Math.sqrt(q))-e[d])/q,r*=q,w*=q,l.x-=r*(t=a.weight/(l.weight+a.weight)),l.y-=w*t,a.x+=r*(t=1-t),a.y+=w*t);if((t=f*y)&&(r=m[0]/2,w=m[1]/2,d=-1,t))for(;++d<z;)k=A[d],k.x+=(r-k.x)*t,k.y+=(w-k.y)*t;if(x)for(vf(a=v.geom.quadtree(A),f,h),d=-1;++d<z;)(k=A[d]).fixed||a.visit(b(k));for(d=-1;++d<z;)k=A[d],k.fixed?(k.x=k.px,k.y=k.py):(k.x-=(k.px-(k.px=k.x))*p,k.y-=(k.py-(k.py=k.y))*p);n.tick({type:"tick",alpha:f})},l.nodes=function(b){return arguments.length?
(A=b,l):A},l.links=function(b){return arguments.length?(N=b,l):N},l.size=function(b){return arguments.length?(m=b,l):m},l.linkDistance=function(b){return arguments.length?(q="function"==typeof b?b:+b,l):q},l.distance=l.linkDistance,l.linkStrength=function(b){return arguments.length?(r="function"==typeof b?b:+b,l):r},l.friction=function(b){return arguments.length?(p=+b,l):p},l.charge=function(b){return arguments.length?(x="function"==typeof b?b:+b,l):x},l.chargeDistance=function(b){return arguments.length?
(w=b*b,l):Math.sqrt(w)},l.gravity=function(b){return arguments.length?(y=+b,l):y},l.theta=function(b){return arguments.length?(z=b*b,l):Math.sqrt(z)},l.alpha=function(b){return arguments.length?(b=+b,f?f=0<b?b:0:0<b&&(n.start({type:"start",alpha:f=b}),v.timer(l.tick)),l):f},l.start=function(){function b(f,e){if(!d){d=Array(k);for(l=0;k>l;++l)d[l]=[];for(l=0;n>l;++l){var g=N[l];d[g.source.index].push(g.target);d[g.target.index].push(g.source)}}for(var h=d[a],l=-1,n=h.length;++l<n;)if(!isNaN(g=h[l][f]))return g;
return Math.random()*e}var a,d,f,k=A.length,n=N.length,p=m[0],t=m[1];for(a=0;k>a;++a)(f=A[a]).index=a,f.weight=0;for(a=0;n>a;++a)f=N[a],"number"==typeof f.source&&(f.source=A[f.source]),"number"==typeof f.target&&(f.target=A[f.target]),++f.source.weight,++f.target.weight;for(a=0;k>a;++a)f=A[a],isNaN(f.x)&&(f.x=b("x",p)),isNaN(f.y)&&(f.y=b("y",t)),isNaN(f.px)&&(f.px=f.x),isNaN(f.py)&&(f.py=f.y);if(e=[],"function"==typeof q)for(a=0;n>a;++a)e[a]=+q.call(this,N[a],a);else for(a=0;n>a;++a)e[a]=q;if(g=
[],"function"==typeof r)for(a=0;n>a;++a)g[a]=+r.call(this,N[a],a);else for(a=0;n>a;++a)g[a]=r;if(h=[],"function"==typeof x)for(a=0;k>a;++a)h[a]=+x.call(this,A[a],a);else for(a=0;k>a;++a)h[a]=x;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){return d||(d=v.behavior.drag().origin(ca).on("dragstart.force",Ah).on("drag.force",a).on("dragend.force",Bh)),arguments.length?(this.on("mouseover.force",Ch).on("mouseout.force",Dh).call(d),void 0):
d},v.rebind(l,n,"on")};var xi=20,yi=1,zi=1/0;v.layout.hierarchy=function(){function b(e){var g,h=[e],l=[];for(e.depth=0;null!=(g=h.pop());)if(l.push(g),(m=d.call(b,g,g.depth))&&(n=m.length)){for(var n,m,p;0<=--n;)h.push(p=m[n]),p.parent=g,p.depth=g.depth+1;f&&(g.value=0);g.children=m}else f&&(g.value=+f.call(b,g,g.depth)||0),delete g.children;return Da(e,function(b){var d,e;a&&(d=b.children)&&d.sort(a);f&&(e=b.parent)&&(e.value+=b.value)}),l}var a=Hh,d=Fh,f=Gh;return b.sort=function(d){return arguments.length?
(a=d,b):a},b.children=function(a){return arguments.length?(d=a,b):d},b.value=function(a){return arguments.length?(f=a,b):f},b.revalue=function(a){return f&&(Hb(a,function(b){b.children&&(b.value=0)}),Da(a,function(a){var d;a.children||(a.value=+f.call(b,a,a.depth)||0);(d=a.parent)&&(d.value+=a.value)})),a},b};v.layout.partition=function(){function b(a,d,f,e){var g=a.children;if(a.x=d,a.y=a.depth*e,a.dx=f,a.dy=e,g&&(k=g.length)){var k,h,l=-1;for(f=a.value?f/a.value:0;++l<k;)b(h=g[l],d,a=h.value*f,
e),d+=a}}function a(b){b=b.children;var d=0;if(b&&(f=b.length))for(var f,e=-1;++e<f;)d=Math.max(d,a(b[e]));return 1+d}function d(g,h){var l=f.call(this,g,h);return b(l[0],0,e[0],e[1]/a(l[0])),l}var f=v.layout.hierarchy(),e=[1,1];return d.size=function(b){return arguments.length?(e=b,d):e},Gb(d,f)};v.layout.pie=function(){function b(g){var h=g.map(function(d,f){return+a.call(b,d,f)}),l=+("function"==typeof f?f.apply(this,arguments):f),n=(("function"==typeof e?e.apply(this,arguments):e)-l)/v.sum(h),
m=v.range(g.length);null!=d&&m.sort(d===ng?function(b,a){return h[a]-h[b]}:function(b,a){return d(g[b],g[a])});var p=[];return m.forEach(function(b){var a;p[b]={data:g[b],value:a=h[b],startAngle:l,endAngle:l+=a*n}}),p}var a=Number,d=ng,f=0,e=na;return b.value=function(d){return arguments.length?(a=d,b):a},b.sort=function(a){return arguments.length?(d=a,b):d},b.startAngle=function(a){return arguments.length?(f=a,b):f},b.endAngle=function(a){return arguments.length?(e=a,b):e},b};var ng={};v.layout.stack=
function(){function b(l,n){if(!(r=l.length))return l;var m=l.map(function(d,f){return a.call(b,d,f)}),p=m.map(function(a){return a.map(function(a,d){return[g.call(b,a,d),h.call(b,a,d)]})}),q=d.call(b,p,n),m=v.permute(m,q),p=v.permute(p,q),r,x,w,y=f.call(b,p,n),z=m[0].length;for(x=0;z>x;++x)for(e.call(b,m[0][x],w=y[x],p[0][x][1]),q=1;r>q;++q)e.call(b,m[q][x],w+=p[q-1][x][1],p[q][x][1]);return l}var a=ca,d=rd,f=sd,e=Kh,g=Ih,h=Jh;return b.values=function(d){return arguments.length?(a=d,b):a},b.order=
function(a){return arguments.length?(d="function"==typeof a?a:Ai.get(a)||rd,b):d},b.offset=function(a){return arguments.length?(f="function"==typeof a?a:Bi.get(a)||sd,b):f},b.x=function(a){return arguments.length?(g=a,b):g},b.y=function(a){return arguments.length?(h=a,b):h},b.out=function(a){return arguments.length?(e=a,b):e},b};var Ai=v.map({"inside-out":function(b){var a,d=b.length,f=b.map(Lh),e=b.map(Mh),g=v.range(d).sort(function(b,a){return f[b]-f[a]}),h=0,l=0,n=[],m=[];for(b=0;d>b;++b)a=g[b],
l>h?(h+=e[a],n.push(a)):(l+=e[a],m.push(a));return m.reverse().concat(n)},reverse:function(b){return v.range(b.length).reverse()},"default":rd}),Bi=v.map({silhouette:function(b){var a,d,f,e=b.length,g=b[0].length,h=[],l=0,n=[];for(d=0;g>d;++d){for(f=a=0;e>a;a++)f+=b[a][d][1];f>l&&(l=f);h.push(f)}for(d=0;g>d;++d)n[d]=(l-h[d])/2;return n},wiggle:function(b){var a,d,f,e,g,h,l,n,m,p=b.length,q=b[0],r=q.length,x=[];x[0]=n=m=0;for(d=1;r>d;++d){for(e=a=0;p>a;++a)e+=b[a][d][1];g=a=0;for(l=q[d][0]-q[d-1][0];p>
a;++a){f=0;for(h=(b[a][d][1]-b[a][d-1][1])/(2*l);a>f;++f)h+=(b[f][d][1]-b[f][d-1][1])/l;g+=h*b[a][d][1]}x[d]=n-=e?g/e*l:0;m>n&&(m=n)}for(d=0;r>d;++d)x[d]-=m;return x},expand:function(b){var a,d,f,e=b.length,g=b[0].length,h=1/e,l=[];for(d=0;g>d;++d){for(f=a=0;e>a;a++)f+=b[a][d][1];if(f)for(a=0;e>a;a++)b[a][d][1]/=f;else for(a=0;e>a;a++)b[a][d][1]=h}for(d=0;g>d;++d)l[d]=0;return l},zero:sd});v.layout.histogram=function(){function b(b,g){var h,l,n=[],m=b.map(d,this),p=f.call(this,m,g),q=e.call(this,
p,m,g);g=-1;for(var r=m.length,x=q.length-1,w=a?1:1/r;++g<x;)h=n[g]=[],h.dx=q[g+1]-(h.x=q[g]),h.y=0;if(0<x)for(g=-1;++g<r;)l=m[g],l>=p[0]&&l<=p[1]&&(h=n[v.bisect(q,l,1,x)-1],h.y+=w,h.push(b[g]));return n}var a=!0,d=Number,f=Ph,e=Oh;return b.value=function(a){return arguments.length?(d=a,b):d},b.range=function(a){return arguments.length?(f=S(a),b):f},b.bins=function(a){return arguments.length?(e="number"==typeof a?function(b){return wf(b,a)}:S(a),b):e},b.frequency=function(d){return arguments.length?
(a=!!d,b):a},b};v.layout.pack=function(){function b(b,g){var h=d.call(this,b,g),l=h[0],n=e[0],m=e[1],p=null==a?Math.sqrt:"function"==typeof a?a:function(){return a};if(l.x=l.y=0,Da(l,function(b){b.r=+p(b.value)}),Da(l,zf),f){var q=f*(a?1:Math.max(2*l.r/n,2*l.r/m))/2;Da(l,function(b){b.r+=q});Da(l,zf);Da(l,function(b){b.r-=q})}return Bf(l,n/2,m/2,a?1:1/Math.max(2*l.r/n,2*l.r/m)),h}var a,d=v.layout.hierarchy().sort(Qh),f=0,e=[1,1];return b.size=function(a){return arguments.length?(e=a,b):e},b.radius=
function(d){return arguments.length?(a=null==d||"function"==typeof d?d:+d,b):a},b.padding=function(a){return arguments.length?(f=+a,b):f},Gb(b,d)};v.layout.tree=function(){function b(b,m){var p=g.call(this,b,m),q=p[0],r=a(q);if(Da(r,d),r.parent.m=-r.z,Hb(r,f),n)Hb(q,e);else{var x=q,v=q,w=q;Hb(q,function(b){b.x<x.x&&(x=b);b.x>v.x&&(v=b);b.depth>w.depth&&(w=b)});var y=h(x,v)/2-x.x,z=l[0]/(v.x+h(v,x)/2+y),A=l[1]/(w.depth||1);Hb(q,function(b){b.x=(b.x+y)*z;b.y=b.depth*A})}return p}function a(b){for(var d=
{A:null,children:[b]},f=[d];null!=(b=f.pop());)for(var e,g=b.children,k=0,h=g.length;h>k;++k)f.push((g[k]=e={_:g[k],parent:b,children:(e=g[k].children)&&e.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:k}).a=e);return d.children[0]}function d(b){var a=b.children,f=b.parent.children,e=b.i?f[b.i-1]:null;if(a.length){for(var g,k=0,l=0,n=b.children,m=n.length;0<=--m;)g=n[m],g.z+=k,g.m+=k,k+=g.s+(l+=g.c);a=(a[0].z+a[a.length-1].z)/2;e?(b.z=e.z+h(b._,e._),b.m=b.z-a):b.z=a}else e&&(b.z=e.z+h(b._,e._));
a=b.parent;f=b.parent.A||f[0];if(e){for(var k=g=b,l=e,n=g.parent.children[0],m=g.m,p=k.m,q=l.m,t=n.m;l=vd(l),g=ud(g),l&&g;){n=ud(n);k=vd(k);k.a=b;e=l.z+q-g.z-m+h(l._,g._);if(0<e){var r=l.a.parent===b.parent?l.a:f,x=b,v=e,w=v/(x.i-r.i);x.c-=w;x.s+=v;r.c+=w;x.z+=v;x.m+=v;m+=e;p+=e}q+=l.m;m+=g.m;t+=n.m;p+=k.m}l&&!vd(k)&&(k.t=l,k.m+=q-p);g&&!ud(n)&&(n.t=g,n.m+=m-t,f=b)}a.A=f}function f(b){b._.x=b.z+b.parent.m;b.m+=b.parent.m}function e(b){b.x*=l[0];b.y=b.depth*l[1]}var g=v.layout.hierarchy().sort(null).value(null),
h=Cf,l=[1,1],n=null;return b.separation=function(a){return arguments.length?(h=a,b):h},b.size=function(a){return arguments.length?(n=null==(l=a)?e:null,b):n?null:l},b.nodeSize=function(a){return arguments.length?(n=null==(l=a)?null:e,b):n?l:null},Gb(b,g)};v.layout.cluster=function(){function b(b,g){var h,l=a.call(this,b,g),n=l[0],m=0;Da(n,function(b){var a=b.children;a&&a.length?(b.x=Uh(a),b.y=Th(a)):(b.x=h?m+=d(b,h):0,b.y=0,h=b)});var p=Df(n),q=Ef(n),r=p.x-d(p,q)/2,x=q.x+d(q,p)/2;return Da(n,e?function(b){b.x=
(b.x-n.x)*f[0];b.y=(n.y-b.y)*f[1]}:function(b){b.x=(b.x-r)/(x-r)*f[0];b.y=(1-(n.y?b.y/n.y:1))*f[1]}),l}var a=v.layout.hierarchy().sort(null).value(null),d=Cf,f=[1,1],e=!1;return b.separation=function(a){return arguments.length?(d=a,b):d},b.size=function(a){return arguments.length?(e=null==(f=a),b):e?null:f},b.nodeSize=function(a){return arguments.length?(e=null!=(f=a),b):e?f:null},Gb(b,a)};v.layout.treemap=function(){function b(b,a){for(var d,f,e=-1,g=b.length;++e<g;)f=(d=b[e]).value*(0>a?0:a),d.area=
isNaN(f)||0>=f?0:f}function a(d){var e=d.children;if(e&&e.length){var g,h=p(d),l=[],n=e.slice(),m=1/0,q="slice"===r?h.dx:"dice"===r?h.dy:"slice-dice"===r?1&d.depth?h.dy:h.dx:Math.min(h.dx,h.dy);b(n,h.dx*h.dy/d.value);for(l.area=0;0<(d=n.length);){l.push(d=n[d-1]);l.area+=d.area;var t;if(!(t="squarify"!==r)){d=q;g=void 0;var v=l.area;t=0;for(var w=1/0,y=-1,z=l.length;++y<z;)(g=l[y].area)&&(w>g&&(w=g),g>t&&(t=g));t=(g=(v*=v,d*=d,v?Math.max(d*t*x/v,v/(d*w*x)):1/0))<=m}t?(n.pop(),m=g):(l.area-=l.pop().area,
f(l,q,h,!1),q=Math.min(h.dx,h.dy),l.length=l.area=0,m=1/0)}l.length&&(f(l,q,h,!0),l.length=l.area=0);e.forEach(a)}}function d(a){var e=a.children;if(e&&e.length){var g=p(a),k=e.slice(),h=[];b(k,g.dx*g.dy/a.value);for(h.area=0;a=k.pop();)h.push(a),h.area+=a.area,null!=a.z&&(f(h,a.z?g.dx:g.dy,g,!k.length),h.length=h.area=0);e.forEach(d)}}function f(b,a,d,e){var g,k=-1,h=b.length,n=d.x,m=d.y,p=a?l(b.area/a):0;if(a==d.dx){for((e||p>d.dy)&&(p=d.dy);++k<h;)g=b[k],g.x=n,g.y=m,g.dy=p,n+=g.dx=Math.min(d.x+
d.dx-n,p?l(g.area/p):0);g.z=!0;g.dx+=d.x+d.dx-n;d.y+=p;d.dy-=p}else{for((e||p>d.dx)&&(p=d.dx);++k<h;)g=b[k],g.x=n,g.y=m,g.dx=p,m+=g.dy=Math.min(d.y+d.dy-m,p?l(g.area/p):0);g.z=!1;g.dy+=d.y+d.dy-m;d.x+=p;d.dx-=p}}function e(f){f=g||h(f);var l=f[0];return l.x=0,l.y=0,l.dx=n[0],l.dy=n[1],g&&h.revalue(l),b([l],l.dx*l.dy/l.value),(g?d:a)(l),q&&(g=f),f}var g,h=v.layout.hierarchy(),l=Math.round,n=[1,1],m=null,p=wd,q=!1,r="squarify",x=.5*(1+Math.sqrt(5));return e.size=function(b){return arguments.length?
(n=b,e):n},e.padding=function(b){function a(d){var f=b.call(e,d,d.depth);return null==f?wd(d):Ff(d,"number"==typeof f?[f,f,f,f]:f)}function d(a){return Ff(a,b)}if(!arguments.length)return m;var f;return p=null==(m=b)?wd:"function"==(f=typeof b)?a:"number"===f?(b=[b,b,b,b],d):d,e},e.round=function(b){return arguments.length?(l=b?Math.round:Number,e):l!=Number},e.sticky=function(b){return arguments.length?(q=b,g=null,e):q},e.ratio=function(b){return arguments.length?(x=b,e):x},e.mode=function(b){return arguments.length?
(r=b+"",e):r},Gb(e,h)};v.random={normal:function(b,a){var d=arguments.length;return 2>d&&(a=1),1>d&&(b=0),function(){var d,f;do d=2*Math.random()-1,f=2*Math.random()-1,f=d*d+f*f;while(!f||1<f);return b+a*d*Math.sqrt(-2*Math.log(f)/f)}},logNormal:function(){var b=v.random.normal.apply(v,arguments);return function(){return Math.exp(b())}},bates:function(b){var a=v.random.irwinHall(b);return function(){return a()/b}},irwinHall:function(b){return function(){for(var a=0,d=0;b>d;d++)a+=Math.random();return a}}};
v.scale={};var Wh={floor:ca,ceil:ca};v.scale.linear=function(){return Hf([0,1],[0,1],cb,!1)};var Zh={s:1,g:1,p:1,r:1,e:1};v.scale.log=function(){return If(v.scale.linear().domain([0,1]),10,!0,[1,10])};var Jf=v.format(".0e"),$h={floor:function(b){return-Math.ceil(-b)},ceil:function(b){return-Math.floor(-b)}};v.scale.pow=function(){return Kf(v.scale.linear(),1,[0,1])};v.scale.sqrt=function(){return v.scale.pow().exponent(.5)};v.scale.ordinal=function(){return Lf([],{t:"range",a:[[]]})};v.scale.category10=
function(){return v.scale.ordinal().range(Ci)};v.scale.category20=function(){return v.scale.ordinal().range(Di)};v.scale.category20b=function(){return v.scale.ordinal().range(Ei)};v.scale.category20c=function(){return v.scale.ordinal().range(Fi)};var Ci=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Mb),Di=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,
1556175,10410725].map(Mb),Ei=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Mb),Fi=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Mb);v.scale.quantile=function(){return Mf([],[])};v.scale.quantize=function(){return Nf(0,1,[0,1])};v.scale.threshold=
function(){return Of([.5],[0,1])};v.scale.identity=function(){return Pf([0,1])};v.svg={};v.svg.arc=function(){function b(){var b=a.apply(this,arguments),g=d.apply(this,arguments),h=f.apply(this,arguments)+db,l=e.apply(this,arguments)+db,n=(h>l&&(n=h,h=l,l=n),l-h),m=J>n?"0":"1",p=Math.cos(h),h=Math.sin(h),q=Math.cos(l),l=Math.sin(l);return n>=Gi?b?"M0,"+g+"A"+g+","+g+" 0 1,1 0,"+-g+"A"+g+","+g+" 0 1,1 0,"+g+"M0,"+b+"A"+b+","+b+" 0 1,0 0,"+-b+"A"+b+","+b+" 0 1,0 0,"+b+"Z":"M0,"+g+"A"+g+","+g+" 0 1,1 0,"+
-g+"A"+g+","+g+" 0 1,1 0,"+g+"Z":b?"M"+g*p+","+g*h+"A"+g+","+g+" 0 "+m+",1 "+g*q+","+g*l+"L"+b*q+","+b*l+"A"+b+","+b+" 0 "+m+",0 "+b*p+","+b*h+"Z":"M"+g*p+","+g*h+"A"+g+","+g+" 0 "+m+",1 "+g*q+","+g*l+"L0,0Z"}var a=ai,d=bi,f=Qf,e=Rf;return b.innerRadius=function(d){return arguments.length?(a=S(d),b):a},b.outerRadius=function(a){return arguments.length?(d=S(a),b):d},b.startAngle=function(a){return arguments.length?(f=S(a),b):f},b.endAngle=function(a){return arguments.length?(e=S(a),b):e},b.centroid=
function(){var b=(a.apply(this,arguments)+d.apply(this,arguments))/2,g=(f.apply(this,arguments)+e.apply(this,arguments))/2+db;return[Math.cos(g)*b,Math.sin(g)*b]},b};var db=-da,Gi=na-C;v.svg.line=function(){return Sf(ca)};var zd=v.map({linear:oa,"linear-closed":function(b){return oa(b)+"Z"},step:function(b){for(var a=0,d=b.length,f=b[0],e=[f[0],",",f[1]];++a<d;)e.push("H",(f[0]+(f=b[a])[0])/2,"V",f[1]);return 1<d&&e.push("H",f[0]),e.join("")},"step-before":Ad,"step-after":Bd,basis:Tf,"basis-open":function(b){if(4>
b.length)return oa(b);for(var a,d=[],f=-1,e=b.length,g=[0],h=[0];3>++f;)a=b[f],g.push(a[0]),h.push(a[1]);d.push(ra(Va,g)+","+ra(Va,h));for(--f;++f<e;)a=b[f],g.shift(),g.push(a[0]),h.shift(),h.push(a[1]),Dd(d,g,h);return d.join("")},"basis-closed":function(b){for(var a,d,f=-1,e=b.length,g=e+4,h=[],l=[];4>++f;)d=b[f%e],h.push(d[0]),l.push(d[1]);a=[ra(Va,h),",",ra(Va,l)];for(--f;++f<g;)d=b[f%e],h.shift(),h.push(d[0]),l.shift(),l.push(d[1]),Dd(a,h,l);return a.join("")},bundle:function(b,a){var d=b.length-
1;if(d)for(var f,e,g=b[0][0],h=b[0][1],l=b[d][0]-g,n=b[d][1]-h,m=-1;++m<=d;)f=b[m],e=m/d,f[0]=a*f[0]+(1-a)*(g+e*l),f[1]=a*f[1]+(1-a)*(h+e*n);return Tf(b)},cardinal:function(b,a){return 3>b.length?oa(b):b[0]+nc(b,Cd(b,a))},"cardinal-open":function(b,a){return 4>b.length?oa(b):b[1]+nc(b.slice(1,b.length-1),Cd(b,a))},"cardinal-closed":function(b,a){return 3>b.length?oa(b):b[0]+nc((b.push(b[0]),b),Cd([b[b.length-2]].concat(b,[b[1]]),a))},monotone:function(b){if(3>b.length)b=oa(b);else{var a=b[0],d,f,
e,g,h=[],l;d=0;l=b.length-1;for(var n=[],m=b[1],p=n[0]=Ed(b[0],m);++d<l;)n[d]=(p+(p=Ed(m,m=b[d+1])))/2;l=(n[d]=p,n);n=-1;for(m=b.length-1;++n<m;)d=Ed(b[n],b[n+1]),L(d)<C?l[n]=l[n+1]=0:(f=l[n]/d,e=l[n+1]/d,g=f*f+e*e,9<g&&(g=3*d/Math.sqrt(g),l[n]=g*f,l[n+1]=g*e));for(n=-1;++n<=m;)g=(b[Math.min(m,n+1)][0]-b[Math.max(0,n-1)][0])/(6*(1+l[n]*l[n])),h.push([g||0,l[n]*g||0]);b=a+nc(b,h)}return b}});zd.forEach(function(b,a){a.key=b;a.closed=/-closed$/.test(b)});var Uf=[0,2/3,1/3,0],Vf=[0,1/3,2/3,0],Va=[0,
1/6,2/3,1/6];v.svg.line.radial=function(){var b=Sf(Wf);return b.radius=b.x,delete b.x,b.angle=b.y,delete b.y,b};Ad.reverse=Bd;Bd.reverse=Ad;v.svg.area=function(){return Xf(ca)};v.svg.area.radial=function(){var b=Xf(Wf);return b.radius=b.x,delete b.x,b.innerRadius=b.x0,delete b.x0,b.outerRadius=b.x1,delete b.x1,b.angle=b.y,delete b.y,b.startAngle=b.y0,delete b.y0,b.endAngle=b.y1,delete b.y1,b};v.svg.chord=function(){function b(b,g){var h=a(this,f,b,g),l=a(this,e,b,g);return"M"+h.p0+d(h.r,h.p1,h.a1-
h.a0)+(h.a0==l.a0&&h.a1==l.a1?"Q 0,0 "+h.p0:"Q 0,0 "+l.p0+d(l.r,l.p1,l.a1-l.a0)+("Q 0,0 "+h.p0))+"Z"}function a(b,d,f,e){var k=d.call(b,f,e);d=g.call(b,k,e);f=h.call(b,k,e)+db;b=l.call(b,k,e)+db;return{r:d,a0:f,a1:b,p0:[d*Math.cos(f),d*Math.sin(f)],p1:[d*Math.cos(b),d*Math.sin(b)]}}function d(b,a,f){return"A"+b+","+b+" 0 "+ +(f>J)+",1 "+a}var f=fd,e=gd,g=ci,h=Qf,l=Rf;return b.radius=function(a){return arguments.length?(g=S(a),b):g},b.source=function(a){return arguments.length?(f=S(a),b):f},b.target=
function(a){return arguments.length?(e=S(a),b):e},b.startAngle=function(a){return arguments.length?(h=S(a),b):h},b.endAngle=function(a){return arguments.length?(l=S(a),b):l},b};v.svg.diagonal=function(){function b(b,e){var g=a.call(this,b,e),h=d.call(this,b,e),l=(g.y+h.y)/2,g=[g,{x:g.x,y:l},{x:h.x,y:l},h];return g=g.map(f),"M"+g[0]+"C"+g[1]+" "+g[2]+" "+g[3]}var a=fd,d=gd,f=Yf;return b.source=function(d){return arguments.length?(a=S(d),b):a},b.target=function(a){return arguments.length?(d=S(a),b):
d},b.projection=function(a){return arguments.length?(f=a,b):f},b};v.svg.diagonal.radial=function(){var b=v.svg.diagonal(),a=Yf,d=b.projection;return b.projection=function(b){return arguments.length?d(di(a=b)):a},b};v.svg.symbol=function(){function b(b,f){return(og.get(a.call(this,b,f))||Zf)(d.call(this,b,f))}var a=fi,d=ei;return b.type=function(d){return arguments.length?(a=S(d),b):a},b.size=function(a){return arguments.length?(d=S(a),b):d},b};var og=v.map({circle:Zf,cross:function(b){b=Math.sqrt(b/
5)/2;return"M"+-3*b+","+-b+"H"+-b+"V"+-3*b+"H"+b+"V"+-b+"H"+3*b+"V"+b+"H"+b+"V"+3*b+"H"+-b+"V"+b+"H"+-3*b+"Z"},diamond:function(b){b=Math.sqrt(b/(2*pg));var a=b*pg;return"M0,"+-b+"L"+a+",0 0,"+b+" "+-a+",0Z"},square:function(b){b=Math.sqrt(b)/2;return"M"+-b+","+-b+"L"+b+","+-b+" "+b+","+b+" "+-b+","+b+"Z"},"triangle-down":function(b){b=Math.sqrt(b/Fc);var a=b*Fc/2;return"M0,"+a+"L"+b+","+-a+" "+-b+","+-a+"Z"},"triangle-up":function(b){b=Math.sqrt(b/Fc);var a=b*Fc/2;return"M0,"+-a+"L"+b+","+a+" "+
-b+","+a+"Z"}});v.svg.symbolTypes=og.keys();var fb,rc,Fc=Math.sqrt(3),pg=Math.tan(30*I),aa=[],dg=0;aa.call=K.call;aa.empty=K.empty;aa.node=K.node;aa.size=K.size;v.transition=function(b){return arguments.length?fb?b.transition():b:cg.transition()};v.transition.prototype=aa;aa.select=function(b){var a,d,f,e=this.id,g=[];b=W(b);for(var h=-1,l=this.length;++h<l;){g.push(a=[]);for(var n=this[h],m=-1,p=n.length;++m<p;)(f=n[m])&&(d=b.call(f,f.__data__,m,h))?("__data__"in f&&(d.__data__=f.__data__),oc(d,
m,e,f.__transition__[e]),a.push(d)):a.push(null)}return Ib(g,e)};aa.selectAll=function(b){var a,d,f,e,g=this.id,h=[];b=ba(b);for(var l=-1,n=this.length;++l<n;)for(var m=this[l],p=-1,q=m.length;++p<q;)if(a=m[p]){e=a.__transition__[g];d=b.call(a,a.__data__,p,l);h.push(a=[]);for(var r=-1,x=d.length;++r<x;)(f=d[r])&&oc(f,r,g,e),a.push(f)}return Ib(h,g)};aa.filter=function(b){var a,d,f,e=[];"function"!=typeof b&&(b=Xd(b));for(var g=0,h=this.length;h>g;g++){e.push(a=[]);d=this[g];for(var l=0,n=d.length;n>
l;l++)(f=d[l])&&b.call(f,f.__data__,l,g)&&a.push(f)}return Ib(e,this.id)};aa.tween=function(b,a){var d=this.id;return 2>arguments.length?this.node().__transition__[d].tween.get(b):Ea(this,null==a?function(a){a.__transition__[d].tween.remove(b)}:function(f){f.__transition__[d].tween.set(b,a)})};aa.attr=function(b,a){function d(){this.removeAttribute(l)}function f(){this.removeAttributeNS(l.space,l.local)}function e(b){return null==b?d:(b+="",function(){var a,d=this.getAttribute(l);return d!==b&&(a=
h(d,b),function(b){this.setAttribute(l,a(b))})})}function g(b){return null==b?f:(b+="",function(){var a,d=this.getAttributeNS(l.space,l.local);return d!==b&&(a=h(d,b),function(b){this.setAttributeNS(l.space,l.local,a(b))})})}if(2>arguments.length){for(a in b)this.attr(a,b[a]);return this}var h="transform"==b?tf:cb,l=v.ns.qualify(b);return Fd(this,"attr."+b,a,l.local?g:e)};aa.attrTween=function(b,a){function d(b,f){var g=a.call(this,b,f,this.getAttribute(e));return g&&function(b){this.setAttribute(e,
g(b))}}function f(b,d){var g=a.call(this,b,d,this.getAttributeNS(e.space,e.local));return g&&function(b){this.setAttributeNS(e.space,e.local,g(b))}}var e=v.ns.qualify(b);return this.tween("attr."+b,e.local?f:d)};aa.style=function(b,a,d){function f(){this.style.removeProperty(b)}var e=arguments.length;if(3>e){if("string"!=typeof b){2>e&&(a="");for(d in b)this.style(d,b[d],a);return this}d=""}return Fd(this,"style."+b,a,function(a){return null==a?f:(a+="",function(){var f,e=ha.getComputedStyle(this,
null).getPropertyValue(b);return e!==a&&(f=cb(e,a),function(a){this.style.setProperty(b,f(a),d)})})})};aa.styleTween=function(b,a,d){return 3>arguments.length&&(d=""),this.tween("style."+b,function(f,e){var g=a.call(this,f,e,ha.getComputedStyle(this,null).getPropertyValue(b));return g&&function(a){this.style.setProperty(b,g(a),d)}})};aa.text=function(b){return Fd(this,"text",b,gi)};aa.remove=function(){return this.each("end.transition",function(){var b;2>this.__transition__.count&&(b=this.parentNode)&&
b.removeChild(this)})};aa.ease=function(b){var a=this.id;return 1>arguments.length?this.node().__transition__[a].ease:("function"!=typeof b&&(b=v.ease.apply(v,arguments)),Ea(this,function(d){d.__transition__[a].ease=b}))};aa.delay=function(b){var a=this.id;return 1>arguments.length?this.node().__transition__[a].delay:Ea(this,"function"==typeof b?function(d,f,e){d.__transition__[a].delay=+b.call(d,d.__data__,f,e)}:(b=+b,function(d){d.__transition__[a].delay=b}))};aa.duration=function(b){var a=this.id;
return 1>arguments.length?this.node().__transition__[a].duration:Ea(this,"function"==typeof b?function(d,f,e){d.__transition__[a].duration=Math.max(1,b.call(d,d.__data__,f,e))}:(b=Math.max(1,b),function(d){d.__transition__[a].duration=b}))};aa.each=function(b,a){var d=this.id;if(2>arguments.length){var f=rc,e=fb;fb=d;Ea(this,function(a,f,e){rc=a.__transition__[d];b.call(a,a.__data__,f,e)});rc=f;fb=e}else Ea(this,function(f){f=f.__transition__[d];(f.event||(f.event=v.dispatch("start","end"))).on(b,
a)});return this};aa.transition=function(){for(var b,a,d,f,e=this.id,g=++dg,h=[],l=0,n=this.length;n>l;l++){h.push(b=[]);a=this[l];for(var m=0,p=a.length;p>m;m++)(d=a[m])&&(f=Object.create(d.__transition__[e]),f.delay+=f.duration,oc(d,m,g,f)),b.push(d)}return Ib(h,g)};v.svg.axis=function(){function b(b){b.each(function(){var b,m=v.select(this),p=this.__chart__||d,q=this.__chart__=d.copy(),r=null==n?q.ticks?q.ticks.apply(q,l):q.domain():n,x=null==a?q.tickFormat?q.tickFormat.apply(q,l):ca:a,w=m.selectAll(".tick").data(r,
q),r=w.enter().insert("g",".domain").attr("class","tick").style("opacity",C),y=v.transition(w.exit()).style("opacity",C).remove(),z=v.transition(w.order()).style("opacity",1),A=Math.max(e,0)+h,F=jc(q),m=m.selectAll(".domain").data([0]),m=(m.enter().append("path").attr("class","domain"),v.transition(m));r.append("line");r.append("text");var M,B,H,ba,I=r.select("line"),J=z.select("line"),x=w.select("text").text(x),w=r.select("text"),L=z.select("text"),R="top"===f||"left"===f?-1:1;if("bottom"===f||"top"===
f?(b=hi,M="x",H="y",B="x2",ba="y2",x.attr("dy",0>R?"0em":".71em").style("text-anchor","middle"),m.attr("d","M"+F[0]+","+R*g+"V0H"+F[1]+"V"+R*g)):(b=ii,M="y",H="x",B="y2",ba="x2",x.attr("dy",".32em").style("text-anchor",0>R?"end":"start"),m.attr("d","M"+R*g+","+F[0]+"H0V"+F[1]+"H"+R*g)),I.attr(ba,R*e),w.attr(H,R*A),J.attr(B,0).attr(ba,R*e),L.attr(M,0).attr(H,R*A),q.rangeBand)var ta=q,K=ta.rangeBand()/2,p=q=function(b){return ta(b)+K};else p.rangeBand?p=q:y.call(b,q,p);r.call(b,p,q);z.call(b,q,q)})}
var a,d=v.scale.linear(),f=qg,e=6,g=6,h=3,l=[10],n=null;return b.scale=function(a){return arguments.length?(d=a,b):d},b.orient=function(a){return arguments.length?(f=a in Hi?a+"":qg,b):f},b.ticks=function(){return arguments.length?(l=arguments,b):l},b.tickValues=function(a){return arguments.length?(n=a,b):n},b.tickFormat=function(d){return arguments.length?(a=d,b):a},b.tickSize=function(a){var d=arguments.length;return d?(e=+a,g=+arguments[d-1],b):e},b.innerTickSize=function(a){return arguments.length?
(e=+a,b):e},b.outerTickSize=function(a){return arguments.length?(g=+a,b):g},b.tickPadding=function(a){return arguments.length?(h=+a,b):h},b.tickSubdivide=function(){return arguments.length&&b},b};var qg="bottom",Hi={top:1,right:1,bottom:1,left:1};v.svg.brush=function(){function b(g){g.each(function(){var g=v.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",e).on("touchstart.brush",e),h=g.selectAll(".background").data([0]);h.enter().append("rect").attr("class",
"background").style("visibility","hidden").style("cursor","crosshair");g.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var l=g.selectAll(".resize").data(w,ca);l.exit().remove();l.enter().append("g").attr("class",function(b){return"resize "+b}).style("cursor",function(b){return Ii[b]}).append("rect").attr("x",function(b){return/[ew]$/.test(b)?-3:null}).attr("y",function(b){return/^[ns]/.test(b)?-3:null}).attr("width",6).attr("height",6).style("visibility",
"hidden");l.style("display",b.empty()?"none":null);var p,g=v.transition(g),h=v.transition(h);n&&(p=jc(n),h.attr("x",p[0]).attr("width",p[1]-p[0]),d(g));m&&(p=jc(m),h.attr("y",p[0]).attr("height",p[1]-p[0]),f(g));a(g)})}function a(b){b.selectAll(".resize").attr("transform",function(b){return"translate("+p[+/e$/.test(b)]+","+q[+/^s/.test(b)]+")"})}function d(b){b.select(".extent").attr("x",p[0]);b.selectAll(".extent,.n>rect,.s>rect").attr("width",p[1]-p[0])}function f(b){b.select(".extent").attr("y",
q[0]);b.selectAll(".extent,.e>rect,.w>rect").attr("height",q[1]-q[0])}function e(){function w(){var b=v.mouse(M),e=!1;F&&(b[0]+=F[0],b[1]+=F[1]);E||(v.event.altKey?(A||(A=[(p[0]+p[1])/2,(q[0]+q[1])/2]),K[0]=p[+(b[0]<A[0])],K[1]=q[+(b[1]<A[1])]):A=null);I&&y(b,n,0)&&(d(H),e=!0);J&&y(b,m,1)&&(f(H),e=!0);e&&(a(H),C({type:"brush",mode:E?"move":"resize"}))}function y(b,a,d){var f,e,k=jc(a);a=k[0];var k=k[1],l=K[d],n=d?q:p,m=n[1]-n[0];return E&&(a-=l,k-=m+l),f=(d?x:r)?Math.max(a,Math.min(k,b[d])):b[d],
E?e=(f+=l)+m:(A&&(l=Math.max(a,Math.min(k,2*A[d]-f))),f>l?(e=f,f=l):e=l),n[0]!=f||n[1]!=e?(d?h=null:g=null,n[0]=f,n[1]=e,!0):void 0}function z(){w();H.style("pointer-events","all").selectAll(".resize").style("display",b.empty()?"none":null);v.select("body").style("cursor",null);gb.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);L();C({type:"brushend"})}var A,F,M=this,B=v.select(v.event.target),
C=l.of(M,arguments),H=v.select(M),ba=B.datum(),I=!/^(n|s)$/.test(ba)&&n,J=!/^(e|w)$/.test(ba)&&m,E=B.classed("extent"),L=Lb(),K=v.mouse(M),gb=v.select(ha).on("keydown.brush",function(){32==v.event.keyCode&&(E||(A=null,K[0]-=p[1],K[1]-=q[1],E=2),R())}).on("keyup.brush",function(){32==v.event.keyCode&&2==E&&(K[0]+=p[1],K[1]+=q[1],E=0,R())});if(v.event.changedTouches?gb.on("touchmove.brush",w).on("touchend.brush",z):gb.on("mousemove.brush",w).on("mouseup.brush",z),H.interrupt().selectAll("*").interrupt(),
E)K[0]=p[0]-K[0],K[1]=q[0]-K[1];else if(ba){var S=+/w$/.test(ba),ba=+/^n/.test(ba);F=[p[1-S]-K[0],q[1-ba]-K[1]];K[0]=p[S];K[1]=q[ba]}else v.event.altKey&&(A=K.slice());H.style("pointer-events","none").selectAll(".resize").style("display",null);v.select("body").style("cursor",B.style("cursor"));C({type:"brushstart"});w()}var g,h,l=Wa(b,"brushstart","brush","brushend"),n=null,m=null,p=[0,0],q=[0,0],r=!0,x=!0,w=Md[0];return b.event=function(b){b.each(function(){var b=l.of(this,arguments),a={x:p,y:q,
i:g,j:h},d=this.__chart__||a;this.__chart__=a;fb?v.select(this).transition().each("start.brush",function(){g=d.i;h=d.j;p=d.x;q=d.y;b({type:"brushstart"})}).tween("brush:brush",function(){var d=ic(p,a.x),f=ic(q,a.y);return g=h=null,function(e){p=a.x=d(e);q=a.y=f(e);b({type:"brush",mode:"resize"})}}).each("end.brush",function(){g=a.i;h=a.j;b({type:"brush",mode:"resize"});b({type:"brushend"})}):(b({type:"brushstart"}),b({type:"brush",mode:"resize"}),b({type:"brushend"}))})},b.x=function(a){return arguments.length?
(n=a,w=Md[!n<<1|!m],b):n},b.y=function(a){return arguments.length?(m=a,w=Md[!n<<1|!m],b):m},b.clamp=function(a){return arguments.length?(n&&m?(r=!!a[0],x=!!a[1]):n?r=!!a:m&&(x=!!a),b):n&&m?[r,x]:n?r:m?x:null},b.extent=function(a){var d,f,e,k,l;return arguments.length?(n&&(d=a[0],f=a[1],m&&(d=d[0],f=f[0]),g=[d,f],n.invert&&(d=n(d),f=n(f)),d>f&&(l=d,d=f,f=l),(d!=p[0]||f!=p[1])&&(p=[d,f])),m&&(e=a[0],k=a[1],n&&(e=e[1],k=k[1]),h=[e,k],m.invert&&(e=m(e),k=m(k)),e>k&&(l=e,e=k,k=l),(e!=q[0]||k!=q[1])&&(q=
[e,k])),b):(n&&(g?(d=g[0],f=g[1]):(d=p[0],f=p[1],n.invert&&(d=n.invert(d),f=n.invert(f)),d>f&&(l=d,d=f,f=l))),m&&(h?(e=h[0],k=h[1]):(e=q[0],k=q[1],m.invert&&(e=m.invert(e),k=m.invert(k)),e>k&&(l=e,e=k,k=l))),n&&m?[[d,e],[f,k]]:n?[d,f]:m&&[e,k])},b.clear=function(){return b.empty()||(p=[0,0],q=[0,0],g=h=null),b},b.empty=function(){return!!n&&p[0]==p[1]||!!m&&q[0]==q[1]},v.rebind(b,l,"on")};var Ii={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",
sw:"nesw-resize"},Md=["n e s w nw ne se sw".split(" "),["e","w"],["n","s"],[]],Nd=B.format=fg.timeFormat,rg=Nd.utc,sg=rg("%Y-%m-%dT%H:%M:%S.%LZ");Nd.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Gd:sg;Gd.parse=function(b){b=new Date(b);return isNaN(b)?null:b};Gd.toString=sg.toString;B.second=Ya(function(b){return new ga(1E3*Math.floor(b/1E3))},function(b,a){b.setTime(b.getTime()+1E3*Math.floor(a))},function(b){return b.getSeconds()});B.seconds=B.second.range;B.seconds.utc=
B.second.utc.range;B.minute=Ya(function(b){return new ga(6E4*Math.floor(b/6E4))},function(b,a){b.setTime(b.getTime()+6E4*Math.floor(a))},function(b){return b.getMinutes()});B.minutes=B.minute.range;B.minutes.utc=B.minute.utc.range;B.hour=Ya(function(b){var a=b.getTimezoneOffset()/60;return new ga(36E5*(Math.floor(b/36E5-a)+a))},function(b,a){b.setTime(b.getTime()+36E5*Math.floor(a))},function(b){return b.getHours()});B.hours=B.hour.range;B.hours.utc=B.hour.utc.range;B.month=Ya(function(b){return b=
B.day(b),b.setDate(1),b},function(b,a){b.setMonth(b.getMonth()+a)},function(b){return b.getMonth()});B.months=B.month.range;B.months.utc=B.month.utc.range;var pc=[1E3,5E3,15E3,3E4,6E4,3E5,9E5,18E5,36E5,108E5,216E5,432E5,864E5,1728E5,6048E5,2592E6,7776E6,31536E6],Od=[[B.second,1],[B.second,5],[B.second,15],[B.second,30],[B.minute,1],[B.minute,5],[B.minute,15],[B.minute,30],[B.hour,1],[B.hour,3],[B.hour,6],[B.hour,12],[B.day,1],[B.day,2],[B.week,1],[B.month,1],[B.month,3],[B.year,1]],Ji=Nd.multi([[".%L",
function(b){return b.getMilliseconds()}],[":%S",function(b){return b.getSeconds()}],["%I:%M",function(b){return b.getMinutes()}],["%I %p",function(b){return b.getHours()}],["%a %d",function(b){return b.getDay()&&1!=b.getDate()}],["%b %d",function(b){return 1!=b.getDate()}],["%B",function(b){return b.getMonth()}],["%Y",mb]]),ji={range:function(b,a,d){return v.range(Math.ceil(b/d)*d,+a,d).map(eb)},floor:ca,ceil:ca};Od.year=B.year;B.scale=function(){return Hd(v.scale.linear(),Od,Ji)};var tg=Od.map(function(b){return[b[0].utc,
b[1]]}),Ki=rg.multi([[".%L",function(b){return b.getUTCMilliseconds()}],[":%S",function(b){return b.getUTCSeconds()}],["%I:%M",function(b){return b.getUTCMinutes()}],["%I %p",function(b){return b.getUTCHours()}],["%a %d",function(b){return b.getUTCDay()&&1!=b.getUTCDate()}],["%b %d",function(b){return 1!=b.getUTCDate()}],["%B",function(b){return b.getUTCMonth()}],["%Y",mb]]);tg.year=B.year.utc;B.scale.utc=function(){return Hd(v.scale.linear(),tg,Ki)};v.text=Uc(function(b){return b.responseText});
v.json=function(b,a){return Ob(b,"application/json",ki,a)};v.html=function(b,a){return Ob(b,"text/html",li,a)};v.xml=Uc(function(b){return b.responseXML});"function"==typeof define&&define.amd?define(v):"object"==typeof module&&module.exports&&(module.exports=v);this.d3=v}();this.j$=this.jStat=function(h,g){function e(a,d){var f=a>d?a:d;return h.pow(10,17-~~(h.log(0<f?f:-f)*h.LOG10E))}function d(a){return"[object Function]"===r.call(a)}function a(a){return"number"==typeof a&&a===a}function f(){return new f._init(arguments)}function l(){return 0}function n(){return 1}function m(a,d){return a===d?1:0}var q=Array.prototype.concat,p=Array.prototype.slice,r=Object.prototype.toString,w=Array.isArray||function(a){return"[object Array]"===r.call(a)};f.fn=f.prototype;f._init=
function(e){var g;if(w(e[0]))if(w(e[0][0])){d(e[1])&&(e[0]=f.map(e[0],e[1]));for(g=0;g<e[0].length;g++)this[g]=e[0][g];this.length=e[0].length}else this[0]=d(e[1])?f.map(e[0],e[1]):e[0],this.length=1;else{if(a(e[0]))this[0]=f.seq.apply(null,e);else{if(e[0]instanceof f)return f(e[0].toArray());this[0]=[]}this.length=1}return this};f._init.prototype=f.prototype;f._init.constructor=f;f.utils={calcRdx:e,isArray:w,isFunction:d,isNumber:a,toVector:function(a){return q.apply([],a)}};f.extend=function(a){var d,
e;if(1===arguments.length){for(e in a)f[e]=a[e];return this}for(d=1;d<arguments.length;d++)for(e in arguments[d])a[e]=arguments[d][e];return a};f.rows=function(a){return a.length||1};f.cols=function(a){return a[0].length||1};f.dimensions=function(a){return{rows:f.rows(a),cols:f.cols(a)}};f.row=function(a,d){return a[d]};f.col=function(a,d){for(var f=Array(a.length),e=0;e<a.length;e++)f[e]=[a[e][d]];return f};f.diag=function(a){for(var d=f.rows(a),e=Array(d),g=0;g<d;g++)e[g]=[a[g][g]];return e};f.antidiag=
function(a){for(var d=f.rows(a)-1,e=Array(d),g=0;0<=d;d--,g++)e[g]=[a[g][d]];return e};f.transpose=function(a){var d=[],f,e,g,h,l;w(a[0])||(a=[a]);e=a.length;g=a[0].length;for(l=0;l<g;l++){f=Array(e);for(h=0;h<e;h++)f[h]=a[h][l];d.push(f)}return 1===d.length?d[0]:d};f.map=function(a,d,f){var e,g,h,l;w(a[0])||(a=[a]);e=a.length;g=a[0].length;h=f?a:Array(e);for(f=0;f<e;f++)for(h[f]||(h[f]=Array(g)),l=0;l<g;l++)h[f][l]=d(a[f][l],f,l);return 1===h.length?h[0]:h};f.cumreduce=function(a,d,f){var e,g,h,
l;w(a[0])||(a=[a]);e=a.length;g=a[0].length;h=f?a:Array(e);for(f=0;f<e;f++)for(h[f]||(h[f]=Array(g)),0<g&&(h[f][0]=a[f][0]),l=1;l<g;l++)h[f][l]=d(h[f][l-1],a[f][l]);return 1===h.length?h[0]:h};f.alter=function(a,d){return f.map(a,d,!0)};f.create=function(a,f,e){var g=Array(a),h,l;d(f)&&(e=f,f=a);for(h=0;h<a;h++)for(g[h]=Array(f),l=0;l<f;l++)g[h][l]=e(h,l);return g};f.zeros=function(d,e){return a(e)||(e=d),f.create(d,e,l)};f.ones=function(d,e){return a(e)||(e=d),f.create(d,e,n)};f.rand=function(d,
e){return a(e)||(e=d),f.create(d,e,h.random)};f.identity=function(d,e){return a(e)||(e=d),f.create(d,e,m)};f.symmetric=function(a){var d=a.length,f,e;if(a.length!==a[0].length)return!1;for(f=0;f<d;f++)for(e=0;e<d;e++)if(a[e][f]!==a[f][e])return!1;return!0};f.clear=function(a){return f.alter(a,l)};f.seq=function(a,f,g,h){d(h)||(h=!1);var l=[],n=e(a,f);g=(f*n-a*n)/((g-1)*n);var m=a,p;for(p=0;m<=f;p++,m=(a*n+g*n*p)/n)l.push(h?h(m,p):m);return l};var y=f.prototype;return y.length=0,y.push=Array.prototype.push,
y.sort=Array.prototype.sort,y.splice=Array.prototype.splice,y.slice=Array.prototype.slice,y.toArray=function(){return 1<this.length?p.call(this):p.call(this)[0]},y.map=function(a,d){return f(f.map(this,a,d))},y.cumreduce=function(a,d){return f(f.cumreduce(this,a,d))},y.alter=function(a){return f.alter(this,a),this},function(a){for(var d=0;d<a.length;d++)(function(a){y[a]=function(d){var e=this,g;return d?(setTimeout(function(){d.call(e,y[a].call(e))}),this):(g=f[a](this),w(g)?f(g):g)}})(a[d])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),
function(a){for(var d=0;d<a.length;d++)(function(a){y[a]=function(d,e){var g=this;return e?(setTimeout(function(){e.call(g,y[a].call(g,d))}),this):f(f[a](this,d))}})(a[d])}(["row","col"]),function(a){for(var d=0;d<a.length;d++){var f=a[d];y[f]=new Function("return jStat(jStat."+f+".apply(null, arguments));")}}(["create","zeros","ones","rand","identity"]),f}(Math);
(function(h,g){function e(a,d){return a-d}var d=h.utils.isFunction;h.sum=function(a){for(var d=0,e=a.length;0<=--e;)d+=a[e];return d};h.sumsqrd=function(a){for(var d=0,e=a.length;0<=--e;)d+=a[e]*a[e];return d};h.sumsqerr=function(a){for(var d=h.mean(a),e=0,g=a.length,q;0<=--g;)q=a[g]-d,e+=q*q;return e};h.product=function(a){for(var d=1,e=a.length;0<=--e;)d*=a[e];return d};h.min=function(a){for(var d=a[0],e=0;++e<a.length;)a[e]<d&&(d=a[e]);return d};h.max=function(a){for(var d=a[0],e=0;++e<a.length;)a[e]>
d&&(d=a[e]);return d};h.mean=function(a){return h.sum(a)/a.length};h.meansqerr=function(a){return h.sumsqerr(a)/a.length};h.geomean=function(a){return g.pow(h.product(a),1/a.length)};h.median=function(a){var d=a.length;a=a.slice().sort(e);return d&1?a[d/2|0]:(a[d/2-1]+a[d/2])/2};h.cumsum=function(a){return h.cumreduce(a,function(a,d){return a+d})};h.cumprod=function(a){return h.cumreduce(a,function(a,d){return a*d})};h.diff=function(a){var d=[],e=a.length,g;for(g=1;g<e;g++)d.push(a[g]-a[g-1]);return d};
h.mode=function(a){var d=a.length;a=a.slice().sort(e);var g=1,h=0,q=0,p=[],r;for(r=0;r<d;r++)a[r]===a[r+1]?g++:(g>h?(p=[a[r]],h=g,q=0):g===h&&(p.push(a[r]),q++),g=1);return 0===q?p[0]:p};h.range=function(a){return h.max(a)-h.min(a)};h.variance=function(a,d){return h.sumsqerr(a)/(a.length-(d?1:0))};h.stdev=function(a,d){return g.sqrt(h.variance(a,d))};h.meandev=function(a){var d=0,e=h.mean(a),m;for(m=a.length-1;0<=m;m--)d+=g.abs(a[m]-e);return d/a.length};h.meddev=function(a){var d=0,e=h.median(a),
m;for(m=a.length-1;0<=m;m--)d+=g.abs(a[m]-e);return d/a.length};h.coeffvar=function(a){return h.stdev(a)/h.mean(a)};h.quartiles=function(a){var d=a.length;a=a.slice().sort(e);return[a[g.round(d/4)-1],a[g.round(d/2)-1],a[g.round(3*d/4)-1]]};h.quantiles=function(a,d,h,m){var q=a.slice().sort(e),p=[d.length];a=a.length;var r,w,y;"undefined"==typeof h&&(h=.375);"undefined"==typeof m&&(m=.375);for(r=0;r<d.length;r++)w=d[r],y=h+w*(1-h-m),y=a*w+y,w=g.floor(g.max(1,g.min(y,a-1))),y=g.max(0,g.min(y-w,1)),
p[r]=(1-y)*q[w-1]+y*q[w];return p};h.percentileOfScore=function(a,d,e){var g=0,h=a.length,p=!1,r;"strict"===e&&(p=!0);for(r=0;r<h;r++)e=a[r],(p&&e<d||!p&&e<=d)&&g++;return g/h};h.histogram=function(a,d){var e=h.min(a),m=d||4,q=(h.max(a)-e)/m,p=a.length;d=[];var r;for(r=0;r<m;r++)d[r]=0;for(r=0;r<p;r++)d[g.min(g.floor((a[r]-e)/q),m-1)]+=1;return d};h.covariance=function(a,d){var e=h.mean(a),g=h.mean(d),q=a.length,p=Array(q),r;for(r=0;r<q;r++)p[r]=(a[r]-e)*(d[r]-g);return h.sum(p)/(q-1)};h.corrcoeff=
function(a,d){return h.covariance(a,d)/h.stdev(a,1)/h.stdev(d,1)};h.stanMoment=function(a,d){var e=h.mean(a),m=h.stdev(a),q=a.length,p=0;for(i=0;i<q;i++)p+=g.pow((a[i]-e)/m,d);return p/a.length};h.skewness=function(a){return h.stanMoment(a,3)};h.kurtosis=function(a){return h.stanMoment(a,4)-3};var a=h.prototype;(function(f){for(var e=0;e<f.length;e++)(function(f){a[f]=function(e,g){var l=[],r=0,w=this;d(e)&&(g=e,e=!1);if(g)return setTimeout(function(){g.call(w,a[f].call(w,e))}),this;if(1<this.length){for(w=
!0===e?this:this.transpose();r<w.length;r++)l[r]=h[f](w[r]);return l}return h[f](this[0],e)}})(f[e])})(["cumsum","cumprod"]);(function(f){for(var e=0;e<f.length;e++)(function(f){a[f]=function(e,g){var l=[],r=0,w=this;d(e)&&(g=e,e=!1);if(g)return setTimeout(function(){g.call(w,a[f].call(w,e))}),this;if(1<this.length){for(w=!0===e?this:this.transpose();r<w.length;r++)l[r]=h[f](w[r]);return!0===e?h[f](h.utils.toVector(l)):l}return h[f](this[0],e)}})(f[e])})("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" "));
(function(f){for(var e=0;e<f.length;e++)(function(f){a[f]=function(){var e=[],g=0,l=this,r=Array.prototype.slice.call(arguments);if(d(r[r.length-1])){var w=r[r.length-1],y=r.slice(0,r.length-1);return setTimeout(function(){w.call(l,a[f].apply(l,y))}),this}w=void 0;if(1<this.length){for(l=l.transpose();g<l.length;g++)e[g]=h[f].apply(l,[l[g]].concat(r));return e}return h[f].apply(l,[this[0]].concat(r))}})(f[e])})(["quantiles","percentileOfScore"])})(this.jStat,Math);
(function(h,g){h.gammaln=function(e){var d=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5.395239384953E-6],f=1.000000000190015,h,n;n=(h=e)+5.5;for(n-=(e+.5)*g.log(n);6>d;d++)f+=a[d]/++h;return g.log(2.5066282746310007*f/e)-n};h.gammafn=function(e){var d=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,
-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,h=0,n=0,m=0,q,p,r,w;if(0>=e)if(w=e%1+3.6E-16)f=(e&1?-1:1)*g.PI/g.sin(g.PI*w),e=1-e;else return Infinity;r=e;1>e?p=e++:p=(e-=h=(e|0)-1)-1;for(q=0;8>q;++q)m=(m+d[q])*p,n=n*p+a[q];w=m/n+1;if(r<e)w/=r;else if(r>e)for(q=0;q<h;++q)w*=e,e++;return f&&(w=f/w),w};h.gammap=function(e,d){var a=h.gammaln(e),f=e,l=1/e,n=l,m=d+1-e,q=1/1E-30,p=1/m,r=p,w=1,y=-~(8.5*g.log(1<=e?e:1/e)+.4*e+17);if(0>
d||0>=e)return NaN;if(d<e+1){for(;w<=y;w++)l+=n*=d/++f;return l*g.exp(-d+e*g.log(d)-a)}for(;w<=y;w++)f=-w*(w-e),m+=2,p=f*p+m,q=m+f/q,p=1/p,r=r*p*q;return 1-r*g.exp(-d+e*g.log(d)-a)};h.factorialln=function(e){return 0>e?NaN:h.gammaln(e+1)};h.factorial=function(e){return 0>e?NaN:h.gammafn(e+1)};h.combination=function(e,d){return 170<e||170<d?g.exp(h.combinationln(e,d)):h.factorial(e)/h.factorial(d)/h.factorial(e-d)};h.combinationln=function(e,d){return h.factorialln(e)-h.factorialln(d)-h.factorialln(e-
d)};h.permutation=function(e,d){return h.factorial(e)/h.factorial(e-d)};h.betafn=function(e,d){return 0>=e||0>=d?void 0:170<e+d?g.exp(h.betaln(e,d)):h.gammafn(e)*h.gammafn(d)/h.gammafn(e+d)};h.betaln=function(e,d){return h.gammaln(e)+h.gammaln(d)-h.gammaln(e+d)};h.betacf=function(e,d,a){var f=1,h=d+a,n=d+1,m=d-1,q=1,p=1-h*e/n,r,w,y;1E-30>g.abs(p)&&(p=1E-30);for(y=p=1/p;100>=f&&!(r=2*f,w=f*(a-f)*e/((m+r)*(d+r)),p=1+w*p,1E-30>g.abs(p)&&(p=1E-30),q=1+w/q,1E-30>g.abs(q)&&(q=1E-30),p=1/p,y=y*p*q,w=-(d+
f)*(h+f)*e/((d+r)*(n+r)),p=1+w*p,1E-30>g.abs(p)&&(p=1E-30),q=1+w/q,1E-30>g.abs(q)&&(q=1E-30),p=1/p,r=p*q,y*=r,3E-7>g.abs(r-1));f++);return y};h.gammapinv=function(e,d){var a=0,f=d-1,l=h.gammaln(d),n,m,q,p,r;if(1<=e)return g.max(100,d+100*g.sqrt(d));if(0>=e)return 0;for(1<d?(p=g.log(f),r=g.exp(f*(p-1)-l),m=.5>e?e:1-e,q=g.sqrt(-2*g.log(m)),n=(2.30753+.27061*q)/(1+q*(.99229+.04481*q))-q,.5>e&&(n=-n),n=g.max(.001,d*g.pow(1-1/(9*d)-n/(3*g.sqrt(d)),3))):(q=1-d*(.253+.12*d),e<q?n=g.pow(e/q,1/d):n=1-g.log(1-
(e-q)/(1-q)));12>a;a++){if(0>=n)return 0;m=h.gammap(d,n)-e;1<d?q=r*g.exp(-(n-f)+f*(g.log(n)-p)):q=g.exp(-n+f*g.log(n)-l);q=m/q;n-=q/=1-.5*g.min(1,q*((d-1)/n-1));0>=n&&(n=.5*(n+q));if(g.abs(q)<1E-8*n)break}return n};h.erf=function(e){var d=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-9.46595344482036E-4,3.66839497852761E-4,4.2523324806907E-5,-2.0278578112534E-5,-1.624290004647E-6,1.30365583558E-6,1.5626441722E-8,-8.5238095915E-8,6.529054439E-9,5.059343495E-9,-9.91364156E-10,
-2.27365122E-10,9.6467911E-11,2.394038E-12,-6.886027E-12,8.94487E-13,3.13092E-13,-1.12708E-13,3.81E-16,7.106E-15,-1.523E-15,-9.4E-17,1.21E-16,-2.8E-17],a=d.length-1,f=!1,h=0,n=0,m,q,p,r;0>e&&(e=-e,f=!0);m=2/(2+e);for(q=4*m-2;0<a;a--)p=h,h=q*h-n+d[a],n=p;return r=m*g.exp(-e*e+.5*(d[0]+q*h)-n),f?r-1:1-r};h.erfc=function(e){return 1-h.erf(e)};h.erfcinv=function(e){var d=0,a,f,l;if(2<=e)return-100;if(0>=e)return 100;l=1>e?e:2-e;a=g.sqrt(-2*g.log(l/2));for(a=-.70711*((2.30753+.27061*a)/(1+a*(.99229+.04481*
a))-a);2>d;d++)f=h.erfc(a)-l,a+=f/(1.1283791670955126*g.exp(-a*a)-a*f);return 1>e?a:-a};h.ibetainv=function(e,d,a){var f=d-1,l=a-1,n=0,m,q,p,r,w,y,x,z,F;if(0>=e)return 0;if(1<=e)return 1;1<=d&&1<=a?(p=.5>e?e:1-e,r=g.sqrt(-2*g.log(p)),y=(2.30753+.27061*r)/(1+r*(.99229+.04481*r))-r,.5>e&&(y=-y),x=(y*y-3)/6,z=2/(1/(2*d-1)+1/(2*a-1)),F=y*g.sqrt(x+z)/z-(1/(2*a-1)-1/(2*d-1))*(x+5/6-2/(3*z)),y=d/(d+a*g.exp(2*F))):(m=g.log(d/(d+a)),q=g.log(a/(d+a)),r=g.exp(d*m)/d,w=g.exp(a*q)/a,F=r+w,e<r/F?y=g.pow(d*F*e,
1/d):y=1-g.pow(a*F*(1-e),1/a));for(m=-h.gammaln(d)-h.gammaln(a)+h.gammaln(d+a);10>n&&0!==y&&1!==y&&!(w=h.ibeta(y,d,a)-e,r=g.exp(f*g.log(y)+l*g.log(1-y)+m),w/=r,y-=r=w/(1-.5*g.min(1,w*(f/y-l/(1-y)))),0>=y&&(y=.5*(y+r)),1<=y&&(y=.5*(y+r+1)),g.abs(r)<1E-8*y&&0<n);n++);return y};h.ibeta=function(e,d,a){var f=0===e||1===e?0:g.exp(h.gammaln(d+a)-h.gammaln(d)-h.gammaln(a)+d*g.log(e)+a*g.log(1-e));return 0>e||1<e?!1:e<(d+1)/(d+a+2)?f*h.betacf(e,d,a)/d:1-f*h.betacf(1-e,a,d)/a};h.randn=function(e,d){var a,
f,l,n;d||(d=e);if(e)return h.create(e,d,function(){return h.randn()});do a=g.random(),f=1.7156*(g.random()-.5),l=a-.449871,n=g.abs(f)+.386595,l=l*l+n*(.196*n-.25472*l);while(.27597<l&&(.27846<l||f*f>-4*g.log(a)*a*a));return f/a};h.randg=function(e,d,a){var f=e,l,n,m;a||(a=d);e||(e=1);if(d)return l=h.zeros(d,a),l.alter(function(){return h.randg(e)}),l;1>e&&(e+=1);d=e-1/3;a=1/g.sqrt(9*d);do{do m=h.randn(),n=1+a*m;while(0>=n);n*=n*n;l=g.random()}while(l>1-.331*g.pow(m,4)&&g.log(l)>.5*m*m+d*(1-n+g.log(n)));
if(e==f)return d*n;do l=g.random();while(0===l);return g.pow(l,1/f)*d*n};(function(e){for(var d=0;d<e.length;d++)(function(a){h.fn[a]=function(){return h(h.map(this,function(d){return h[a](d)}))}})(e[d])})(["gammaln","gammafn","factorial","factorialln"]);(function(e){for(var d=0;d<e.length;d++)(function(a){h.fn[a]=function(){return h(h[a].apply(null,arguments))}})(e[d])})(["randn"])})(this.jStat,Math);
(function(h,g){(function(e){for(var d=0;d<e.length;d++)(function(a){h[a]=function(a,d,e){return this instanceof arguments.callee?(this._a=a,this._b=d,this._c=e,this):new arguments.callee(a,d,e)};h.fn[a]=function(d,e,g){d=h[a](d,e,g);return d.data=this,d};h[a].prototype.sample=function(d){var e=this._a,g=this._b,m=this._c;return d?h.alter(d,function(){return h[a].sample(e,g,m)}):h[a].sample(e,g,m)};(function(d){for(var e=0;e<d.length;e++)(function(d){h[a].prototype[d]=function(f){var e=this._a,g=this._b,
l=this._c;return!f&&0!==f&&(f=this.data),"number"!=typeof f?h.fn.map.call(f,function(f){return h[a][d](f,e,g,l)}):h[a][d](f,e,g,l)}})(d[e])})(["pdf","cdf","inv"]);(function(d){for(var e=0;e<d.length;e++)(function(d){h[a].prototype[d]=function(){return h[a][d](this._a,this._b,this._c)}})(d[e])})(["mean","median","mode","variance"])})(e[d])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" "));
h.extend(h.beta,{pdf:function(e,d,a){return 1<e||0>e?0:1==d&&1==a?1:512>d||512>a?g.pow(e,d-1)*g.pow(1-e,a-1)/h.betafn(d,a):g.exp((d-1)*g.log(e)+(a-1)*g.log(1-e)-h.betaln(d,a))},cdf:function(e,d,a){return 1<e||0>e?1*(1<e):h.ibeta(e,d,a)},inv:function(e,d,a){return h.ibetainv(e,d,a)},mean:function(e,d){return e/(e+d)},median:function(e,d){throw Error("median not yet implemented");},mode:function(e,d){return e*d/(g.pow(e+d,2)*(e+d+1))},sample:function(e,d){var a=h.randg(e);return a/(a+h.randg(d))},variance:function(e,
d){return e*d/(g.pow(e+d,2)*(e+d+1))}});h.extend(h.centralF,{pdf:function(e,d,a){var f,l,n;return 0>e?void 0:2>=d?g.sqrt(g.pow(d*e,d)*g.pow(a,a)/g.pow(d*e+a,d+a))/(e*h.betafn(d/2,a/2)):(f=d*e/(a+e*d),l=a/(a+e*d),n=d*l/2,n*h.binomial.pdf((d-2)/2,(d+a-2)/2,f))},cdf:function(e,d,a){return h.ibeta(d*e/(d*e+a),d/2,a/2)},inv:function(e,d,a){return a/(d*(1/h.ibetainv(e,d/2,a/2)-1))},mean:function(e,d){return 2<d?d/(d-2):void 0},mode:function(e,d){return 2<e?d*(e-2)/(e*(d+2)):void 0},sample:function(e,d){var a=
2*h.randg(e/2),f=2*h.randg(d/2);return a/e/(f/d)},variance:function(e,d){return 4>=d?void 0:2*d*d*(e+d-2)/(e*(d-2)*(d-2)*(d-4))}});h.extend(h.cauchy,{pdf:function(e,d,a){return a/(g.pow(e-d,2)+g.pow(a,2))/g.PI},cdf:function(e,d,a){return g.atan((e-d)/a)/g.PI+.5},inv:function(e,d,a){return d+a*g.tan(g.PI*(e-.5))},median:function(e,d){return e},mode:function(e,d){return e},sample:function(e,d){return h.randn()*g.sqrt(1/(2*h.randg(.5)))*d+e}});h.extend(h.chisquare,{pdf:function(e,d){return 0===e?0:g.exp((d/
2-1)*g.log(e)-e/2-d/2*g.log(2)-h.gammaln(d/2))},cdf:function(e,d){return h.gammap(d/2,e/2)},inv:function(e,d){return 2*h.gammapinv(e,.5*d)},mean:function(e){return e},median:function(e){return e*g.pow(1-2/(9*e),3)},mode:function(e){return 0<e-2?e-2:0},sample:function(e){return 2*h.randg(e/2)},variance:function(e){return 2*e}});h.extend(h.exponential,{pdf:function(e,d){return 0>e?0:d*g.exp(-d*e)},cdf:function(e,d){return 0>e?0:1-g.exp(-d*e)},inv:function(e,d){return-g.log(1-e)/d},mean:function(e){return 1/
e},median:function(e){return 1/e*g.log(2)},mode:function(e){return 0},sample:function(e){return-1/e*g.log(g.random())},variance:function(e){return g.pow(e,-2)}});h.extend(h.gamma,{pdf:function(e,d,a){return g.exp((d-1)*g.log(e)-e/a-h.gammaln(d)-d*g.log(a))},cdf:function(e,d,a){return h.gammap(d,e/a)},inv:function(e,d,a){return h.gammapinv(e,d)*a},mean:function(e,d){return e*d},mode:function(e,d){return 1<e?(e-1)*d:void 0},sample:function(e,d){return h.randg(e)*d},variance:function(e,d){return e*d*
d}});h.extend(h.invgamma,{pdf:function(e,d,a){return g.exp(-(d+1)*g.log(e)-a/e-h.gammaln(d)+d*g.log(a))},cdf:function(e,d,a){return 1-h.gammap(d,a/e)},inv:function(e,d,a){return a/h.gammapinv(1-e,d)},mean:function(e,d){return 1<e?d/(e-1):void 0},mode:function(e,d){return d/(e+1)},sample:function(e,d){return d/h.randg(e)},variance:function(e,d){return 2>=e?void 0:d*d/((e-1)*(e-1)*(e-2))}});h.extend(h.kumaraswamy,{pdf:function(e,d,a){return g.exp(g.log(d)+g.log(a)+(d-1)*g.log(e)+(a-1)*g.log(1-g.pow(e,
d)))},cdf:function(e,d,a){return 1-g.pow(1-g.pow(e,d),a)},mean:function(e,d){return d*h.gammafn(1+1/e)*h.gammafn(d)/h.gammafn(1+1/e+d)},median:function(e,d){return g.pow(1-g.pow(2,-1/d),1/e)},mode:function(e,d){return 1<=e&&1<=d&&1!==e&&1!==d?g.pow((e-1)/(e*d-1),1/e):void 0},variance:function(e,d){throw Error("variance not yet implemented");}});h.extend(h.lognormal,{pdf:function(e,d,a){return g.exp(-g.log(e)-.5*g.log(2*g.PI)-g.log(a)-g.pow(g.log(e)-d,2)/(2*a*a))},cdf:function(e,d,a){return.5+.5*h.erf((g.log(e)-
d)/g.sqrt(2*a*a))},inv:function(e,d,a){return g.exp(-1.4142135623730951*a*h.erfcinv(2*e)+d)},mean:function(e,d){return g.exp(e+d*d/2)},median:function(e,d){return g.exp(e)},mode:function(e,d){return g.exp(e-d*d)},sample:function(e,d){return g.exp(h.randn()*d+e)},variance:function(e,d){return(g.exp(d*d)-1)*g.exp(2*e+d*d)}});h.extend(h.normal,{pdf:function(e,d,a){return g.exp(-.5*g.log(2*g.PI)-g.log(a)-g.pow(e-d,2)/(2*a*a))},cdf:function(e,d,a){return.5*(1+h.erf((e-d)/g.sqrt(2*a*a)))},inv:function(e,
d,a){return-1.4142135623730951*a*h.erfcinv(2*e)+d},mean:function(e,d){return e},median:function(e,d){return e},mode:function(e,d){return e},sample:function(e,d){return h.randn()*d+e},variance:function(e,d){return d*d}});h.extend(h.pareto,{pdf:function(e,d,a){return e<d?void 0:a*g.pow(d,a)/g.pow(e,a+1)},cdf:function(e,d,a){return 1-g.pow(d/e,a)},mean:function(e,d){return 1>=d?void 0:d*g.pow(e,d)/(d-1)},median:function(e,d){return e*d*g.SQRT2},mode:function(e,d){return e},variance:function(e,d){return 2>=
d?void 0:e*e*d/(g.pow(d-1,2)*(d-2))}});h.extend(h.studentt,{pdf:function(e,d){return h.gammafn((d+1)/2)/(g.sqrt(d*g.PI)*h.gammafn(d/2))*g.pow(1+e*e/d,-((d+1)/2))},cdf:function(e,d){var a=d/2;return h.ibeta((e+g.sqrt(e*e+d))/(2*g.sqrt(e*e+d)),a,a)},inv:function(e,d){var a=h.ibetainv(2*g.min(e,1-e),.5*d,.5);return a=g.sqrt(d*(1-a)/a),.5<e?a:-a},mean:function(e){return 1<e?0:void 0},median:function(e){return 0},mode:function(e){return 0},sample:function(e){return h.randn()*g.sqrt(e/(2*h.randg(e/2)))},
variance:function(e){return 2<e?e/(e-2):1<e?Infinity:void 0}});h.extend(h.weibull,{pdf:function(e,d,a){return 0>e?0:a/d*g.pow(e/d,a-1)*g.exp(-g.pow(e/d,a))},cdf:function(e,d,a){return 0>e?0:1-g.exp(-g.pow(e/d,a))},inv:function(e,d,a){return d*g.pow(-g.log(1-e),1/a)},mean:function(e,d){return e*h.gammafn(1+1/d)},median:function(e,d){return e*g.pow(g.log(2),1/d)},mode:function(e,d){return 1>=d?void 0:e*g.pow((d-1)/d,1/d)},sample:function(e,d){return e*g.pow(-g.log(g.random()),1/d)},variance:function(e,
d){return e*e*h.gammafn(1+2/d)-g.pow(this.mean(e,d),2)}});h.extend(h.uniform,{pdf:function(e,d,a){return e<d||e>a?0:1/(a-d)},cdf:function(e,d,a){return e<d?0:e<a?(e-d)/(a-d):1},inv:function(e,d,a){return d+e*(a-d)},mean:function(e,d){return.5*(e+d)},median:function(e,d){return h.mean(e,d)},mode:function(e,d){throw Error("mode is not yet implemented");},sample:function(e,d){return e/2+d/2+(d/2-e/2)*(2*g.random()-1)},variance:function(e,d){return g.pow(d-e,2)/12}});h.extend(h.binomial,{pdf:function(e,
d,a){return 0===a||1===a?d*a===e?1:0:h.combination(d,e)*g.pow(a,e)*g.pow(1-a,d-e)},cdf:function(e,d,a){var f=[],g=0;if(0>e)return 0;if(e<d){for(;g<=e;g++)f[g]=h.binomial.pdf(g,d,a);return h.sum(f)}return 1}});h.extend(h.negbin,{pdf:function(e,d,a){return e!==e|0?!1:0>e?0:h.combination(e+d-1,d-1)*g.pow(1-a,e)*g.pow(a,d)},cdf:function(e,d,a){var f=0,g=0;if(0>e)return 0;for(;g<=e;g++)f+=h.negbin.pdf(g,d,a);return f}});h.extend(h.hypgeom,{pdf:function(e,d,a,f){if(e!==e|0)return!1;if(0>e||e<a-(d-f)||e>
f||e>a)return 0;if(2*a>d)return 2*f>d?h.hypgeom.pdf(d-a-f+e,d,d-a,d-f):h.hypgeom.pdf(f-e,d,d-a,f);if(2*f>d)return h.hypgeom.pdf(a-e,d,a,d-f);if(a<f)return h.hypgeom.pdf(e,d,f,a);for(var l=1,n=0,m=0;m<e;m++){for(;1<l&&n<f;)l*=1-a/(d-n),n++;l*=(f-m)*(a-m)/((m+1)*(d-a-f+m+1))}for(;n<f;n++)l*=1-a/(d-n);return g.min(1,g.max(0,l))},cdf:function(e,d,a,f){if(0>e||e<a-(d-f))return 0;if(e>=f||e>=a)return 1;if(2*a>d)return 2*f>d?h.hypgeom.cdf(d-a-f+e,d,d-a,d-f):1-h.hypgeom.cdf(f-e-1,d,d-a,f);if(2*f>d)return 1-
h.hypgeom.cdf(a-e-1,d,a,d-f);if(a<f)return h.hypgeom.cdf(e,d,f,a);for(var l=1,n=1,m=0,q=0;q<e;q++){for(;1<l&&m<f;){var p=1-a/(d-m),n=n*p,l=l*p;m++}n*=(f-q)*(a-q)/((q+1)*(d-a-f+q+1));l+=n}for(;m<f;m++)l*=1-a/(d-m);return g.min(1,g.max(0,l))}});h.extend(h.poisson,{pdf:function(e,d){return g.pow(d,e)*g.exp(-d)/h.factorial(e)},cdf:function(e,d){var a=[],f=0;if(0>e)return 0;for(;f<=e;f++)a.push(h.poisson.pdf(f,d));return h.sum(a)},mean:function(e){return e},variance:function(e){return e},sample:function(e){var d=
1,a=0;e=g.exp(-e);do a++,d*=g.random();while(d>e);return a-1}});h.extend(h.triangular,{pdf:function(e,d,a,f){return a<=d||f<d||f>a?void 0:e<d||e>a?0:e<=f?2*(e-d)/((a-d)*(f-d)):2*(a-e)/((a-d)*(a-f))},cdf:function(e,d,a,f){return a<=d||f<d||f>a?void 0:e<d?0:e<=f?g.pow(e-d,2)/((a-d)*(f-d)):1-g.pow(a-e,2)/((a-d)*(a-f))},mean:function(e,d,a){return(e+d+a)/3},median:function(e,d,a){if(a<=(e+d)/2)return d-g.sqrt((d-e)*(d-a))/g.sqrt(2);if(a>(e+d)/2)return e+g.sqrt((d-e)*(a-e))/g.sqrt(2)},mode:function(e,
d,a){return a},sample:function(e,d,a){var f=g.random();return f<(a-e)/(d-e)?e+g.sqrt(f*(d-e)*(a-e)):d-g.sqrt((1-f)*(d-e)*(d-a))},variance:function(e,d,a){return(e*e+d*d+a*a-e*d-e*a-d*a)/18}})})(this.jStat,Math);
(function(h,g){var e=Array.prototype.push,d=h.utils.isArray;h.extend({add:function(a,f){return d(f)?(d(f[0])||(f=[f]),h.map(a,function(a,d,e){return a+f[d][e]})):h.map(a,function(a){return a+f})},subtract:function(a,f){return d(f)?(d(f[0])||(f=[f]),h.map(a,function(a,d,e){return a-f[d][e]||0})):h.map(a,function(a){return a-f})},divide:function(a,f){return d(f)?(d(f[0])||(f=[f]),h.multiply(a,h.inv(f))):h.map(a,function(a){return a/f})},multiply:function(a,f){var e,g,m,q,p=a.length,r=a[0].length,w=
h.zeros(p,m=d(f)?f[0].length:r),y=0;if(d(f)){for(;y<m;y++)for(e=0;e<p;e++){for(g=q=0;g<r;g++)q+=a[e][g]*f[g][y];w[e][y]=q}return 1===p&&1===y?w[0][0]:w}return h.map(a,function(a){return a*f})},dot:function(a,f){d(a[0])||(a=[a]);d(f[0])||(f=[f]);for(var e=1===a[0].length&&1!==a.length?h.transpose(a):a,g=1===f[0].length&&1!==f.length?h.transpose(f):f,m=[],q=0,p=e.length,r=e[0].length,w,y;q<p;q++){m[q]=[];for(y=w=0;y<r;y++)w+=e[q][y]*g[q][y];m[q]=w}return 1===m.length?m[0]:m},pow:function(a,d){return h.map(a,
function(a){return g.pow(a,d)})},exp:function(a){return h.map(a,function(a){return g.exp(a)})},log:function(a){return h.map(a,function(a){return g.log(a)})},abs:function(a){return h.map(a,function(a){return g.abs(a)})},norm:function(a,f){var e=0,h=0;isNaN(f)&&(f=2);for(d(a[0])&&(a=a[0]);h<a.length;h++)e+=g.pow(g.abs(a[h]),f);return g.pow(e,1/f)},angle:function(a,d){return g.acos(h.dot(a,d)/(h.norm(a)*h.norm(d)))},aug:function(a,d){for(var g=a.slice(),h=0;h<g.length;h++)e.apply(g[h],d[h]);return g},
inv:function(a){var d=a.length,e=a[0].length,g=h.identity(d,e);a=h.gauss_jordan(a,g);for(var g=[],m=0,q;m<d;m++)for(g[m]=[],q=e;q<a[0].length;q++)g[m][q-e]=a[m][q];return g},det:function(a){var d=a.length,e=2*d,g=Array(e),h=d-1,q=e-1,p=h-d+1,r=q,w=0,y=0,x;if(2===d)return a[0][0]*a[1][1]-a[0][1]*a[1][0];for(;w<e;w++)g[w]=1;for(w=0;w<d;w++){for(x=0;x<d;x++)g[0>p?p+d:p]*=a[w][x],g[r<d?r+d:r]*=a[w][x],p++,r--;p=--h-d+1;r=--q}for(w=0;w<d;w++)y+=g[w];for(;w<e;w++)y-=g[w];return y},gauss_elimination:function(a,
d){var e=0,n=0,m=a.length,q=a[0].length,p=1,r=0,w=[],y;a=h.aug(a,d);y=a[0].length;for(e=0;e<m;e++){p=a[e][e];n=e;for(r=e+1;r<q;r++)p<g.abs(a[r][e])&&(p=a[r][e],n=r);if(n!=e)for(r=0;r<y;r++)p=a[e][r],a[e][r]=a[n][r],a[n][r]=p;for(n=e+1;n<m;n++)for(p=a[n][e]/a[e][e],r=e;r<y;r++)a[n][r]-=p*a[e][r]}for(e=m-1;0<=e;e--){r=0;for(n=e+1;n<=m-1;n++)r+=w[n]*a[e][n];w[e]=(a[e][y-1]-r)/a[e][e]}return w},gauss_jordan:function(a,d){for(var e=h.aug(a,d),n=e.length,m=e[0].length,q=0;q<n;q++){for(var p=q,r=q+1;r<n;r++)g.abs(e[r][q])>
g.abs(e[p][q])&&(p=r);r=e[q];e[q]=e[p];e[p]=r;for(r=q+1;r<n;r++)for(c=e[r][q]/e[q][q],p=q;p<m;p++)e[r][p]-=e[q][p]*c}for(q=n-1;0<=q;q--){c=e[q][q];for(r=0;r<q;r++)for(p=m-1;p>q-1;p--)e[r][p]-=e[q][p]*e[r][q]/c;e[q][q]/=c;for(p=n;p<m;p++)e[q][p]/=c}return e},lu:function(a,d){throw Error("lu not yet implemented");},cholesky:function(a,d){throw Error("cholesky not yet implemented");},gauss_jacobi:function(a,d,e,n){for(var m=0,q=0,p=a.length,r=[],w=[],y=[];m<p;m++)for(r[m]=[],w[m]=[],y[m]=[],q=0;q<p;q++)m>
q?(r[m][q]=a[m][q],w[m][q]=y[m][q]=0):m<q?(w[m][q]=a[m][q],r[m][q]=y[m][q]=0):(y[m][q]=a[m][q],r[m][q]=w[m][q]=0);a=h.multiply(h.multiply(h.inv(y),h.add(r,w)),-1);y=h.multiply(h.inv(y),d);d=e;e=h.add(h.multiply(a,e),y);for(m=2;g.abs(h.norm(h.subtract(e,d)))>n;)d=e,e=h.add(h.multiply(a,d),y),m++;return e},gauss_seidel:function(a,d,e,n){for(var m=0,q=a.length,p=[],r=[],w=[],y;m<q;m++)for(p[m]=[],r[m]=[],w[m]=[],y=0;y<q;y++)m>y?(p[m][y]=a[m][y],r[m][y]=w[m][y]=0):m<y?(r[m][y]=a[m][y],p[m][y]=w[m][y]=
0):(w[m][y]=a[m][y],p[m][y]=r[m][y]=0);a=h.multiply(h.multiply(h.inv(h.add(w,p)),r),-1);p=h.multiply(h.inv(h.add(w,p)),d);d=e;e=h.add(h.multiply(a,e),p);for(m=2;g.abs(h.norm(h.subtract(e,d)))>n;)d=e,e=h.add(h.multiply(a,d),p),m+=1;return e},SOR:function(a,d,e,n,m){for(var q=0,p=a.length,r=[],w=[],y=[],x;q<p;q++)for(r[q]=[],w[q]=[],y[q]=[],x=0;x<p;x++)q>x?(r[q][x]=a[q][x],w[q][x]=y[q][x]=0):q<x?(w[q][x]=a[q][x],r[q][x]=y[q][x]=0):(y[q][x]=a[q][x],r[q][x]=w[q][x]=0);a=h.multiply(h.inv(h.add(y,h.multiply(r,
m))),h.subtract(h.multiply(y,1-m),h.multiply(w,m)));m=h.multiply(h.multiply(h.inv(h.add(y,h.multiply(r,m))),d),m);d=e;e=h.add(h.multiply(a,e),m);for(q=2;g.abs(h.norm(h.subtract(e,d)))>n;)d=e,e=h.add(h.multiply(a,d),m),q++;return e},householder:function(a){for(var d=a.length,e=a[0].length,n=0,m=[],q=[],p;n<d-1;n++){q=0;for(m=n+1;m<e;m++)q+=a[m][n]*a[m][n];m=0<a[n+1][n]?-1:1;q=m*g.sqrt(q);p=g.sqrt((q*q-a[n+1][n]*q)/2);m=h.zeros(d,1);m[n+1][0]=(a[n+1][n]-q)/(2*p);for(q=n+2;q<d;q++)m[q][0]=a[q][n]/(2*
p);q=h.subtract(h.identity(d,e),h.multiply(h.multiply(m,h.transpose(m)),2));a=h.multiply(q,h.multiply(a,q))}return a},QR:function(a,d){for(var e=a.length,n=a[0].length,m=0,q=[],p=[],r=[],w;m<e-1;m++){p=0;for(q=m+1;q<n;q++)p+=a[q][m]*a[q][m];q=0<a[m+1][m]?-1:1;p=q*g.sqrt(p);w=g.sqrt((p*p-a[m+1][m]*p)/2);q=h.zeros(e,1);q[m+1][0]=(a[m+1][m]-p)/(2*w);for(p=m+2;p<e;p++)q[p][0]=a[p][m]/(2*w);p=h.subtract(h.identity(e,n),h.multiply(h.multiply(q,h.transpose(q)),2));a=h.multiply(p,a);d=h.multiply(p,d)}for(m=
e-1;0<=m;m--){for(q=m+1;q<=n-1;q++);r[m]=d[m][0]/a[m][m]}return r},jacobi:function(a){for(var d=1,e=0,n=a.length,m=h.identity(n,n),q=[],p,r,w,y,x;1===d;){e++;y=a[0][1];d=0;w=1;for(p=0;p<n;p++)for(r=0;r<n;r++)p!=r&&y<g.abs(a[p][r])&&(y=g.abs(a[p][r]),d=p,w=r);a[d][d]===a[w][w]?x=0<a[d][w]?g.PI/4:-g.PI/4:x=g.atan(2*a[d][w]/(a[d][d]-a[w][w]))/2;p=h.identity(n,n);p[d][d]=g.cos(x);p[d][w]=-g.sin(x);p[w][d]=g.sin(x);p[w][w]=g.cos(x);m=h.multiply(m,p);a=h.multiply(h.multiply(h.inv(p),a),p);d=0;for(p=1;p<
n;p++)for(r=1;r<n;r++)p!=r&&.001<g.abs(a[p][r])&&(d=1)}for(p=0;p<n;p++)q.push(a[p][p]);return[m,q]},rungekutta:function(a,d,e,g,h,q){var p,r,w;if(2===q)for(;g<=e;)p=d*a(g,h),r=d*a(g+d,h+p),h+=(p+r)/2,g+=d;if(4===q)for(;g<=e;)p=d*a(g,h),r=d*a(g+d/2,h+p/2),q=d*a(g+d/2,h+r/2),w=d*a(g+d,h+q),h+=(p+2*r+2*q+w)/6,g+=d;return h},romberg:function(a,d,e,h){for(var m=0,q=(e-d)/2,p=[],r=[],w=[],y,x,z;m<h/2;){z=a(d);x=d;for(y=0;x<=e;x+=q,y++)p[y]=x;y=p.length;for(x=1;x<y-1;x++)z+=(0!==x%2?4:2)*a(p[x]);z=q/3*(z+
a(e));w[m]=z;q/=2;m++}a=w.length;for(y=1;1!==a;){for(x=0;x<a-1;x++)r[x]=(g.pow(4,y)*w[x+1]-w[x])/(g.pow(4,y)-1);a=r.length;w=r;r=[];y++}return w},richardson:function(a,d,e,h){function m(a,d){for(var e=0,f=a.length,g;e<f;e++)a[e]===d&&(g=e);return g}for(var q=g.abs(e-a[m(a,e)+1]),p=0,r=[],w=[],y,x;h>=q;)y=m(a,e+h),x=m(a,e),r[p]=(d[y]-2*d[x]+d[2*x-y])/(h*h),h/=2,p++;d=r.length;for(a=1;1!=d;){for(e=0;e<d-1;e++)w[e]=(g.pow(4,a)*r[e+1]-r[e])/(g.pow(4,a)-1);d=w.length;r=w;w=[];a++}return r},simpson:function(a,
d,e,g){g=(e-d)/g;var h=a(d),q=[],p=d,r=0;for(d=1;p<=e;p+=g,r++)q[r]=p;for(p=q.length;d<p-1;d++)h+=(0!==d%2?4:2)*a(q[d]);return g/3*(h+a(e))},hermite:function(a,d,e,g){for(var h=a.length,q=0,p=0,r=[],w=[],y=[],x=[],z;p<h;p++){r[p]=1;for(z=0;z<h;z++)p!=z&&(r[p]*=(g-a[z])/(a[p]-a[z]));for(z=w[p]=0;z<h;z++)p!=z&&(w[p]+=1/(a[p]-a[z]));y[p]=(1-2*(g-a[p])*w[p])*r[p]*r[p];x[p]=(g-a[p])*r[p]*r[p];q+=y[p]*d[p]+x[p]*e[p]}return q},lagrange:function(a,d,e){for(var g=0,h=0,q,p,r=a.length;h<r;h++){p=d[h];for(q=
0;q<r;q++)h!=q&&(p*=(e-a[q])/(a[h]-a[q]));g+=p}return g},cubic_spline:function(a,d,e){for(var g=a.length,m=0,q=[],p=[],r=[],w=[],y=[],x=[],z=[];m<g-1;m++)y[m]=a[m+1]-a[m];r[0]=0;for(m=1;m<g-1;m++)r[m]=3/y[m]*(d[m+1]-d[m])-3/y[m-1]*(d[m]-d[m-1]);for(m=1;m<g-1;m++)q[m]=[],p[m]=[],q[m][m-1]=y[m-1],q[m][m]=2*(y[m-1]+y[m]),q[m][m+1]=y[m],p[m][0]=r[m];w=h.multiply(h.inv(q),p);for(m=0;m<g-1;m++)x[m]=(d[m+1]-d[m])/y[m]-y[m]*(w[m+1][0]+2*w[m][0])/3,z[m]=(w[m+1][0]-w[m][0])/(3*y[m]);for(m=0;m<g&&!(a[m]>e);m++);
return--m,d[m]+(e-a[m])*x[m]+h.sq(e-a[m])*w[m]+(e-a[m])*h.sq(e-a[m])*z[m]},gauss_quadrature:function(){throw Error("gauss_quadrature not yet implemented");},PCA:function(a){var d=a.length,e=a[0].length,g=0,m,q,p=[],r=[];m=[];for(var w=[],y=[],x=[],x=[],r=[],g=[],z=[],g=0;g<d;g++)p[g]=h.sum(a[g])/e;for(g=0;g<e;g++)for(x[g]=[],m=0;m<d;m++)x[g][m]=a[m][g]-p[m];x=h.transpose(x);for(g=0;g<d;g++)for(r[g]=[],m=0;m<d;m++)r[g][m]=h.dot([x[g]],[x[m]])/(e-1);m=h.jacobi(r);g=m[0];r=m[1];z=h.transpose(g);for(g=
0;g<r.length;g++)for(m=g;m<r.length;m++)r[g]<r[m]&&(q=r[g],r[g]=r[m],r[m]=q,w=z[g],z[g]=z[m],z[m]=w);x=h.transpose(x);for(g=0;g<d;g++)for(y[g]=[],m=0;m<x.length;m++)y[g][m]=h.dot([z[g]],[x[m]]);return[a,r,z,y]}});(function(a){for(var d=0;d<a.length;d++)(function(a){h.fn[a]=function(d,e){var f=this;return e?(setTimeout(function(){e.call(f,h.fn[a].call(f,d))},15),this):"number"==typeof h[a](this,d)?h[a](this,d):h(h[a](this,d))}})(a[d])})("add divide multiply subtract dot pow exp log abs norm angle".split(" "))})(this.jStat,
Math);
(function(h,g){var e=[].slice,d=h.utils.isNumber;h.extend({zscore:function(){var a=e.call(arguments);return d(a[1])?(a[0]-a[1])/a[2]:(a[0]-h.mean(a[1]))/h.stdev(a[1],a[2])},ztest:function(){var a=e.call(arguments);if(4===a.length){if(d(a[1])){var f=h.zscore(a[0],a[1],a[2]);return 1===a[3]?h.normal.cdf(-g.abs(f),0,1):2*h.normal.cdf(-g.abs(f),0,1)}f=a[0];return 1===a[2]?h.normal.cdf(-g.abs(f),0,1):2*h.normal.cdf(-g.abs(f),0,1)}f=h.zscore(a[0],a[1],a[3]);return 1===a[1]?h.normal.cdf(-g.abs(f),0,1):2*
h.normal.cdf(-g.abs(f),0,1)}});h.extend(h.fn,{zscore:function(a,d){return(a-this.mean())/this.stdev(d)},ztest:function(a,d,e){a=g.abs(this.zscore(a,e));return 1===d?h.normal.cdf(-a,0,1):2*h.normal.cdf(-a,0,1)}});h.extend({tscore:function(){var a=e.call(arguments);return 4===a.length?(a[0]-a[1])/(a[2]/g.sqrt(a[3])):(a[0]-h.mean(a[1]))/(h.stdev(a[1],!0)/g.sqrt(a[1].length))},ttest:function(){var a=e.call(arguments),f;return 5===a.length?(f=g.abs(h.tscore(a[0],a[1],a[2],a[3])),1===a[4]?h.studentt.cdf(-f,
a[3]-1):2*h.studentt.cdf(-f,a[3]-1)):d(a[1])?(f=g.abs(a[0]),1==a[2]?h.studentt.cdf(-f,a[1]-1):2*h.studentt.cdf(-f,a[1]-1)):(f=g.abs(h.tscore(a[0],a[1])),1==a[2]?h.studentt.cdf(-f,a[1].length-1):2*h.studentt.cdf(-f,a[1].length-1))}});h.extend(h.fn,{tscore:function(a){return(a-this.mean())/(this.stdev(!0)/g.sqrt(this.cols()))},ttest:function(a,d){return 1===d?1-h.studentt.cdf(g.abs(this.tscore(a)),this.cols()-1):2*h.studentt.cdf(-g.abs(this.tscore(a)),this.cols()-1)}});h.extend({anovafscore:function(){var a=
e.call(arguments),d,l,n,m,q,p;if(1===a.length){d=Array(a[0].length);for(q=0;q<a[0].length;q++)d[q]=a[0][q];a=d}if(2===a.length)return h.variance(a[0])/h.variance(a[1]);l=[];for(q=0;q<a.length;q++)l=l.concat(a[q]);n=h.mean(l);for(q=d=0;q<a.length;q++)d+=a[q].length*g.pow(h.mean(a[q])-n,2);d/=a.length-1;for(q=m=0;q<a.length;q++)for(n=h.mean(a[q]),p=0;p<a[q].length;p++)m+=g.pow(a[q][p]-n,2);return m/=l.length-a.length,d/m},anovaftest:function(){var a=e.call(arguments),f,g,n,m;if(d(a[0]))return 1-h.centralF.cdf(a[0],
a[1],a[2]);anovafscore=h.anovafscore(a);f=a.length-1;for(m=n=0;m<a.length;m++)n+=a[m].length;return g=n-f-1,1-h.centralF.cdf(anovafscore,f,g)},ftest:function(a,d,e){return 1-h.centralF.cdf(a,d,e)}});h.extend(h.fn,{anovafscore:function(){return h.anovafscore(this.toArray())},anovaftes:function(){var a=0,d;for(d=0;d<this.length;d++)a+=this[d].length;return h.ftest(this.anovafscore(),this.length-1,a-this.length)}});h.extend({normalci:function(){var a=e.call(arguments),d=Array(2),l;return 4===a.length?
l=g.abs(h.normal.inv(a[1]/2,0,1)*a[2]/g.sqrt(a[3])):l=g.abs(h.normal.inv(a[1]/2,0,1)*h.stdev(a[2])/g.sqrt(a[2].length)),d[0]=a[0]-l,d[1]=a[0]+l,d},tci:function(){var a=e.call(arguments),d=Array(2),l;return 4===a.length?l=g.abs(h.studentt.inv(a[1]/2,a[3]-1)*a[2]/g.sqrt(a[3])):l=g.abs(h.studentt.inv(a[1]/2,a[2].length-1)*h.stdev(a[2],!0)/g.sqrt(a[2].length)),d[0]=a[0]-l,d[1]=a[0]+l,d},significant:function(a,d){return a<d}});h.extend(h.fn,{normalci:function(a,d){return h.normalci(a,d,this.toArray())},
tci:function(a,d){return h.tci(a,d,this.toArray())}})})(this.jStat,Math);var utils=utils||{};
(function(h){h.htmlNamespaceUri="http://www.w3.org/1999/xhtml";h.svgNamespaceUri="http://www.w3.org/2000/svg";h.xlinkUri="http://www.w3.org/1999/xlink";h.hasOwnProperty=function(g,e){var d=g.__proto__||g.constructor.prototype;return e in g&&(!(e in d)||d[e]!==g[e])};h.shuffleArray=function(g){for(var e=g.length,d,a;0!==e;)a=Math.floor(Math.random()*e),--e,d=g[e],g[e]=g[a],g[a]=d;return g};h.isObjInArray=function(g,e){var d=!1;0<=g.indexOf(e)&&(d=!0);return d};h.removeA=function(g){for(var e,d=arguments,
a=d.length,f;1<a&&g.length;)for(e=d[--a];-1!==(f=g.indexOf(e));)g.splice(f,1);return g};h.getKeys=function(g){var e=[],d;for(d in g)e.push(d);return e};h.eliminateDuplicates=function(g){for(var e=[],d=0;d<g.length;d++){var a=g[d];h.isObjInArray(e,a)||e.push(a)}return e};h.keepReplicates=function(g,e,d){for(var a={},f=0;f<g.length;f++){var h=g[f];h in a||(a[h]=0);a[h]++}e=null==e?2:e;g=[];for(h in a)null!=d&&d?a[h]<e&&g.push(h):a[h]>=e&&g.push(h);return g};h.beginsWith=function(g,e){return 0===g.indexOf(e)};
h.endsWith=function(g,e){return-1!==g.indexOf(e,g.length-e.length)};h.lengthOfLongestString=function(g){var e=[],d;for(d in g)e.push(g[d].length);return Math.max.apply(null,e)};h.isNumerical=function(g){return null==g||""===g||isNaN(g)?!1:!0};h.getListBoxSelectedValues=function(g){for(var e=[],d=0;d<g.length;d++){var a=g[d];a.selected&&e.push(a.value)}return e};h.linearInterpolation=function(g,e,d){return(d-e)*g+e};h.rangeLimit=function(g,e,d){"undefined"===typeof e&&(e=-1);"undefined"===typeof d&&
(d=1);return g<e?e:g>d?d:g};h.extractFromJq=function(g){return g.get(0)};h.convertToJq=function(g){$(g);return g};h.extractFromD3=function(g){return g.node()};h.convertToD3=function(g){return d3.select(g)};h.sort_by=function(g,e,d){var a=d?function(a){return d(a[g])}:function(a){return a[g]};e=[-1,1][+!!e];return function(d,g){return d=a(d),g=a(g),e*((d>g)-(g>d))}};h.compareAsNumeric=function(g,e){var d=parseFloat(g),a=parseFloat(e);if(utils.isNumerical(d)&&utils.isNumerical(a)){if(d<a)return-1;if(d>
a)return 1}else if(d==d||a==a){if(d!=d)return-1;if(a!=a)return 1}return 0};h.compareAsString=function(g,e){var d=new String(g),a=new String(e);return"null"==d&&"null"!=a?1:"null"!=d&&"null"==a?-1:d.localeCompare(a)};h.compareAsDate=function(g,e){var d=g,a=e;null==d?d="1000":""==d&&(d="1001");null==a?a="1000":""==a&&(a="1001");return new Date(d)-new Date(a)};h.rgbComponentToHex=function(g){g=g.toString(16);return 1==g.length?"0"+g:g};h.rgbToHex=function(g,e,d){return"#"+this.rgbComponentToHex(g)+this.rgbComponentToHex(e)+
this.rgbComponentToHex(d)};h.centeredRgbaColorMapper=function(g,e,d,a){var f=null,h=null==e?0:e,n=null==d?-1.96:d,m=null==a?1.96:a;return f=function(a){var d=1,e=169,f=169,y=169;a=parseFloat(a);null!=a&&a==a&&(a>h?(e=255,y=f=0,a>m?d=1:(d=(a-h)/(m-h),d=Math.abs(d),g&&(d=Math.log(d)))):a<h?(f=e=0,y=255,a<n?d=1:(d=(a-h)/(n-h),d=Math.abs(d),g&&(d=Math.log(d)))):(y=f=e=255,d=1));return"rgba("+e+","+f+","+y+","+d+")"}};h.setupQuantileColorMapper=function(g,e){var d=e;null==d&&(d="rgb(255,255,217) rgb(237,248,177) rgb(199,233,180) rgb(127,205,187) rgb(65,182,196) rgb(29,145,192) rgb(34,94,168) rgb(37,52,148) rgb(8,29,88)".split(" "));
var a=d.length;return d3.scale.quantile().domain([0,a-1,d3.max(g,function(a){return parseFloat(a)})]).range(d)};h.getXmlDom_url=function(g){xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");xmlhttp.open("GET",g,!1);xmlhttp.send();return xmlDoc=xmlhttp.responseXML};h.getXmlDom_string=function(g){window.DOMParser?(parser=new DOMParser,xmlDoc=parser.parseFromString(g,"text/xml")):(xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.async=!1,xmlDoc.loadXML(g));return xmlDoc};
h.getDateTime=function(){var g=new Date,e=g.getFullYear(),d=g.getMonth()+1,a=g.getDate(),f=g.getHours(),h=g.getMinutes(),g=g.getSeconds();1==d.toString().length&&(d="0"+d);1==a.toString().length&&(a="0"+a);1==f.toString().length&&(f="0"+f);1==h.toString().length&&(h="0"+h);1==g.toString().length&&(g="0"+g);return e+"/"+d+"/"+a+" "+f+":"+h+":"+g};h.todaysDate=function(){var g=new Date,e=g.getDate();g.getDay();var d=g.getMonth()+1,g=g.getYear();return[,"January","February","March","April","May","June",
"July","August","September","October","November","December"][d]+" "+e+", "+(1E3>g?g+1900:g)};h.removeElemById=function(g){g=document.getElementById(g);g.parentNode.removeChild(g)};h.removeChildElems=function(g){for(;g.firstChild;)g.removeChild(g.firstChild);return g};h.createDivElement=function(g,e){var d=document.createElement("div");null!=g&&(d.id=g);null!=e&&(d.className=e);return d};h.setElemAttributes=function(g,e,d){d="undefined"===typeof d?null:d;if(null!=e)for(var a in e)g.setAttributeNS(d,
a,e[a]);return g};h.swapContainingDivs=function(g,e){var d=e.parentNode;document.getElementById(g.parentNode.id).appendChild(e);document.getElementById(d.id).appendChild(g)};h.simpleAsyncGet=function(g,e){var d=new XMLHttpRequest,d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");d.onreadystatechange=function(){this.readyState===(this.DONE||4)&&(200==this.status?e(this.responseText):400==this.status?console.log("There was an error 400"):console.log("status was not 200",
this.status))};d.open("GET",g,!0);d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.send(null)};h.getResponse=function(g){var e=null,d=null,d=new XMLHttpRequest;d.open("GET",g,!1);d.onload=function(){e=d.status;200!=e&&console.log("xhr status: "+e+" for "+g)};d.send(null);var a=null;200==e&&(a=d.responseText);return a};h.loadNewSettings=function(g){g=window.location.pathname+"?query="+JSON.stringify(g);window.open(g,"_self")};h.getQueryObj=function(){var g={};location.search.slice(1).split("&").forEach(function(e){e=
e.split("=");g[e[0]]=decodeURIComponent(e[1])||""});return g};h.getQueryStringParameterByName=function(g){g=g.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");g=(new RegExp("[\\?&]"+g+"=([^&#]*)")).exec(location.search);return null==g?"":decodeURIComponent(g[1].replace(/\+/g," "))};h.parseJson=function(g){return JSON.parse(g)};h.serializeJson=function(g,e){return e?JSON.stringify(g,null,"\t"):JSON.stringify(g)};h.prettyJson=function(g){return this.serializeJson(g,!0)};h.bottomRoundedRectSvgPath=function(g,
e,d,a,f){g=""+("M"+g+","+e)+("h"+d);g+="v"+(a-f);g+="a"+f+","+f+" 0 0 1 "+-1*f+","+f;g+="h"+-1*(d-2*f);g+="a"+f+","+f+" 0 0 1 "+-1*f+","+-1*f;g+="v"+-1*(a-f);return g+="z"};h.allRoundedRectSvgPath=function(g,e,d,a,f){g=""+("M"+g+","+(e+f))+("a"+f+","+f+" 0 0 1 "+f+","+-1*f);g+="h"+(d-2*f);g+="a"+f+","+f+" 0 0 1 "+f+","+f;g+="v"+(a-2*f);g+="a"+f+","+f+" 0 0 1 "+-1*f+","+f;g+="h"+-1*(d-2*f);g+="a"+f+","+f+" 0 0 1 "+-1*f+","+-1*f;g+="v"+-1*(a-2*f);return g+="z"};h.allAngledRectSvgPath=function(g,e,d,
a){var f=d>a?d/8:a/8;g=""+("M"+(g+f)+","+e)+("h"+(d-2*f));g+="l"+f+","+f;g+="v"+(a-2*f);g+="l"+-1*f+","+f;g+="h"+-1*(d-2*f);g+="l"+-1*f+","+-1*f;g+="v"+-1*(a-2*f);return g+="z"};h.createSvgRingElement=function(g,e,d,a){function f(a,d,e,f){f=(f-90)*Math.PI/180;return{x:a+e*Math.cos(f),y:d+e*Math.sin(f)}}g=function(a,d,e,g,h){var l=f(a,d,e,h);a=f(a,d,e,g);return["M",l.x,l.y,"A",e,e,0,180>=h-g?"0":"1",0,a.x,a.y].join(" ")}(g,e,d,0,359.9);e=document.createElementNS(this.svgNamespaceUri,"path");e.setAttributeNS(null,
"d",g);if(null!=a)for(var h in a)e.setAttributeNS(null,h,a[h]);return e};h.createSvgCircleElement=function(g,e,d,a){var f=document.createElementNS(this.svgNamespaceUri,"circle");f.setAttributeNS(null,"cx",g);f.setAttributeNS(null,"cy",e);f.setAttributeNS(null,"r",d);if(null!=a)for(var h in a)f.setAttributeNS(null,h,a[h]);return f};h.createSvgRectElement=function(g,e,d,a,f,h,n){var m=document.createElementNS(this.svgNamespaceUri,"rect");m.setAttributeNS(null,"x",g);m.setAttributeNS(null,"y",e);m.setAttributeNS(null,
"rx",d);m.setAttributeNS(null,"ry",a);m.setAttributeNS(null,"width",f);m.setAttributeNS(null,"height",h);if(null!=n)for(var q in n)m.setAttributeNS(null,q,n[q]);return m};h.createSvgImageElement=function(g,e,d,a,f,h){var n=document.createElementNS(this.svgNamespaceUri,"image");n.setAttributeNS(this.xlinkUri,"href",g);n.setAttributeNS(null,"x",e);n.setAttributeNS(null,"y",d);n.setAttributeNS(null,"width",a);n.setAttributeNS(null,"height",f);if(null!=h)for(var m in h)n.setAttributeNS(null,m,h[m]);return n};
h.setCookie=function(g,e,d){if(d){var a=new Date;a.setTime(a.getTime()+864E5*d);d="; expires="+a.toGMTString()}else d="";document.cookie=g+"="+e+d+"; path=/"};h.getCookie=function(g){g+="=";for(var e=document.cookie.split(";"),d=0;d<e.length;d++){for(var a=e[d];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(g))return a.substring(g.length,a.length)}return null};h.deleteCookie=function(g){this.setCookie(g,"",-1)};h.getNormalizedVector=function(g){var e=[],d=jStat.min(g),a=jStat.max(g);
if(0>d||0==a){console.log("min:"+d+"\tmax:"+a);if(0>d)return null;if(0==a)return g}for(d=0;d<g.length;d++)e.push(g[d]/a);return e};h.computeMarginalEntropy=function(g,e){for(var d=0,a=[],f=e(g),h=0;h<f.length;h++)a.push({bin:h,count:f[h].length});for(h=0;h<a.length;h++)f=a[h],f.probability=f.count/g.length,f.prod=0==f.probability?0:f.probability*Math.log2(f.probability),d+=f.prod;return-1*d};h.computeJointEntropy=function(g,e,d){if(g.length!=e.length)return null;var a=function(a,d){for(var e=null,
f=0;f<a.length;f++){var g=a[f];d>=g.x&&d<g.x+g.dx&&(e=f)}null==e&&(g=a[a.length-1],d-g.x-g.dx<g.dx&&(e=a.length-1));return e},f=d(g),l=d(e);d={};for(var n=0;n<f.length;n++)for(var m=0;m<l.length;m++){var q=n+"_"+m;d[q]=0}for(n=0;n<g.length;n++)q=a(f,g[n]),m=a(l,e[n]),q=q+"_"+m,d[q]++;e=0;a=h.getKeys(d);for(n=0;n<a.length;n++)q=a[n],f=d[q]/g.length,f=0==f?0:f*Math.log2(f),e+=f;return-1*e};h.mutualInformation=function(g,e,d){d="undefined"===typeof d?g.length:d;var a=d3.layout.histogram().bins(d).frequency(!1);
d=h.computeMarginalEntropy(g,a);var f=h.computeMarginalEntropy(e,a);g=h.computeJointEntropy(g,e,a);return d+f-g}})(utils);var eventData=eventData||{};
(function(h){h.eventHierarchyUrl="observation_deck/data/eventHierarchy.xml";h.getEventElems=function(g,e){var d=[];g.find("event").each(function(a,f){var g=f.getAttribute("type");void 0===e||null===e?d.push(f):g===e&&d.push(f)});return d};h.getEventParentChildren=function(g,e){var d={parent:null,children:[]},a=h.getEventElems(g,e);$(a).each(function(a,e){if("event"!==e.tagName)return"continue";d.parent=e.parentNode.getAttribute("type");$(e.children).each(function(a,e){"event"===e.tagName&&d.children.push(e.getAttribute("type"))})});
return d};h.tracebackToRoot=function(g,e){for(var d=[],a=h.getEventElems(g,e),f=0;f<a.length;f++){var l=a[f],n=[];d.push(n);l=l.getAttribute("type");for(l=h.getEventParentChildren(g,l).parent;void 0!==l&&null!==l;)n.push(l),l=h.getEventParentChildren(g,l).parent}return d};h.OD_eventAlbum=function(){this.album={};this.datatypeSuffixMapping={};this.pivot={};this.addEvent=function(g,e){var d=new h.OD_event(g);this.album[g.id]=d;"datatype"in g&&"geneSuffix"in g&&(this.datatypeSuffixMapping[g.datatype]=
g.geneSuffix);d.data.setData(e,"numeric"==g.allowedValues||"expression"==g.allowedValues);return d};this.deleteEvent=function(g){delete this.album[g]};this.getEventIdsByType=function(){for(var g={},e=utils.getKeys(this.album),d=0;d<e.length;d++){var a=e[d],f=this.getEvent(a).metadata.datatype;utils.hasOwnProperty(g,f)||(g[f]=[]);g[f].push(a)}return g};this.getEventData=function(g){for(var e={},d=utils.getKeys(this.album),a=0;a<d.length;a++){var f=d[a],h=this.getEvent(f).data.getData(g);e[f]=h}return e};
this.getAllDataAsList=function(){for(var g=[],e=this.getEventData(),d=utils.getKeys(e),a=0;a<d.length;a++){for(var f=d[a],h=e[f].slice(),n=0;n<h.length;n++)h[n].eventId=f;g=g.concat(h)}return g};this.getAllSampleIds=function(){for(var g=[],e=utils.getKeys(this.album),d=0;d<e.length;d++)var a=this.getEvent(e[d]).data.getAllSampleIds(),g=g.concat(a);return utils.eliminateDuplicates(g)};this.selectSamples=function(g){var e=this.getAllSampleIds();if(0==g.length)return e;for(var d in g)var a=g[d].value,
e=this.getEvent(g[d].eventId).data.selectIds(a,e);return e};this.getEvent=function(g){return this.album[g]};this.getAllChildren=function(g,e){for(var d="undefined"===typeof e?[]:e,a=[],f=0;f<g.length;f++)var h=this.getEvent(g[f]).metadata,a=a.concat(getKeys(h.children));if(0==a.length)return d;d=d.concat(a);return this.getAllChildren(a,d)};this.setPivotScores=function(g,e){this.pivot=null==e?{}:{event:g,scores:e};return this};this.getPivotSortedEvents=function(){if("undefined"===typeof this.pivot.scores||
null==this.pivot.scores)return console.log("getPivotSortedEvents found no pivot scores"),[];for(var g=[],e=0;e<this.pivot.scores.length;e++){var d=this.pivot.scores[e];g.push({key:d.gene,val:parseFloat(d.weight)})}g=g.sort(utils.sort_by("val"));g.reverse();return g};this.getGroupedPivotSorts=function(){console.log("getGroupedPivotSorts");var g={},e=this.getPivotSortedEvents();e.reverse();for(var d=[],a=0;a<e.length;a++)d.push(e[a].key);var e=this.getEventIdsByType(),f;for(f in e){for(var a=this.datatypeSuffixMapping[f],
a=null==a?"":a,h=[],n=e[f],m=0;m<d.length;m++){var q=d[m]+a;utils.isObjInArray(n,q)&&h.push(q)}h=h.concat(n);h=utils.eliminateDuplicates(h);g[f]=h}return g};this.getAllPivotScores=function(g,e){var d={},a=this.getEventIdsByType();if(!utils.hasOwnProperty(a,g))return d;for(var a=a[g],f=0;f<a.length;f++){var h=a[f],n=this.pivotSort(h,e);d[h]=n}return d};this.pivotSort_2=function(g,e){for(var d=this.pivotSort(g,jStat.corrcoeff),a={},f=0;f<d.length;f++){var h=d[f],n=h.event;a[n]=0>h.score?-1:1}for(var d=
this.pivotSort(g,e),m=[],q=[],f=0;f<d.length;f++)h=d[f],n=h.event,0>a[n]?q.push(h):m.push(h);m.sort(utils.sort_by("score"));q.sort(utils.sort_by("score"),!0);return m.concat(q)};this.pivotSort=function(g,e){console.log("eventAlbum.pivotSort:",g);"undefined"===typeof e&&(console.log("using default scoringAlgorithm, jStat.corrcoeff"),e=jStat.corrcoeff);var d=this.getEvent(g);if(null==d)return console.log("eventObj not found for",g),null;for(var a=d.data.getAllSampleIds(),f=d.data.getNullSamples(),a=
utils.keepReplicates(a.concat(f),2,!0),f=this.getEventIdsByType()[d.metadata.datatype],h=[],n=0;n<f.length;n++){var m=f[n],q=this.getEvent(m),p=q.data.getAllSampleIds(),r=q.data.getNullSamples(),p=utils.keepReplicates(p.concat(r),2,!0),p=utils.keepReplicates(p.concat(a)),r=d.data.getData(p),q=q.data.getData(p);if(0<q.length){var w=[],y=[],x=null;null==x&&(x=utils.hasOwnProperty(r[0],"val_orig")?"val_orig":"val");for(var z=null,F=0;F<p.length;F++)null==z&&(z=utils.hasOwnProperty(q[F],"val_orig")?"val_orig":
"val"),w.push(r[F][x]),y.push(q[F][z]);p=e(w,y);h.push({event:m,score:p})}else console.log("eventData2 is empty")}h.sort(utils.sort_by("score"));return h};this.multisortEvents=function(g,e){console.log("multisortEvents");console.log("rowSortSteps",g);console.log("colSortSteps",e);var d=this.getEventIdsByType(),a=[],f;for(f in d)var h=d[f],a=a.concat(h);h=[];if(null!=e){for(var n=e.getSteps(),m=0;m<n.length;m++){f=n[m];var q=f.name;h.push(q)}h.reverse()}var p=h.slice(0);for(f=0;f<a.length;f++)q=a[f],
utils.isObjInArray(p,q)||p.push(q);if(null!=g)for(n=g.getSteps().reverse(),m=0;m<n.length;m++){f=n[m];var q=f.name,r=f.reverse,a=this.getEvent(q);f=a.metadata.datatype;var w=a.metadata.scoredDatatype,q=this.datatypeSuffixMapping[w];if(null==w)console.log("no scored datatype to sort");else if(a=a.metadata.sortSignatureVector(),r&&a.reverse(),utils.hasOwnProperty(d,w)){n=d[w].slice(0);p=[];m=[];for(r=0;r<a.length;r++){var y=a[r]+q,x=n.indexOf(y);0<=x&&m.push(y);0<=x&&!utils.isObjInArray(h,y)&&(p.push(y),
delete n[x]);utils.isObjInArray(h,y)&&delete n[x]}console.log("scoredEventSigWeightOverlap",m.length,m);for(var z in n)p.push(n[z]);a=h.slice(0);for(f in d)if(f===w)a=a.concat(p);else{var h=d[f],F;for(F in h)q=h[F],utils.isObjInArray(a,q)||a.push(q)}p=a;console.log("rowNames.length",p.length,p);break}else console.log(w+" group has no events")}return p};this.multisortSamples=function(g){var e=this.getAllSampleIds();if(null==g)return e;var d=g.getSteps().slice();d.reverse();var a=this;e.sort(function(e,
g){for(var h=0,m=0;m<d.length;m++){var q=d[m].name,p=d[m].reverse,r=a.getEvent(q);if(void 0==r||null==r)console.log("no event found for sorting: "+q);else{var h=r.metadata.allowedValues,q=r.data.getData([e,g]),r=q[0].val,w=q[1].val,q=null,q="numeric"==h?utils.compareAsNumeric:"categoric"==h?utils.compareAsString:"expression"==h?utils.compareAsNumeric:"date"==h?utils.compareAsDate:utils.compareAsString,h=q(r,w);q==utils.compareAsNumeric&&(h*=-1);p&&(h*=-1);if(0!=h)break}}return h});return e};this.zScoreExpressionRescaling=
function(){console.log("zScoreExpressionRescaling");var g=this.getEventIdsByType();if(!utils.hasOwnProperty(g,"expression data"))return console.log("no expression"),null;for(var g=g["expression data"],e={},d={stats:e},a=[],f=0;f<g.length;f++){var h=g[f],n=this.getEvent(h).data.getStats();e[h]={};e[h]=n;for(var n=this.getEvent(h).data.getData(),m=0;m<n.length;m++){var q=n[m];utils.hasOwnProperty(q,"val_orig")&&(q.val=q.val_orig);var p=q.val;q.val_orig=p;utils.isNumerical(p)&&(q.val=(p-e[h].mean)/e[h].sd,
a.push(q.val))}}d.maxVal=jStat.max(a);d.minVal=jStat.min(a);return d};this.betweenMeansExpressionRescaling=function(g,e,d){console.log("betweenMeansExpressionRescaling",g,e,d);e=this.getEvent(g).data.selectIds(e);var a=null;null==d?(a=this.getEvent(g).data.selectIds(d),a=a.concat(e),a=utils.eliminateDuplicates(a)):a=this.getEvent(g).data.selectIds(d);g=this.getEventIdsByType();if(!utils.hasOwnProperty(g,"expression data"))return console.log("no expression"),null;g=g["expression data"];d={};for(var f=
{meanVals:d},h=[],n=0;n<g.length;n++){var m=g[n];d[m]={};d[m].group1=this.getEvent(m).data.getStats(e).mean;d[m].group2=this.getEvent(m).data.getStats(a).mean;for(var q=(d[m].group2-d[m].group1)/2,m=this.getEvent(m).data.getData(),p=0;p<m.length;p++){var r=m[p];utils.hasOwnProperty(r,"val_orig")&&(r.val=r.val_orig);var w=r.val;r.val_orig=w;utils.isNumerical(w)&&(r.val=w-q,h.push(r.val))}}f.maxVal=jStat.max(h);f.minVal=jStat.min(h);return f};this.yuliaExpressionRescaling=function(g,e){console.log("yuliaExpressionRescaling",
g,e);var d=this.getEvent(g).data.selectIds(e),a=this.getEventIdsByType();if(!utils.hasOwnProperty(a,"expression data"))return console.log("no expression"),null;for(var a=a["expression data"],f={},h={meanVals:f},n=[],m=0;m<a.length;m++){var q=a[m];f[q]=this.getEvent(q).data.getStats(d).mean;for(var p=this.getEvent(q).data.getData(),r=0;r<p.length;r++){var w=p[r];utils.hasOwnProperty(w,"val_orig")&&(w.val=w.val_orig);var y=w.val;w.val_orig=y;utils.isNumerical(y)&&(w.val=y-f[q],n.push(w.val))}}h.maxVal=
jStat.max(n);h.minVal=jStat.min(n);return h};this.eventwiseMedianRescaling=function(){console.log("eventwiseMedianRescaling");var g=this.getEventIdsByType();if(!utils.hasOwnProperty(g,"expression data"))return console.log("no expression"),null;for(var g=g["expression data"],e={},d={stats:e},a=[],f=0;f<g.length;f++){var h=g[f],n=this.getEvent(h).data.getStats();e[h]={};e[h]=n;for(var n=this.getEvent(h).data.getData(),m=0;m<n.length;m++){var q=n[m];utils.hasOwnProperty(q,"val_orig")&&(q.val=q.val_orig);
var p=q.val;q.val_orig=p;utils.isNumerical(p)&&(q.val=p-e[h].median,a.push(q.val))}}d.maxVal=jStat.max(a);d.minVal=jStat.min(a);return d};this.samplewiseMedianRescaling=function(){console.log("samplewiseMedianRescaling");var g=this.getEventIdsByType();if(!utils.hasOwnProperty(g,"expression data"))return console.log("no expression"),null;for(var g=g["expression data"],e={},d={stats:e},a=[],f=this.getAllSampleIds(),h=0;h<f.length;h++){var n=f[h];e[n]={};for(var m=this.getEventData([n]),q=[],p=0;p<g.length;p++){var r=
g[p];if(utils.hasOwnProperty(m,r)){if(r=m[r][0],r.id===n){utils.hasOwnProperty(r,"val_orig")&&(r.val=r.val_orig);var w=r.val;r.val_orig=w;utils.isNumerical(w)&&q.push(w)}}else console.log(r+" was not found for "+n)}q=jStat.median(q);e[n]["samplewise median"]=q;if(isNaN(q))console.log("sample median for "+n+" is NaN.");else for(p=0;p<g.length;p++)r=g[p],utils.hasOwnProperty(m,r)?(r=m[r][0],r.id===n&&(utils.hasOwnProperty(r,"val_orig")&&(r.val=r.val_orig),w=r.val,r.val_orig=w,utils.isNumerical(w)&&
(r.val=w-e[n]["samplewise median"],a.push(w)))):console.log(r+" was not found for "+n)}d.maxVal=jStat.max(a);d.minVal=jStat.min(a);return d};this.bivariateNormalization=function(){};this.fillInMissingSamples=function(g){for(var e=this.getAllSampleIds(),d=this.getEventIdsByType(),a=0;a<utils.getKeys(d).length;a++)for(var f=utils.getKeys(d)[a],h=0;h<d[f].length;h++){var n=d[f][h],m=this.getEvent(n).data.getAllSampleIds();if(0!=e.length-m.length){for(var m=utils.keepReplicates(e.concat(m),2,!0),q={},
p=0;p<m.length;p++)q[m[p]]=g;this.getEvent(n).data.setData(q)}}return this}};h.OD_event=function(g){this.metadata=new h.OD_eventMetadata(g);this.data=new h.OD_eventDataCollection};h.OD_eventMetadata=function(g){this.id=g.id;this.name=g.name;this.displayName=g.displayName;this.description=g.description;this.datatype=g.datatype;this.allowedValues=g.allowedValues;this.minAllowedVal=g.minAllowedVal;this.maxAllowedVal=g.maxAllowedVal;this.weightedGeneVector=[];this.setScoreRange=function(e,d){this.minAllowedVal=
e;this.maxAllowedVal=d};this.setWeightVector=function(e,d){this.weightedGeneVector=e;this.scoredDatatype=d;return this};this.sortSignatureVector=function(e){var d=this.weightedGeneVector.slice(0);d.sort(function(a,d){return utils.compareAsNumeric(a.weight,d.weight)});for(var a=[],f=0;f<d.length;f++)a.push(d[f].gene);e||a.reverse();return a}};h.OD_eventDataCollection=function(){function g(e,d){this.id=e;this.val=d}this.dataCollection=[];this.getValueCounts=function(e){var d={};e=this.getData(e);for(var a=
0;a<e.length;a++){var f=e[a].val;utils.hasOwnProperty(d,f)||(d[f]=0);d[f]+=1}return d};this.getValues=function(e){var d=this.getValueCounts(),d=utils.getKeys(d);null!=e&&1==e&&(d=utils.eliminateDuplicates(d));return d};this.setData=function(e,d){for(var a in e){var f=e[a];"NaN"!=f&&"null"!=f&&""!=f&&"N/A"!=f&&(null!=d&&1==d&&(f=parseFloat(f)),this.dataCollection.push(new g(a,f)))}return this};this.getData=function(e){var d=this.getAllSampleIds(!0);null==e&&(e=utils.getKeys(d));for(var a=[],f=0;f<
e.length;f++){var h=e[f];h in d?a.push(this.dataCollection[d[h]]):a.push(new g(h,null))}return a};this.getAllSampleIds=function(e){for(var d={},a=0;a<this.dataCollection.length;a++)d[this.dataCollection[a].id]=a;return e?d:utils.getKeys(d)};this.getNullSamples=function(e){var d=[];e=this.getData(e);for(var a=0;a<e.length;a++){var f=e[a];null==f.val&&d.push(f.id)}return d};this.sortSamples=function(e,d){var a=this.getData(e),f=compareSamplesAsStrings;d=null==d?"categoric":d.toLowerCase();"numeric"==
d||"expression"==d?f=compareSamplesAsNumeric:"date"==d&&(f=compareSamplesAsDate);a.sort(f);for(var f=[],g=0;g<a.length;g++)f.push(a[g].id);return f};this.selectIds=function(e,d){for(var a=[],f=null==d?this.getData():this.getData(d),g=0;g<f.length;g++){var h=f[g];h.val==e&&a.push(h.id)}return a};this.getStats=function(e,d){"undefined"===typeof d&&(d=3);var a={min:0,max:0,mean:0,median:0,sd:0,meddev:0,meandev:0},f=this.getAllSampleIds(!0);null==e&&(e=utils.getKeys(f));for(var g=[],h=0;h<e.length;h++){var m=
e[h];if(m in f){var m=this.dataCollection[f[m]],q=null,q=utils.hasOwnProperty(m,"val_orig")?m.val_orig:m.val;utils.isNumerical(q)&&g.push(q)}}a.mean=jStat.mean(g).toPrecision(d);a.sd=jStat.stdev(g).toPrecision(d);a.median=jStat.median(g).toPrecision(d);a.meddev=jStat.meddev(g).toPrecision(d);a.meandev=jStat.meandev(g).toPrecision(d);a.min=jStat.min(g).toPrecision(d);a.max=jStat.max(g).toPrecision(d);return a}};h.sortingSteps=function(g){this.steps=[];null!=g&&(this.steps=g);this.getSteps=function(){return this.steps};
this.getIndex=function(e){for(var d=0;d<this.steps.length;d++)if(this.steps[d].name==e)return d;return-1};this.addStep=function(e,d){var a=this.getIndex(e);0<=a?(a=this.steps.splice(a,1)[0],d||(a.reverse=!a.reverse),this.steps.push(a)):this.steps.push({name:e,reverse:!1})};this.removeStep=function(e){e=this.getIndex(e);0<=e&&this.steps.splice(e,1)};this.clearSteps=function(){this.steps.splice(0,this.steps.length)}};h.sampleSelectionCriteria=function(){this.criteria=[];this.getCriteria=function(){return this.criteria};
this.addCriteria=function(g,e){var d={eventId:g,value:e},a;for(a in this.criteria)if(JSON.stringify(this.criteria[a])==JSON.stringify(d))return;this.criteria.push(d)};this.removeCriteria=function(g,e){for(var d=0;d<this.criteria.length;d++)if(this.criteria[d].eventId==g&&this.criteria[d].value==e){this.criteria.splice(d,1);break}};this.clearCriteria=function(){this.criteria.splice(0,this.criteria.length)}}})(eventData);var medbookDataLoader=medbookDataLoader||{};
(function(h){h.transposeClinicalData=function(g,e){for(var d={},a=0;a<g.length;a++){var f=g[a],h=f[e],n;for(n in f)n in d||(d[n]={}),d[n][h]=f[n]}return d};h.getClinicalData=function(g,e){for(var d=utils.getResponse(g).split("\n"),a=[],f=[],l=[],n=0;n<d.length;n++){var m=d[n];utils.beginsWith(m,"#")?f.push(m):utils.beginsWith(m,"STRING")?l=m.split("\t"):a.push(m)}d=d3.tsv.parse(a.join("\n"));a=this.transposeClinicalData(d,"SAMPLE_ID");delete a.SAMPLE_ID;f=utils.getKeys(a);for(n=0;n<f.length;n++){var m=
f[n],q=a[m],p=l[n+1],r="categoric";"number"==p.toLowerCase()?r="numeric":"date"==p.toLowerCase()&&(r="date");h.loadEventBySampleData(e,m,"","clinical data",r,q)}return d};h.getMutationData=function(g,e){for(var d=utils.getResponse(g),a=d3.tsv.parse(d),d={},f=0;f<a.length;f++){var h=a[f],n=h.Hugo_Symbol,h=h.Tumor_Sample_Barcode,h=h.replace(/_/g,"-"),h=h.replace(/[A-Z]$/,"");utils.hasOwnProperty(d,n)||(d[n]={},d[n].metadata={id:n+"_mut",name:null,displayName:null,description:null,datatype:"mutation data",
allowedValues:"categoric"},d[n].data={});d[n].data[h]=!0}a=utils.getKeys(d);for(f=0;f<a.length;f++)n=d[a[f]],e.addEvent(n.metadata,n.data);return d};h.getExpressionData=function(g,e){h.getGeneBySampleData(g,e,"_mRNA","expression data","numeric")};h.getViperData=function(g,e){h.getGeneBySampleData(g,e,"_viper","viper data","numeric")};h.getGeneBySampleData=function(g,e,d,a,f){g=utils.getResponse(g);g=d3.tsv.parse(g);for(var l in g){var n=g[l],m=n[""];delete n[""];h.loadEventBySampleData(e,m,d,a,f,
n)}};h.loadEventBySampleData=function(g,e,d,a,f,h){return g.addEvent({geneSuffix:d,id:e+d,name:a+" for "+e,displayName:e,description:null,datatype:a,allowedValues:f},h)};h.mongoClinicalData=function(g,e){for(var d=0;d<g.length;d++){var a=g[d],f=null;if(utils.hasOwnProperty(a,"sample"))f=a.sample;else if(hasOwnProperty(a,"Sample"))f=a.Sample;else if(hasOwnProperty(a,"Patient ID"))f=a["Patient ID"];else if(hasOwnProperty(a,"Patient ID "))f=a["Patient ID "];else{console.log("no sample ID found in clinical doc: "+
prettyJson(a));continue}f=f.trim();if("Patient ID"!==f&&"Patient ID "!==f)for(var l=utils.getKeys(a),n=0;n<l.length;n++){var m=l[n];if(!utils.isObjInArray(["_id","sample","Sample"],m)){var q=e.getEvent(m);null==q&&(q=h.loadEventBySampleData(e,m,"","clinical data","categoric",[]));var p={};p[f]=a[m];q.data.setData(p)}}}return q};h.mongoExpressionData=function(g,e){for(var d=0;d<g.length;d++){var a=g[d],f=null;if(utils.hasOwnProperty(a,"gene"))f=a.gene;else if(utils.hasOwnProperty(a,"id"))f=a.id;else{console.log("no gene identifier found in expression doc: "+
utils.prettyJson(a));continue}var f=f.trim(),l=f+"_mRNA";utils.getKeys(a);var n=a.samples,a={},m;for(m in n)a[m]=n[m].rsem_quan_log2;l=e.getEvent(l);null==l?h.loadEventBySampleData(e,f,"_mRNA","expression data","numeric",a):l.data.setData(a)}};h.mongoExpressionData_old=function(g,e){for(var d=0;d<g.length;d++){var a=g[d],f=null;if(utils.hasOwnProperty(a,"gene"))f=a.gene;else if(utils.hasOwnProperty(a,"id"))f=a.id;else{console.log("no gene identifier found in expression doc: "+utils.prettyJson(a));
continue}for(var f=f.trim(),l=f+"_mRNA",n=utils.getKeys(a),m=0;m<n.length;m++){var q=n[m];if(!utils.isObjInArray(["_id","gene","id"],q)){var p=e.getEvent(l);null==p&&(p=h.loadEventBySampleData(e,f,"_mRNA","expression data","numeric",[]));var r={};r[q]=parseFloat(a[q]);p.data.setData(r)}}}return p};h.getSignature=function(g,e){var d=utils.getResponse(g),d=d3.tsv.parse(d),a=g.split("/").pop(),f=e.getEvent(a);null==f&&(e.addEvent({id:a,name:null,displayName:null,description:null,datatype:"expression signature",
allowedValues:"numeric",weightedGeneVector:d},[]),f=e.getEvent(a));return f};h.loadSignatureObj=function(g,e){for(var d={},a=0;a<g.length;a++){var f=g[a],l=f.id,n=f.name,f=f.val;utils.hasOwnProperty(d,n)||(d[n]={});d[n][l]=f}l=utils.getKeys(d);for(a=0;a<l.length;a++){var n=l[a],f=d[n],m=e.getEvent(n);null==m&&(m=h.loadEventBySampleData(e,n,"","expression signature","numeric",{}),m.metadata.setWeightVector([],"expression data"));m.data.setData(f)}};h.loadSignatureWeightsObj=function(g,e){for(var d=
g.name+"_v"+g.version,a=e.getEvent(d),f=[],l=g.signature,n=utils.getKeys(l),m=0;m<n.length;m++){var q=n[m];f.push({gene:q,weight:l[q].weight})}null==a&&(a=h.loadEventBySampleData(e,d,"","expression signature","numeric",[]));a.metadata.setWeightVector(f,"expression data");return a};h.loadBmegSignatureWeightsAsSamples=function(g,e){var d=utils.getKeys(g.query.weights),a=g.features,f=[],l=[],n;for(n in a)f.push({gene:n,weight:a[n]}),l.push(n);var l=utils.eliminateDuplicates(l),m=g.signatures,a={},q=
{},p;for(p in m){n=m[p];q[p]=n.score;var r=n.weights;n=d.slice(0);n=n.concat(utils.getKeys(r));n=utils.eliminateDuplicates(n);for(var w=0,y=n.length;w<y;w++){var x=n[w];if(utils.isObjInArray(d,x)||utils.isObjInArray(l,x)){var z=r[x];"undefined"!==typeof z&&(utils.hasOwnProperty(a,x)||(a[x]={}),a[x][p]=z)}}}console.log("num genes:"+utils.getKeys(a).length);h.loadEventBySampleData(e,"query_score","","signature query score","numeric",q).metadata.setWeightVector(f,"signature weight");n=utils.getKeys(a);
for(d=0;d<n.length;d++)x=n[d],f=x+"_weight",l=e.getEvent(f),null==l?(l=h.loadEventBySampleData(e,x,"_weight","signature weight","numeric",a[x]),l.metadata.setScoreRange(-1,1)):console.log("loadBmegSignatureWeightsAsSamples:","existing event for: "+f)};h.loadPivotScores=function(g,e){e.setPivotScores(g)}})(medbookDataLoader);u=utils;buildObservationDeck=function(h,g){g=getConfiguration(g);g.containerDivId=h.id;drawMatrix(h,g);setupContextMenus(g);return g};
getConfiguration=function(h){var g=utils.getCookie("od_config"),g=utils.parseJson(g)||{};h.querySettings=g;g=null;"pivot_event"in h&&null!=h.pivot_event&&(h.querySettings.pivot_event=h.pivot_event);"eventAlbum"in h?g=h.eventAlbum:(g=new eventData.OD_eventAlbum,h.eventAlbum=g);var e=medbookDataLoader;if("dataUrl"in h){var d=h.dataUrl;"clinicalUrl"in d&&e.getClinicalData(d.clinicalUrl,g);"expressionUrl"in d&&e.getExpressionData(d.expressionUrl,g);"mutationUrl"in d&&e.getMutationData(d.mutationUrl,g)}"mongoData"in
h&&(d=h.mongoData,"clinical"in d&&e.mongoClinicalData(d.clinical,g),"expression"in d&&e.mongoExpressionData(d.expression,g));delete h.mongoData;if("signature"in h&&(d=h.signature,"expression"in d)){var a=d.expression;if("file"in a)for(var f=a.file,d=0;d<f.length;d++){var l=f[d];console.log(l);e.getSignature(l,g)}if("object"in a)for(a=a.object,d=0;d<a.length;d++)f=a[d],e.loadSignatureObj(f,g)}delete h.signature;if("signature_index"in h&&(d=h.signature_index,"expression"in d&&(d=d.expression,"object"in
d)))for(a=d.object,d=0;d<a.length;d++)f=a[d],e.loadSignatureWeightsObj(f,g);delete h.signature_index;"bmegSigServiceData"in h&&(console.log("bmegSigServiceData in config"),e.loadBmegSignatureWeightsAsSamples(h.bmegSigServiceData,g));delete h.bmegSigServiceData;"displayedSamples"in h||(h.displayedSamples=[]);var g=h.eventAlbum.getEventIdsByType(),n;for(n in g);if("deleteEvents"in h)for(n=h.deleteEvents,d=0;d<n.length;d++)h.eventAlbum.deleteEvent(n[d]);return h};
getCookieEvents=function(){var h=[],g=utils.parseJson(utils.getCookie("od_config"));if("undefined"===typeof g||null==g||0==utils.getKeys(g).length)return[];utils.hasOwnProperty(g,"pivot_sort")&&h.push(g.pivot_sort.pivot_event);if(utils.hasOwnProperty(g,"colSort"))for(var e=g.colSort.steps,d=0;d<e.length;d++)h.push(e[d].name);utils.hasOwnProperty(g,"required events")&&(h=h.concat(g["required events"]));g=[];for(d=0;d<h.length;d++)e=h[d],utils.endsWith(e,"_mRNA")&&g.push(e.replace("_mRNA",""));return utils.eliminateDuplicates(g)};
getCookiePivot=function(){var h=null,g=utils.parseJson(utils.getCookie("od_config"));if("undefined"===typeof g||null==g||0==utils.getKeys(g).length)return h;utils.hasOwnProperty(g,"querySettings")&&(g=config.querySettings,utils.hasOwnProperty(g,"pivot_event")&&(h=g.pivot_event));return h};
setupContextMenus=function(h){for(var g=[".typeLabel",".colLabel",".rowLabel",".mrna_exp",".categoric"],e=0;e<g.length;e++)$.contextMenu("destroy",g[e]);setupTypeLabelContextMenu(h);setupColLabelContextMenu(h);setupRowLabelContextMenu(h);setupCategoricCellContextMenu(h);setupExpressionCellContextMenu(h)};
resetConfig=function(h){var g="dataUrl eventAlbum mongoData containerDivId signature rowTitleCallback columnTitleCallback".split(" ");utils.deleteCookie("od_config");for(var e=utils.getKeys(h),d=0;d<e.length;d++){var a=e[d];utils.isObjInArray(g,a)||delete h[a]}console.log("remaining config",h)};createResetContextMenuItem=function(h){return{name:"reset",icon:null,disabled:!1,callback:function(g,e){resetConfig(h);var d=document.getElementById(h.containerDivId);buildObservationDeck(d,h)}}};
setupColLabelContextMenu=function(h){var g=h.columnTitleCallback;$.contextMenu({selector:".colLabel",trigger:"left",build:function(e,d){var a=e[0].getAttribute("sample");return{items:{title:{name:a,icon:null,disabled:null==g,callback:function(d,e){null==g?console.log("default titleCallback for column",a):g(a,h)}},reset:createResetContextMenuItem(h)}}}})};
setupTypeLabelContextMenu=function(h){var g=h.datatypeTitleCallback;$.contextMenu({selector:".typeLabel",trigger:"left",callback:function(e,d){console.log("elem",this[0])},build:function(e,d){var a=e[0].getAttribute("datatype");return{items:{title:{name:function(){return a},icon:null,disabled:!1,callback:function(d,e){null==g?(console.log("datatype",a),console.log("default titleCallback for datatype",a)):g(eventId,h)}},sep1:"---------",pivot_sort_datatype:{name:function(){return"pivot sort "+a+" events"},
icon:null,disabled:function(a,d){return"pivot_event"in h.querySettings?!1:!0},callback:function(d,e){console.log("add "+a+" to list of pivot sort datatypes");var g=h.querySettings;console.log("pivotEventId",g.pivot_event.id);datatypes=[];"pivot_sort_list"in g&&(datatypes=g.pivot_sort_list);datatypes.push(a);g.pivot_sort_list=utils.eliminateDuplicates(datatypes);utils.setCookie("od_config",JSON.stringify(g));g=document.getElementById(h.containerDivId);buildObservationDeck(g,h)}},toggle_datatype_visibility:{name:function(){return"toggle visibility"},
icon:null,disabled:null,callback:function(d,e){"hiddenDatatypes"in h.querySettings||(h.querySettings.hiddenDatatypes=[]);var g=h.querySettings.hiddenDatatypes;utils.isObjInArray(g,a)?utils.removeA(g,a):g.push(a);utils.setCookie("od_config",JSON.stringify(h.querySettings));g=document.getElementById(h.containerDivId);buildObservationDeck(g,h)}},reset:createResetContextMenuItem(h)}}}})};
setupRowLabelContextMenu=function(h){var g=h.rowTitleCallback;$.contextMenu({selector:".rowLabel",trigger:"left",callback:function(e,d){console.log("elem",this[0])},build:function(e,d){var a=e[0].getAttribute("eventId"),f=h.eventAlbum.getEvent(a),l=f.metadata.datatype,n=f.metadata.weightedGeneVector.length;return{items:{title:{name:f.metadata.displayName,icon:null,disabled:function(){var a=!0;null!=g&&utils.isObjInArray(["expression data","clinical data"],l)&&(a=!1);return a},callback:function(d,
e){null==g?console.log("default titleCallback for row",a):g(a,h)}},sep1:"---------",set_pivot:{name:function(){return"set as pivot"},icon:null,disabled:function(a,d){return n?!1:!0},callback:function(d,e){var f={id:a,datatype:l};console.log("no Session object. Writing pivotSettings to querySettings.");var g=h.querySettings;g.pivot_event=f;utils.setCookie("od_config",JSON.stringify(g));f=document.getElementById(h.containerDivId);buildObservationDeck(f,h)}},sort_fold:{name:"sort...",items:{sort:{name:"samples by this event",
icon:null,disabled:!1,callback:function(d,e){var f=null,g=h.querySettings,f="colSort"in g?new eventData.sortingSteps(g.colSort.steps):new eventData.sortingSteps;f.addStep(a);g.colSort=f;utils.setCookie("od_config",JSON.stringify(g));f=document.getElementById(h.containerDivId);buildObservationDeck(f,h)}}}},hide_fold:{name:"hide...",items:{hide_null_samples:{name:"null samples in this row",icon:null,disabled:!1,callback:function(d,e){var f=h.querySettings;f["required events"]=[a];utils.setCookie("od_config",
JSON.stringify(f));f=document.getElementById(h.containerDivId);buildObservationDeck(f,h)}}}},sep1:"---------",reset:createResetContextMenuItem(h)}}}})};
setupExpressionCellContextMenu=function(h){$.contextMenu({selector:".mrna_exp",trigger:"left",callback:function(g,e){},build:function(g,e){var d=g[0],a=d.getAttribute("eventId"),d=d.getAttribute("sampleId");return{items:{title:{name:a+" for "+d,icon:null,disabled:!0},sep1:"---------",rescaling_fold:{name:"normalize coloring...",items:{"samplewise median rescaling":{name:"over each column",icon:null,disabled:!1,callback:function(a,d){var e=h.querySettings;e["expression rescaling"]={method:"samplewiseMedianRescaling"};
utils.setCookie("od_config",JSON.stringify(e));e=document.getElementById(h.containerDivId);buildObservationDeck(e,h)}},"eventwise median rescaling":{name:"over each row",icon:null,disabled:!1,callback:function(a,d){var e=h.querySettings;e["expression rescaling"]={method:"eventwiseMedianRescaling"};utils.setCookie("od_config",JSON.stringify(e));e=document.getElementById(h.containerDivId);buildObservationDeck(e,h)}}}},sep1:"---------",reset:createResetContextMenuItem(h)}}}})};
setupCategoricCellContextMenu=function(h){$.contextMenu({selector:".categoric",trigger:"left",callback:function(g,e){},build:function(g,e){var d=g[0],a=d.getAttribute("eventId"),d=d.getAttribute("sampleId");return{items:{title:{name:a+" for "+d,icon:null,disabled:!0},sep1:"---------","yulia expression rescaling":{name:"rescale mRNA values using this category",icon:null,disabled:!1,callback:function(a,d){var e=this[0],g=e.getAttribute("eventId");e.getAttribute("sampleId");e=e.getAttribute("val");console.log("key:",
a,"eventId:",g,"val:",e);console.log("href",window.location.href);console.log("host",window.location.host);console.log("pathname",window.location.pathname);console.log("search",window.location.search);var q=h.querySettings;q["expression rescaling"]={method:"yulia_rescaling",eventId:g,val:e};utils.setCookie("od_config",JSON.stringify(q));g=document.getElementById(h.containerDivId);buildObservationDeck(g,h)}},sep1:"---------",reset:createResetContextMenuItem(h)}}}})};
drawMatrix=function(h,g){var e=utils.removeChildElems(h),d=g.eventAlbum;d.fillInMissingSamples(null);var a=d.getEventIdsByType(),f=d3.scale.category10(),l=[],n;for(n in a)f(n),l=l.concat(a[n]);var m=g.querySettings,q=null;if(utils.hasOwnProperty(a,"expression data")&&utils.hasOwnProperty(m,"expression rescaling")){var p=m["expression rescaling"];"yulia_rescaling"===p.method?q=d.yuliaExpressionRescaling(p.eventId,p.val):"eventwiseMedianRescaling"===p.method?q=d.eventwiseMedianRescaling():"zScoreExpressionRescaling"===
p.method?q=d.zScoreExpressionRescaling():"samplewiseMedianRescaling"===p.method&&(q=d.samplewiseMedianRescaling())}else utils.hasOwnProperty(a,"expression data")?q=d.eventwiseMedianRescaling():console.log("no expression data rescaling");var r=utils.centeredRgbaColorMapper(!1);null!=q&&(r=utils.centeredRgbaColorMapper(!1,0,q.minVal,q.maxVal));for(var w={},p=0;p<l.length;p++){var y=l[p],x=d.getEvent(y).metadata.allowedValues;if("categoric"==x)w[y]=d3.scale.category10();else if("numeric"==x){var z=d.getEvent(y),
x=z.metadata.minAllowedVal,z=z.metadata.maxAllowedVal;if("undefined"!=typeof x&&"undefined"!=typeof z)w[y]=utils.centeredRgbaColorMapper(!1,0,x,z);else{for(var z=d.getEvent(y).data.getValues(),x=[],F=0;F<z.length;F++){var M=z[F];utils.isNumerical(M)&&x.push(M)}z=Math.min.apply(null,x);x=Math.max.apply(null,x);w[y]=utils.centeredRgbaColorMapper(!1,0,z,x)}}else w[y]="expression"==x?r:d3.scale.category10()}y=l=null;if("colSort"in m)for(y=new eventData.sortingSteps(m.colSort.steps),p=y.getSteps().length-
1;0<=p;p--)r=y.steps[p],r=r.name,d.getEvent(r)||(console.log(r,"not found, skip sorting by that event"),y.removeStep(r));utils.hasOwnProperty(m,"pivot_sort")&&(r=m.pivot_sort,r=r.pivot_event,null==y&&(y=new eventData.sortingSteps),d.getEvent(r)&&y.addStep(r,!0));l=d.multisortSamples(y);r=[];if("required events"in m){x=m["required events"][0];console.log("requiredEventId",x);try{var H=d.getEvent(x).data.getNullSamples(),r=r.concat(H)}catch(A){console.log("ERROR while getting samples to hide in eventID:",
x,"error.message ->",A.message)}finally{console.log("samplesToHide",r)}}r=utils.eliminateDuplicates(r);H=[];for(x=0;x<l.length;x++)z=l[x],utils.isObjInArray(g.displayedSamples,z)?H.push(z):utils.isObjInArray(r,z)||0==g.displayedSamples.length&&H.push(z);var l=H,R={};for(p in l)r=l[p],R[r]=p;H=null;if("rowSort"in m)for(H=new eventData.sortingSteps(m.rowSort.steps),p=H.getSteps().length-1;0<=p;p--)r=H.steps[p],r=r.name,d.getEvent(r)||(console.log(r,"not found, skip sorting by that event"),H.removeStep(r));
H=d.multisortEvents(H,y);if(utils.hasOwnProperty(m,"pivot_sort_list")){console.log("querySettings has a pivot_sort_list of datatypes",m.pivot_sort_list);p=[];y=m.pivot_event.id;r=d.getEvent(y);d.setPivotScores(y,r.metadata.weightedGeneVector);y=d.getGroupedPivotSorts();for(n in y)p=p.concat(y[n]);H=p.concat(H);H=utils.eliminateDuplicates(H)}n=null;if(utils.hasOwnProperty(m,"pivot_sort")){r=m.pivot_sort;r=r.pivot_event;n=d.pivotSort(r);"undefined"===typeof q&&(q={stats:{}});r=[];for(p=0;p<n.length;p++)y=
n[p].event,x=n[p].score,r.push(y),q.stats[y]={pivotScore:x};H=r.concat(H);H=utils.eliminateDuplicates(H)}y=m.hiddenDatatypes||[];r=[];for(p=0;p<H.length;p++)x=H[p],n=d.getEvent(x).metadata.datatype,utils.isObjInArray(y,n)||r.push(x);var H=r,Na=null;null!=m.pivot_event&&(Na=m.pivot_event.id,console.log("moving pivot event to top:",Na),H.unshift(Na),H=utils.eliminateDuplicates(H));var Wa={};for(p in H)r=H[p],Wa[r]=p;var m=utils.lengthOfLongestString(l),p=utils.lengthOfLongestString(H),ea={top:3<m?9*
m:30,right:0,bottom:0,left:1<p?8*p:15},m=document.documentElement.clientWidth,W=Math.floor((m-ea.left-ea.right)/(l.length>H.length?l.length:H.length)),W=9<W?W:9;console.log("gridSize",W);console.log("margin",ea);p=ea.top+ea.bottom+W*H.length;e=d3.select(e).append("svg").attr({width:m,height:p,viewBox:"0 0 "+m+" "+p,perserveAspectRatio:"xMinYMin meet"}).append("g").attr({transform:"translate("+ea.left+","+ea.top+")"});utils.createSvgRectElement(0,0,0,0,m,p,{fill:"white","class":"primer"});e.append("rect").attr({x:0,
y:0,rx:0,ry:0,width:W*l.length,height:W*H.length,fill:"white","class":"primer"});e.selectAll(".typeLabel").data(function(){return utils.getKeys(a)}).enter().append("text").text(function(a){return a.toUpperCase()}).attr({x:function(d,e){var f=0,g;for(g in a)if(g===d)break;else f+=a[g].length;g=utils.getKeys(a);e>=g.length-1&&(f+=a[d].length);f=f*W*-1;e>=g.length-1&&(f+=6.6*d.length);return f},y:function(a,d){return-1*(ea.left-(0==d%2?15:25))},transform:"rotate(-90)","class":function(a,d){return"typeLabel mono axis unselectable"},
datatype:function(a,d){return a}}).style("text-anchor","end").style("fill",function(a){return f(a)});m=-6;p=W/1.5;e.selectAll(".rowLabel").data(H).enter().append("text").text(function(a){return d.getEvent(a).metadata.displayName}).attr({x:0,y:function(a,d){return d*W},transform:"translate("+m+", "+p+")","class":function(a,d){var e="rowLabel mono axis unselectable";a===Na&&(e+=" pivotEvent");return e},eventId:function(a,d){return a},datatype:function(a,e){return d.getEvent(a).metadata.datatype}}).style("text-anchor",
"end").style("fill",function(a){a=d.getEvent(a).metadata.datatype;return f(a)}).append("title").text(function(a){var e=d.getEvent(a),f="event: "+a+"\ndatatype: "+e.metadata.datatype;"numeric"===e.metadata.allowedValues&&null!=q&&utils.hasOwnProperty(q,"stats")&&"undefined"!==typeof q.stats[a]&&(f=f+"\nraw data stats: "+utils.prettyJson(q.stats[a]));return f});m=Math.floor(W/5);p=-1*Math.floor(W/3);e.selectAll(".colLabel").data(l).enter().append("text").text(function(a){return a}).attr({y:function(a,
d){return(d+1)*W},x:0,transform:"rotate(-90) translate("+m+", "+p+")","class":function(a,d){return"colLabel mono axis unselectable"},sample:function(a,d){return a}}).style("text-anchor","start").append("title").text(function(a){return"sample: "+a});m=d.getAllDataAsList();n=[];for(p=0;p<m.length;p++)l=m[p],y=l.eventId,utils.isObjInArray(H,y)&&n.push(l);e.selectAll(".cell").data(n).enter().append(function(a){var e=document.createElementNS(utils.svgNamespaceUri,"g");e.setAttributeNS(null,"class","cell");
if(!utils.hasOwnProperty(R,a.id))return e;var f=R[a.id]*W,g=Wa[a.eventId]*W,h=4,l=4,m=W,n=W,p={"class":"bordered"},q=a.eventId;if(null==q||null==a.val)p.fill="lightgrey",e.appendChild(utils.createSvgRectElement(f,g,h,l,m,n,p));if(null==q||null==a.val)return e;p=a.val;f=R[a.id]*W;g=Wa[a.eventId]*W;l=h=4;n=m=W;p={stroke:"#E6E6E6","stroke-width":"2px",fill:(0,w[a.eventId])(p)};"categoric"===d.getEvent(a.eventId).metadata.allowedValues?(p["class"]="categoric",p.eventId=a.eventId,p.sampleId=a.id,p.val=
a.val):"expression data"===d.getEvent(a.eventId).metadata.datatype&&(p["class"]="mrna_exp",p.eventId=a.eventId,p.sampleId=a.id,p.val=a.val);e.appendChild(utils.createSvgRectElement(f,g,h,l,m,n,p));return e}).append("title").text(function(a){return"event: "+a.eventId+"\nsample: "+a.id+"\nvalue: "+a.val});return g};
