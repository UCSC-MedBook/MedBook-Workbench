(function(h,f){function e(a){a=a.split(/\s+/);for(var d=[],g=0,e;e=a[g];g++)e=e[0].toUpperCase(),d.push(e);return d}function d(a){return a.id&&h('label[for="'+a.id+'"]').val()||a.name}function a(g,e,l){l||(l=0);e.each(function(){var e=h(this),m=this,n=this.nodeName.toLowerCase(),p,q;"label"==n&&e.find("input, textarea, select").length&&(p=e.text(),e=e.children().first(),m=e.get(0),n=m.nodeName.toLowerCase());switch(n){case "menu":q={name:e.attr("label"),items:{}};l=a(q.items,e.children(),l);break;
case "a":case "button":q={name:e.text(),disabled:!!e.attr("disabled"),callback:function(){return function(){e.click()}}()};break;case "menuitem":case "command":switch(e.attr("type")){case f:case "command":case "menuitem":q={name:e.attr("label"),disabled:!!e.attr("disabled"),callback:function(){return function(){e.click()}}()};break;case "checkbox":q={type:"checkbox",disabled:!!e.attr("disabled"),name:e.attr("label"),selected:!!e.attr("checked")};break;case "radio":q={type:"radio",disabled:!!e.attr("disabled"),
name:e.attr("label"),radio:e.attr("radiogroup"),value:e.attr("id"),selected:!!e.attr("checked")};break;default:q=f}break;case "hr":q="-------";break;case "input":switch(e.attr("type")){case "text":q={type:"text",name:p||d(m),disabled:!!e.attr("disabled"),value:e.val()};break;case "checkbox":q={type:"checkbox",name:p||d(m),disabled:!!e.attr("disabled"),selected:!!e.attr("checked")};break;case "radio":q={type:"radio",name:p||d(m),disabled:!!e.attr("disabled"),radio:!!e.attr("name"),value:e.val(),selected:!!e.attr("checked")};
break;default:q=f}break;case "select":q={type:"select",name:p||d(m),disabled:!!e.attr("disabled"),selected:e.val(),options:{}};e.children().each(function(){q.options[this.value]=h(this).text()});break;case "textarea":q={type:"textarea",name:p||d(m),disabled:!!e.attr("disabled"),value:e.val()};break;case "label":break;default:q={type:"html",html:e.clone(!0)}}q&&(l++,g["key"+l]=q)});return l}h.support.htmlMenuitem="HTMLMenuItemElement"in window;h.support.htmlCommand="HTMLCommandElement"in window;h.support.eventSelectstart=
"onselectstart"in document.documentElement;if(!h.ui||!h.ui.widget){var g=h.cleanData;h.cleanData=function(a){for(var d=0,e;null!=(e=a[d]);d++)try{h(e).triggerHandler("remove")}catch(f){}g(a)}}var l=null,m=!1,n=h(window),p=0,r={},q={},w={},x={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,determinePosition:function(a){if(h.ui&&h.ui.position)a.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");
else{var d=this.offset();d.top+=this.outerHeight();d.left+=this.outerWidth()/2-a.outerWidth()/2;a.css(d)}},position:function(a,d,e){if(d||e){d="maintain"===d&&"maintain"===e?a.$menu.position():{top:e,left:d};e=n.scrollTop()+n.height();var g=n.scrollLeft()+n.width(),f=a.$menu.height(),h=a.$menu.width();d.top+f>e&&(d.top-=f);d.left+h>g&&(d.left-=h);a.$menu.css(d)}else a.determinePosition.call(this,a.$menu)},positionSubmenu:function(a){if(h.ui&&h.ui.position)a.css("display","block").position({my:"left top",
at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var d={top:0,left:this.outerWidth()};a.css(d)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:h.noop,hide:h.noop},callback:null,items:{}},z=null,B=null,A=null,L,ba=function(a){for(var d=0;d=Math.max(d,parseInt(a.css("z-index"),10)||0),a=a.parent(),a&&a.length&&!(-1<"html body".indexOf(a.prop("nodeName").toLowerCase())););return d},E={abortevent:function(a){a.preventDefault();a.stopImmediatePropagation()},
contextmenu:function(a){var d=h(this);a.preventDefault();a.stopImmediatePropagation();if(!("right"!=a.data.trigger&&a.originalEvent||d.hasClass("context-menu-active")||d.hasClass("context-menu-disabled"))){l=d;if(a.data.build){var e=a.data.build(l,a);if(!1===e)return;a.data=h.extend(!0,{},x,a.data,e||{});if(!a.data.items||h.isEmptyObject(a.data.items))throw window.console&&(console.error||console.log)("No items specified to show in contextMenu"),Error("No Items specified");a.data.$trigger=l;N.create(a.data)}N.show.call(d,
a.data,a.pageX,a.pageY)}},click:function(a){a.preventDefault();a.stopImmediatePropagation();h(this).trigger(h.Event("contextmenu",{data:a.data,pageX:a.pageX,pageY:a.pageY}))},mousedown:function(a){var d=h(this);l&&l.length&&!l.is(d)&&l.data("contextMenu").$menu.trigger("contextmenu:hide");2==a.button&&(l=d.data("contextMenuActive",!0))},mouseup:function(a){var d=h(this);d.data("contextMenuActive")&&l&&l.length&&l.is(d)&&!d.hasClass("context-menu-disabled")&&(a.preventDefault(),a.stopImmediatePropagation(),
l=d,d.trigger(h.Event("contextmenu",{data:a.data,pageX:a.pageX,pageY:a.pageY})));d.removeData("contextMenuActive")},mouseenter:function(a){var d=h(this),e=h(a.relatedTarget),g=h(document);e.is(".context-menu-list")||e.closest(".context-menu-list").length||l&&l.length||(B=a.pageX,A=a.pageY,L=a.data,g.on("mousemove.contextMenuShow",E.mousemove),z=setTimeout(function(){z=null;g.off("mousemove.contextMenuShow");l=d;d.trigger(h.Event("contextmenu",{data:L,pageX:B,pageY:A}))},a.data.delay))},mousemove:function(a){B=
a.pageX;A=a.pageY},mouseleave:function(a){a=h(a.relatedTarget);if(!a.is(".context-menu-list")&&!a.closest(".context-menu-list").length){try{clearTimeout(z)}catch(d){}z=null}},layerClick:function(a){var d=h(this).data("contextMenuRoot"),e=a.button,g=a.pageX,f=a.pageY,l,m;a.preventDefault();a.stopImmediatePropagation();setTimeout(function(){var p,q="left"==d.trigger&&0===e||"right"==d.trigger&&2===e;document.elementFromPoint&&(d.$layer.hide(),l=document.elementFromPoint(g-n.scrollLeft(),f-n.scrollTop()),
d.$layer.show());if(d.reposition&&q)if(document.elementFromPoint){if(d.$trigger.is(l)||d.$trigger.has(l).length){d.position.call(d.$trigger,d,g,f);return}}else if(m=d.$trigger.offset(),p=h(window),m.top+=p.scrollTop(),m.top<=a.pageY&&(m.left+=p.scrollLeft(),m.left<=a.pageX&&(m.bottom=m.top+d.$trigger.outerHeight(),m.bottom>=a.pageY&&(m.right=m.left+d.$trigger.outerWidth(),m.right>=a.pageX)))){d.position.call(d.$trigger,d,g,f);return}if(l&&q)d.$trigger.one("contextmenu:hidden",function(){h(l).contextMenu({x:g,
y:f})});d.$menu.trigger("contextmenu:hide")},50)},keyStop:function(a,d){d.isInput||a.preventDefault();a.stopPropagation()},key:function(a){var d=l.data("contextMenu")||{};switch(a.keyCode){case 9:case 38:if(E.keyStop(a,d),d.isInput){if(9==a.keyCode&&a.shiftKey){a.preventDefault();d.$selected&&d.$selected.find("input, textarea, select").blur();d.$menu.trigger("prevcommand");return}if(38==a.keyCode&&"checkbox"==d.$selected.find("input, textarea, select").prop("type")){a.preventDefault();return}}else if(9!=
a.keyCode||a.shiftKey){d.$menu.trigger("prevcommand");return}case 40:E.keyStop(a,d);if(d.isInput){if(9==a.keyCode){a.preventDefault();d.$selected&&d.$selected.find("input, textarea, select").blur();d.$menu.trigger("nextcommand");return}if(40==a.keyCode&&"checkbox"==d.$selected.find("input, textarea, select").prop("type")){a.preventDefault();return}}else{d.$menu.trigger("nextcommand");return}break;case 37:E.keyStop(a,d);if(d.isInput||!d.$selected||!d.$selected.length)break;if(!d.$selected.parent().hasClass("context-menu-root")){a=
d.$selected.parent().parent();d.$selected.trigger("contextmenu:blur");d.$selected=a;return}break;case 39:E.keyStop(a,d);if(d.isInput||!d.$selected||!d.$selected.length)break;var e=d.$selected.data("contextMenu")||{};if(e.$menu&&d.$selected.hasClass("context-menu-submenu")){d.$selected=null;e.$selected=null;e.$menu.trigger("nextcommand");return}break;case 35:case 36:d.$selected&&d.$selected.find("input, textarea, select").length||((d.$selected&&d.$selected.parent()||d.$menu).children(":not(.disabled, .not-selectable)")[36==
a.keyCode?"first":"last"]().trigger("contextmenu:focus"),a.preventDefault());return;case 13:E.keyStop(a,d);if(d.isInput){if(d.$selected&&!d.$selected.is("textarea, select")){a.preventDefault();return}break}d.$selected&&d.$selected.trigger("mouseup");return;case 32:case 33:case 34:E.keyStop(a,d);return;case 27:E.keyStop(a,d);d.$menu.trigger("contextmenu:hide");return;default:if(e=String.fromCharCode(a.keyCode).toUpperCase(),d.accesskeys[e]){d.accesskeys[e].$node.trigger(d.accesskeys[e].$menu?"contextmenu:focus":
"mouseup");return}}a.stopPropagation();d.$selected&&d.$selected.trigger(a)},prevItem:function(a){a.stopPropagation();var d=h(this).data("contextMenu")||{};if(d.$selected){var e=d.$selected,d=d.$selected.parent().data("contextMenu")||{};d.$selected=e}for(var e=d.$menu.children(),g=d.$selected&&d.$selected.prev().length?d.$selected.prev():e.last(),f=g;g.hasClass("disabled")||g.hasClass("not-selectable");)if(g=g.prev().length?g.prev():e.last(),g.is(f))return;d.$selected&&E.itemMouseleave.call(d.$selected.get(0),
a);E.itemMouseenter.call(g.get(0),a);a=g.find("input, textarea, select");a.length&&a.focus()},nextItem:function(a){a.stopPropagation();var d=h(this).data("contextMenu")||{};if(d.$selected){var e=d.$selected,d=d.$selected.parent().data("contextMenu")||{};d.$selected=e}for(var e=d.$menu.children(),g=d.$selected&&d.$selected.next().length?d.$selected.next():e.first(),f=g;g.hasClass("disabled")||g.hasClass("not-selectable");)if(g=g.next().length?g.next():e.first(),g.is(f))return;d.$selected&&E.itemMouseleave.call(d.$selected.get(0),
a);E.itemMouseenter.call(g.get(0),a);a=g.find("input, textarea, select");a.length&&a.focus()},focusInput:function(a){a=h(this).closest(".context-menu-item");var d=a.data(),e=d.contextMenu,d=d.contextMenuRoot;d.$selected=e.$selected=a;d.isInput=e.isInput=!0},blurInput:function(a){a=h(this).closest(".context-menu-item").data();a.contextMenuRoot.isInput=a.contextMenu.isInput=!1},menuMouseenter:function(a){h(this).data().contextMenuRoot.hovering=!0},menuMouseleave:function(a){var d=h(this).data().contextMenuRoot;
d.$layer&&d.$layer.is(a.relatedTarget)&&(d.hovering=!1)},itemMouseenter:function(a){var d=h(this),e=d.data(),g=e.contextMenu,e=e.contextMenuRoot;e.hovering=!0;a&&e.$layer&&e.$layer.is(a.relatedTarget)&&(a.preventDefault(),a.stopImmediatePropagation());(g.$menu?g:e).$menu.children(".hover").trigger("contextmenu:blur");d.hasClass("disabled")||d.hasClass("not-selectable")?g.$selected=null:d.trigger("contextmenu:focus")},itemMouseleave:function(a){var d=h(this),e=d.data(),g=e.contextMenu,e=e.contextMenuRoot;
e!==g&&e.$layer&&e.$layer.is(a.relatedTarget)?(e.$selected&&e.$selected.trigger("contextmenu:blur"),a.preventDefault(),a.stopImmediatePropagation(),e.$selected=g.$selected=g.$node):d.trigger("contextmenu:blur")},itemClick:function(a){var d=h(this),e=d.data(),g=e.contextMenuRoot,f=e.contextMenuKey;if(e.contextMenu.items[f]&&!d.is(".disabled, .context-menu-submenu, .context-menu-separator, .not-selectable")){a.preventDefault();a.stopImmediatePropagation();if(h.isFunction(g.callbacks[f])&&Object.prototype.hasOwnProperty.call(g.callbacks,
f))a=g.callbacks[f];else if(h.isFunction(g.callback))a=g.callback;else return;!1!==a.call(g.$trigger,f,g)?g.$menu.trigger("contextmenu:hide"):g.$menu.parent().length&&N.update.call(g.$trigger,g)}},inputClick:function(a){a.stopImmediatePropagation()},hideMenu:function(a,d){var e=h(this).data("contextMenuRoot");N.hide.call(e.$trigger,e,d&&d.force)},focusItem:function(a){a.stopPropagation();a=h(this);var d=a.data(),e=d.contextMenu,d=d.contextMenuRoot;a.addClass("hover").siblings(".hover").trigger("contextmenu:blur");
e.$selected=d.$selected=a;e.$node&&d.positionSubmenu.call(e.$node,e.$menu)},blurItem:function(a){a.stopPropagation();a=h(this);var d=a.data().contextMenu;a.removeClass("hover");d.$selected=null}},N={show:function(a,d,e){var g=h(this),f={};h("#context-menu-layer").trigger("mousedown");a.$trigger=g;if(!1===a.events.show.call(g,a))l=null;else if(N.update.call(g,a),a.position.call(g,a,d,e),a.zIndex&&(f.zIndex=ba(g)+a.zIndex),N.layer.call(a.$menu,a,f.zIndex),a.$menu.find("ul").css("zIndex",f.zIndex+1),
a.$menu.css(f)[a.animation.show](a.animation.duration,function(){g.trigger("contextmenu:visible")}),g.data("contextMenu",a).addClass("context-menu-active"),h(document).off("keydown.contextMenu").on("keydown.contextMenu",E.key),a.autoHide)h(document).on("mousemove.contextMenuAutoHide",function(d){var e=g.offset();e.right=e.left+g.outerWidth();e.bottom=e.top+g.outerHeight();!a.$layer||a.hovering||d.pageX>=e.left&&d.pageX<=e.right&&d.pageY>=e.top&&d.pageY<=e.bottom||a.$menu.trigger("contextmenu:hide")})},
hide:function(a,d){var e=h(this);a||(a=e.data("contextMenu")||{});if(d||!a.events||!1!==a.events.hide.call(e,a)){e.removeData("contextMenu").removeClass("context-menu-active");if(a.$layer){setTimeout(function(a){return function(){a.remove()}}(a.$layer),10);try{delete a.$layer}catch(g){a.$layer=null}}l=null;a.$menu.find(".hover").trigger("contextmenu:blur");a.$selected=null;h(document).off(".contextMenuAutoHide").off("keydown.contextMenu");a.$menu&&a.$menu[a.animation.hide](a.animation.duration,function(){a.build&&
(a.$menu.remove(),h.each(a,function(d,e){switch(d){case "ns":case "selector":case "build":case "trigger":return!0;default:a[d]=f;try{delete a[d]}catch(g){}return!0}}));setTimeout(function(){e.trigger("contextmenu:hidden")},10)})}},create:function(a,d){d===f&&(d=a);a.$menu=h('<ul class="context-menu-list"></ul>').addClass(a.className||"").data({contextMenu:a,contextMenuRoot:d});h.each(["callbacks","commands","inputs"],function(e,g){a[g]={};d[g]||(d[g]={})});d.accesskeys||(d.accesskeys={});h.each(a.items,
function(g,f){var l=h('<li class="context-menu-item"></li>').addClass(f.className||""),m=null,n=null;l.on("click",h.noop);f.$node=l.data({contextMenu:a,contextMenuRoot:d,contextMenuKey:g});if(f.accesskey)for(var p=e(f.accesskey),q=0,r;r=p[q];q++)if(!d.accesskeys[r]){d.accesskeys[r]=f;f._name=f.name.replace(new RegExp("("+r+")","i"),'<span class="context-menu-accesskey">$1</span>');break}if("string"==typeof f)l.addClass("context-menu-separator not-selectable");else if(f.type&&w[f.type])w[f.type].call(l,
f,a,d),h.each([a,d],function(a,d){d.commands[g]=f;h.isFunction(f.callback)&&(d.callbacks[g]=f.callback)});else{"html"==f.type?l.addClass("context-menu-html not-selectable"):f.type?(m=h("<label></label>").appendTo(l),h("<span></span>").html(f._name||f.name).appendTo(m),l.addClass("context-menu-input"),a.hasTypes=!0,h.each([a,d],function(a,d){d.commands[g]=f;d.inputs[g]=f})):f.items&&(f.type="sub");switch(f.type){case "text":n=h('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+
g).val(f.value||"").appendTo(m);break;case "textarea":n=h('<textarea name=""></textarea>').attr("name","context-menu-input-"+g).val(f.value||"").appendTo(m);f.height&&n.height(f.height);break;case "checkbox":n=h('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+g).val(f.value||"").prop("checked",!!f.selected).prependTo(m);break;case "radio":n=h('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+f.radio).val(f.value||"").prop("checked",
!!f.selected).prependTo(m);break;case "select":n=h('<select name="">').attr("name","context-menu-input-"+g).appendTo(m);f.options&&(h.each(f.options,function(a,d){h("<option></option>").val(a).text(d).appendTo(n)}),n.val(f.selected));break;case "sub":h("<span></span>").html(f._name||f.name).appendTo(l);f.appendTo=f.$node;N.create(f,d);l.data("contextMenu",f).addClass("context-menu-submenu");f.callback=null;break;case "html":h(f.html).appendTo(l);break;default:h.each([a,d],function(a,d){d.commands[g]=
f;h.isFunction(f.callback)&&(d.callbacks[g]=f.callback)}),h("<span></span>").html(f._name||f.name||"").appendTo(l)}if(f.type&&"sub"!=f.type&&"html"!=f.type&&(n.on("focus",E.focusInput).on("blur",E.blurInput),f.events))n.on(f.events,a);f.icon&&l.addClass("icon icon-"+f.icon)}f.$input=n;f.$label=m;l.appendTo(a.$menu);if(!a.hasTypes&&h.support.eventSelectstart)l.on("selectstart.disableTextSelect",E.abortevent)});a.$node||a.$menu.css("display","none").addClass("context-menu-root");a.$menu.appendTo(a.appendTo||
document.body)},resize:function(a,d){a.css({position:"absolute",display:"block"});a.data("width",Math.ceil(a.width())+1);a.css({position:"static",minWidth:"0px",maxWidth:"100000px"});a.find("> li > ul").each(function(){N.resize(h(this),!0)});d||a.find("ul").andSelf().css({position:"",display:"",minWidth:"",maxWidth:""}).width(function(){return h(this).data("width")})},update:function(a,d){var e=this;d===f&&(d=a,N.resize(a.$menu));a.$menu.children().each(function(){var g=h(this),f=g.data("contextMenuKey"),
l=a.items[f],f=h.isFunction(l.disabled)&&l.disabled.call(e,f,d)||!0===l.disabled;g[f?"addClass":"removeClass"]("disabled");if(l.type)switch(g.find("input, select, textarea").prop("disabled",f),l.type){case "text":case "textarea":l.$input.val(l.value||"");break;case "checkbox":case "radio":l.$input.val(l.value||"").prop("checked",!!l.selected);break;case "select":l.$input.val(l.selected||"")}l.$menu&&N.update.call(e,l,d)})},layer:function(a,d){var e=a.$layer=h('<div id="context-menu-layer" style="position:fixed; z-index:'+
d+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"></div>').css({height:n.height(),width:n.width(),display:"block"}).data("contextMenuRoot",a).insertBefore(this).on("contextmenu",E.abortevent).on("mousedown",E.layerClick);h.support.fixedPosition||e.css({position:"absolute",height:h(document).height()});return e}};h.fn.contextMenu=function(a){a===f?this.first().trigger("contextmenu"):a.x&&a.y?this.first().trigger(h.Event("contextmenu",{pageX:a.x,pageY:a.y})):"hide"===
a?(a=this.data("contextMenu").$menu)&&a.trigger("contextmenu:hide"):"destroy"===a?h.contextMenu("destroy",{context:this}):h.isPlainObject(a)?(a.context=this,h.contextMenu("create",a)):a?this.removeClass("context-menu-disabled"):a||this.addClass("context-menu-disabled");return this};h.contextMenu=function(a,d){"string"!=typeof a&&(d=a,a="create");"string"==typeof d?d={selector:d}:d===f&&(d={});var e=h.extend(!0,{},x,d||{}),g=h(document),l=g,n=!1;e.context&&e.context.length?(l=h(e.context).first(),
e.context=l.get(0),n=e.context!==document):e.context=document;switch(a){case "create":if(!e.selector)throw Error("No selector specified");if(e.selector.match(/.context-menu-(list|item|input)($|\s)/))throw Error('Cannot bind to selector "'+e.selector+'" as it contains a reserved className');if(!e.build&&(!e.items||h.isEmptyObject(e.items)))throw Error("No Items specified");p++;e.ns=".contextMenu"+p;n||(r[e.selector]=e.ns);q[e.ns]=e;e.trigger||(e.trigger="right");m||(g.on({"contextmenu:hide.contextMenu":E.hideMenu,
"prevcommand.contextMenu":E.prevItem,"nextcommand.contextMenu":E.nextItem,"contextmenu.contextMenu":E.abortevent,"mouseenter.contextMenu":E.menuMouseenter,"mouseleave.contextMenu":E.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",E.inputClick).on({"mouseup.contextMenu":E.itemClick,"contextmenu:focus.contextMenu":E.focusItem,"contextmenu:blur.contextMenu":E.blurItem,"contextmenu.contextMenu":E.abortevent,"mouseenter.contextMenu":E.itemMouseenter,"mouseleave.contextMenu":E.itemMouseleave},
".context-menu-item"),m=!0);l.on("contextmenu"+e.ns,e.selector,e,E.contextmenu);if(n)l.on("remove"+e.ns,function(){h(this).contextMenu("destroy")});switch(e.trigger){case "hover":l.on("mouseenter"+e.ns,e.selector,e,E.mouseenter).on("mouseleave"+e.ns,e.selector,e,E.mouseleave);break;case "left":l.on("click"+e.ns,e.selector,e,E.click)}e.build||N.create(e);break;case "destroy":var w;if(n){var z=e.context;h.each(q,function(a,d){if(d.context!==z)return!0;w=h(".context-menu-list").filter(":visible");w.length&&
w.data().contextMenuRoot.$trigger.is(h(d.context).find(d.selector))&&w.trigger("contextmenu:hide",{force:!0});try{q[d.ns].$menu&&q[d.ns].$menu.remove(),delete q[d.ns]}catch(e){q[d.ns]=null}h(d.context).off(d.ns);return!0})}else if(!e.selector)g.off(".contextMenu .contextMenuAutoHide"),h.each(q,function(a,d){h(d.context).off(d.ns)}),r={},q={},p=0,m=!1,h("#context-menu-layer, .context-menu-list").remove();else if(r[e.selector]){w=h(".context-menu-list").filter(":visible");w.length&&w.data().contextMenuRoot.$trigger.is(e.selector)&&
w.trigger("contextmenu:hide",{force:!0});try{q[r[e.selector]].$menu&&q[r[e.selector]].$menu.remove(),delete q[r[e.selector]]}catch(B){q[r[e.selector]]=null}g.off(r[e.selector])}break;case "html5":(!h.support.htmlCommand&&!h.support.htmlMenuitem||"boolean"==typeof d&&d)&&h('menu[type="context"]').each(function(){this.id&&h.contextMenu({selector:"[contextmenu="+this.id+"]",items:h.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw Error('Unknown operation "'+a+'"');}return this};
h.contextMenu.setInputValues=function(a,d){d===f&&(d={});h.each(a.inputs,function(a,e){switch(e.type){case "text":case "textarea":e.value=d[a]||"";break;case "checkbox":e.selected=d[a]?!0:!1;break;case "radio":e.selected=(d[e.radio]||"")==e.value?!0:!1;break;case "select":e.selected=d[a]||""}})};h.contextMenu.getInputValues=function(a,d){d===f&&(d={});h.each(a.inputs,function(a,e){switch(e.type){case "text":case "textarea":case "select":d[a]=e.$input.val();break;case "checkbox":d[a]=e.$input.prop("checked");
break;case "radio":e.$input.prop("checked")&&(d[e.radio]=e.value)}});return d};h.contextMenu.fromMenu=function(d){d=h(d);var e={};a(e,d.children());return e};h.contextMenu.defaults=x;h.contextMenu.types=w;h.contextMenu.handle=E;h.contextMenu.op=N;h.contextMenu.menus=q})(jQuery);!function(){function h(b,k){return k>b?-1:b>k?1:b>=k?0:0/0}function f(b){return null===b?0/0:+b}function e(b){return!isNaN(b)}function d(b){return{left:function(k,v,a,d){3>arguments.length&&(a=0);for(4>arguments.length&&(d=k.length);d>a;){var y=a+d>>>1;0>b(k[y],v)?a=y+1:d=y}return a},right:function(k,v,a,d){3>arguments.length&&(a=0);for(4>arguments.length&&(d=k.length);d>a;){var y=a+d>>>1;0<b(k[y],v)?d=y:a=y+1}return a}}}function a(b){return b.length}function g(b,k){for(var v in k)Object.defineProperty(b.prototype,
v,{value:k[v],enumerable:!1})}function l(){this._=Object.create(null)}function m(b){return(b+="")===ug||b[0]===Fc?Fc+b:b}function n(b){return(b+="")[0]===Fc?b.slice(1):b}function p(b){return m(b)in this._}function r(b){return(b=m(b))in this._&&delete this._[b]}function q(){var b=[],k;for(k in this._)b.push(n(k));return b}function w(){var b=0,k;for(k in this._)++b;return b}function x(){for(var b in this._)return!1;return!0}function z(){this._=Object.create(null)}function B(b,k,v){return function(){var a=
v.apply(k,arguments);return a===k?b:a}}function A(b,k){if(k in b)return k;k=k.charAt(0).toUpperCase()+k.slice(1);for(var v=0,a=Ud.length;a>v;++v){var d=Ud[v]+k;if(d in b)return d}}function L(){}function ba(){}function E(b){function k(){for(var k,a=v,d=-1,I=a.length;++d<I;)(k=a[d].on)&&k.apply(this,arguments);return b}var v=[],a=new l;return k.on=function(k,d){var e,g=a.get(k);return 2>arguments.length?g&&g.on:(g&&(g.on=null,v=v.slice(0,e=v.indexOf(g)).concat(v.slice(e+1)),a.remove(k)),d&&v.push(a.set(k,
{on:d})),b)},k}function N(){t.event.preventDefault()}function T(){for(var b,k=t.event;b=k.sourceEvent;)k=b;return k}function Dc(b){for(var k=new ba,v=0,a=arguments.length;++v<a;)k[arguments[v]]=E(k);return k.of=function(v,a){return function(d){try{var I=d.sourceEvent=t.event;d.target=b;t.event=d;k[d.type].apply(v,a)}finally{t.event=I}}},k}function Ka(b){return Fb(b,K),b}function Ec(b){return"function"==typeof b?b:function(){return Gc(b,this)}}function Nd(b){return"function"==typeof b?b:function(){return Hc(b,
this)}}function Od(b,k){function v(){this.removeAttribute(b)}function a(){this.removeAttributeNS(b.space,b.local)}function d(){this.setAttribute(b,k)}function y(){this.setAttributeNS(b.space,b.local,k)}function e(){var v=k.apply(this,arguments);null==v?this.removeAttribute(b):this.setAttribute(b,v)}function g(){var v=k.apply(this,arguments);null==v?this.removeAttributeNS(b.space,b.local):this.setAttributeNS(b.space,b.local,v)}return b=t.ns.qualify(b),null==k?b.local?a:v:"function"==typeof k?b.local?
g:e:b.local?y:d}function Pd(b){return b.trim().replace(/\s+/g," ")}function Qd(b){return new RegExp("(?:^|\\s+)"+t.requote(b)+"(?:\\s+|$)","g")}function Rd(b,k){function v(){for(var v=-1;++v<d;)b[v](this,k)}function a(){for(var v=-1,I=k.apply(this,arguments);++v<d;)b[v](this,I)}b=(b+"").trim().split(/^|\s+/).map(tg);var d=b.length;return"function"==typeof k?a:v}function tg(b){var k=Qd(b);return function(v,a){if(d=v.classList)return a?d.add(b):d.remove(b);var d=v.getAttribute("class")||"";a?(k.lastIndex=
0,k.test(d)||v.setAttribute("class",Pd(d+" "+b))):v.setAttribute("class",Pd(d.replace(k," ")))}}function Sd(b,k,v){function a(){this.style.removeProperty(b)}function d(){this.style.setProperty(b,k,v)}function y(){var a=k.apply(this,arguments);null==a?this.style.removeProperty(b):this.style.setProperty(b,a,v)}return null==k?a:"function"==typeof k?y:d}function Td(b,k){function v(){delete this[b]}function a(){this[b]=k}function d(){var v=k.apply(this,arguments);null==v?delete this[b]:this[b]=v}return null==
k?v:"function"==typeof k?d:a}function Wd(b){return"function"==typeof b?b:(b=t.ns.qualify(b)).local?function(){return this.ownerDocument.createElementNS(b.space,b.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,b)}}function Xd(b){return function(){return Yd(this,b)}}function vg(b){return arguments.length||(b=h),function(k,v){return k&&v?b(k.__data__,v.__data__):!k-!v}}function Aa(b,k){for(var v=0,a=b.length;a>v;v++)for(var d,y=b[v],e=0,g=y.length;g>e;e++)(d=y[e])&&k(d,
e,v);return b}function Zd(b){return Fb(b,Ba),b}function wg(b){var k,v;return function(a,d,y){a=b[y].update;var e=a.length;y!=v&&(v=y,k=0);for(d>=k&&(k=d+1);!(d=a[k])&&++k<e;);return d}}function Gb(){var b=this.__transition__;b&&++b.active}function $d(b,k,v){function a(){var k=this[e];k&&(this.removeEventListener(b,k,k.$),delete this[e])}function d(){var y=f(k,La(arguments));a.call(this);this.addEventListener(b,this[e]=y,y.$=v);y._=k}function y(){var k,v=new RegExp("^__on([^.]+)"+t.requote(b)+"$"),
a;for(a in this)if(k=a.match(v)){var d=this[a];this.removeEventListener(k[1],d,d.$);delete this[a]}}var e="__on"+b,g=b.indexOf("."),f=ae;0<g&&(b=b.slice(0,g));var h=Ic.get(b);return h&&(b=h,f=xg),g?k?d:a:k?L:y}function ae(b,k){return function(v){var a=t.event;t.event=v;k[0]=this.__data__;try{b.apply(this,k)}finally{t.event=a}}}function xg(b,k){var v=ae(b,k);return function(b){var k=b.relatedTarget;k&&(k===this||8&k.compareDocumentPosition(this))||v.call(this,b)}}function Hb(){var b=".dragsuppress-"+
++yg,k="click"+b,v=t.select(ca).on("touchmove"+b,N).on("dragstart"+b,N).on("selectstart"+b,N);if(qb){var a=Ca.style,d=a[qb];a[qb]="none"}return function(y){function e(){v.on(k,null)}v.on(b,null);qb&&(a[qb]=d);y&&(v.on(k,function(){N();e()},!0),setTimeout(e,0))}}function Jc(b,k){k.changedTouches&&(k=k.changedTouches[0]);var v=b.ownerSVGElement||b;if(v.createSVGPoint){var a=v.createSVGPoint();if(0>Kc&&(ca.scrollX||ca.scrollY)){var v=t.select("body").append("svg").style({position:"absolute",top:0,left:0,
margin:0,padding:0,border:"none"},"important"),d=v[0][0].getScreenCTM();Kc=!(d.f||d.e);v.remove()}return Kc?(a.x=k.pageX,a.y=k.pageY):(a.x=k.clientX,a.y=k.clientY),a=a.matrixTransform(b.getScreenCTM().inverse()),[a.x,a.y]}v=b.getBoundingClientRect();return[k.clientX-v.left-b.clientLeft,k.clientY-v.top-b.clientTop]}function zg(){return t.event.changedTouches[0].identifier}function Ag(){return t.event.target}function Bg(){return ca}function Lc(b,k,v){return(k[0]-b[0])*(v[1]-b[1])-(k[1]-b[1])*(v[0]-
b[0])}function be(b){return 1<b?0:-1>b?H:Math.acos(b)}function cb(b){return 1<b?Z:-1>b?-Z:Math.asin(b)}function ce(b){return((b=Math.exp(b))+1/b)/2}function de(b){return(b=Math.sin(b/2))*b}function Ta(){}function wa(b,k,v){return this instanceof wa?(this.h=+b,this.s=+k,void(this.l=+v)):2>arguments.length?b instanceof wa?new wa(b.h,b.s,b.l):ee(""+b,fe,wa):new wa(b,k,v)}function Mc(b,k,v){function a(b){return 360<b?b-=360:0>b&&(b+=360),60>b?d+(y-d)*b/60:180>b?y:240>b?d+(y-d)*(240-b)/60:d}var d,y;return b=
isNaN(b)?0:0>(b%=360)?b+360:b,k=isNaN(k)?0:0>k?0:1<k?1:k,v=0>v?0:1<v?1:v,y=.5>=v?v*(1+k):v+k-v*k,d=2*v-y,new da(Math.round(255*a(b+120)),Math.round(255*a(b)),Math.round(255*a(b-120)))}function ra(b,k,v){return this instanceof ra?(this.h=+b,this.c=+k,void(this.l=+v)):2>arguments.length?b instanceof ra?new ra(b.h,b.c,b.l):b instanceof sa?ge(b.l,b.a,b.b):ge((b=he((b=t.rgb(b)).r,b.g,b.b)).l,b.a,b.b):new ra(b,k,v)}function Nc(b,k,v){return isNaN(b)&&(b=0),isNaN(k)&&(k=0),new sa(v,Math.cos(b*=J)*k,Math.sin(b)*
k)}function sa(b,k,v){return this instanceof sa?(this.l=+b,this.a=+k,void(this.b=+v)):2>arguments.length?b instanceof sa?new sa(b.l,b.a,b.b):b instanceof ra?Nc(b.h,b.c,b.l):he((b=da(b)).r,b.g,b.b):new sa(b,k,v)}function ie(b,k,v){b=(b+16)/116;k=b+k/500;v=b-v/200;return k=Oc(k)*je,b=Oc(b)*ke,v=Oc(v)*le,new da(Pc(3.2404542*k-1.5371385*b-.4985314*v),Pc(-.969266*k+1.8760108*b+.041556*v),Pc(.0556434*k-.2040259*b+1.0572252*v))}function ge(b,k,v){return 0<b?new ra(Math.atan2(v,k)*R,Math.sqrt(k*k+v*v),b):
new ra(0/0,0/0,b)}function Oc(b){return.206893034<b?b*b*b:(b-4/29)/7.787037}function Qc(b){return.008856<b?Math.pow(b,1/3):7.787037*b+4/29}function Pc(b){return Math.round(255*(.00304>=b?12.92*b:1.055*Math.pow(b,1/2.4)-.055))}function da(b,k,v){return this instanceof da?(this.r=~~b,this.g=~~k,void(this.b=~~v)):2>arguments.length?b instanceof da?new da(b.r,b.g,b.b):ee(""+b,da,Mc):new da(b,k,v)}function Ib(b){return new da(b>>16,255&b>>8,255&b)+""}function db(b){return 16>b?"0"+Math.max(0,b).toString(16):
Math.min(255,b).toString(16)}function ee(b,k,v){var a,d,y,e=0,g=0,f=0;if(a=/([a-z]+)\((.*)\)/i.exec(b))switch(d=a[2].split(","),a[1]){case "hsl":return v(parseFloat(d[0]),parseFloat(d[1])/100,parseFloat(d[2])/100);case "rgb":return k(Rc(d[0]),Rc(d[1]),Rc(d[2]))}return(y=Jb.get(b))?k(y.r,y.g,y.b):(null==b||"#"!==b.charAt(0)||isNaN(y=parseInt(b.slice(1),16))||(4===b.length?(e=(3840&y)>>4,e|=e>>4,g=240&y,g|=g>>4,f=15&y,f|=f<<4):7===b.length&&(e=(16711680&y)>>16,g=(65280&y)>>8,f=255&y)),k(e,g,f))}function fe(b,
k,v){var a,d,y=Math.min(b/=255,k/=255,v/=255),e=Math.max(b,k,v),g=e-y,f=(e+y)/2;return g?(d=.5>f?g/(e+y):g/(2-e-y),a=b==e?(k-v)/g+(v>k?6:0):k==e?(v-b)/g+2:(b-k)/g+4,a*=60):(a=0/0,d=0<f&&1>f?0:a),new wa(a,d,f)}function he(b,k,v){b=Sc(b);k=Sc(k);v=Sc(v);var a=Qc((.4124564*b+.3575761*k+.1804375*v)/je),d=Qc((.2126729*b+.7151522*k+.072175*v)/ke);b=Qc((.0193339*b+.119192*k+.9503041*v)/le);return sa(116*d-16,500*(a-d),200*(d-b))}function Sc(b){return.04045>=(b/=255)?b/12.92:Math.pow((b+.055)/1.055,2.4)}
function Rc(b){var k=parseFloat(b);return"%"===b.charAt(b.length-1)?Math.round(2.55*k):k}function Q(b){return"function"==typeof b?b:function(){return b}}function Y(b){return b}function Tc(b){return function(k,v,a){return 2===arguments.length&&"function"==typeof v&&(a=v,v=null),Kb(k,v,b,a)}}function Kb(b,k,v,a){function d(){var b,k=f.status,a;if(a=!k)a=(a=f.responseType)&&"text"!==a?f.response:f.responseText;if(a||200<=k&&300>k||304===k){try{b=v.call(y,f)}catch(I){return e.error.call(y,I),void 0}e.load.call(y,
b)}else e.error.call(y,f)}var y={},e=t.dispatch("beforesend","progress","load","error"),g={},f=new XMLHttpRequest,h=null;return!ca.XDomainRequest||"withCredentials"in f||!/^(http(s)?:)?\/\//.test(b)||(f=new XDomainRequest),"onload"in f?f.onload=f.onerror=d:f.onreadystatechange=function(){3<f.readyState&&d()},f.onprogress=function(b){var k=t.event;t.event=b;try{e.progress.call(y,f)}finally{t.event=k}},y.header=function(b,k){return b=(b+"").toLowerCase(),2>arguments.length?g[b]:(null==k?delete g[b]:
g[b]=k+"",y)},y.mimeType=function(b){return arguments.length?(k=null==b?null:b+"",y):k},y.responseType=function(b){return arguments.length?(h=b,y):h},y.response=function(b){return v=b,y},["get","post"].forEach(function(b){y[b]=function(){return y.send.apply(y,[b].concat(La(arguments)))}}),y.send=function(v,a,d){if(2===arguments.length&&"function"==typeof a&&(d=a,a=null),f.open(v,b,!0),null==k||"accept"in g||(g.accept=k+",*/*"),f.setRequestHeader)for(var I in g)f.setRequestHeader(I,g[I]);return null!=
k&&f.overrideMimeType&&f.overrideMimeType(k),null!=h&&(f.responseType=h),null!=d&&y.on("error",d).on("load",function(b){d(null,b)}),e.beforesend.call(y,f),f.send(null==a?null:a),y},y.abort=function(){return f.abort(),y},t.rebind(y,e,"on"),null==a?y:y.get(Cg(a))}function Cg(b){return 1===b.length?function(k,v){b(null==k?v:null)}:b}function Uc(){var b=me(),b=ne()-b;24<b?(isFinite(b)&&(clearTimeout(Lb),Lb=setTimeout(Uc,b)),Mb=0):(Mb=1,oe(Uc))}function me(){var b=Date.now();for(Da=Nb;Da;)b>=Da.t&&(Da.f=
Da.c(b-Da.t)),Da=Da.n;return b}function ne(){for(var b,k=Nb,v=1/0;k;)k.f?k=b?b.n=k.n:Nb=k.n:(k.t<v&&(v=k.t),k=(b=k).n);return Ob=b,v}function Vc(b,k){return k-(b?Math.ceil(Math.log(b)/Math.LN10):1)}function Dg(b){var k=b.decimal,v=b.thousands,a=b.grouping,d=b.currency,y=a&&v?function(b,k){for(var d=b.length,y=[],e=0,g=a[0],F=0;0<d&&0<g&&(F+g+1>k&&(g=Math.max(1,k-F)),y.push(b.substring(d-=g,d+g)),!((F+=g+1)>k));)g=a[e=(e+1)%a.length];return y.reverse().join(v)}:Y;return function(b){b=pe.exec(b);var v=
b[1]||" ",a=b[2]||">",e=b[3]||"-",I=b[4]||"",g=b[5],f=+b[6],h=b[7],l=b[8],m=b[9],n=1,p="",q="",r=!1,w=!0;switch(l&&(l=+l.substring(1)),(g||"0"===v&&"="===a)&&(g=v="0",a="="),m){case "n":h=!0;m="g";break;case "%":n=100;q="%";m="f";break;case "p":n=100;q="%";m="r";break;case "b":case "o":case "x":case "X":"#"===I&&(p="0"+m.toLowerCase());case "c":w=!1;case "d":r=!0;l=0;break;case "s":n=-1,m="r"}"$"===I&&(p=d[0],q=d[1]);"r"!=m||l||(m="g");null!=l&&("g"==m?l=Math.max(1,Math.min(21,l)):("e"==m||"f"==m)&&
(l=Math.max(0,Math.min(20,l))));var m=Eg.get(m)||Fg,z=g&&h;return function(b){var d=q;if(r&&b%1)return"";var I=0>b||0===b&&0>1/b?(b=-b,"-"):"-"===e?"":e;0>n?(d=t.formatPrefix(b,l),b=d.scale(b),d=d.symbol+q):b*=n;b=m(b,l);var F,X,S=b.lastIndexOf(".");0>S?(S=w?b.lastIndexOf("e"):-1,0>S?(F=b,X=""):(F=b.substring(0,S),X=b.substring(S))):(F=b.substring(0,S),X=k+b.substring(S+1));!g&&h&&(F=y(F,1/0));var S=p.length+F.length+X.length+(z?0:I.length),x=f>S?Array(S=f-S+1).join(v):"";return z&&(F=y(x+F,x.length?
f-X.length:1/0)),I+=p,b=F+X,("<"===a?I+b+x:">"===a?x+I+b:"^"===a?x.substring(0,S>>=1)+I+b+x.substring(S):I+(z?b:x+b))+d}}}function Fg(b){return b+""}function Fa(){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):arguments[0])}function Ua(b,k,v){function a(k){var v=b(k),d=y(v,1);return d-k>k-v?v:d}function d(v){return k(v=b(new aa(v-1)),1),v}function y(b,v){return k(b=new aa(+b),v),b}function e(b,a,I){b=d(b);var y=[];if(1<I)for(;a>b;)v(b)%I||y.push(new Date(+b)),k(b,1);else for(;a>
b;)y.push(new Date(+b)),k(b,1);return y}b.floor=b;b.round=a;b.ceil=d;b.offset=y;b.range=e;var g=b.utc=Qb(b);return g.floor=g,g.round=Qb(a),g.ceil=Qb(d),g.offset=Qb(y),g.range=function(b,k,v){try{aa=Fa;var a=new Fa;return a._=b,e(a,k,v)}finally{aa=Date}},b}function Qb(b){return function(k,v){try{aa=Fa;var a=new Fa;return a._=k,b(a,v)._}finally{aa=Date}}}function Gg(b){function k(b){function k(v){for(var d,e,y,I=[],g=-1,F=0;++g<a;)37===b.charCodeAt(g)&&(I.push(b.slice(F,g)),null!=(e=qe[d=b.charAt(++g)])&&
(d=b.charAt(++g)),(y=P[d])&&(d=y(v,null==e?"e"===d?" ":"0":e)),I.push(d),F=g+1);return I.push(b.slice(F,g)),I.join("")}var a=b.length;return k.parse=function(k){var a={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(v(a,b,k,0)!=k.length)return null;"p"in a&&(a.H=a.H%12+12*a.p);k=null!=a.Z&&aa!==Fa;var d=new (k?Fa:aa);return"j"in a?d.setFullYear(a.y,0,a.j):"w"in a&&("W"in a||"U"in a)?(d.setFullYear(a.y,0,1),d.setFullYear(a.y,0,"W"in a?(a.w+6)%7+7*a.W-(d.getDay()+5)%7:a.w+7*a.U-(d.getDay()+6)%7)):d.setFullYear(a.y,
a.m,a.d),d.setHours(a.H+(0|a.Z/100),a.M+a.Z%100,a.S,a.L),k?d._:d},k.toString=function(){return b},k}function v(b,k,v,a){for(var d,e,y,I=0,g=k.length,F=v.length;g>I;){if(a>=F)return-1;if(d=k.charCodeAt(I++),37===d){if(y=k.charAt(I++),e=x[y in qe?k.charAt(I++):y],!e||0>(a=e(b,v,a)))return-1}else if(d!=v.charCodeAt(a++))return-1}return a}var a=b.dateTime,d=b.date,y=b.time,e=b.periods,g=b.days,f=b.shortDays,h=b.months,l=b.shortMonths;k.utc=function(b){function v(b){try{aa=Fa;var k=new aa;return k._=b,
a(k)}finally{aa=Date}}var a=k(b);return v.parse=function(b){try{aa=Fa;var k=a.parse(b);return k&&k._}finally{aa=Date}},v.toString=a.toString,v};k.multi=k.utc.multi=Hg;var m=t.map(),n=Rb(g),p=Sb(g),q=Rb(f),r=Sb(f),w=Rb(h),Ea=Sb(h),z=Rb(l),O=Sb(l);e.forEach(function(b,k){m.set(b.toLowerCase(),k)});var P={a:function(b){return f[b.getDay()]},A:function(b){return g[b.getDay()]},b:function(b){return l[b.getMonth()]},B:function(b){return h[b.getMonth()]},c:k(a),d:function(b,k){return ea(b.getDate(),k,2)},
e:function(b,k){return ea(b.getDate(),k,2)},H:function(b,k){return ea(b.getHours(),k,2)},I:function(b,k){return ea(b.getHours()%12||12,k,2)},j:function(b,k){return ea(1+C.dayOfYear(b),k,3)},L:function(b,k){return ea(b.getMilliseconds(),k,3)},m:function(b,k){return ea(b.getMonth()+1,k,2)},M:function(b,k){return ea(b.getMinutes(),k,2)},p:function(b){return e[+(12<=b.getHours())]},S:function(b,k){return ea(b.getSeconds(),k,2)},U:function(b,k){return ea(C.sundayOfYear(b),k,2)},w:function(b){return b.getDay()},
W:function(b,k){return ea(C.mondayOfYear(b),k,2)},x:k(d),X:k(y),y:function(b,k){return ea(b.getFullYear()%100,k,2)},Y:function(b,k){return ea(b.getFullYear()%1E4,k,4)},Z:Ig,"%":function(){return"%"}},x={a:function(b,k,v){q.lastIndex=0;return(k=q.exec(k.slice(v)))?(b.w=r.get(k[0].toLowerCase()),v+k[0].length):-1},A:function(b,k,v){n.lastIndex=0;return(k=n.exec(k.slice(v)))?(b.w=p.get(k[0].toLowerCase()),v+k[0].length):-1},b:function(b,k,v){z.lastIndex=0;return(k=z.exec(k.slice(v)))?(b.m=O.get(k[0].toLowerCase()),
v+k[0].length):-1},B:function(b,k,v){w.lastIndex=0;return(k=w.exec(k.slice(v)))?(b.m=Ea.get(k[0].toLowerCase()),v+k[0].length):-1},c:function(b,k,a){return v(b,P.c.toString(),k,a)},d:re,e:re,H:se,I:se,j:Jg,L:Kg,m:Lg,M:Mg,p:function(b,k,v){k=m.get(k.slice(v,v+=2).toLowerCase());return null==k?-1:(b.p=k,v)},S:Ng,U:Og,w:Pg,W:Qg,x:function(b,k,a){return v(b,P.x.toString(),k,a)},X:function(b,k,a){return v(b,P.X.toString(),k,a)},y:Rg,Y:Sg,Z:Tg,"%":Ug};return k}function ea(b,k,v){var a=0>b?"-":"";b=(a?-b:
b)+"";var d=b.length;return a+(v>d?Array(v-d+1).join(k)+b:b)}function Rb(b){return new RegExp("^(?:"+b.map(t.requote).join("|")+")","i")}function Sb(b){for(var k=new l,v=-1,a=b.length;++v<a;)k.set(b[v].toLowerCase(),v);return k}function Pg(b,k,v){V.lastIndex=0;return(k=V.exec(k.slice(v,v+1)))?(b.w=+k[0],v+k[0].length):-1}function Og(b,k,v){V.lastIndex=0;return(k=V.exec(k.slice(v)))?(b.U=+k[0],v+k[0].length):-1}function Qg(b,k,v){V.lastIndex=0;return(k=V.exec(k.slice(v)))?(b.W=+k[0],v+k[0].length):
-1}function Sg(b,k,v){V.lastIndex=0;return(k=V.exec(k.slice(v,v+4)))?(b.y=+k[0],v+k[0].length):-1}function Rg(b,k,v){V.lastIndex=0;if(k=V.exec(k.slice(v,v+2))){var a=+k[0];b=(b.y=a+(68<a?1900:2E3),v+k[0].length)}else b=-1;return b}function Tg(b,k,v){return/^[+-]\d{4}$/.test(k=k.slice(v,v+5))?(b.Z=-k,v+5):-1}function Lg(b,k,v){V.lastIndex=0;return(k=V.exec(k.slice(v,v+2)))?(b.m=k[0]-1,v+k[0].length):-1}function re(b,k,v){V.lastIndex=0;return(k=V.exec(k.slice(v,v+2)))?(b.d=+k[0],v+k[0].length):-1}function Jg(b,
k,v){V.lastIndex=0;return(k=V.exec(k.slice(v,v+3)))?(b.j=+k[0],v+k[0].length):-1}function se(b,k,v){V.lastIndex=0;return(k=V.exec(k.slice(v,v+2)))?(b.H=+k[0],v+k[0].length):-1}function Mg(b,k,v){V.lastIndex=0;return(k=V.exec(k.slice(v,v+2)))?(b.M=+k[0],v+k[0].length):-1}function Ng(b,k,v){V.lastIndex=0;return(k=V.exec(k.slice(v,v+2)))?(b.S=+k[0],v+k[0].length):-1}function Kg(b,k,v){V.lastIndex=0;return(k=V.exec(k.slice(v,v+3)))?(b.L=+k[0],v+k[0].length):-1}function Ig(b){var k=b.getTimezoneOffset();
b=0<k?"-":"+";var v=0|G(k)/60,k=G(k)%60;return b+ea(v,"0",2)+ea(k,"0",2)}function Ug(b,k,v){te.lastIndex=0;return(b=te.exec(k.slice(v,v+1)))?v+b[0].length:-1}function Hg(b){for(var k=b.length,v=-1;++v<k;)b[v][0]=this(b[v][0]);return function(k){for(var v=0,a=b[v];!a[1](k);)a=b[++v];return a[0](k)}}function Wc(){}function ue(b,k,v){var a=v.s=b+k,d=a-b;v.t=b-(a-d)+(k-d)}function Tb(b,k){b&&ve.hasOwnProperty(b.type)&&ve[b.type](b,k)}function Xc(b,k,v){var a=-1,d=b.length-v;for(k.lineStart();++a<d;)v=
b[a],k.point(v[0],v[1],v[2]);k.lineEnd()}function we(b,k){var a=-1,d=b.length;for(k.polygonStart();++a<d;)Xc(b[a],k,1);k.polygonEnd()}function Vg(){function b(b,k){b*=J;k=k*J/2+H/4;var a=b-d,v=0<=a?1:-1,g=v*a,a=Math.cos(k),f=Math.sin(k),h=y*f,l=e*a+h*Math.cos(g),v=h*v*Math.sin(g);Va.add(Math.atan2(v,l));d=b;e=a;y=f}var k,a,d,e,y;ia.point=function(g,f){ia.point=b;d=(k=g)*J;e=Math.cos(f=(a=f)*J/2+H/4);y=Math.sin(f)};ia.lineEnd=function(){b(k,a)}}function Wa(b){var k=b[0];b=b[1];var a=Math.cos(b);return[a*
Math.cos(k),a*Math.sin(k),Math.sin(b)]}function Ub(b,k){return b[0]*k[0]+b[1]*k[1]+b[2]*k[2]}function fb(b,k){return[b[1]*k[2]-b[2]*k[1],b[2]*k[0]-b[0]*k[2],b[0]*k[1]-b[1]*k[0]]}function Yc(b,k){b[0]+=k[0];b[1]+=k[1];b[2]+=k[2]}function Vb(b,k){return[b[0]*k,b[1]*k,b[2]*k]}function Wb(b){var k=Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);b[0]/=k;b[1]/=k;b[2]/=k}function Xb(b){return[Math.atan2(b[1],b[0]),cb(b[2])]}function Yb(b,k){return G(b[0]-k[0])<D&&G(b[1]-k[1])<D}function Zc(b,k){b*=J;var a=Math.cos(k*=
J);sb(a*Math.cos(b),a*Math.sin(b),Math.sin(k))}function sb(b,k,a){++tb;Ga+=(b-Ga)/tb;Ha+=(k-Ha)/tb;xa+=(a-xa)/tb}function xe(){function b(b,e){b*=J;var g=Math.cos(e*=J),f=g*Math.cos(b),g=g*Math.sin(b),h=Math.sin(e),l=Math.atan2(Math.sqrt((l=a*h-d*g)*l+(l=d*f-k*h)*l+(l=k*g-a*f)*l),k*f+a*g+d*h);gb+=l;na+=l*(k+(k=f));oa+=l*(a+(a=g));fa+=l*(d+(d=h));sb(k,a,d)}var k,a,d;ta.point=function(e,y){e*=J;var g=Math.cos(y*=J);k=g*Math.cos(e);a=g*Math.sin(e);d=Math.sin(y);ta.point=b;sb(k,a,d)}}function ye(){ta.point=
Zc}function Wg(){function b(b,k){b*=J;var a=Math.cos(k*=J),v=a*Math.cos(b),a=a*Math.sin(b),g=Math.sin(k),f=e*g-y*a,h=y*v-d*g,l=d*a-e*v,m=Math.sqrt(f*f+h*h+l*l),n=d*v+e*a+y*g,p=m&&-be(n)/m,m=Math.atan2(m,n);Na+=p*f;Oa+=p*h;ya+=p*l;gb+=m;na+=m*(d+(d=v));oa+=m*(e+(e=a));fa+=m*(y+(y=g));sb(d,e,y)}var k,a,d,e,y;ta.point=function(g,f){k=g;a=f;ta.point=b;g*=J;var h=Math.cos(f*=J);d=h*Math.cos(g);e=h*Math.sin(g);y=Math.sin(f);sb(d,e,y)};ta.lineEnd=function(){b(k,a);ta.lineEnd=ye;ta.point=Zc}}function hb(){return!0}
function ze(b,k,a,d,e){var y=[],g=[];if(b.forEach(function(b){if(!(0>=(k=b.length-1))){var k,a=b[0],v=b[k];if(Yb(a,v)){e.lineStart();for(v=0;k>v;++v)e.point((a=b[v])[0],a[1]);return e.lineEnd(),void 0}k=new Zb(a,b,null,!0);a=new Zb(a,null,k,!1);k.o=a;y.push(k);g.push(a);k=new Zb(v,b,null,!1);a=new Zb(v,null,k,!0);k.o=a;y.push(k);g.push(a)}}),g.sort(k),Ae(y),Ae(g),y.length){b=0;k=a;for(a=g.length;a>b;++b)g[b].e=k=!k;for(var f,h=y[0];;){for(var l=h,m=!0;l.v;)if((l=l.n)===h)return;k=l.z;e.lineStart();
do{if(l.v=l.o.v=!0,l.e){if(m)for(b=0,a=k.length;a>b;++b)e.point((f=k[b])[0],f[1]);else d(l.x,l.n.x,1,e);l=l.n}else{if(m)for(k=l.p.z,b=k.length-1;0<=b;--b)e.point((f=k[b])[0],f[1]);else d(l.x,l.p.x,-1,e);l=l.p}l=l.o;k=l.z;m=!m}while(!l.v);e.lineEnd()}}}function Ae(b){if(k=b.length){for(var k,a,d=0,e=b[0];++d<k;)e.n=a=b[d],a.p=e,e=a;e.n=a=b[0];a.p=e}}function Zb(b,k,a,d){this.x=b;this.z=k;this.o=a;this.e=d;this.v=!1;this.n=this.p=null}function Be(b,k,a,d){return function(e,y){function g(k,a){var v=
e(k,a);b(k=v[0],a=v[1])&&y.point(k,a)}function f(b,k){var a=e(b,k);w.point(a[0],a[1])}function h(){M.point=f;w.lineStart()}function l(){M.point=g;w.lineEnd()}function m(b,k){la.push([b,k]);var a=e(b,k);P.point(a[0],a[1])}function n(){P.lineStart();la=[]}function p(){m(la[0][0],la[0][1]);P.lineEnd();var b;b=P.clean();var k=O.buffer(),a=k.length;if(la.pop(),r.push(la),la=null,a)if(1&b){b=k[0];var v,a=b.length-1,k=-1;if(0<a){x||(y.polygonStart(),x=!0);for(y.lineStart();++k<a;)y.point((v=b[k])[0],v[1]);
y.lineEnd()}}else 1<a&&2&b&&k.push(k.pop().concat(k.shift())),q.push(k.filter(Xg))}var q,r,la,w=k(y),z=e.invert(d[0],d[1]),M={point:g,lineStart:h,lineEnd:l,polygonStart:function(){M.point=m;M.lineStart=n;M.lineEnd=p;q=[];r=[]},polygonEnd:function(){M.point=g;M.lineStart=h;M.lineEnd=l;q=t.merge(q);var b,k=z;b=r;var d=k[0],e=k[1],I=[Math.sin(d),-Math.cos(d),0],F=0,f=0;Va.reset();for(var U=0,m=b.length;m>U;++U){var n=b[U],p=n.length;if(p)for(var S=n[0],qa=S[0],k=S[1]/2+H/4,Ma=Math.sin(k),la=Math.cos(k),
w=1;;){w===p&&(w=0);var k=n[w],O=k[0],rb=k[1]/2+H/4,P=Math.sin(rb),rb=Math.cos(rb),B=O-qa,A=0<=B?1:-1,E=A*B,L=E>H,Ma=Ma*P;if(Va.add(Math.atan2(Ma*A*Math.sin(E),la*rb+Ma*Math.cos(E))),F+=L?B+A*ja:B,L^qa>=d^O>=d)S=fb(Wa(S),Wa(k)),Wb(S),qa=fb(I,S),Wb(qa),qa=(L^0<=B?-1:1)*cb(qa[2]),(e>qa||e===qa&&(S[0]||S[1]))&&(f+=L^0<=B?1:-1);if(!w++)break;qa=O;Ma=P;la=rb;S=k}}b=(-D>F||D>F&&0>Va)^1&f;q.length?(x||(y.polygonStart(),x=!0),ze(q,Yg,b,a,y)):b&&(x||(y.polygonStart(),x=!0),y.lineStart(),a(null,null,1,y),y.lineEnd());
x&&(y.polygonEnd(),x=!1);q=r=null},sphere:function(){y.polygonStart();y.lineStart();a(null,null,1,y);y.lineEnd();y.polygonEnd()}},O=Ce(),P=k(O),x=!1;return M}}function Xg(b){return 1<b.length}function Ce(){var b,k=[];return{lineStart:function(){k.push(b=[])},point:function(k,a){b.push([k,a])},lineEnd:L,buffer:function(){var a=k;return k=[],b=null,a},rejoin:function(){1<k.length&&k.push(k.pop().concat(k.shift()))}}}function Yg(b,k){return(0>(b=b.x)[0]?b[1]-Z-D:Z-b[1])-(0>(k=k.x)[0]?k[1]-Z-D:Z-k[1])}
function Zg(b){function k(b,k){return Math.cos(b)*Math.cos(k)>e}function a(b,k,v){var d=Wa(b),y=Wa(k),g=[1,0,0],y=fb(d,y),I=Ub(y,y),d=y[0],f=I-d*d;if(!f)return!v&&b;I=e*I/f;f=-e*d/f;d=fb(g,y);g=Vb(g,I);y=Vb(y,f);Yc(g,y);y=Ub(g,d);I=Ub(d,d);f=y*y-I*(Ub(g,g)-1);if(!(0>f)){var h=Math.sqrt(f),f=Vb(d,(-y-h)/I);if(Yc(f,g),f=Xb(f),!v)return f;var U;v=b[0];var l=k[0];b=b[1];k=k[1];v>l&&(U=v,v=l,l=U);var m=l-v,X=G(m-H)<D,n=X||D>m;if(!X&&b>k&&(U=b,b=k,k=U),n?X?0<b+k^f[1]<(G(f[0]-v)<D?b:k):b<=f[1]&&f[1]<=k:
m>H^(v<=f[0]&&f[0]<=l))return U=Vb(d,(-y+h)/I),Yc(U,g),[f,Xb(U)]}}function d(k,a){var v=y?b:H-b,e=0;return-v>k?e|=1:k>v&&(e|=2),-v>a?e|=4:a>v&&(e|=8),e}var e=Math.cos(b),y=0<e,g=G(e)>D,f=$c(b,6*J);return Be(k,function(b){var e,f,F,h,U;return{lineStart:function(){h=F=!1;U=1},point:function(l,m){var n,p=[l,m],q=k(l,m),r=y?q?0:d(l,m):q?d(l+(0>l?H:-H),m):0;if(!e&&(h=F=q)&&b.lineStart(),q!==F&&(n=a(e,p),(Yb(e,n)||Yb(p,n))&&(p[0]+=D,p[1]+=D,q=k(p[0],p[1]))),q!==F)U=0,q?(b.lineStart(),n=a(p,e),b.point(n[0],
n[1])):(n=a(e,p),b.point(n[0],n[1]),b.lineEnd()),e=n;else if(g&&e&&y^q){var t;r&f||!(t=a(p,e,!0))||(U=0,y?(b.lineStart(),b.point(t[0][0],t[0][1]),b.point(t[1][0],t[1][1]),b.lineEnd()):(b.point(t[1][0],t[1][1]),b.lineEnd(),b.lineStart(),b.point(t[0][0],t[0][1])))}!q||e&&Yb(e,p)||b.point(p[0],p[1]);e=p;F=q;f=r},lineEnd:function(){F&&b.lineEnd();e=null},clean:function(){return U|(h&&F)<<1}}},f,y?[0,-b]:[-H,b-H])}function De(b,k,a,d){return function(e){var y,g=e.a,f=e.b,h=g.x,g=g.y,l=0,m=1,n=f.x-h,f=
f.y-g;if(y=b-h,n||!(0<y)){if(y/=n,0>n){if(l>y)return;m>y&&(m=y)}else if(0<n){if(y>m)return;y>l&&(l=y)}if(y=a-h,n||!(0>y)){if(y/=n,0>n){if(y>m)return;y>l&&(l=y)}else if(0<n){if(l>y)return;m>y&&(m=y)}if(y=k-g,f||!(0<y)){if(y/=f,0>f){if(l>y)return;m>y&&(m=y)}else if(0<f){if(y>m)return;y>l&&(l=y)}if(y=d-g,f||!(0>y)){if(y/=f,0>f){if(y>m)return;y>l&&(l=y)}else if(0<f){if(l>y)return;m>y&&(m=y)}return 0<l&&(e.a={x:h+l*n,y:g+l*f}),1>m&&(e.b={x:h+m*n,y:g+m*f}),e}}}}}}function Ee(b,k,a,d){function e(d,y){return G(d[0]-
b)<D?0<y?0:3:G(d[0]-a)<D?0<y?2:1:G(d[1]-k)<D?0<y?1:0:0<y?3:2}function y(b,k){return g(b.x,k.x)}function g(b,k){var a=e(b,1),v=e(k,1);return a!==v?a-v:0===a?k[1]-b[1]:1===a?b[0]-k[0]:2===a?b[1]-k[1]:k[0]-b[0]}return function(f){function h(y,f,l,U){var m=0,n=0;if(null==y||(m=e(y,l))!==(n=e(f,l))||0>g(y,f)^0<l){do U.point(0===m||3===m?b:a,1<m?d:k);while((m=(m+l+4)%4)!==n)}else U.point(f[0],f[1])}function l(e,y){e>=b&&a>=e&&y>=k&&d>=y&&f.point(e,y)}function m(e,y){e=Math.max(-$b,Math.min($b,e));y=Math.max(-$b,
Math.min($b,y));var g=e>=b&&a>=e&&y>=k&&d>=y;if(p&&q.push([e,y]),P)r=e,w=y,z=g,P=!1,g&&(f.lineStart(),f.point(e,y));else if(g&&O)f.point(e,y);else{var F={a:{x:x,y:M},b:{x:e,y:y}};B(F)?(O||(f.lineStart(),f.point(F.a.x,F.a.y)),f.point(F.b.x,F.b.y),g||f.lineEnd(),Pb=!1):g&&(f.lineStart(),f.point(e,y),Pb=!1)}x=e;M=y;O=g}var n,p,q,r,w,z,x,M,O,P,Pb,ma=f,ha=Ce(),B=De(b,k,a,d),A={point:l,lineStart:function(){A.point=m;p&&p.push(q=[]);P=!0;O=!1;x=M=0/0},lineEnd:function(){n&&(m(r,w),z&&O&&ha.rejoin(),n.push(ha.buffer()));
A.point=l;O&&f.lineEnd()},polygonStart:function(){f=ha;n=[];p=[];Pb=!0},polygonEnd:function(){f=ma;n=t.merge(n);var k;k=[b,d];for(var a=0,v=p.length,e=k[1],g=0;v>g;++g)for(var F,l=1,m=p[g],X=m.length,ga=m[0];X>l;++l)F=m[l],ga[1]<=e?F[1]>e&&0<Lc(ga,F,k)&&++a:F[1]<=e&&0>Lc(ga,F,k)&&--a,ga=F;k=0!==a;a=Pb&&k;v=n.length;(a||v)&&(f.polygonStart(),a&&(f.lineStart(),h(null,null,1,f),f.lineEnd()),v&&ze(n,y,k,h,f),f.polygonEnd());n=p=q=null}};return A}}function Fe(b,k){function a(v,d){return v=b(v,d),k(v[0],
v[1])}return b.invert&&k.invert&&(a.invert=function(a,v){return a=k.invert(a,v),a&&b.invert(a[0],a[1])}),a}function ad(b){var k=0,a=H/3,d=bd(b);b=d(k,a);return b.parallels=function(b){return arguments.length?d(k=b[0]*H/180,a=b[1]*H/180):[k/H*180,a/H*180]},b}function Ge(b,k){function a(b,k){var v=Math.sqrt(y-2*e*Math.sin(k))/e;return[v*Math.sin(b*=e),g-v*Math.cos(b)]}var d=Math.sin(b),e=(d+Math.sin(k))/2,y=1+d*(2*e-d),g=Math.sqrt(y)/e;return a.invert=function(b,k){var a=g-k;return[Math.atan2(b,a)/
e,cb((y-(b*b+a*a)*e*e)/(2*e))]},a}function $g(){function b(b,k){ac+=e*b-d*k;d=b;e=k}var k,a,d,e;Pa.point=function(y,g){Pa.point=b;k=d=y;a=e=g};Pa.lineEnd=function(){b(k,a)}}function ah(){function b(b,k){g.push("M",b,",",k,y)}function k(b,k){g.push("M",b,",",k);f.point=a}function a(b,k){g.push("L",b,",",k)}function d(){f.point=b}function e(){g.push("Z")}var y=He(4.5),g=[],f={point:b,lineStart:function(){f.point=k},lineEnd:d,polygonStart:function(){f.lineEnd=e},polygonEnd:function(){f.lineEnd=d;f.point=
b},pointRadius:function(b){return y=He(b),f},result:function(){if(g.length){var b=g.join("");return g=[],b}}};return f}function He(b){return"m0,"+b+"a"+b+","+b+" 0 1,1 0,"+-2*b+"a"+b+","+b+" 0 1,1 0,"+2*b+"z"}function Xa(b,k){Ga+=b;Ha+=k;++xa}function Ie(){function b(b,d){var e=b-k,g=d-a,e=Math.sqrt(e*e+g*g);na+=e*(k+b)/2;oa+=e*(a+d)/2;fa+=e;Xa(k=b,a=d)}var k,a;ua.point=function(d,e){ua.point=b;Xa(k=d,a=e)}}function Je(){ua.point=Xa}function bh(){function b(b,k){var a=b-d,v=k-e,a=Math.sqrt(a*a+v*
v);na+=a*(d+b)/2;oa+=a*(e+k)/2;fa+=a;a=e*b-d*k;Na+=a*(d+b);Oa+=a*(e+k);ya+=3*a;Xa(d=b,e=k)}var k,a,d,e;ua.point=function(y,g){ua.point=b;Xa(k=d=y,a=e=g)};ua.lineEnd=function(){b(k,a)}}function ch(b){function k(k,a){b.moveTo(k,a);b.arc(k,a,g,0,ja)}function a(k,v){b.moveTo(k,v);f.point=d}function d(k,a){b.lineTo(k,a)}function e(){f.point=k}function y(){b.closePath()}var g=4.5,f={point:k,lineStart:function(){f.point=a},lineEnd:e,polygonStart:function(){f.lineEnd=y},polygonEnd:function(){f.lineEnd=e;
f.point=k},pointRadius:function(b){return g=b,f},result:L};return f}function Ke(b){function k(b){return(f?d:a)(b)}function a(k){return Le(k,function(a,v){a=b(a,v);k.point(a[0],a[1])})}function d(k){function a(v,d){v=b(v,d);k.point(v[0],v[1])}function v(){w=0/0;E.point=y;k.lineStart()}function y(a,v){var d=Wa([a,v]),g=b(a,v);e(w,z,t,x,B,A,w=g[0],z=g[1],t=a,x=d[0],B=d[1],A=d[2],f,k);k.point(w,z)}function g(){E.point=a;k.lineEnd()}function I(){v();E.point=h;E.lineEnd=l}function h(b,k){y(m=b,k);n=w;X=
z;p=x;q=B;r=A;E.point=y}function l(){e(w,z,t,x,B,A,n,X,m,p,q,r,f,k);E.lineEnd=g;g()}var m,n,X,p,q,r,t,w,z,x,B,A,E={point:a,lineStart:v,lineEnd:g,polygonStart:function(){k.polygonStart();E.lineStart=I},polygonEnd:function(){k.polygonEnd();E.lineStart=v}};return E}function e(k,a,v,d,I,f,h,l,m,U,n,p,q,r){var t=h-k,w=l-a,z=t*t+w*w;if(z>4*y&&q--){var x=d+U,B=I+n,A=f+p,E=Math.sqrt(x*x+B*B+A*A),eb=Math.asin(A/=E),L=G(G(A)-1)<D||G(v-m)<D?(v+m)/2:Math.atan2(B,x),C=b(L,eb),eb=C[0],C=C[1],N=eb-k,T=C-a,J=w*N-
t*T;(J*J/z>y||.3<G((t*N+w*T)/z-.5)||g>d*U+I*n+f*p)&&(e(k,a,v,d,I,f,eb,C,L,x/=E,B/=E,A,q,r),r.point(eb,C),e(eb,C,L,x,B,A,h,l,m,U,n,p,q,r))}}var y=.5,g=Math.cos(30*J),f=16;return k.precision=function(b){return arguments.length?(f=0<(y=b*b)&&16,k):Math.sqrt(y)},k}function dh(b){var k=Ke(function(k,a){return b([k*R,a*R])});return function(b){return Me(k(b))}}function Ne(b){this.stream=b}function Le(b,k){return{point:k,sphere:function(){b.sphere()},lineStart:function(){b.lineStart()},lineEnd:function(){b.lineEnd()},
polygonStart:function(){b.polygonStart()},polygonEnd:function(){b.polygonEnd()}}}function Qa(b){return bd(function(){return b})()}function bd(b){function k(b){return b=h(b[0]*J,b[1]*J),[b[0]*q+l,m-b[1]*q]}function a(b){return b=h.invert((b[0]-l)/q,(m-b[1])/q),b&&[b[0]*R,b[1]*R]}function d(){h=Fe(f=cd(Ea,M,O),g);var b=g(z,x);return l=r-b[0]*q,m=w+b[1]*q,e()}function e(){return n&&(n.valid=!1,n=null),k}var g,f,h,l,m,n,p=Ke(function(b,k){return b=g(b,k),[b[0]*q+l,m-b[1]*q]}),q=150,r=480,w=250,z=0,x=
0,Ea=0,M=0,O=0,P=Oe,B=Y,ma=null,ha=null;return k.stream=function(b){return n&&(n.valid=!1),n=Me(P(f,p(B(b)))),n.valid=!0,n},k.clipAngle=function(b){return arguments.length?(P=null==b?(ma=b,Oe):Zg((ma=+b)*J),e()):ma},k.clipExtent=function(b){return arguments.length?(ha=b,B=b?Ee(b[0][0],b[0][1],b[1][0],b[1][1]):Y,e()):ha},k.scale=function(b){return arguments.length?(q=+b,d()):q},k.translate=function(b){return arguments.length?(r=+b[0],w=+b[1],d()):[r,w]},k.center=function(b){return arguments.length?
(z=b[0]%360*J,x=b[1]%360*J,d()):[z*R,x*R]},k.rotate=function(b){return arguments.length?(Ea=b[0]%360*J,M=b[1]%360*J,O=2<b.length?b[2]%360*J:0,d()):[Ea*R,M*R,O*R]},t.rebind(k,p,"precision"),function(){return g=b.apply(this,arguments),k.invert=g.invert&&a,d()}}function Me(b){return Le(b,function(k,a){b.point(k*J,a*J)})}function ub(b,k){return[b,k]}function Pe(b,k){return[b>H?b-ja:-H>b?b+ja:b,k]}function cd(b,k,a){return b?k||a?Fe(Qe(b),Re(k,a)):Qe(b):k||a?Re(k,a):Pe}function Se(b){return function(k,
a){return k+=b,[k>H?k-ja:-H>k?k+ja:k,a]}}function Qe(b){var k=Se(b);return k.invert=Se(-b),k}function Re(b,k){function a(b,k){var v=Math.cos(k),h=Math.cos(b)*v,v=Math.sin(b)*v,l=Math.sin(k),m=l*d+h*e;return[Math.atan2(v*g-m*f,h*d-l*e),cb(m*g+v*f)]}var d=Math.cos(b),e=Math.sin(b),g=Math.cos(k),f=Math.sin(k);return a.invert=function(b,k){var a=Math.cos(k),v=Math.cos(b)*a,a=Math.sin(b)*a,h=Math.sin(k),l=h*g-a*f;return[Math.atan2(a*g+h*f,v*d+l*e),cb(l*d-v*e)]},a}function $c(b,k){var a=Math.cos(b),d=Math.sin(b);
return function(e,g,f,h){var l=f*k;null!=e?(e=Te(a,e),g=Te(a,g),(0<f?g>e:e>g)&&(e+=f*ja)):(e=b+f*ja,g=b-.5*l);for(var m;0<f?e>g:g>e;e-=l)h.point((m=Xb([a,-d*Math.cos(e),-d*Math.sin(e)]))[0],m[1])}}function Te(b,k){var a=Wa(k);a[0]-=b;Wb(a);var d=be(-a[1]);return((0>-a[2]?-d:d)+2*Math.PI-D)%(2*Math.PI)}function Ue(b,k,a){var d=t.range(b,k-D,a).concat(k);return function(b){return d.map(function(k){return[b,k]})}}function Ve(b,k,a){var d=t.range(b,k-D,a).concat(k);return function(b){return d.map(function(k){return[k,
b]})}}function dd(b){return b.source}function ed(b){return b.target}function eh(b,k,a,d){var e=Math.cos(k),g=Math.sin(k),f=Math.cos(d),h=Math.sin(d),l=e*Math.cos(b),m=e*Math.sin(b),n=f*Math.cos(a),p=f*Math.sin(a),q=2*Math.asin(Math.sqrt(de(d-k)+e*f*de(a-b))),r=1/Math.sin(q);a=q?function(b){var k=Math.sin(b*=q)*r,a=Math.sin(q-b)*r;b=a*l+k*n;var d=a*m+k*p,k=a*g+k*h;return[Math.atan2(d,b)*R,Math.atan2(k,Math.sqrt(b*b+d*d))*R]}:function(){return[b*R,k*R]};return a.distance=q,a}function vb(b,k){function a(k,
d){var v=Math.cos(k),e=Math.cos(d),v=b(v*e);return[v*e*Math.sin(k),v*Math.sin(d)]}return a.invert=function(b,a){var d=Math.sqrt(b*b+a*a),v=k(d),e=Math.sin(v),v=Math.cos(v);return[Math.atan2(b*e,d*v),Math.asin(d&&a*e/d)]},a}function We(b,k){function a(b,k){0<g?-Z+D>k&&(k=-Z+D):k>Z-D&&(k=Z-D);var d=g/Math.pow(Math.tan(H/4+k/2),e);return[d*Math.sin(e*b),g-d*Math.cos(e*b)]}var d=Math.cos(b),e=b===k?Math.sin(b):Math.log(d/Math.cos(k))/Math.log(Math.tan(H/4+k/2)/Math.tan(H/4+b/2)),g=d*Math.pow(Math.tan(H/
4+b/2),e)/e;return e?(a.invert=function(b,k){var a=g-k,d=(0<e?1:0>e?-1:0)*Math.sqrt(b*b+a*a);return[Math.atan2(b,a)/e,2*Math.atan(Math.pow(g/d,1/e))-Z]},a):bc}function Xe(b,k){function a(b,k){var d=g-k;return[d*Math.sin(e*b),g-d*Math.cos(e*b)]}var d=Math.cos(b),e=b===k?Math.sin(b):(d-Math.cos(k))/(k-b),g=d/e+b;return G(e)<D?ub:(a.invert=function(b,k){var a=g-k;return[Math.atan2(b,a)/e,g-(0<e?1:0>e?-1:0)*Math.sqrt(b*b+a*a)]},a)}function bc(b,k){return[b,Math.log(Math.tan(H/4+k/2))]}function Ye(b){var k,
a=Qa(b),d=a.scale,e=a.translate,g=a.clipExtent;return a.scale=function(){var b=d.apply(a,arguments);return b===a?k?a.clipExtent(null):a:b},a.translate=function(){var b=e.apply(a,arguments);return b===a?k?a.clipExtent(null):a:b},a.clipExtent=function(b){var f=g.apply(a,arguments);if(f===a){if(k=null==b){var h=H*d(),l=e();g([[l[0]-h,l[1]-h],[l[0]+h,l[1]+h]])}}else k&&(f=null);return f},a.clipExtent(null)}function fd(b,k){return[Math.log(Math.tan(H/4+k/2)),-b]}function ib(b){return b[0]}function wb(b){return b[1]}
function Ze(b){for(var k=b.length,a=[0,1],d=2,e=2;k>e;e++){for(;1<d&&0>=Lc(b[a[d-2]],b[a[d-1]],b[e]);)--d;a[d++]=e}return a.slice(0,d)}function fh(b,k){return b[0]-k[0]||b[1]-k[1]}function gd(b,k,a){return(a[0]-k[0])*(b[1]-k[1])<(a[1]-k[1])*(b[0]-k[0])}function $e(b,k,a,d){var e=b[0],g=a[0],f=k[0]-e,h=d[0]-g;b=b[1];a=a[1];k=k[1]-b;d=d[1]-a;g=(h*(b-a)-d*(e-g))/(d*f-h*k);return[e+g*f,b+g*k]}function af(b){var k=b[0];b=b[b.length-1];return!(k[0]-b[0]||k[1]-b[1])}function gh(){cc(this);this.edge=this.site=
this.circle=null}function bf(b){var k=cf.pop()||new gh;return k.site=b,k}function hd(b){jb(b);kb.remove(b);cf.push(b);cc(b)}function df(b,k){var a=b.site,d=a.x,e=a.y,g=e-k;if(!g)return d;var f=b.P;if(!f)return-1/0;var a=f.site,f=a.x,a=a.y,h=a-k;if(!h)return f;var l=f-d,m=1/g-1/h,n=l/h;return m?(-n+Math.sqrt(n*n-2*m*(l*l/(-2*h)-a+h/2+e-g/2)))/m+d:(d+f)/2}function ef(b){this.site=b;this.edges=[]}function ff(b,k){return k.angle-b.angle}function hh(){cc(this);this.x=this.y=this.arc=this.site=this.cy=
null}function lb(b){var k=b.P,a=b.N;if(k&&a){var d=k.site,k=b.site,e=a.site;if(d!==e){var a=k.x,g=k.y,f=d.x-a,h=d.y-g,d=e.x-a,e=e.y-g,l=2*(f*e-h*d);if(!(l>=-id)){var m=f*f+h*h,n=d*d+e*e,h=(e*m-h*n)/l,f=(f*n-d*m)/l,e=f+g,g=gf.pop()||new hh;g.arc=b;g.site=k;g.x=h+a;g.y=e+Math.sqrt(h*h+f*f);g.cy=e;b.circle=g;b=null;for(k=xb._;k;)if(g.y<k.y||g.y===k.y&&g.x<=k.x){if(!k.L){b=k.P;break}k=k.L}else{if(!k.R){b=k;break}k=k.R}xb.insert(b,g);b||(jd=g)}}}}function jb(b){var k=b.circle;k&&(k.P||(jd=k.N),xb.remove(k),
gf.push(k),cc(k),b.circle=null)}function ih(b,k){var a=b.b;if(a)return!0;var d,e,g=b.a,a=k[0][0],f=k[1][0],h=k[0][1],l=k[1][1],m=b.l,n=b.r,p=m.x,m=m.y,q=n.x,n=n.y;e=(p+q)/2;if(n===m){if(a>e||e>=f)return;if(p>q){if(g){if(g.y>=l)return}else g={x:e,y:h};a={x:e,y:l}}else{if(g){if(g.y<h)return}else g={x:e,y:l};a={x:e,y:h}}}else if(d=(p-q)/(n-m),e=(m+n)/2-d*e,-1>d||1<d)if(p>q){if(g){if(g.y>=l)return}else g={x:(h-e)/d,y:h};a={x:(l-e)/d,y:l}}else{if(g){if(g.y<h)return}else g={x:(l-e)/d,y:l};a={x:(h-e)/d,
y:h}}else if(n>m){if(g){if(g.x>=f)return}else g={x:a,y:d*a+e};a={x:f,y:d*f+e}}else{if(g){if(g.x<a)return}else g={x:f,y:d*f+e};a={x:a,y:d*a+e}}return b.a=g,b.b=a,!0}function hf(b,k){this.l=b;this.r=k;this.a=this.b=null}function yb(b,k,a,d){var e=new hf(b,k);return mb.push(e),a&&dc(e,b,k,a),d&&dc(e,k,b,d),Ya[b.i].edges.push(new ec(e,b,k)),Ya[k.i].edges.push(new ec(e,k,b)),e}function jh(b,k,a){b=new hf(b,null);return b.a=k,b.b=a,mb.push(b),b}function dc(b,k,a,d){b.a||b.b?b.l===a?b.b=d:b.a=d:(b.a=d,b.l=
k,b.r=a)}function ec(b,k,a){var d=b.a,e=b.b;this.edge=b;this.site=k;this.angle=a?Math.atan2(a.y-k.y,a.x-k.x):b.l===k?Math.atan2(e.x-d.x,d.y-e.y):Math.atan2(d.x-e.x,e.y-d.y)}function kd(){this._=null}function cc(b){b.U=b.C=b.L=b.R=b.P=b.N=null}function zb(b,k){var a=k.R,d=k.U;d?d.L===k?d.L=a:d.R=a:b._=a;a.U=d;k.U=a;k.R=a.L;k.R&&(k.R.U=k);a.L=k}function Ab(b,k){var a=k.L,d=k.U;d?d.L===k?d.L=a:d.R=a:b._=a;a.U=d;k.U=a;k.L=a.R;k.L&&(k.L.U=k);a.R=k}function jf(b){for(;b.L;)b=b.L;return b}function ld(b,
k){var a,d,e,g=b.sort(kh).pop();mb=[];Ya=Array(b.length);kb=new kd;for(xb=new kd;;)if(e=jd,g&&(!e||g.y<e.y||g.y===e.y&&g.x<e.x)){if(g.x!==a||g.y!==d){Ya[g.i]=new ef(g);a=g;for(var f=d=void 0,h=void 0,l=void 0,m=a.x,n=a.y,p=kb._;p;)if(h=df(p,n)-m,h>D)p=p.L;else{var q;var r=p;q=n;var t=r.N;t?q=df(t,q):(r=r.site,q=r.y===q?r.x:1/0);if(l=m-q,!(l>D)){h>-D?(d=p.P,f=p):l>-D?(d=p,f=p.N):d=f=p;break}if(!p.R){d=p;break}p=p.R}h=bf(a);if(kb.insert(d,h),d||f)if(d===f)jb(d),f=bf(d.site),kb.insert(h,f),h.edge=f.edge=
yb(d.site,h.site),lb(d),lb(f);else if(f){jb(d);jb(f);l=d.site;n=l.x;p=l.y;q=a.x-n;var r=a.y-p,m=f.site,t=m.x-n,w=m.y-p,z=2*(q*w-r*t),x=q*q+r*r,M=t*t+w*w,n={x:(w*x-r*M)/z+n,y:(q*M-t*x)/z+p};dc(f.edge,l,m,n);h.edge=yb(l,a,null,n);f.edge=yb(a,m,null,n);lb(d);lb(f)}else h.edge=yb(d.site,h.site);a=g.x;d=g.y}g=b.pop()}else{if(!e)break;m=e.arc;f=m.circle;l=f.x;n=f.cy;f={x:l,y:n};q=m.P;p=m.N;h=[m];hd(m);for(m=q;m.circle&&G(l-m.circle.x)<D&&G(n-m.circle.cy)<D;)q=m.P,h.unshift(m),hd(m),m=q;h.unshift(m);jb(m);
for(q=p;q.circle&&G(l-q.circle.x)<D&&G(n-q.circle.cy)<D;)p=q.N,h.push(q),hd(q),q=p;h.push(q);jb(q);l=void 0;n=h.length;for(l=1;n>l;++l)q=h[l],m=h[l-1],dc(q.edge,m.site,q.site,f);m=h[0];q=h[n-1];q.edge=yb(m.site,q.site,null,f);lb(m);lb(q)}if(k){g=mb;a=De(k[0][0],k[0][1],k[1][0],k[1][1]);for(d=g.length;d--;)e=g[d],(!ih(e,k)||!a(e)||G(e.a.x-e.b.x)<D&&G(e.a.y-e.b.y)<D)&&(e.a=e.b=null,g.splice(d,1));var O,m=k[0][0],n=k[1][0],p=k[0][1];q=k[1][1];r=Ya;for(t=r.length;t--;)if(O=r[t],O&&O.prepare())for(f=O.edges,
h=f.length,d=0;h>d;)l=f[d].end(),g=l.x,a=l.y,w=f[++d%h].start(),e=w.x,w=w.y,(G(g-e)>D||G(a-w)>D)&&(f.splice(d,0,new ec(jh(O.site,l,G(g-m)<D&&q-a>D?{x:m,y:G(e-m)<D?w:q}:G(a-q)<D&&n-g>D?{x:G(w-q)<D?e:n,y:q}:G(g-n)<D&&a-p>D?{x:n,y:G(e-n)<D?w:p}:G(a-p)<D&&g-m>D?{x:G(w-p)<D?e:m,y:p}:null),O.site,null)),++h)}O={cells:Ya,edges:mb};return kb=xb=mb=Ya=null,O}function kh(b,k){return k.y-b.y||k.x-b.x}function lh(b){return b.x}function mh(b){return b.y}function kf(){return{leaf:!0,nodes:[],point:null,x:null,
y:null}}function Bb(b,k,a,d,e,g){if(!b(k,a,d,e,g)){var f=.5*(a+e),h=.5*(d+g);k=k.nodes;k[0]&&Bb(b,k[0],a,d,f,h);k[1]&&Bb(b,k[1],f,d,e,h);k[2]&&Bb(b,k[2],a,h,f,g);k[3]&&Bb(b,k[3],f,h,e,g)}}function md(b,k){b=t.rgb(b);k=t.rgb(k);var a=b.r,d=b.g,e=b.b,g=k.r-a,f=k.g-d,h=k.b-e;return function(b){return"#"+db(Math.round(a+g*b))+db(Math.round(d+f*b))+db(Math.round(e+h*b))}}function lf(b,k){var a,d={},e={};for(a in b)a in k?d[a]=Za(b[a],k[a]):e[a]=b[a];for(a in k)a in b||(e[a]=k[a]);return function(b){for(a in d)e[a]=
d[a](b);return e}}function Ia(b,k){return b=+b,k=+k,function(a){return b*(1-a)+k*a}}function mf(b,k){var a,d,e,g=nd.lastIndex=od.lastIndex=0,f=-1,h=[],l=[];b+="";for(k+="";(a=nd.exec(b))&&(d=od.exec(k));)(e=d.index)>g&&(e=k.slice(g,e),h[f]?h[f]+=e:h[++f]=e),(a=a[0])===(d=d[0])?h[f]?h[f]+=d:h[++f]=d:(h[++f]=null,l.push({i:f,x:Ia(a,d)})),g=od.lastIndex;return g<k.length&&(e=k.slice(g),h[f]?h[f]+=e:h[++f]=e),2>h.length?l[0]?(k=l[0].x,function(b){return k(b)+""}):function(){return k}:(k=l.length,function(b){for(var a,
d=0;k>d;++d)h[(a=l[d]).i]=a.x(b);return h.join("")})}function Za(b,k){for(var a,d=t.interpolators.length;0<=--d&&!(a=t.interpolators[d](b,k)););return a}function fc(b,k){var a,d=[],e=[],g=b.length,f=k.length,h=Math.min(b.length,k.length);for(a=0;h>a;++a)d.push(Za(b[a],k[a]));for(;g>a;++a)e[a]=b[a];for(;f>a;++a)e[a]=k[a];return function(b){for(a=0;h>a;++a)e[a]=d[a](b);return e}}function nh(b){return function(k){return 0>=k?0:1<=k?1:b(k)}}function nf(b){return function(k){return 1-b(1-k)}}function of(b){return function(k){return.5*
(.5>k?b(2*k):2-b(2-2*k))}}function oh(b){return b*b}function ph(b){return b*b*b}function qh(b){if(0>=b)return 0;if(1<=b)return 1;var k=b*b,a=k*b;return 4*(.5>b?a:3*(b-k)+a-.75)}function rh(b){return 1-Math.cos(b*Z)}function sh(b){return Math.pow(2,10*(b-1))}function th(b){return 1-Math.sqrt(1-b*b)}function uh(b){return 1/2.75>b?7.5625*b*b:2/2.75>b?7.5625*(b-=1.5/2.75)*b+.75:2.5/2.75>b?7.5625*(b-=2.25/2.75)*b+.9375:7.5625*(b-=2.625/2.75)*b+.984375}function pf(b,k){return k-=b,function(a){return Math.round(b+
k*a)}}function qf(b){var k=[b.a,b.b],a=[b.c,b.d],d=rf(k),e=k[0]*a[0]+k[1]*a[1],g;g=-e;g=(a[0]+=g*k[0],a[1]+=g*k[1],a);g=rf(g)||0;k[0]*a[1]<a[0]*k[1]&&(k[0]*=-1,k[1]*=-1,d*=-1,e*=-1);this.rotate=(d?Math.atan2(k[1],k[0]):Math.atan2(-a[0],a[1]))*R;this.translate=[b.e,b.f];this.scale=[d,g];this.skew=g?Math.atan2(e,g)*R:0}function rf(b){var k=Math.sqrt(b[0]*b[0]+b[1]*b[1]);return k&&(b[0]/=k,b[1]/=k),k}function sf(b,k){var a,d=[],e=[],g=t.transform(b),f=t.transform(k),h=g.translate,l=f.translate,m=g.rotate,
n=f.rotate,p=g.skew,q=f.skew,g=g.scale,f=f.scale;return h[0]!=l[0]||h[1]!=l[1]?(d.push("translate(",null,",",null,")"),e.push({i:1,x:Ia(h[0],l[0])},{i:3,x:Ia(h[1],l[1])})):l[0]||l[1]?d.push("translate("+l+")"):d.push(""),m!=n?(180<m-n?n+=360:180<n-m&&(m+=360),e.push({i:d.push(d.pop()+"rotate(",null,")")-2,x:Ia(m,n)})):n&&d.push(d.pop()+"rotate("+n+")"),p!=q?e.push({i:d.push(d.pop()+"skewX(",null,")")-2,x:Ia(p,q)}):q&&d.push(d.pop()+"skewX("+q+")"),g[0]!=f[0]||g[1]!=f[1]?(a=d.push(d.pop()+"scale(",
null,",",null,")"),e.push({i:a-4,x:Ia(g[0],f[0])},{i:a-2,x:Ia(g[1],f[1])})):(1!=f[0]||1!=f[1])&&d.push(d.pop()+"scale("+f+")"),a=e.length,function(b){for(var k,g=-1;++g<a;)d[(k=e[g]).i]=k.x(b);return d.join("")}}function vh(b,k){return k=(k-=b=+b)||1/k,function(a){return(a-b)/k}}function wh(b,k){return k=(k-=b=+b)||1/k,function(a){return Math.max(0,Math.min(1,(a-b)/k))}}function xh(b){var k=b.source;b=b.target;var a;var d=b;if(k===d)a=k;else{a=tf(k);for(var d=tf(d),e=a.pop(),g=d.pop(),f=null;e===
g;)f=e,e=a.pop(),g=d.pop();a=f}for(d=[k];k!==a;)k=k.parent,d.push(k);for(k=d.length;b!==a;)d.splice(k,0,b),b=b.parent;return d}function tf(b){for(var k=[],a=b.parent;null!=a;)k.push(b),b=a,a=a.parent;return k.push(b),k}function yh(b){b.fixed|=2}function zh(b){b.fixed&=-7}function Ah(b){b.fixed|=4;b.px=b.x;b.py=b.y}function Bh(b){b.fixed&=-5}function uf(b,k,a){var d=0,e=0;if(b.charge=0,!b.leaf)for(var g,f=b.nodes,h=f.length,l=-1;++l<h;)g=f[l],null!=g&&(uf(g,k,a),b.charge+=g.charge,d+=g.charge*g.cx,
e+=g.charge*g.cy);b.point&&(b.leaf||(b.point.x+=Math.random()-.5,b.point.y+=Math.random()-.5),k*=a[b.point.index],b.charge+=b.pointCharge=k,d+=k*b.point.x,e+=k*b.point.y);b.cx=d/b.charge;b.cy=e/b.charge}function Cb(b,k){return t.rebind(b,k,"sort","children","value"),b.nodes=b,b.links=Ch,b}function Db(b,k){for(var a=[b];null!=(b=a.pop());)if(k(b),(e=b.children)&&(d=e.length))for(var d,e;0<=--d;)a.push(e[d])}function za(b,k){for(var a=[b],d=[];null!=(b=a.pop());)if(d.push(b),(g=b.children)&&(e=g.length))for(var e,
g,f=-1;++f<e;)a.push(g[f]);for(;null!=(b=d.pop());)k(b)}function Dh(b){return b.children}function Eh(b){return b.value}function Fh(b,k){return k.value-b.value}function Ch(b){return t.merge(b.map(function(b){return(b.children||[]).map(function(a){return{source:b,target:a}})}))}function Gh(b){return b.x}function Hh(b){return b.y}function Ih(b,k,a){b.y0=k;b.y=a}function pd(b){return t.range(b.length)}function qd(b){var k=-1;b=b[0].length;for(var a=[];++k<b;)a[k]=0;return a}function Jh(b){for(var k,a=
1,d=0,e=b[0][1],g=b.length;g>a;++a)(k=b[a][1])>e&&(d=a,e=k);return d}function Kh(b){return b.reduce(Lh,0)}function Lh(b,k){return b+k[1]}function Mh(b,k){return vf(b,Math.ceil(Math.log(k.length)/Math.LN2+1))}function vf(b,k){for(var a=-1,d=+b[0],e=(b[1]-d)/k,g=[];++a<=k;)g[a]=e*a+d;return g}function Nh(b){return[t.min(b),t.max(b)]}function Oh(b,k){return b.value-k.value}function rd(b,k){var a=b._pack_next;b._pack_next=k;k._pack_prev=b;k._pack_next=a;a._pack_prev=k}function wf(b,k){b._pack_next=k;
k._pack_prev=b}function xf(b,k){var a=k.x-b.x,d=k.y-b.y,e=b.r+k.r;return.999*e*e>a*a+d*d}function yf(b){function k(b){n=Math.min(b.x-b.r,n);p=Math.max(b.x+b.r,p);q=Math.min(b.y-b.r,q);r=Math.max(b.y+b.r,r)}if((a=b.children)&&(m=a.length)){var a,d,e,g,f,h,l,m,n=1/0,p=-1/0,q=1/0,r=-1/0;if(a.forEach(Ph),d=a[0],d.x=-d.r,d.y=0,k(d),1<m&&(e=a[1],e.x=e.r,e.y=0,k(e),2<m))for(g=a[2],zf(d,e,g),k(g),rd(d,g),d._pack_prev=g,rd(g,e),e=d._pack_next,f=3;m>f;f++){zf(d,e,g=a[f]);var t=0,w=1,z=1;for(h=e._pack_next;h!==
e;h=h._pack_next,w++)if(xf(h,g)){t=1;break}if(1==t)for(l=d._pack_prev;l!==h._pack_prev&&!xf(l,g);l=l._pack_prev,z++);t?(z>w||w==z&&e.r<d.r?wf(d,e=h):wf(d=l,e),f--):(rd(d,g),e=g,k(g))}d=(n+p)/2;e=(q+r)/2;for(f=h=0;m>f;f++)g=a[f],g.x-=d,g.y-=e,h=Math.max(h,g.r+Math.sqrt(g.x*g.x+g.y*g.y));b.r=h;a.forEach(Qh)}}function Ph(b){b._pack_next=b._pack_prev=b}function Qh(b){delete b._pack_next;delete b._pack_prev}function Af(b,k,a,d){var e=b.children;if(b.x=k+=d*b.x,b.y=a+=d*b.y,b.r*=d,e){b=-1;for(var g=e.length;++b<
g;)Af(e[b],k,a,d)}}function zf(b,k,a){var d=b.r+a.r,e=k.x-b.x,g=k.y-b.y;if(d&&(e||g)){var f=k.r+a.r,h=e*e+g*g,f=f*f,d=d*d;k=.5+(d-f)/(2*h);f=Math.sqrt(Math.max(0,2*f*(d+h)-(d-=h)*d-f*f))/(2*h);a.x=b.x+k*e+f*g;a.y=b.y+k*g-f*e}else a.x=b.x+d,a.y=b.y}function Bf(b,k){return b.parent==k.parent?1:2}function sd(b){var k=b.children;return k.length?k[0]:b.t}function td(b){var k,a=b.children;return(k=a.length)?a[k-1]:b.t}function Rh(b){return 1+t.max(b,function(b){return b.y})}function Sh(b){return b.reduce(function(b,
a){return b+a.x},0)/b.length}function Cf(b){var k=b.children;return k&&k.length?Cf(k[0]):b}function Df(b){var k,a=b.children;return a&&(k=a.length)?Df(a[k-1]):b}function ud(b){return{x:b.x,y:b.y,dx:b.dx,dy:b.dy}}function Ef(b,k){var a=b.x+k[3],d=b.y+k[0],e=b.dx-k[1]-k[3],g=b.dy-k[0]-k[2];return 0>e&&(a+=e/2,e=0),0>g&&(d+=g/2,g=0),{x:a,y:d,dx:e,dy:g}}function nb(b){var k=b[0];b=b[b.length-1];return b>k?[k,b]:[b,k]}function gc(b){return b.rangeExtent?b.rangeExtent():nb(b.range())}function Th(b,k,a,
d){var e=a(b[0],b[1]),g=d(k[0],k[1]);return function(b){return g(e(b))}}function hc(b,k){var a,d=0,e=b.length-1,g=b[d],f=b[e];return g>f&&(a=d,d=e,e=a,a=g,g=f,f=a),b[d]=k.floor(g),b[e]=k.ceil(f),b}function Ff(b){return b?{floor:function(a){return Math.floor(a/b)*b},ceil:function(a){return Math.ceil(a/b)*b}}:Uh}function Vh(b,a,d,e){var g=[],f=[],h=0,l=Math.min(b.length,a.length)-1;for(b[l]<b[0]&&(b=b.slice().reverse(),a=a.slice().reverse());++h<=l;)g.push(d(b[h-1],b[h])),f.push(e(a[h-1],a[h]));return function(a){var k=
t.bisect(b,a,1,l)-1;return f[k](g[k](a))}}function Gf(b,a,d,e){function g(){var m=2<Math.min(b.length,a.length)?Vh:Th,n=e?wh:vh;return h=m(b,a,n,d),l=m(a,b,n,Za),f}function f(b){return h(b)}var h,l;return f.invert=function(b){return l(b)},f.domain=function(a){return arguments.length?(b=a.map(Number),g()):b},f.range=function(b){return arguments.length?(a=b,g()):a},f.rangeRound=function(b){return f.range(b).interpolate(pf)},f.clamp=function(b){return arguments.length?(e=b,g()):e},f.interpolate=function(b){return arguments.length?
(d=b,g()):d},f.ticks=function(a){return t.range.apply(t,Ra(b,a))},f.tickFormat=function(a,k){return vd(b,a,k)},f.nice=function(a){return hc(b,Ff(Ra(b,a)[2])),g()},f.copy=function(){return Gf(b,a,d,e)},g()}function wd(b,a){return t.rebind(b,a,"range","rangeRound","interpolate","clamp")}function Ra(b,a){null==a&&(a=10);var d=nb(b),e=d[1]-d[0],g=Math.pow(10,Math.floor(Math.log(e/a)/Math.LN10)),e=a/e*g;return.15>=e?g*=10:.35>=e?g*=5:.75>=e&&(g*=2),d[0]=Math.ceil(d[0]/g)*g,d[1]=Math.floor(d[1]/g)*g+.5*
g,d[2]=g,d}function vd(b,a,d){b=Ra(b,a);if(d){a=pe.exec(d);if(a.shift(),"s"===a[8]){var e=t.formatPrefix(Math.max(G(b[0]),G(b[1])));return a[7]||(a[7]="."+ic(e.scale(b[2]))),a[8]="f",d=t.format(a.join("")),function(b){return d(e.scale(b))+e.symbol}}a[7]||(a[7]="."+Wh(a[8],b));d=a.join("")}else d=",."+ic(b[2])+"f";return t.format(d)}function ic(b){return-Math.floor(Math.log(b)/Math.LN10+.01)}function Wh(b,a){var d=ic(a[2]);return b in Xh?Math.abs(d-ic(Math.max(G(a[0]),G(a[1]))))+ +("e"!==b):d-2*("%"===
b)}function Hf(b,a,d,e){function g(b){return(d?Math.log(0>b?0:b):-Math.log(0<b?0:-b))/Math.log(a)}function f(b){return d?Math.pow(a,b):-Math.pow(a,-b)}function h(a){return b(g(a))}return h.invert=function(a){return f(b.invert(a))},h.domain=function(a){return arguments.length?(d=0<=a[0],b.domain((e=a.map(Number)).map(g)),h):e},h.base=function(d){return arguments.length?(a=+d,b.domain(e.map(g)),h):a},h.nice=function(){var a=hc(e.map(g),d?Math:Yh);return b.domain(a),e=a.map(f),h},h.ticks=function(){var b=
nb(e),h=[],l=b[0],b=b[1],m=Math.floor(g(l)),n=Math.ceil(g(b)),p=a%1?2:a;if(isFinite(n-m)){if(d){for(;n>m;m++)for(var q=1;p>q;q++)h.push(f(m)*q);h.push(f(m))}else for(h.push(f(m));m++<n;)for(q=p-1;0<q;q--)h.push(f(m)*q);for(m=0;h[m]<l;m++);for(n=h.length;h[n-1]>b;n--);h=h.slice(m,n)}return h},h.tickFormat=function(b,a){if(!arguments.length)return If;2>arguments.length?a=If:"function"!=typeof a&&(a=t.format(a));var k,e=Math.max(.1,b/h.ticks().length),l=d?(k=1E-12,Math.ceil):(k=-1E-12,Math.floor);return function(b){return b/
f(l(g(b)+k))<=e?a(b):""}},h.copy=function(){return Hf(b.copy(),a,d,e)},wd(h,b)}function Jf(b,a,d){function e(a){return b(g(a))}var g=jc(a),f=jc(1/a);return e.invert=function(a){return f(b.invert(a))},e.domain=function(a){return arguments.length?(b.domain((d=a.map(Number)).map(g)),e):d},e.ticks=function(b){return t.range.apply(t,Ra(d,b))},e.tickFormat=function(b,a){return vd(d,b,a)},e.nice=function(b){return e.domain(hc(d,Ff(Ra(d,b)[2])))},e.exponent=function(h){return arguments.length?(g=jc(a=h),
f=jc(1/a),b.domain(d.map(g)),e):a},e.copy=function(){return Jf(b.copy(),a,d)},wd(e,b)}function jc(b){return function(a){return 0>a?-Math.pow(-a,b):Math.pow(a,b)}}function Kf(b,a){function d(e){return f[((g.get(e)||("range"===a.t?g.set(e,b.push(e)):0/0))-1)%f.length]}function e(a,k){return t.range(b.length).map(function(b){return a+k*b})}var g,f,h;return d.domain=function(e){if(!arguments.length)return b;b=[];g=new l;for(var f,h=-1,y=e.length;++h<y;)g.has(f=e[h])||g.set(f,b.push(f));return d[a.t].apply(d,
a.a)},d.range=function(b){return arguments.length?(f=b,h=0,a={t:"range",a:arguments},d):f},d.rangePoints=function(g,l){2>arguments.length&&(l=0);var m=g[0],n=g[1],F=(n-m)/(Math.max(1,b.length-1)+l);return f=e(2>b.length?(m+n)/2:m+F*l/2,F),h=0,a={t:"rangePoints",a:arguments},d},d.rangeBands=function(g,l,m){2>arguments.length&&(l=0);3>arguments.length&&(m=l);var n=g[1]<g[0],F=g[n-0],p=(g[1-n]-F)/(b.length-l+2*m);return f=e(F+p*m,p),n&&f.reverse(),h=p*(1-l),a={t:"rangeBands",a:arguments},d},d.rangeRoundBands=
function(g,l,m){2>arguments.length&&(l=0);3>arguments.length&&(m=l);var n=g[1]<g[0],F=g[n-0],p=g[1-n],q=Math.floor((p-F)/(b.length-l+2*m));return f=e(F+Math.round((p-F-(b.length-l)*q)/2),q),n&&f.reverse(),h=Math.round(q*(1-l)),a={t:"rangeRoundBands",a:arguments},d},d.rangeBand=function(){return h},d.rangeExtent=function(){return nb(a.a[0])},d.copy=function(){return Kf(b,a)},d.domain(b)}function Lf(b,a){function d(){var e=0,f=a.length;for(l=[];++e<f;)l[e-1]=t.quantile(b,e/f);return g}function g(b){return isNaN(b=
+b)?void 0:a[t.bisect(l,b)]}var l;return g.domain=function(a){return arguments.length?(b=a.map(f).filter(e).sort(h),d()):b},g.range=function(b){return arguments.length?(a=b,d()):a},g.quantiles=function(){return l},g.invertExtent=function(d){return d=a.indexOf(d),0>d?[0/0,0/0]:[0<d?l[d-1]:b[0],d<l.length?l[d]:b[b.length-1]]},g.copy=function(){return Lf(b,a)},d()}function Mf(b,a,d){function e(a){return d[Math.max(0,Math.min(h,Math.floor(f*(a-b))))]}function g(){return f=d.length/(a-b),h=d.length-1,
e}var f,h;return e.domain=function(d){return arguments.length?(b=+d[0],a=+d[d.length-1],g()):[b,a]},e.range=function(b){return arguments.length?(d=b,g()):d},e.invertExtent=function(a){return a=d.indexOf(a),a=0>a?0/0:a/f+b,[a,a+1/f]},e.copy=function(){return Mf(b,a,d)},g()}function Nf(b,a){function d(e){return e>=e?a[t.bisect(b,e)]:void 0}return d.domain=function(a){return arguments.length?(b=a,d):b},d.range=function(b){return arguments.length?(a=b,d):a},d.invertExtent=function(d){return d=a.indexOf(d),
[b[d-1],b[d]]},d.copy=function(){return Nf(b,a)},d}function Of(b){function a(b){return+b}return a.invert=a,a.domain=a.range=function(d){return arguments.length?(b=d.map(a),a):b},a.ticks=function(a){return t.range.apply(t,Ra(b,a))},a.tickFormat=function(a,k){return vd(b,a,k)},a.copy=function(){return Of(b)},a}function Zh(b){return b.innerRadius}function $h(b){return b.outerRadius}function Pf(b){return b.startAngle}function Qf(b){return b.endAngle}function Rf(b){function a(k){function h(){n.push("M",
f(b(p),l))}for(var m,n=[],p=[],q=-1,r=k.length,t=Q(d),X=Q(e);++q<r;)g.call(this,m=k[q],q)?p.push([+t.call(this,m,q),+X.call(this,m,q)]):p.length&&(h(),p=[]);return p.length&&h(),n.length?n.join(""):null}var d=ib,e=wb,g=hb,f=ka,h=f.key,l=.7;return a.x=function(b){return arguments.length?(d=b,a):d},a.y=function(b){return arguments.length?(e=b,a):e},a.defined=function(b){return arguments.length?(g=b,a):g},a.interpolate=function(b){return arguments.length?(h="function"==typeof b?f=b:(f=xd.get(b)||ka).key,
a):h},a.tension=function(b){return arguments.length?(l=b,a):l},a}function ka(b){return b.join("L")}function yd(b){for(var a=0,d=b.length,e=b[0],g=[e[0],",",e[1]];++a<d;)g.push("V",(e=b[a])[1],"H",e[0]);return g.join("")}function zd(b){for(var a=0,d=b.length,e=b[0],g=[e[0],",",e[1]];++a<d;)g.push("H",(e=b[a])[0],"V",e[1]);return g.join("")}function kc(b,a){if(1>a.length||b.length!=a.length&&b.length!=a.length+2)return ka(b);var d=b.length!=a.length,e="",g=b[0],f=b[1],h=a[0],l=h,m=1;if(d&&(e+="Q"+(f[0]-
2*h[0]/3)+","+(f[1]-2*h[1]/3)+","+f[0]+","+f[1],g=b[1],m=2),1<a.length)for(l=a[1],f=b[m],m++,e+="C"+(g[0]+h[0])+","+(g[1]+h[1])+","+(f[0]-l[0])+","+(f[1]-l[1])+","+f[0]+","+f[1],g=2;g<a.length;g++,m++)f=b[m],l=a[g],e+="S"+(f[0]-l[0])+","+(f[1]-l[1])+","+f[0]+","+f[1];d&&(d=b[m],e+="Q"+(f[0]+2*l[0]/3)+","+(f[1]+2*l[1]/3)+","+d[0]+","+d[1]);return e}function Ad(b,a){for(var d,e=[],g=(1-a)/2,f=b[0],h=b[1],l=1,m=b.length;++l<m;)d=f,f=h,h=b[l],e.push([g*(h[0]-d[0]),g*(h[1]-d[1])]);return e}function Sf(b){if(3>
b.length)return ka(b);var a=1,d=b.length,e=b[0],g=e[0],f=e[1],h=[g,g,g,(e=b[1])[0]],l=[f,f,f,e[1]],g=[g,",",f,"L",pa(Sa,h),",",pa(Sa,l)];for(b.push(b[d-1]);++a<=d;)e=b[a],h.shift(),h.push(e[0]),l.shift(),l.push(e[1]),Bd(g,h,l);return b.pop(),g.push("L",e),g.join("")}function pa(b,a){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]*a[3]}function Bd(b,a,d){b.push("C",pa(Tf,a),",",pa(Tf,d),",",pa(Uf,a),",",pa(Uf,d),",",pa(Sa,a),",",pa(Sa,d))}function Cd(b,a){return(a[1]-b[1])/(a[0]-b[0])}function Vf(b){for(var a,
d,e,g=-1,f=b.length;++g<f;)a=b[g],d=a[0],e=a[1]+$a,a[0]=d*Math.cos(e),a[1]=d*Math.sin(e);return b}function Wf(b){function a(k){function m(){w.push("M",l(b(O),q),p,n(b(z.reverse()),q),"Z")}for(var r,t,Vd,w=[],z=[],O=[],x=-1,B=k.length,ma=Q(d),ha=Q(g),A=d===e?function(){return t}:Q(e),E=g===f?function(){return Vd}:Q(f);++x<B;)h.call(this,r=k[x],x)?(z.push([t=+ma.call(this,r,x),Vd=+ha.call(this,r,x)]),O.push([+A.call(this,r,x),+E.call(this,r,x)])):z.length&&(m(),z=[],O=[]);return z.length&&m(),w.length?
w.join(""):null}var d=ib,e=ib,g=0,f=wb,h=hb,l=ka,m=l.key,n=l,p="L",q=.7;return a.x=function(b){return arguments.length?(d=e=b,a):e},a.x0=function(b){return arguments.length?(d=b,a):d},a.x1=function(b){return arguments.length?(e=b,a):e},a.y=function(b){return arguments.length?(g=f=b,a):f},a.y0=function(b){return arguments.length?(g=b,a):g},a.y1=function(b){return arguments.length?(f=b,a):f},a.defined=function(b){return arguments.length?(h=b,a):h},a.interpolate=function(b){return arguments.length?(m=
"function"==typeof b?l=b:(l=xd.get(b)||ka).key,n=l.reverse||l,p=l.closed?"M":"L",a):m},a.tension=function(b){return arguments.length?(q=b,a):q},a}function ai(b){return b.radius}function Xf(b){return[b.x,b.y]}function bi(b){return function(){var a=b.apply(this,arguments),d=a[0],a=a[1]+$a;return[d*Math.cos(a),d*Math.sin(a)]}}function ci(){return 64}function di(){return"circle"}function Yf(b){b=Math.sqrt(b/H);return"M0,"+b+"A"+b+","+b+" 0 1,1 0,"+-b+"A"+b+","+b+" 0 1,1 0,"+b+"Z"}function Eb(b,a){return Fb(b,
W),b.id=a,b}function Dd(b,a,d,e){var g=b.id;return Aa(b,"function"==typeof d?function(b,f,h){b.__transition__[g].tween.set(a,e(d.call(b,b.__data__,f,h)))}:(d=e(d),function(b){b.__transition__[g].tween.set(a,d)}))}function ei(b){return null==b&&(b=""),function(){this.textContent=b}}function lc(b,a,d,e){var g=b.__transition__||(b.__transition__={active:0,count:0}),f=g[d];if(!f){var h=e.time,f=g[d]={tween:new l,time:h,ease:e.ease,delay:e.delay,duration:e.duration};++g.count;t.timer(function(e){function l(e){return g.active>
d?n():(g.active=d,f.event&&f.event.start.call(b,I,a),f.tween.forEach(function(d,e){(e=e.call(b,I,a))&&z.push(e)}),t.timer(function(){return w.c=m(e||1)?hb:m,1},0,h),void 0)}function m(e){if(g.active!==d)return n();e/=r;for(var h=p(e),l=z.length;0<l;)z[--l].call(b,h);return 1<=e?(f.event&&f.event.end.call(b,I,a),n()):void 0}function n(){return--g.count?delete g[d]:delete b.__transition__,1}var I=b.__data__,p=f.ease,q=f.delay,r=f.duration,w=Da,z=[];return w.t=q+h,e>=q?l(e-q):(w.c=l,void 0)},0,h)}}function fi(b,
a,d){b.attr("transform",function(b){var e=a(b);return"translate("+(isFinite(e)?e:d(b))+",0)"})}function gi(b,a,d){b.attr("transform",function(b){var e=a(b);return"translate(0,"+(isFinite(e)?e:d(b))+")"})}function Ed(b){return b.toISOString()}function Fd(b,a,d){function e(a){return b(a)}function g(b,d){var e=(b[1]-b[0])/d,f=t.bisect(mc,e);return f==mc.length?[a.year,Ra(b.map(function(b){return b/31536E6}),d)[2]]:f?a[e/mc[f-1]<mc[f]/e?f-1:f]:[hi,Ra(b,d)[2]]}return e.invert=function(a){return ab(b.invert(a))},
e.domain=function(a){return arguments.length?(b.domain(a),e):b.domain().map(ab)},e.nice=function(b,a){function d(k){return!isNaN(k)&&!b.range(k,ab(+k+1),a).length}var k=e.domain(),f=nb(k),f=null==b?g(f,10):"number"==typeof b&&g(f,b);return f&&(b=f[0],a=f[1]),e.domain(hc(k,1<a?{floor:function(a){for(;d(a=b.floor(a));)a=ab(a-1);return a},ceil:function(a){for(;d(a=b.ceil(a));)a=ab(+a+1);return a}}:b))},e.ticks=function(b,a){var d=nb(e.domain()),k=null==b?g(d,10):"number"==typeof b?g(d,b):!b.range&&[{range:b},
a];return k&&(b=k[0],a=k[1]),b.range(d[0],ab(+d[1]+1),1>a?1:a)},e.tickFormat=function(){return d},e.copy=function(){return Fd(b.copy(),a,d)},wd(e,b)}function ab(b){return new Date(b)}function ii(b){return JSON.parse(b.responseText)}function ji(b){var a=va.createRange();return a.selectNode(va.body),a.createContextualFragment(b.responseText)}var t={version:"3.4.13"};Date.now||(Date.now=function(){return+new Date});var Zf=[].slice,La=function(b){return Zf.call(b)},va=document,Ca=va.documentElement,ca=
window;try{La(Ca.childNodes)[0].nodeType}catch(Ji){La=function(b){for(var a=b.length,d=Array(a);a--;)d[a]=b[a];return d}}try{va.createElement("div").style.setProperty("opacity",0,"")}catch(Ki){var nc=ca.Element.prototype,ki=nc.setAttribute,li=nc.setAttributeNS,$f=ca.CSSStyleDeclaration.prototype,mi=$f.setProperty;nc.setAttribute=function(b,a){ki.call(this,b,a+"")};nc.setAttributeNS=function(b,a,d){li.call(this,b,a,d+"")};$f.setProperty=function(b,a,d){mi.call(this,b,a+"",d)}}t.ascending=h;t.descending=
function(b,a){return b>a?-1:a>b?1:a>=b?0:0/0};t.min=function(b,a){var d,e,g=-1,f=b.length;if(1===arguments.length){for(;++g<f&&!(null!=(d=b[g])&&d>=d);)d=void 0;for(;++g<f;)null!=(e=b[g])&&d>e&&(d=e)}else{for(;++g<f&&!(null!=(d=a.call(b,b[g],g))&&d>=d);)d=void 0;for(;++g<f;)null!=(e=a.call(b,b[g],g))&&d>e&&(d=e)}return d};t.max=function(b,a){var d,e,g=-1,f=b.length;if(1===arguments.length){for(;++g<f&&!(null!=(d=b[g])&&d>=d);)d=void 0;for(;++g<f;)null!=(e=b[g])&&e>d&&(d=e)}else{for(;++g<f&&!(null!=
(d=a.call(b,b[g],g))&&d>=d);)d=void 0;for(;++g<f;)null!=(e=a.call(b,b[g],g))&&e>d&&(d=e)}return d};t.extent=function(b,a){var d,e,g,f=-1,h=b.length;if(1===arguments.length){for(;++f<h&&!(null!=(d=g=b[f])&&d>=d);)d=g=void 0;for(;++f<h;)null!=(e=b[f])&&(d>e&&(d=e),e>g&&(g=e))}else{for(;++f<h&&!(null!=(d=g=a.call(b,b[f],f))&&d>=d);)d=void 0;for(;++f<h;)null!=(e=a.call(b,b[f],f))&&(d>e&&(d=e),e>g&&(g=e))}return[d,g]};t.sum=function(b,a){var d,g=0,f=b.length,h=-1;if(1===arguments.length)for(;++h<f;)e(d=
+b[h])&&(g+=d);else for(;++h<f;)e(d=+a.call(b,b[h],h))&&(g+=d);return g};t.mean=function(b,a){var d,g=0,h=b.length,l=-1,m=h;if(1===arguments.length)for(;++l<h;)e(d=f(b[l]))?g+=d:--m;else for(;++l<h;)e(d=f(a.call(b,b[l],l)))?g+=d:--m;return m?g/m:void 0};t.quantile=function(b,a){var d=(b.length-1)*a+1,e=Math.floor(d),g=+b[e-1];return(d-=e)?g+d*(b[e]-g):g};t.median=function(b,a){var d,g=[],l=b.length,m=-1;if(1===arguments.length)for(;++m<l;)e(d=f(b[m]))&&g.push(d);else for(;++m<l;)e(d=f(a.call(b,b[m],
m)))&&g.push(d);return g.length?t.quantile(g.sort(h),.5):void 0};var ag=d(h);t.bisectLeft=ag.left;t.bisect=t.bisectRight=ag.right;t.bisector=function(b){return d(1===b.length?function(a,d){return h(b(a),d)}:b)};t.shuffle=function(b){for(var a,d,e=b.length;e;)d=0|Math.random()*e--,a=b[e],b[e]=b[d],b[d]=a;return b};t.permute=function(b,a){for(var d=a.length,e=Array(d);d--;)e[d]=b[a[d]];return e};t.pairs=function(b){for(var a=0,d=b.length-1,e=b[0],g=Array(0>d?0:d);d>a;)g[a]=[e,e=b[++a]];return g};t.zip=
function(){if(!(g=arguments.length))return[];for(var b=-1,d=t.min(arguments,a),e=Array(d);++b<d;)for(var g,f=-1,h=e[b]=Array(g);++f<g;)h[f]=arguments[f][b];return e};t.transpose=function(b){return t.zip.apply(t,b)};t.keys=function(b){var a=[],d;for(d in b)a.push(d);return a};t.values=function(b){var a=[],d;for(d in b)a.push(b[d]);return a};t.entries=function(b){var a=[],d;for(d in b)a.push({key:d,value:b[d]});return a};t.merge=function(b){var a,d,e,g=b.length;a=-1;for(var f=0;++a<g;)f+=b[a].length;
for(d=Array(f);0<=--g;)for(e=b[g],a=e.length;0<=--a;)d[--f]=e[a];return d};var G=Math.abs;t.range=function(b,a,d){if(3>arguments.length&&(d=1,2>arguments.length&&(a=b,b=0)),1/0===(a-b)/d)throw Error("infinite range");var e,g=[],f;e=G(d);for(f=1;e*f%1;)f*=10;var h=-1;if(b*=f,a*=f,d*=f,0>d)for(;(e=b+d*++h)>a;)g.push(e/f);else for(;(e=b+d*++h)<a;)g.push(e/f);return g};t.map=function(b){var a=new l;if(b instanceof l)b.forEach(function(b,d){a.set(b,d)});else for(var d in b)a.set(d,b[d]);return a};var ug=
"__proto__",Fc="\x00";g(l,{has:p,get:function(b){return this._[m(b)]},set:function(b,a){return this._[m(b)]=a},remove:r,keys:q,values:function(){var b=[],a;for(a in this._)b.push(this._[a]);return b},entries:function(){var b=[],a;for(a in this._)b.push({key:n(a),value:this._[a]});return b},size:w,empty:x,forEach:function(b){for(var a in this._)b.call(this,n(a),this._[a])}});t.nest=function(){function b(a,k,h){if(h>=f.length)return e?e.call(g,k):d?k.sort(d):k;for(var m,n,p,q,r=-1,t=k.length,X=f[h++],
w=new l;++r<t;)(q=w.get(m=X(n=k[r])))?q.push(n):w.set(m,[n]);return a?(n=a(),p=function(d,k){n.set(d,b(a,k,h))}):(n={},p=function(d,k){n[d]=b(a,k,h)}),w.forEach(p),n}function a(b,d){if(d>=f.length)return b;var e=[],g=h[d++];return b.forEach(function(b,g){e.push({key:b,values:a(g,d)})}),g?e.sort(function(b,a){return g(b.key,a.key)}):e}var d,e,g={},f=[],h=[];return g.map=function(a,d){return b(d,a,0)},g.entries=function(d){return a(b(t.map,d,0),0)},g.key=function(b){return f.push(b),g},g.sortKeys=function(b){return h[f.length-
1]=b,g},g.sortValues=function(b){return d=b,g},g.rollup=function(b){return e=b,g},g};t.set=function(b){var a=new z;if(b)for(var d=0,e=b.length;e>d;++d)a.add(b[d]);return a};g(z,{has:p,add:function(b){return this._[m(b+="")]=!0,b},remove:r,values:q,size:w,empty:x,forEach:function(b){for(var a in this._)b.call(this,n(a))}});t.behavior={};t.rebind=function(b,a){for(var d,e=1,g=arguments.length;++e<g;)b[d=arguments[e]]=B(b,a,a[d]);return b};var Ud="webkit ms moz Moz o O".split(" ");t.dispatch=function(){for(var b=
new ba,a=-1,d=arguments.length;++a<d;)b[arguments[a]]=E(b);return b};ba.prototype.on=function(b,a){var d=b.indexOf("."),e="";if(0<=d&&(e=b.slice(d+1),b=b.slice(0,d)),b)return 2>arguments.length?this[b].on(e):this[b].on(e,a);if(2===arguments.length){if(null==a)for(b in this)this.hasOwnProperty(b)&&this[b].on(e,null);return this}};t.event=null;t.requote=function(b){return b.replace(ni,"\\$&")};var ni=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,Fb={}.__proto__?function(b,a){b.__proto__=a}:function(b,a){for(var d in a)b[d]=
a[d]},Gc=function(b,a){return a.querySelector(b)},Hc=function(b,a){return a.querySelectorAll(b)},oi=Ca.matches||Ca[A(Ca,"matchesSelector")],Yd=function(b,a){return oi.call(b,a)};"function"==typeof Sizzle&&(Gc=function(b,a){return Sizzle(b,a)[0]||null},Hc=Sizzle,Yd=Sizzle.matchesSelector);t.selection=function(){return bg};var K=t.selection.prototype=[];K.select=function(b){var a,d,e,g,f=[];b=Ec(b);for(var h=-1,l=this.length;++h<l;){f.push(a=[]);a.parentNode=(e=this[h]).parentNode;for(var m=-1,n=e.length;++m<
n;)(g=e[m])?(a.push(d=b.call(g,g.__data__,m,h)),d&&"__data__"in g&&(d.__data__=g.__data__)):a.push(null)}return Ka(f)};K.selectAll=function(b){var a,d,e=[];b=Nd(b);for(var g=-1,f=this.length;++g<f;)for(var h=this[g],l=-1,m=h.length;++l<m;)(d=h[l])&&(e.push(a=La(b.call(d,d.__data__,l,g))),a.parentNode=d);return Ka(e)};var Gd={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};
t.ns={prefix:Gd,qualify:function(b){var a=b.indexOf(":"),d=b;return 0<=a&&(d=b.slice(0,a),b=b.slice(a+1)),Gd.hasOwnProperty(d)?{space:Gd[d],local:b}:b}};K.attr=function(b,a){if(2>arguments.length){if("string"==typeof b){var d=this.node();return b=t.ns.qualify(b),b.local?d.getAttributeNS(b.space,b.local):d.getAttribute(b)}for(a in b)this.each(Od(a,b[a]));return this}return this.each(Od(b,a))};K.classed=function(b,a){if(2>arguments.length){if("string"==typeof b){var d=this.node(),e=(b=(b+"").trim().split(/^|\s+/)).length,
g=-1;if(a=d.classList)for(;++g<e;){if(!a.contains(b[g]))return!1}else for(a=d.getAttribute("class");++g<e;)if(!Qd(b[g]).test(a))return!1;return!0}for(a in b)this.each(Rd(a,b[a]));return this}return this.each(Rd(b,a))};K.style=function(b,a,d){var e=arguments.length;if(3>e){if("string"!=typeof b){2>e&&(a="");for(d in b)this.each(Sd(d,b[d],a));return this}if(2>e)return ca.getComputedStyle(this.node(),null).getPropertyValue(b);d=""}return this.each(Sd(b,a,d))};K.property=function(b,a){if(2>arguments.length){if("string"==
typeof b)return this.node()[b];for(a in b)this.each(Td(a,b[a]));return this}return this.each(Td(b,a))};K.text=function(b){return arguments.length?this.each("function"==typeof b?function(){var a=b.apply(this,arguments);this.textContent=null==a?"":a}:null==b?function(){this.textContent=""}:function(){this.textContent=b}):this.node().textContent};K.html=function(b){return arguments.length?this.each("function"==typeof b?function(){var a=b.apply(this,arguments);this.innerHTML=null==a?"":a}:null==b?function(){this.innerHTML=
""}:function(){this.innerHTML=b}):this.node().innerHTML};K.append=function(b){return b=Wd(b),this.select(function(){return this.appendChild(b.apply(this,arguments))})};K.insert=function(b,a){return b=Wd(b),a=Ec(a),this.select(function(){return this.insertBefore(b.apply(this,arguments),a.apply(this,arguments)||null)})};K.remove=function(){return this.each(function(){var b=this.parentNode;b&&b.removeChild(this)})};K.data=function(b,a){function d(b,e){var g,f,h,v=b.length,y=e.length,q=Math.min(v,y),
I=Array(y),r=Array(y),F=Array(v);if(a){var t,q=new l,w=Array(v);for(g=-1;++g<v;)q.has(t=a.call(f=b[g],f.__data__,g))?F[g]=f:q.set(t,f),w[g]=t;for(g=-1;++g<y;)(f=q.get(t=a.call(e,h=e[g],g)))?!0!==f&&(I[g]=f,f.__data__=h):r[g]={__data__:h},q.set(t,!0);for(g=-1;++g<v;)!0!==q.get(w[g])&&(F[g]=b[g])}else{for(g=-1;++g<q;)f=b[g],h=e[g],f?(f.__data__=h,I[g]=f):r[g]={__data__:h};for(;y>g;++g)r[g]={__data__:e[g]};for(;v>g;++g)F[g]=b[g]}r.update=I;r.parentNode=I.parentNode=F.parentNode=b.parentNode;m.push(r);
n.push(I);p.push(F)}var e,g,f=-1,h=this.length;if(!arguments.length){for(b=Array(h=(e=this[0]).length);++f<h;)(g=e[f])&&(b[f]=g.__data__);return b}var m=Zd([]),n=Ka([]),p=Ka([]);if("function"==typeof b)for(;++f<h;)d(e=this[f],b.call(e,e.parentNode.__data__,f));else for(;++f<h;)d(e=this[f],b);return n.enter=function(){return m},n.exit=function(){return p},n};K.datum=function(b){return arguments.length?this.property("__data__",b):this.property("__data__")};K.filter=function(b){var a,d,e,g=[];"function"!=
typeof b&&(b=Xd(b));for(var f=0,h=this.length;h>f;f++){g.push(a=[]);a.parentNode=(d=this[f]).parentNode;for(var l=0,m=d.length;m>l;l++)(e=d[l])&&b.call(e,e.__data__,l,f)&&a.push(e)}return Ka(g)};K.order=function(){for(var b=-1,a=this.length;++b<a;)for(var d,e=this[b],g=e.length-1,f=e[g];0<=--g;)(d=e[g])&&(f&&f!==d.nextSibling&&f.parentNode.insertBefore(d,f),f=d);return this};K.sort=function(b){b=vg.apply(this,arguments);for(var a=-1,d=this.length;++a<d;)this[a].sort(b);return this.order()};K.each=
function(b){return Aa(this,function(a,d,e){b.call(a,a.__data__,d,e)})};K.call=function(b){var a=La(arguments);return b.apply(a[0]=this,a),this};K.empty=function(){return!this.node()};K.node=function(){for(var b=0,a=this.length;a>b;b++)for(var d=this[b],e=0,g=d.length;g>e;e++){var f=d[e];if(f)return f}return null};K.size=function(){var b=0;return Aa(this,function(){++b}),b};var Ba=[];t.selection.enter=Zd;t.selection.enter.prototype=Ba;Ba.append=K.append;Ba.empty=K.empty;Ba.node=K.node;Ba.call=K.call;
Ba.size=K.size;Ba.select=function(b){for(var a,d,e,g,f,h=[],l=-1,m=this.length;++l<m;){e=(g=this[l]).update;h.push(a=[]);a.parentNode=g.parentNode;for(var n=-1,p=g.length;++n<p;)(f=g[n])?(a.push(e[n]=d=b.call(g.parentNode,f.__data__,n,l)),d.__data__=f.__data__):a.push(null)}return Ka(h)};Ba.insert=function(b,a){return 2>arguments.length&&(a=wg(this)),K.insert.call(this,b,a)};K.transition=function(){for(var b,a,d=bb||++cg,e=[],g=oc||{time:Date.now(),ease:qh,delay:0,duration:250},f=-1,h=this.length;++f<
h;){e.push(b=[]);for(var l=this[f],m=-1,n=l.length;++m<n;)(a=l[m])&&lc(a,m,d,g),b.push(a)}return Eb(e,d)};K.interrupt=function(){return this.each(Gb)};t.select=function(b){b=["string"==typeof b?Gc(b,va):b];return b.parentNode=Ca,Ka([b])};t.selectAll=function(b){b=La("string"==typeof b?Hc(b,va):b);return b.parentNode=Ca,Ka([b])};var bg=t.select(Ca);K.on=function(b,a,d){var e=arguments.length;if(3>e){if("string"!=typeof b){2>e&&(a=!1);for(d in b)this.each($d(d,b[d],a));return this}if(2>e)return(e=this.node()["__on"+
b])&&e._;d=!1}return this.each($d(b,a,d))};var Ic=t.map({mouseenter:"mouseover",mouseleave:"mouseout"});Ic.forEach(function(b){"on"+b in va&&Ic.remove(b)});var qb="onselectstart"in va?null:A(Ca.style,"userSelect"),yg=0;t.mouse=function(b){return Jc(b,T())};var Kc=/WebKit/.test(ca.navigator.userAgent)?-1:0;t.touch=function(b,a,d){if(3>arguments.length&&(d=a,a=T().changedTouches),a)for(var e,g=0,f=a.length;f>g;++g)if((e=a[g]).identifier===d)return Jc(b,e)};t.behavior.drag=function(){function b(){this.on("mousedown.drag",
g).on("touchstart.drag",f)}function a(b,k,g,f,h){return function(){var a,l=t.event.target,m=this.parentNode,n=d.of(this,arguments),y=0,p=b(),q=".drag"+(null==p?"":"-"+p),r=t.select(g()).on(f+q,function(){var b,d,e=k(m,p);e&&(b=e[0]-w[0],d=e[1]-w[1],y=y|b|d,w=e,n({type:"drag",x:e[0]+a[0],y:e[1]+a[1],dx:b,dy:d}))}).on(h+q,function(){k(m,p)&&(r.on(f+q,null).on(h+q,null),F(y&&t.event.target===l),n({type:"dragend"}))}),F=Hb(),w=k(m,p);e?(a=e.apply(this,arguments),a=[a.x-w[0],a.y-w[1]]):a=[0,0];n({type:"dragstart"})}}
var d=Dc(b,"drag","dragstart","dragend"),e=null,g=a(L,t.mouse,Bg,"mousemove","mouseup"),f=a(zg,t.touch,Ag,"touchmove","touchend");return b.origin=function(a){return arguments.length?(e=a,b):e},t.rebind(b,d,"on")};t.touches=function(b,a){return 2>arguments.length&&(a=T().touches),a?La(a).map(function(a){var d=Jc(b,a);return d.identifier=a.identifier,d}):[]};var H=Math.PI,ja=2*H,Z=H/2,D=1E-6,id=D*D,J=H/180,R=180/H,pc=Math.SQRT2;t.interpolateZoom=function(b,a){function d(b){var a=b*w;if(t){b=ce(r);var k=
f/(2*p),h,v=pc*a+r;h=((v=Math.exp(2*v))-1)/(v+1);h*=b;var n=r,v=((n=Math.exp(n))-1/n)/2,k=k*(h-v);return[e+k*l,g+k*m,f*b/ce(pc*a+r)]}return[e+b*l,g+b*m,f*Math.exp(pc*a)]}var e=b[0],g=b[1],f=b[2],h=a[2],l=a[0]-e,m=a[1]-g,n=l*l+m*m,p=Math.sqrt(n),q=(h*h-f*f+4*n)/(4*f*p),n=(h*h-f*f-4*n)/(4*h*p),r=Math.log(Math.sqrt(q*q+1)-q),t=Math.log(Math.sqrt(n*n+1)-n)-r,w=(t||Math.log(h/f))/pc;return d.duration=1E3*w,d};t.behavior.zoom=function(){function b(b){b.on(E,m).on(pi+".zoom",p).on("dblclick.zoom",q).on(D,
n)}function a(b){return[(b[0]-A.x)/A.k,(b[1]-A.y)/A.k]}function d(b){A.k=Math.max(ha[0],Math.min(ha[1],b))}function e(b,a){a=[a[0]*A.k+A.x,a[1]*A.k+A.y];A.x+=b[0]-a[0];A.y+=b[1]-a[1]}function g(){M&&M.domain(Ea.range().map(function(b){return(b-A.x)/A.k}).map(Ea.invert));P&&P.domain(O.range().map(function(b){return(b-A.y)/A.k}).map(O.invert))}function f(b){b({type:"zoomstart"})}function h(b){g();b({type:"zoom",scale:A.k,translate:[A.x,A.y]})}function l(b){b({type:"zoomend"})}function m(){var b=this,
d=t.event.target,g=T.of(b,arguments),v=0,n=t.select(ca).on(L,function(){v=1;e(t.mouse(b),p);h(g)}).on(C,function(){n.on(L,null).on(C,null);q(v&&t.event.target===d);l(g)}),p=a(t.mouse(b)),q=Hb();Gb.call(b);f(g)}function n(){function b(){var d=t.touches(F);return r=A.k,d.forEach(function(b){b.identifier in z&&(z[b.identifier]=a(b))}),d}function g(){var a=t.event.target;t.select(a).on(O,p).on(qa,q);Ma.push(a);for(var a=t.event.changedTouches,k=0,f=a.length;f>k;++k)z[a[k].identifier]=null;f=b();k=Date.now();
1===f.length?(500>k-B&&(a=f[0],f=z[a.identifier],d(2*A.k),e(a,f),N(),h(w)),B=k):1<f.length&&(a=f[0],f=f[1],k=a[0]-f[0],a=a[1]-f[1],S=k*k+a*a)}function p(){for(var b,a,k,g,f=t.touches(F),l=0,m=f.length;m>l;++l,g=null)if(k=f[l],g=z[k.identifier]){if(a)break;b=k;a=g}if(g){var n=(n=k[0]-b[0])*n+(n=k[1]-b[1])*n,f=S&&Math.sqrt(n/S);b=[(b[0]+k[0])/2,(b[1]+k[1])/2];a=[(a[0]+g[0])/2,(a[1]+g[1])/2];d(f*r)}B=null;e(b,a);h(w)}function q(){if(t.event.touches.length){for(var a=t.event.changedTouches,d=0,e=a.length;e>
d;++d)delete z[a[d].identifier];for(var k in z)return void b()}t.selectAll(Ma).on(x,null);M.on(E,m).on(D,n);la();l(w)}var r,F=this,w=T.of(F,arguments),z={},S=0,x=".zoom-"+t.event.changedTouches[0].identifier,O="touchmove"+x,qa="touchend"+x,Ma=[],M=t.select(F),la=Hb();Gb.call(F);g();f(w);M.on(E,null).on(D,g)}function p(){var b=T.of(this,arguments);x?clearTimeout(x):(r=a(w=z||t.mouse(this)),Gb.call(this),f(b));x=setTimeout(function(){x=null;l(b)},50);N();d(Math.pow(2,.002*qc())*A.k);e(w,r);h(b)}function q(){var b=
T.of(this,arguments),g=t.mouse(this),m=a(g),n=Math.log(A.k)/Math.LN2;f(b);d(Math.pow(2,t.event.shiftKey?Math.ceil(n)-1:Math.floor(n)+1));e(g,m);h(b);l(b)}var r,w,z,x,B,Ea,M,O,P,A={x:0,y:0,k:1},ma=[960,500],ha=dg,E="mousedown.zoom",L="mousemove.zoom",C="mouseup.zoom",D="touchstart.zoom",T=Dc(b,"zoomstart","zoom","zoomend");return b.event=function(b){b.each(function(){var b=T.of(this,arguments),a=A;bb?t.select(this).transition().each("start.zoom",function(){A=this.__chart__||{x:0,y:0,k:1};f(b)}).tween("zoom:zoom",
function(){var d=ma[0],e=d/2,k=ma[1]/2,g=t.interpolateZoom([(e-A.x)/A.k,(k-A.y)/A.k,d/A.k],[(e-a.x)/a.k,(k-a.y)/a.k,d/a.k]);return function(a){a=g(a);var f=d/a[2];this.__chart__=A={x:e-a[0]*f,y:k-a[1]*f,k:f};h(b)}}).each("end.zoom",function(){l(b)}):(this.__chart__=A,f(b),h(b),l(b))})},b.translate=function(a){return arguments.length?(A={x:+a[0],y:+a[1],k:A.k},g(),b):[A.x,A.y]},b.scale=function(a){return arguments.length?(A={x:A.x,y:A.y,k:+a},g(),b):A.k},b.scaleExtent=function(a){return arguments.length?
(ha=null==a?dg:[+a[0],+a[1]],b):ha},b.center=function(a){return arguments.length?(z=a&&[+a[0],+a[1]],b):z},b.size=function(a){return arguments.length?(ma=a&&[+a[0],+a[1]],b):ma},b.x=function(a){return arguments.length?(M=a,Ea=a.copy(),A={x:0,y:0,k:1},b):M},b.y=function(a){return arguments.length?(P=a,O=a.copy(),A={x:0,y:0,k:1},b):P},t.rebind(b,T,"on")};var qc,dg=[0,1/0],pi="onwheel"in va?(qc=function(){return-t.event.deltaY*(t.event.deltaMode?120:1)},"wheel"):"onmousewheel"in va?(qc=function(){return t.event.wheelDelta},
"mousewheel"):(qc=function(){return-t.event.detail},"MozMousePixelScroll");t.color=Ta;Ta.prototype.toString=function(){return this.rgb()+""};t.hsl=wa;var Hd=wa.prototype=new Ta;Hd.brighter=function(b){return b=Math.pow(.7,arguments.length?b:1),new wa(this.h,this.s,this.l/b)};Hd.darker=function(b){return b=Math.pow(.7,arguments.length?b:1),new wa(this.h,this.s,b*this.l)};Hd.rgb=function(){return Mc(this.h,this.s,this.l)};t.hcl=ra;var Id=ra.prototype=new Ta;Id.brighter=function(b){return new ra(this.h,
this.c,Math.min(100,this.l+rc*(arguments.length?b:1)))};Id.darker=function(b){return new ra(this.h,this.c,Math.max(0,this.l-rc*(arguments.length?b:1)))};Id.rgb=function(){return Nc(this.h,this.c,this.l).rgb()};t.lab=sa;var rc=18,je=.95047,ke=1,le=1.08883,Jd=sa.prototype=new Ta;Jd.brighter=function(b){return new sa(Math.min(100,this.l+rc*(arguments.length?b:1)),this.a,this.b)};Jd.darker=function(b){return new sa(Math.max(0,this.l-rc*(arguments.length?b:1)),this.a,this.b)};Jd.rgb=function(){return ie(this.l,
this.a,this.b)};t.rgb=da;var sc=da.prototype=new Ta;sc.brighter=function(b){b=Math.pow(.7,arguments.length?b:1);var a=this.r,d=this.g,e=this.b;return a||d||e?(a&&30>a&&(a=30),d&&30>d&&(d=30),e&&30>e&&(e=30),new da(Math.min(255,a/b),Math.min(255,d/b),Math.min(255,e/b))):new da(30,30,30)};sc.darker=function(b){return b=Math.pow(.7,arguments.length?b:1),new da(b*this.r,b*this.g,b*this.b)};sc.hsl=function(){return fe(this.r,this.g,this.b)};sc.toString=function(){return"#"+db(this.r)+db(this.g)+db(this.b)};
var Jb=t.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,
darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,
grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,
lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,
palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,
tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Jb.forEach(function(b,a){Jb.set(b,new da(a>>16,255&a>>8,255&a))});t.functor=Q;t.xhr=Tc(Y);t.dsv=function(b,a){function d(b,f,h){3>arguments.length&&(h=f,f=null);var l=Kb(b,a,null==f?e:g(f),h);return l.row=function(b){return arguments.length?l.response(null==(f=b)?e:g(b)):f},l}function e(b){return d.parse(b.responseText)}function g(b){return function(a){return d.parse(a.responseText,
b)}}function f(a){return a.map(h).join(b)}function h(b){return l.test(b)?'"'+b.replace(/\"/g,'""')+'"':b}var l=new RegExp('["'+b+"\n]"),m=b.charCodeAt(0);return d.parse=function(b,a){var e;return d.parseRows(b,function(b,d){if(e)return e(b,d-1);var k=new Function("d","return {"+b.map(function(b,a){return JSON.stringify(b)+": d["+a+"]"}).join(",")+"}");e=a?function(b,d){return a(k(b),d)}:k})},d.parseRows=function(b,a){function d(){if(v>=l)return f;if(k)return k=!1,g;var a=v;if(34===b.charCodeAt(a)){for(var e=
a;e++<l;)if(34===b.charCodeAt(e)){if(34!==b.charCodeAt(e+1))break;++e}v=e+2;var h=b.charCodeAt(e+1);return 13===h?(k=!0,10===b.charCodeAt(e+2)&&++v):10===h&&(k=!0),b.slice(a+1,e).replace(/""/g,'"')}for(;l>v;){h=b.charCodeAt(v++);e=1;if(10===h)k=!0;else if(13===h)k=!0,10===b.charCodeAt(v)&&(++v,++e);else if(h!==m)continue;return b.slice(a,v-e)}return b.slice(a)}for(var e,k,g={},f={},h=[],l=b.length,v=0,n=0;(e=d())!==f;){for(var y=[];e!==g&&e!==f;)y.push(e),e=d();a&&null==(y=a(y,n++))||h.push(y)}return h},
d.format=function(a){if(Array.isArray(a[0]))return d.formatRows(a);var e=new z,k=[];return a.forEach(function(b){for(var a in b)e.has(a)||k.push(e.add(a))}),[k.map(h).join(b)].concat(a.map(function(a){return k.map(function(b){return h(a[b])}).join(b)})).join("\n")},d.formatRows=function(b){return b.map(f).join("\n")},d};t.csv=t.dsv(",","text/csv");t.tsv=t.dsv("\t","text/tab-separated-values");var Nb,Ob,Mb,Lb,Da,oe=ca[A(ca,"requestAnimationFrame")]||function(b){setTimeout(b,17)};t.timer=function(b,
a,d){var e=arguments.length;2>e&&(a=0);3>e&&(d=Date.now());e={c:b,t:d+a,f:!1,n:null};Ob?Ob.n=e:Nb=e;Ob=e;Mb||(Lb=clearTimeout(Lb),Mb=1,oe(Uc))};t.timer.flush=function(){me();ne()};t.round=function(b,a){return a?Math.round(b*(a=Math.pow(10,a)))/a:Math.round(b)};var qi="y z a f p n \u00b5 m  k M G T P E Z Y".split(" ").map(function(b,a){var d=Math.pow(10,3*G(8-a));return{scale:8<a?function(b){return b/d}:function(b){return b*d},symbol:b}});t.formatPrefix=function(b,a){var d=0;return b&&(0>b&&(b*=-1),
a&&(b=t.round(b,Vc(b,a))),d=1+Math.floor(1E-12+Math.log(b)/Math.LN10),d=Math.max(-24,Math.min(24,3*Math.floor((d-1)/3)))),qi[8+d/3]};var pe=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Eg=t.map({b:function(b){return b.toString(2)},c:function(b){return String.fromCharCode(b)},o:function(b){return b.toString(8)},x:function(b){return b.toString(16)},X:function(b){return b.toString(16).toUpperCase()},g:function(b,a){return b.toPrecision(a)},e:function(b,a){return b.toExponential(a)},
f:function(b,a){return b.toFixed(a)},r:function(b,a){return(b=t.round(b,Vc(b,a))).toFixed(Math.max(0,Math.min(20,Vc(b*(1+1E-15),a))))}}),C=t.time={},aa=Date;Fa.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},
getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Ja.setUTCDate.apply(this._,arguments)},setDay:function(){Ja.setUTCDay.apply(this._,arguments)},setFullYear:function(){Ja.setUTCFullYear.apply(this._,arguments)},setHours:function(){Ja.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Ja.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Ja.setUTCMinutes.apply(this._,
arguments)},setMonth:function(){Ja.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Ja.setUTCSeconds.apply(this._,arguments)},setTime:function(){Ja.setTime.apply(this._,arguments)}};var Ja=Date.prototype;C.year=Ua(function(b){return b=C.day(b),b.setMonth(0,1),b},function(b,a){b.setFullYear(b.getFullYear()+a)},function(b){return b.getFullYear()});C.years=C.year.range;C.years.utc=C.year.utc.range;C.day=Ua(function(b){var a=new aa(2E3,0);return a.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),
a},function(b,a){b.setDate(b.getDate()+a)},function(b){return b.getDate()-1});C.days=C.day.range;C.days.utc=C.day.utc.range;C.dayOfYear=function(b){var a=C.year(b);return Math.floor((b-a-6E4*(b.getTimezoneOffset()-a.getTimezoneOffset()))/864E5)};"sunday monday tuesday wednesday thursday friday saturday".split(" ").forEach(function(b,a){a=7-a;var d=C[b]=Ua(function(b){return(b=C.day(b)).setDate(b.getDate()-(b.getDay()+a)%7),b},function(b,a){b.setDate(b.getDate()+7*Math.floor(a))},function(b){var d=
C.year(b).getDay();return Math.floor((C.dayOfYear(b)+(d+a)%7)/7)-(d!==a)});C[b+"s"]=d.range;C[b+"s"].utc=d.utc.range;C[b+"OfYear"]=function(b){var d=C.year(b).getDay();return Math.floor((C.dayOfYear(b)+(d+a)%7)/7)}});C.week=C.sunday;C.weeks=C.sunday.range;C.weeks.utc=C.sunday.utc.range;C.weekOfYear=C.sundayOfYear;var qe={"-":"",_:" ",0:"0"},V=/^\s*\d+/,te=/^%/;t.locale=function(b){return{numberFormat:Dg(b),timeFormat:Gg(b)}};var eg=t.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],
dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),shortDays:"Sun Mon Tue Wed Thu Fri Sat".split(" "),months:"January February March April May June July August September October November December".split(" "),shortMonths:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")});t.format=eg.numberFormat;t.geo={};Wc.prototype={s:0,t:0,add:function(b){ue(b,this.t,tc);ue(tc.s,this.s,this);this.s?
this.t+=tc.t:this.s=tc.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var tc=new Wc;t.geo.stream=function(b,a){b&&fg.hasOwnProperty(b.type)?fg[b.type](b,a):Tb(b,a)};var fg={Feature:function(b,a){Tb(b.geometry,a)},FeatureCollection:function(b,a){for(var d=b.features,e=-1,g=d.length;++e<g;)Tb(d[e].geometry,a)}},ve={Sphere:function(b,a){a.sphere()},Point:function(b,a){b=b.coordinates;a.point(b[0],b[1],b[2])},MultiPoint:function(b,a){for(var d=b.coordinates,e=-1,g=d.length;++e<
g;)b=d[e],a.point(b[0],b[1],b[2])},LineString:function(b,a){Xc(b.coordinates,a,0)},MultiLineString:function(b,a){for(var d=b.coordinates,e=-1,g=d.length;++e<g;)Xc(d[e],a,0)},Polygon:function(b,a){we(b.coordinates,a)},MultiPolygon:function(b,a){for(var d=b.coordinates,e=-1,g=d.length;++e<g;)we(d[e],a)},GeometryCollection:function(b,a){for(var d=b.geometries,e=-1,g=d.length;++e<g;)Tb(d[e],a)}};t.geo.area=function(b){return ob=0,t.geo.stream(b,ia),ob};var ob,Va=new Wc,ia={sphere:function(){ob+=4*H},
point:L,lineStart:L,lineEnd:L,polygonStart:function(){Va.reset();ia.lineStart=Vg},polygonEnd:function(){var b=2*Va;ob+=0>b?4*H+b:b;ia.lineStart=ia.lineEnd=ia.point=L}};t.geo.bounds=function(){function b(b,a){O.push(P=[p=b,r=b]);q>a&&(q=a);a>w&&(w=a)}function a(d,e){var g=Wa([d*J,e*J]);if(B){var k=fb(B,g),k=fb([k[1],-k[0],0],k);Wb(k);var k=Xb(k),f=d-z,h=0<f?1:-1,m=k[0]*R*h,f=180<G(f);f^(m>h*z&&h*d>m)?(k=k[1]*R,k>w&&(w=k)):(m=(m+360)%360-180,f^(m>h*z&&h*d>m))?(k=-k[1]*R,q>k&&(q=k)):(q>e&&(q=e),e>w&&
(w=e));f?z>d?l(p,d)>l(p,r)&&(r=d):l(d,r)>l(p,r)&&(p=d):r>=p?(p>d&&(p=d),d>r&&(r=d)):d>z?l(p,d)>l(p,r)&&(r=d):l(d,r)>l(p,r)&&(p=d)}else b(d,e);B=g;z=d}function d(){E.point=a}function e(){P[0]=p;P[1]=r;E.point=b;B=null}function g(b,d){if(B){var e=b-z;M+=180<G(e)?e+(0<e?360:-360):e}else x=b,A=d;ia.point(b,d);a(b,d)}function f(){ia.lineStart()}function h(){g(x,A);ia.lineEnd();G(M)>D&&(p=-(r=180));P[0]=p;P[1]=r;B=null}function l(b,a){return 0>(a-=b)?a+360:a}function m(b,a){return b[0]-a[0]}function n(b,
a){return a[0]<=a[1]?a[0]<=b&&b<=a[1]:b<a[0]||a[1]<b}var p,q,r,w,z,x,A,B,M,O,P,E={point:b,lineStart:d,lineEnd:e,polygonStart:function(){E.point=g;E.lineStart=f;E.lineEnd=h;M=0;ia.polygonStart()},polygonEnd:function(){ia.polygonEnd();E.point=b;E.lineStart=d;E.lineEnd=e;0>Va?(p=-(r=180),q=-(w=90)):M>D?w=90:-D>M&&(q=-90);P[0]=p;P[1]=r}};return function(b){w=r=-(p=q=1/0);O=[];t.geo.stream(b,E);if(b=O.length){O.sort(m);for(var a,d=1,e=O[0],g=[e];b>d;++d)a=O[d],n(a[0],e)||n(a[1],e)?(l(e[0],a[1])>l(e[0],
e[1])&&(e[1]=a[1]),l(a[0],e[1])>l(e[0],e[1])&&(e[0]=a[0])):g.push(e=a);var k,f=-1/0;b=g.length-1;d=0;for(e=g[b];b>=d;e=a,++d)a=g[d],(k=l(e[1],a[0]))>f&&(f=k,p=a[0],r=e[1])}return O=P=null,1/0===p||1/0===q?[[0/0,0/0],[0/0,0/0]]:[[p,q],[r,w]]}}();t.geo.centroid=function(b){tb=gb=Ga=Ha=xa=na=oa=fa=Na=Oa=ya=0;t.geo.stream(b,ta);b=Na;var a=Oa,d=ya,e=b*b+a*a+d*d;return id>e&&(b=na,a=oa,d=fa,D>gb&&(b=Ga,a=Ha,d=xa),e=b*b+a*a+d*d,id>e)?[0/0,0/0]:[Math.atan2(a,b)*R,cb(d/Math.sqrt(e))*R]};var tb,gb,Ga,Ha,xa,
na,oa,fa,Na,Oa,ya,ta={sphere:L,point:Zc,lineStart:xe,lineEnd:ye,polygonStart:function(){ta.lineStart=Wg},polygonEnd:function(){ta.lineStart=xe}},Oe=Be(hb,function(b){var a,d=0/0,e=0/0,g=0/0;return{lineStart:function(){b.lineStart();a=1},point:function(f,h){var l=0<f?H:-H,m=G(f-d);if(G(m-H)<D)b.point(d,e=0<(e+h)/2?Z:-Z),b.point(g,e),b.lineEnd(),b.lineStart(),b.point(l,e),b.point(f,e),a=0;else if(g!==l&&m>=H){G(d-g)<D&&(d-=g*D);G(f-l)<D&&(f-=l*D);var m=d,n=e,p=f,q,r,t=Math.sin(m-p);e=G(t)>D?Math.atan((Math.sin(n)*
(r=Math.cos(h))*Math.sin(p)-Math.sin(h)*(q=Math.cos(n))*Math.sin(m))/(q*r*t)):(n+h)/2;b.point(g,e);b.lineEnd();b.lineStart();b.point(l,e);a=0}b.point(d=f,e=h);g=l},lineEnd:function(){b.lineEnd();d=e=0/0},clean:function(){return 2-a}}},function(b,a,d,e){null==b?(d*=Z,e.point(-H,d),e.point(0,d),e.point(H,d),e.point(H,0),e.point(H,-d),e.point(0,-d),e.point(-H,-d),e.point(-H,0),e.point(-H,d)):G(b[0]-a[0])>D?(b=b[0]<a[0]?H:-H,d=d*b/2,e.point(-b,d),e.point(0,d),e.point(b,d)):e.point(a[0],a[1])},[-H,-H/
2]),$b=1E9;t.geo.clipExtent=function(){var b,a,d,e,g,f,h={stream:function(b){return g&&(g.valid=!1),g=f(b),g.valid=!0,g},extent:function(l){return arguments.length?(f=Ee(b=+l[0][0],a=+l[0][1],d=+l[1][0],e=+l[1][1]),g&&(g.valid=!1,g=null),h):[[b,a],[d,e]]}};return h.extent([[0,0],[960,500]])};(t.geo.conicEqualArea=function(){return ad(Ge)}).raw=Ge;t.geo.albers=function(){return t.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)};t.geo.albersUsa=function(){function b(b){var f=
b[0];b=b[1];return a=null,d(f,b),a||(e(f,b),a)||g(f,b),a}var a,d,e,g,f=t.geo.albers(),h=t.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=t.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),m={point:function(b,d){a=[b,d]}};return b.invert=function(b){var a=f.scale(),d=f.translate(),e=(b[0]-d[0])/a,a=(b[1]-d[1])/a;return(.12<=a&&.234>a&&-.425<=e&&-.214>e?h:.166<=a&&.234>a&&-.214<=e&&-.115>e?l:f).invert(b)},b.stream=function(b){var a=f.stream(b),d=
h.stream(b),e=l.stream(b);return{point:function(b,g){a.point(b,g);d.point(b,g);e.point(b,g)},sphere:function(){a.sphere();d.sphere();e.sphere()},lineStart:function(){a.lineStart();d.lineStart();e.lineStart()},lineEnd:function(){a.lineEnd();d.lineEnd();e.lineEnd()},polygonStart:function(){a.polygonStart();d.polygonStart();e.polygonStart()},polygonEnd:function(){a.polygonEnd();d.polygonEnd();e.polygonEnd()}}},b.precision=function(a){return arguments.length?(f.precision(a),h.precision(a),l.precision(a),
b):f.precision()},b.scale=function(a){return arguments.length?(f.scale(a),h.scale(.35*a),l.scale(a),b.translate(f.translate())):f.scale()},b.translate=function(a){if(!arguments.length)return f.translate();var k=f.scale(),n=+a[0],p=+a[1];return d=f.translate(a).clipExtent([[n-.455*k,p-.238*k],[n+.455*k,p+.238*k]]).stream(m).point,e=h.translate([n-.307*k,p+.201*k]).clipExtent([[n-.425*k+D,p+.12*k+D],[n-.214*k-D,p+.234*k-D]]).stream(m).point,g=l.translate([n-.205*k,p+.212*k]).clipExtent([[n-.214*k+D,
p+.166*k+D],[n-.115*k-D,p+.234*k-D]]).stream(m).point,b},b.scale(1070)};var uc,ac,vc,wc,xc,yc,Pa={point:L,lineStart:L,lineEnd:L,polygonStart:function(){ac=0;Pa.lineStart=$g},polygonEnd:function(){Pa.lineStart=Pa.lineEnd=Pa.point=L;uc+=G(ac/2)}},ri={point:function(b,a){vc>b&&(vc=b);b>xc&&(xc=b);wc>a&&(wc=a);a>yc&&(yc=a)},lineStart:L,lineEnd:L,polygonStart:L,polygonEnd:L},ua={point:Xa,lineStart:Ie,lineEnd:Je,polygonStart:function(){ua.lineStart=bh},polygonEnd:function(){ua.point=Xa;ua.lineStart=Ie;
ua.lineEnd=Je}};t.geo.path=function(){function b(b){return b&&("function"==typeof h&&g.pointRadius(+h.apply(this,arguments)),f&&f.valid||(f=e(g)),t.geo.stream(b,f)),g.result()}var a,d,e,g,f,h=4.5;return b.area=function(b){return uc=0,t.geo.stream(b,e(Pa)),uc},b.centroid=function(b){return Ga=Ha=xa=na=oa=fa=Na=Oa=ya=0,t.geo.stream(b,e(ua)),ya?[Na/ya,Oa/ya]:fa?[na/fa,oa/fa]:xa?[Ga/xa,Ha/xa]:[0/0,0/0]},b.bounds=function(b){return xc=yc=-(vc=wc=1/0),t.geo.stream(b,e(ri)),[[vc,wc],[xc,yc]]},b.projection=
function(d){return arguments.length?(e=(a=d)?d.stream||dh(d):Y,f=null,b):a},b.context=function(a){return arguments.length?(g=null==(d=a)?new ah:new ch(a),"function"!=typeof h&&g.pointRadius(h),f=null,b):d},b.pointRadius=function(a){return arguments.length?(h="function"==typeof a?a:(g.pointRadius(+a),+a),b):h},b.projection(t.geo.albersUsa()).context(null)};t.geo.transform=function(b){return{stream:function(a){a=new Ne(a);for(var d in b)a[d]=b[d];return a}}};Ne.prototype={point:function(b,a){this.stream.point(b,
a)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};t.geo.projection=Qa;t.geo.projectionMutator=bd;(t.geo.equirectangular=function(){return Qa(ub)}).raw=ub.invert=ub;t.geo.rotation=function(b){function a(d){return d=b(d[0]*J,d[1]*J),d[0]*=R,d[1]*=R,d}return b=cd(b[0]%360*J,b[1]*J,2<b.length?b[2]*J:0),a.invert=function(a){return a=
b.invert(a[0]*J,a[1]*J),a[0]*=R,a[1]*=R,a},a};Pe.invert=ub;t.geo.circle=function(){function b(){var b="function"==typeof e?e.apply(this,arguments):e,a=cd(-b[0]*J,-b[1]*J,0).invert,g=[];return d(null,null,1,{point:function(b,d){g.push(b=a(b,d));b[0]*=R;b[1]*=R}}),{type:"Polygon",coordinates:[g]}}var a,d,e=[0,0],g=6;return b.origin=function(a){return arguments.length?(e=a,b):e},b.angle=function(e){return arguments.length?(d=$c((a=+e)*J,g*J),b):a},b.precision=function(e){return arguments.length?(d=$c(a*
J,(g=+e)*J),b):g},b.angle(90)};t.geo.distance=function(b,a){var d,e=(a[0]-b[0])*J,g=b[1]*J,f=a[1]*J,h=Math.sin(e),e=Math.cos(e),l=Math.sin(g),g=Math.cos(g),m=Math.sin(f),f=Math.cos(f);return Math.atan2(Math.sqrt((d=f*h)*d+(d=g*m-l*f*e)*d),l*m+g*f*e)};t.geo.graticule=function(){function b(){return{type:"MultiLineString",coordinates:a()}}function a(){return t.range(Math.ceil(f/A)*A,g,A).map(r).concat(t.range(Math.ceil(n/B)*B,m,B).map(w)).concat(t.range(Math.ceil(e/z)*z,d,z).filter(function(b){return G(b%
A)>D}).map(p)).concat(t.range(Math.ceil(l/x)*x,h,x).filter(function(b){return G(b%B)>D}).map(q))}var d,e,g,f,h,l,m,n,p,q,r,w,z=10,x=z,A=90,B=360,M=2.5;return b.lines=function(){return a().map(function(b){return{type:"LineString",coordinates:b}})},b.outline=function(){return{type:"Polygon",coordinates:[r(f).concat(w(m).slice(1),r(g).reverse().slice(1),w(n).reverse().slice(1))]}},b.extent=function(a){return arguments.length?b.majorExtent(a).minorExtent(a):b.minorExtent()},b.majorExtent=function(a){return arguments.length?
(f=+a[0][0],g=+a[1][0],n=+a[0][1],m=+a[1][1],f>g&&(a=f,f=g,g=a),n>m&&(a=n,n=m,m=a),b.precision(M)):[[f,n],[g,m]]},b.minorExtent=function(a){return arguments.length?(e=+a[0][0],d=+a[1][0],l=+a[0][1],h=+a[1][1],e>d&&(a=e,e=d,d=a),l>h&&(a=l,l=h,h=a),b.precision(M)):[[e,l],[d,h]]},b.step=function(a){return arguments.length?b.majorStep(a).minorStep(a):b.minorStep()},b.majorStep=function(a){return arguments.length?(A=+a[0],B=+a[1],b):[A,B]},b.minorStep=function(a){return arguments.length?(z=+a[0],x=+a[1],
b):[z,x]},b.precision=function(a){return arguments.length?(M=+a,p=Ue(l,h,90),q=Ve(e,d,M),r=Ue(n,m,90),w=Ve(f,g,M),b):M},b.majorExtent([[-180,-90+D],[180,90-D]]).minorExtent([[-180,-80-D],[180,80+D]])};t.geo.greatArc=function(){function b(){return{type:"LineString",coordinates:[a||e.apply(this,arguments),d||g.apply(this,arguments)]}}var a,d,e=dd,g=ed;return b.distance=function(){return t.geo.distance(a||e.apply(this,arguments),d||g.apply(this,arguments))},b.source=function(d){return arguments.length?
(e=d,a="function"==typeof d?null:d,b):e},b.target=function(a){return arguments.length?(g=a,d="function"==typeof a?null:a,b):g},b.precision=function(){return arguments.length?b:0},b};t.geo.interpolate=function(b,a){return eh(b[0]*J,b[1]*J,a[0]*J,a[1]*J)};t.geo.length=function(b){return zc=0,t.geo.stream(b,pb),zc};var zc,pb={sphere:L,point:L,lineStart:function(){function b(b,g){var f=Math.sin(g*=J),h=Math.cos(g),l=G((b*=J)-a),m=Math.cos(l);zc+=Math.atan2(Math.sqrt((l=h*Math.sin(l))*l+(l=e*f-d*h*m)*
l),d*f+e*h*m);a=b;d=f;e=h}var a,d,e;pb.point=function(g,f){a=g*J;d=Math.sin(f*=J);e=Math.cos(f);pb.point=b};pb.lineEnd=function(){pb.point=pb.lineEnd=L}},lineEnd:L,polygonStart:L,polygonEnd:L},gg=vb(function(b){return Math.sqrt(2/(1+b))},function(b){return 2*Math.asin(b/2)});(t.geo.azimuthalEqualArea=function(){return Qa(gg)}).raw=gg;var hg=vb(function(b){return(b=Math.acos(b))&&b/Math.sin(b)},Y);(t.geo.azimuthalEquidistant=function(){return Qa(hg)}).raw=hg;(t.geo.conicConformal=function(){return ad(We)}).raw=
We;(t.geo.conicEquidistant=function(){return ad(Xe)}).raw=Xe;var ig=vb(function(b){return 1/b},Math.atan);(t.geo.gnomonic=function(){return Qa(ig)}).raw=ig;bc.invert=function(b,a){return[b,2*Math.atan(Math.exp(a))-Z]};(t.geo.mercator=function(){return Ye(bc)}).raw=bc;var jg=vb(function(){return 1},Math.asin);(t.geo.orthographic=function(){return Qa(jg)}).raw=jg;var kg=vb(function(b){return 1/(1+b)},function(b){return 2*Math.atan(b)});(t.geo.stereographic=function(){return Qa(kg)}).raw=kg;fd.invert=
function(b,a){return[-a,2*Math.atan(Math.exp(b))-Z]};(t.geo.transverseMercator=function(){var b=Ye(fd),a=b.center,d=b.rotate;return b.center=function(b){return b?a([-b[1],b[0]]):(b=a(),[b[1],-b[0]])},b.rotate=function(b){return b?d([b[0],b[1],2<b.length?b[2]+90:90]):(b=d(),[b[0],b[1],b[2]-90])},d([0,0,90])}).raw=fd;t.geom={};t.geom.hull=function(b){function a(b){if(3>b.length)return[];var g,k=Q(d),f=Q(e),h=b.length,l=[],m=[];for(g=0;h>g;g++)l.push([+k.call(this,b[g],g),+f.call(this,b[g],g),g]);l.sort(fh);
for(g=0;h>g;g++)m.push([l[g][0],-l[g][1]]);var k=Ze(l),m=Ze(m),f=m[0]===k[0],h=m[m.length-1]===k[k.length-1],n=[];for(g=k.length-1;0<=g;--g)n.push(b[l[k[g]][2]]);for(g=+f;g<m.length-h;++g)n.push(b[l[m[g]][2]]);return n}var d=ib,e=wb;return arguments.length?a(b):(a.x=function(b){return arguments.length?(d=b,a):d},a.y=function(b){return arguments.length?(e=b,a):e},a)};t.geom.polygon=function(b){return Fb(b,Ac),b};var Ac=t.geom.polygon.prototype=[];Ac.area=function(){for(var b,a=-1,d=this.length,e=this[d-
1],g=0;++a<d;)b=e,e=this[a],g+=b[1]*e[0]-b[0]*e[1];return.5*g};Ac.centroid=function(b){var a,d,e=-1,g=this.length,f=0,h=0,l=this[g-1];for(arguments.length||(b=-1/(6*this.area()));++e<g;)a=l,l=this[e],d=a[0]*l[1]-l[0]*a[1],f+=(a[0]+l[0])*d,h+=(a[1]+l[1])*d;return[f*b,h*b]};Ac.clip=function(b){for(var a,d,e,g,f,h,l=af(b),m=-1,n=this.length-af(this),p=this[n-1];++m<n;){a=b.slice();b.length=0;g=this[m];f=a[(e=a.length-l)-1];for(d=-1;++d<e;)h=a[d],gd(h,p,g)?(gd(f,p,g)||b.push($e(f,h,p,g)),b.push(h)):gd(f,
p,g)&&b.push($e(f,h,p,g)),f=h;l&&b.push(b[0]);p=g}return b};var mb,Ya,kb,jd,xb,cf=[],gf=[];ef.prototype.prepare=function(){for(var b,a=this.edges,d=a.length;d--;)b=a[d].edge,b.b&&b.a||a.splice(d,1);return a.sort(ff),a.length};ec.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};kd.prototype={insert:function(b,a){var d,e,g;if(b){if(a.P=b,a.N=b.N,b.N&&(b.N.P=a),b.N=a,b.R){for(b=b.R;b.L;)b=b.L;b.L=
a}else b.R=a;d=b}else this._?(b=jf(this._),a.P=null,a.N=b,b.P=b.L=a,d=b):(a.P=a.N=null,this._=a,d=null);a.L=a.R=null;a.U=d;a.C=!0;for(b=a;d&&d.C;)e=d.U,d===e.L?(g=e.R,g&&g.C?(d.C=g.C=!1,e.C=!0,b=e):(b===d.R&&(zb(this,d),b=d,d=b.U),d.C=!1,e.C=!0,Ab(this,e))):(g=e.L,g&&g.C?(d.C=g.C=!1,e.C=!0,b=e):(b===d.L&&(Ab(this,d),b=d,d=b.U),d.C=!1,e.C=!0,zb(this,e))),d=b.U;this._.C=!1},remove:function(b){b.N&&(b.N.P=b.P);b.P&&(b.P.N=b.N);b.N=b.P=null;var a,d,e,g=b.U,f=b.L,h=b.R;if(d=f?h?jf(h):f:h,g?g.L===b?g.L=
d:g.R=d:this._=d,f&&h?(e=d.C,d.C=b.C,d.L=f,f.U=d,d!==h?(g=d.U,d.U=b.U,b=d.R,g.L=b,d.R=h,h.U=d):(d.U=g,g=d,b=d.R)):(e=b.C,b=d),b&&(b.U=g),!e){if(b&&b.C)return b.C=!1,void 0;do{if(b===this._)break;if(b===g.L){if(a=g.R,a.C&&(a.C=!1,g.C=!0,zb(this,g),a=g.R),a.L&&a.L.C||a.R&&a.R.C){a.R&&a.R.C||(a.L.C=!1,a.C=!0,Ab(this,a),a=g.R);a.C=g.C;g.C=a.R.C=!1;zb(this,g);b=this._;break}}else if(a=g.L,a.C&&(a.C=!1,g.C=!0,Ab(this,g),a=g.L),a.L&&a.L.C||a.R&&a.R.C){a.L&&a.L.C||(a.R.C=!1,a.C=!0,zb(this,a),a=g.L);a.C=g.C;
g.C=a.L.C=!1;Ab(this,g);b=this._;break}a.C=!0;b=g;g=g.U}while(!b.C);b&&(b.C=!1)}}};t.geom.voronoi=function(b){function a(b){var e=Array(b.length),g=l[0][0],f=l[0][1],k=l[1][0],h=l[1][1];return ld(d(b),l).cells.forEach(function(a,d){var l=a.edges,m=a.site;(e[d]=l.length?l.map(function(b){b=b.start();return[b.x,b.y]}):m.x>=g&&m.x<=k&&m.y>=f&&m.y<=h?[[g,h],[k,h],[k,f],[g,f]]:[]).point=b[d]}),e}function d(b){return b.map(function(b,a){return{x:Math.round(f(b,a)/D)*D,y:Math.round(h(b,a)/D)*D,i:a}})}var e=
ib,g=wb,f=e,h=g,l=Bc;return b?a(b):(a.links=function(b){return ld(d(b)).edges.filter(function(b){return b.l&&b.r}).map(function(a){return{source:b[a.l.i],target:b[a.r.i]}})},a.triangles=function(b){var a=[];return ld(d(b)).cells.forEach(function(d,e){for(var g,f=d.site,k=d.edges.sort(ff),h=-1,l=k.length,m=k[l-1].edge,m=m.l===f?m.r:m.l;++h<l;)g=m,m=k[h].edge,m=m.l===f?m.r:m.l,e<g.i&&e<m.i&&0>(f.x-m.x)*(g.y-f.y)-(f.x-g.x)*(m.y-f.y)&&a.push([b[e],b[g.i],b[m.i]])}),a},a.x=function(b){return arguments.length?
(f=Q(e=b),a):e},a.y=function(b){return arguments.length?(h=Q(g=b),a):g},a.clipExtent=function(b){return arguments.length?(l=null==b?Bc:b,a):l===Bc?null:l},a.size=function(b){return arguments.length?a.clipExtent(b&&[[0,0],b]):l===Bc?null:l&&l[1]},a)};var Bc=[[-1E6,-1E6],[1E6,1E6]];t.geom.delaunay=function(b){return t.geom.voronoi().triangles(b)};t.geom.quadtree=function(b,a,d,e,g){function f(b){function n(b,a,d,e,g,f,k,h){if(!isNaN(d)&&!isNaN(e))if(b.leaf){var l=b.x,m=b.y;if(null!=l){if(!(.01>G(l-
d)+G(m-e))){var v=b.point;b.x=b.y=b.point=null;p(b,v,l,m,g,f,k,h)}p(b,a,d,e,g,f,k,h)}else b.x=d,b.y=e,b.point=a}else p(b,a,d,e,g,f,k,h)}function p(b,a,d,e,g,f,k,h){var l=.5*(g+k),m=.5*(f+h),v=d>=l,q=e>=m,y=(q<<1)+v;b.leaf=!1;b=b.nodes[y]||(b.nodes[y]=kf());v?g=l:k=l;q?f=m:h=m;n(b,a,d,e,g,f,k,h)}var q,y,r,t,w,z,x,A,B,E=Q(l),L=Q(m);if(null!=a)z=a,x=d,A=e,B=g;else if(A=B=-(z=x=1/0),y=[],r=[],w=b.length,h)for(t=0;w>t;++t)q=b[t],q.x<z&&(z=q.x),q.y<x&&(x=q.y),q.x>A&&(A=q.x),q.y>B&&(B=q.y),y.push(q.x),r.push(q.y);
else for(t=0;w>t;++t){var C=+E(q=b[t],t);q=+L(q,t);z>C&&(z=C);x>q&&(x=q);C>A&&(A=C);q>B&&(B=q);y.push(C);r.push(q)}C=A-z;q=B-x;C>q?B=x+C:A=z+q;var D=kf();if(D.add=function(b){n(D,b,+E(b,++t),+L(b,t),z,x,A,B)},D.visit=function(b){Bb(b,D,z,x,A,B)},t=-1,null==a){for(;++t<w;)n(D,b[t],y[t],r[t],z,x,A,B);--t}else b.forEach(D.add);return y=r=b=q=null,D}var h,l=ib,m=wb;return(h=arguments.length)?(l=lh,m=mh,3===h&&(g=d,e=a,d=a=0),f(b)):(f.x=function(b){return arguments.length?(l=b,f):l},f.y=function(b){return arguments.length?
(m=b,f):m},f.extent=function(b){return arguments.length?(null==b?a=d=e=g=null:(a=+b[0][0],d=+b[0][1],e=+b[1][0],g=+b[1][1]),f):null==a?null:[[a,d],[e,g]]},f.size=function(b){return arguments.length?(null==b?a=d=e=g=null:(a=d=0,e=+b[0],g=+b[1]),f):null==a?null:[e-a,g-d]},f)};t.interpolateRgb=md;t.interpolateObject=lf;t.interpolateNumber=Ia;t.interpolateString=mf;var nd=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,od=new RegExp(nd.source,"g");t.interpolate=Za;t.interpolators=[function(b,a){var d=typeof a;
return("string"===d?Jb.has(a)||/^(#|rgb\(|hsl\()/.test(a)?md:mf:a instanceof Ta?md:Array.isArray(a)?fc:"object"===d&&isNaN(a)?lf:Ia)(b,a)}];t.interpolateArray=fc;var lg=function(){return Y},si=t.map({linear:lg,poly:function(b){return function(a){return Math.pow(a,b)}},quad:function(){return oh},cubic:function(){return ph},sin:function(){return rh},exp:function(){return sh},circle:function(){return th},elastic:function(b,a){var d;return 2>arguments.length&&(a=.45),arguments.length?d=a/ja*Math.asin(1/
b):(b=1,d=a/4),function(e){return 1+b*Math.pow(2,-10*e)*Math.sin((e-d)*ja/a)}},back:function(b){return b||(b=1.70158),function(a){return a*a*((b+1)*a-b)}},bounce:function(){return uh}}),ti=t.map({"in":Y,out:nf,"in-out":of,"out-in":function(b){return of(nf(b))}});t.ease=function(b){var a=b.indexOf("-"),d=0<=a?b.slice(0,a):b,a=0<=a?b.slice(a+1):"in";return d=si.get(d)||lg,a=ti.get(a)||Y,nh(a(d.apply(null,Zf.call(arguments,1))))};t.interpolateHcl=function(b,a){b=t.hcl(b);a=t.hcl(a);var d=b.h,e=b.c,g=
b.l,f=a.h-d,h=a.c-e,l=a.l-g;return isNaN(h)&&(h=0,e=isNaN(e)?a.c:e),isNaN(f)?(f=0,d=isNaN(d)?a.h:d):180<f?f-=360:-180>f&&(f+=360),function(b){return Nc(d+f*b,e+h*b,g+l*b)+""}};t.interpolateHsl=function(b,a){b=t.hsl(b);a=t.hsl(a);var d=b.h,e=b.s,g=b.l,f=a.h-d,h=a.s-e,l=a.l-g;return isNaN(h)&&(h=0,e=isNaN(e)?a.s:e),isNaN(f)?(f=0,d=isNaN(d)?a.h:d):180<f?f-=360:-180>f&&(f+=360),function(b){return Mc(d+f*b,e+h*b,g+l*b)+""}};t.interpolateLab=function(b,a){b=t.lab(b);a=t.lab(a);var d=b.l,e=b.a,g=b.b,f=a.l-
d,h=a.a-e,l=a.b-g;return function(b){return ie(d+f*b,e+h*b,g+l*b)+""}};t.interpolateRound=pf;t.transform=function(b){var a=va.createElementNS(t.ns.prefix.svg,"g");return(t.transform=function(b){if(null!=b){a.setAttribute("transform",b);var d=a.transform.baseVal.consolidate()}return new qf(d?d.matrix:ui)})(b)};qf.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ui={a:1,b:0,c:0,d:1,e:0,f:0};t.interpolateTransform=
sf;t.layout={};t.layout.bundle=function(){return function(b){for(var a=[],d=-1,e=b.length;++d<e;)a.push(xh(b[d]));return a}};t.layout.chord=function(){function b(){var b,n,q,r,w,z={},x=[],A=t.range(f),B=[];d=[];e=[];b=0;for(r=-1;++r<f;){n=0;for(w=-1;++w<f;)n+=g[r][w];x.push(n);B.push(t.range(f));b+=n}h&&A.sort(function(b,a){return h(x[b],x[a])});l&&B.forEach(function(b,a){b.sort(function(b,d){return l(g[a][b],g[a][d])})});b=(ja-p*f)/b;n=0;for(r=-1;++r<f;){q=n;for(w=-1;++w<f;){var ga=A[r],E=B[ga][w],
C=g[ga][E],L=n,D=n+=C*b;z[ga+"-"+E]={index:ga,subindex:E,startAngle:L,endAngle:D,value:C}}e[ga]={index:ga,startAngle:q,endAngle:n,value:(n-q)/b};n+=p}for(r=-1;++r<f;)for(w=r-1;++w<f;)b=z[r+"-"+w],n=z[w+"-"+r],(b.value||n.value)&&d.push(b.value<n.value?{source:n,target:b}:{source:b,target:n});m&&a()}function a(){d.sort(function(b,a){return m((b.source.value+b.target.value)/2,(a.source.value+a.target.value)/2)})}var d,e,g,f,h,l,m,n={},p=0;return n.matrix=function(b){return arguments.length?(f=(g=b)&&
g.length,d=e=null,n):g},n.padding=function(b){return arguments.length?(p=b,d=e=null,n):p},n.sortGroups=function(b){return arguments.length?(h=b,d=e=null,n):h},n.sortSubgroups=function(b){return arguments.length?(l=b,d=null,n):l},n.sortChords=function(b){return arguments.length?(m=b,d&&a(),n):m},n.chords=function(){return d||b(),d},n.groups=function(){return e||b(),e},n};t.layout.force=function(){function b(b){return function(a,d,e,g){if(a.point!==b){e=a.cx-b.x;var f=a.cy-b.y;d=g-d;g=e*e+f*f;if(g>
d*d/A)return z>g&&(d=a.charge/g,b.px-=e*d,b.py-=f*d),!0;a.point&&g&&z>g&&(d=a.pointCharge/g,b.px-=e*d,b.py-=f*d)}return!a.charge}}function a(b){b.px=t.event.x;b.py=t.event.y;l.resume()}var d,e,g,f,h,l={},m=t.dispatch("start","tick","end"),n=[1,1],p=.9,q=vi,r=wi,w=-30,z=xi,x=.1,A=.64,B=[],M=[];return l.tick=function(){if(.005>(e*=.99))return m.end({type:"end",alpha:e=0}),!0;var a,d,k,l,q,v,r,z,A=B.length,U=M.length;for(d=0;U>d;++d)k=M[d],a=k.source,l=k.target,r=l.x-a.x,z=l.y-a.y,(q=r*r+z*z)&&(q=e*
f[d]*((q=Math.sqrt(q))-g[d])/q,r*=q,z*=q,l.x-=r*(v=a.weight/(l.weight+a.weight)),l.y-=z*v,a.x+=r*(v=1-v),a.y+=z*v);if((v=e*x)&&(r=n[0]/2,z=n[1]/2,d=-1,v))for(;++d<A;)k=B[d],k.x+=(r-k.x)*v,k.y+=(z-k.y)*v;if(w)for(uf(a=t.geom.quadtree(B),e,h),d=-1;++d<A;)(k=B[d]).fixed||a.visit(b(k));for(d=-1;++d<A;)k=B[d],k.fixed?(k.x=k.px,k.y=k.py):(k.x-=(k.px-(k.px=k.x))*p,k.y-=(k.py-(k.py=k.y))*p);m.tick({type:"tick",alpha:e})},l.nodes=function(b){return arguments.length?(B=b,l):B},l.links=function(b){return arguments.length?
(M=b,l):M},l.size=function(b){return arguments.length?(n=b,l):n},l.linkDistance=function(b){return arguments.length?(q="function"==typeof b?b:+b,l):q},l.distance=l.linkDistance,l.linkStrength=function(b){return arguments.length?(r="function"==typeof b?b:+b,l):r},l.friction=function(b){return arguments.length?(p=+b,l):p},l.charge=function(b){return arguments.length?(w="function"==typeof b?b:+b,l):w},l.chargeDistance=function(b){return arguments.length?(z=b*b,l):Math.sqrt(z)},l.gravity=function(b){return arguments.length?
(x=+b,l):x},l.theta=function(b){return arguments.length?(A=b*b,l):Math.sqrt(A)},l.alpha=function(b){return arguments.length?(b=+b,e?e=0<b?b:0:0<b&&(m.start({type:"start",alpha:e=b}),t.timer(l.tick)),l):e},l.start=function(){function b(e,g){if(!d){d=Array(k);for(l=0;k>l;++l)d[l]=[];for(l=0;m>l;++l){var f=M[l];d[f.source.index].push(f.target);d[f.target.index].push(f.source)}}for(var h=d[a],l=-1,m=h.length;++l<m;)if(!isNaN(f=h[l][e]))return f;return Math.random()*g}var a,d,e,k=B.length,m=M.length,p=
n[0],v=n[1];for(a=0;k>a;++a)(e=B[a]).index=a,e.weight=0;for(a=0;m>a;++a)e=M[a],"number"==typeof e.source&&(e.source=B[e.source]),"number"==typeof e.target&&(e.target=B[e.target]),++e.source.weight,++e.target.weight;for(a=0;k>a;++a)e=B[a],isNaN(e.x)&&(e.x=b("x",p)),isNaN(e.y)&&(e.y=b("y",v)),isNaN(e.px)&&(e.px=e.x),isNaN(e.py)&&(e.py=e.y);if(g=[],"function"==typeof q)for(a=0;m>a;++a)g[a]=+q.call(this,M[a],a);else for(a=0;m>a;++a)g[a]=q;if(f=[],"function"==typeof r)for(a=0;m>a;++a)f[a]=+r.call(this,
M[a],a);else for(a=0;m>a;++a)f[a]=r;if(h=[],"function"==typeof w)for(a=0;k>a;++a)h[a]=+w.call(this,B[a],a);else for(a=0;k>a;++a)h[a]=w;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){return d||(d=t.behavior.drag().origin(Y).on("dragstart.force",yh).on("drag.force",a).on("dragend.force",zh)),arguments.length?(this.on("mouseover.force",Ah).on("mouseout.force",Bh).call(d),void 0):d},t.rebind(l,m,"on")};var vi=20,wi=1,xi=1/0;t.layout.hierarchy=
function(){function b(g){var f,h=[g],l=[];for(g.depth=0;null!=(f=h.pop());)if(l.push(f),(n=d.call(b,f,f.depth))&&(m=n.length)){for(var m,n,p;0<=--m;)h.push(p=n[m]),p.parent=f,p.depth=f.depth+1;e&&(f.value=0);f.children=n}else e&&(f.value=+e.call(b,f,f.depth)||0),delete f.children;return za(g,function(b){var d,g;a&&(d=b.children)&&d.sort(a);e&&(g=b.parent)&&(g.value+=b.value)}),l}var a=Fh,d=Dh,e=Eh;return b.sort=function(d){return arguments.length?(a=d,b):a},b.children=function(a){return arguments.length?
(d=a,b):d},b.value=function(a){return arguments.length?(e=a,b):e},b.revalue=function(a){return e&&(Db(a,function(b){b.children&&(b.value=0)}),za(a,function(a){var d;a.children||(a.value=+e.call(b,a,a.depth)||0);(d=a.parent)&&(d.value+=a.value)})),a},b};t.layout.partition=function(){function b(a,d,e,g){var f=a.children;if(a.x=d,a.y=a.depth*g,a.dx=e,a.dy=g,f&&(k=f.length)){var k,h,l=-1;for(e=a.value?e/a.value:0;++l<k;)b(h=f[l],d,a=h.value*e,g),d+=a}}function a(b){b=b.children;var d=0;if(b&&(e=b.length))for(var e,
g=-1;++g<e;)d=Math.max(d,a(b[g]));return 1+d}function d(f,h){var l=e.call(this,f,h);return b(l[0],0,g[0],g[1]/a(l[0])),l}var e=t.layout.hierarchy(),g=[1,1];return d.size=function(b){return arguments.length?(g=b,d):g},Cb(d,e)};t.layout.pie=function(){function b(f){var h=f.map(function(d,e){return+a.call(b,d,e)}),l=+("function"==typeof e?e.apply(this,arguments):e),m=(("function"==typeof g?g.apply(this,arguments):g)-l)/t.sum(h),n=t.range(f.length);null!=d&&n.sort(d===mg?function(b,a){return h[a]-h[b]}:
function(b,a){return d(f[b],f[a])});var p=[];return n.forEach(function(b){var a;p[b]={data:f[b],value:a=h[b],startAngle:l,endAngle:l+=a*m}}),p}var a=Number,d=mg,e=0,g=ja;return b.value=function(d){return arguments.length?(a=d,b):a},b.sort=function(a){return arguments.length?(d=a,b):d},b.startAngle=function(a){return arguments.length?(e=a,b):e},b.endAngle=function(a){return arguments.length?(g=a,b):g},b};var mg={};t.layout.stack=function(){function b(l,m){if(!(r=l.length))return l;var n=l.map(function(d,
e){return a.call(b,d,e)}),p=n.map(function(a){return a.map(function(a,d){return[f.call(b,a,d),h.call(b,a,d)]})}),q=d.call(b,p,m),n=t.permute(n,q),p=t.permute(p,q),r,w,z,x=e.call(b,p,m),A=n[0].length;for(w=0;A>w;++w)for(g.call(b,n[0][w],z=x[w],p[0][w][1]),q=1;r>q;++q)g.call(b,n[q][w],z+=p[q-1][w][1],p[q][w][1]);return l}var a=Y,d=pd,e=qd,g=Ih,f=Gh,h=Hh;return b.values=function(d){return arguments.length?(a=d,b):a},b.order=function(a){return arguments.length?(d="function"==typeof a?a:yi.get(a)||pd,
b):d},b.offset=function(a){return arguments.length?(e="function"==typeof a?a:zi.get(a)||qd,b):e},b.x=function(a){return arguments.length?(f=a,b):f},b.y=function(a){return arguments.length?(h=a,b):h},b.out=function(a){return arguments.length?(g=a,b):g},b};var yi=t.map({"inside-out":function(b){var a,d=b.length,e=b.map(Jh),g=b.map(Kh),f=t.range(d).sort(function(b,a){return e[b]-e[a]}),h=0,l=0,m=[],n=[];for(b=0;d>b;++b)a=f[b],l>h?(h+=g[a],m.push(a)):(l+=g[a],n.push(a));return n.reverse().concat(m)},
reverse:function(b){return t.range(b.length).reverse()},"default":pd}),zi=t.map({silhouette:function(b){var a,d,e,g=b.length,f=b[0].length,h=[],l=0,m=[];for(d=0;f>d;++d){for(e=a=0;g>a;a++)e+=b[a][d][1];e>l&&(l=e);h.push(e)}for(d=0;f>d;++d)m[d]=(l-h[d])/2;return m},wiggle:function(b){var a,d,e,g,f,h,l,m,n,p=b.length,q=b[0],r=q.length,t=[];t[0]=m=n=0;for(d=1;r>d;++d){for(g=a=0;p>a;++a)g+=b[a][d][1];f=a=0;for(l=q[d][0]-q[d-1][0];p>a;++a){e=0;for(h=(b[a][d][1]-b[a][d-1][1])/(2*l);a>e;++e)h+=(b[e][d][1]-
b[e][d-1][1])/l;f+=h*b[a][d][1]}t[d]=m-=g?f/g*l:0;n>m&&(n=m)}for(d=0;r>d;++d)t[d]-=n;return t},expand:function(b){var a,d,e,g=b.length,f=b[0].length,h=1/g,l=[];for(d=0;f>d;++d){for(e=a=0;g>a;a++)e+=b[a][d][1];if(e)for(a=0;g>a;a++)b[a][d][1]/=e;else for(a=0;g>a;a++)b[a][d][1]=h}for(d=0;f>d;++d)l[d]=0;return l},zero:qd});t.layout.histogram=function(){function b(b,f){var h,l,m=[],n=b.map(d,this),p=e.call(this,n,f),q=g.call(this,p,n,f);f=-1;for(var r=n.length,w=q.length-1,z=a?1:1/r;++f<w;)h=m[f]=[],h.dx=
q[f+1]-(h.x=q[f]),h.y=0;if(0<w)for(f=-1;++f<r;)l=n[f],l>=p[0]&&l<=p[1]&&(h=m[t.bisect(q,l,1,w)-1],h.y+=z,h.push(b[f]));return m}var a=!0,d=Number,e=Nh,g=Mh;return b.value=function(a){return arguments.length?(d=a,b):d},b.range=function(a){return arguments.length?(e=Q(a),b):e},b.bins=function(a){return arguments.length?(g="number"==typeof a?function(b){return vf(b,a)}:Q(a),b):g},b.frequency=function(d){return arguments.length?(a=!!d,b):a},b};t.layout.pack=function(){function b(b,f){var h=d.call(this,
b,f),l=h[0],m=g[0],n=g[1],p=null==a?Math.sqrt:"function"==typeof a?a:function(){return a};if(l.x=l.y=0,za(l,function(b){b.r=+p(b.value)}),za(l,yf),e){var q=e*(a?1:Math.max(2*l.r/m,2*l.r/n))/2;za(l,function(b){b.r+=q});za(l,yf);za(l,function(b){b.r-=q})}return Af(l,m/2,n/2,a?1:1/Math.max(2*l.r/m,2*l.r/n)),h}var a,d=t.layout.hierarchy().sort(Oh),e=0,g=[1,1];return b.size=function(a){return arguments.length?(g=a,b):g},b.radius=function(d){return arguments.length?(a=null==d||"function"==typeof d?d:+d,
b):a},b.padding=function(a){return arguments.length?(e=+a,b):e},Cb(b,d)};t.layout.tree=function(){function b(b,n){var p=f.call(this,b,n),q=p[0],r=a(q);if(za(r,d),r.parent.m=-r.z,Db(r,e),m)Db(q,g);else{var t=q,w=q,z=q;Db(q,function(b){b.x<t.x&&(t=b);b.x>w.x&&(w=b);b.depth>z.depth&&(z=b)});var x=h(t,w)/2-t.x,A=l[0]/(w.x+h(w,t)/2+x),B=l[1]/(z.depth||1);Db(q,function(b){b.x=(b.x+x)*A;b.y=b.depth*B})}return p}function a(b){for(var d={A:null,children:[b]},e=[d];null!=(b=e.pop());)for(var g,f=b.children,
k=0,h=f.length;h>k;++k)e.push((f[k]=g={_:f[k],parent:b,children:(g=f[k].children)&&g.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:k}).a=g);return d.children[0]}function d(b){var a=b.children,e=b.parent.children,g=b.i?e[b.i-1]:null;if(a.length){for(var f,k=0,l=0,m=b.children,n=m.length;0<=--n;)f=m[n],f.z+=k,f.m+=k,k+=f.s+(l+=f.c);a=(a[0].z+a[a.length-1].z)/2;g?(b.z=g.z+h(b._,g._),b.m=b.z-a):b.z=a}else g&&(b.z=g.z+h(b._,g._));a=b.parent;e=b.parent.A||e[0];if(g){for(var k=f=b,l=g,m=f.parent.children[0],
n=f.m,p=k.m,q=l.m,v=m.m;l=td(l),f=sd(f),l&&f;){m=sd(m);k=td(k);k.a=b;g=l.z+q-f.z-n+h(l._,f._);if(0<g){var r=l.a.parent===b.parent?l.a:e,t=b,w=g,y=w/(t.i-r.i);t.c-=y;t.s+=w;r.c+=y;t.z+=w;t.m+=w;n+=g;p+=g}q+=l.m;n+=f.m;v+=m.m;p+=k.m}l&&!td(k)&&(k.t=l,k.m+=q-p);f&&!sd(m)&&(m.t=f,m.m+=n-v,e=b)}a.A=e}function e(b){b._.x=b.z+b.parent.m;b.m+=b.parent.m}function g(b){b.x*=l[0];b.y=b.depth*l[1]}var f=t.layout.hierarchy().sort(null).value(null),h=Bf,l=[1,1],m=null;return b.separation=function(a){return arguments.length?
(h=a,b):h},b.size=function(a){return arguments.length?(m=null==(l=a)?g:null,b):m?null:l},b.nodeSize=function(a){return arguments.length?(m=null==(l=a)?null:g,b):m?l:null},Cb(b,f)};t.layout.cluster=function(){function b(b,f){var h,l=a.call(this,b,f),m=l[0],n=0;za(m,function(b){var a=b.children;a&&a.length?(b.x=Sh(a),b.y=Rh(a)):(b.x=h?n+=d(b,h):0,b.y=0,h=b)});var p=Cf(m),q=Df(m),r=p.x-d(p,q)/2,t=q.x+d(q,p)/2;return za(m,g?function(b){b.x=(b.x-m.x)*e[0];b.y=(m.y-b.y)*e[1]}:function(b){b.x=(b.x-r)/(t-
r)*e[0];b.y=(1-(m.y?b.y/m.y:1))*e[1]}),l}var a=t.layout.hierarchy().sort(null).value(null),d=Bf,e=[1,1],g=!1;return b.separation=function(a){return arguments.length?(d=a,b):d},b.size=function(a){return arguments.length?(g=null==(e=a),b):g?null:e},b.nodeSize=function(a){return arguments.length?(g=null!=(e=a),b):g?e:null},Cb(b,a)};t.layout.treemap=function(){function b(b,a){for(var d,e,g=-1,f=b.length;++g<f;)e=(d=b[g]).value*(0>a?0:a),d.area=isNaN(e)||0>=e?0:e}function a(d){var g=d.children;if(g&&g.length){var f,
h=p(d),l=[],m=g.slice(),n=1/0,q="slice"===r?h.dx:"dice"===r?h.dy:"slice-dice"===r?1&d.depth?h.dy:h.dx:Math.min(h.dx,h.dy);b(m,h.dx*h.dy/d.value);for(l.area=0;0<(d=m.length);){l.push(d=m[d-1]);l.area+=d.area;var v;if(!(v="squarify"!==r)){d=q;f=void 0;var t=l.area;v=0;for(var y=1/0,z=-1,x=l.length;++z<x;)(f=l[z].area)&&(y>f&&(y=f),f>v&&(v=f));v=(f=(t*=t,d*=d,t?Math.max(d*v*w/t,t/(d*y*w)):1/0))<=n}v?(m.pop(),n=f):(l.area-=l.pop().area,e(l,q,h,!1),q=Math.min(h.dx,h.dy),l.length=l.area=0,n=1/0)}l.length&&
(e(l,q,h,!0),l.length=l.area=0);g.forEach(a)}}function d(a){var g=a.children;if(g&&g.length){var f=p(a),k=g.slice(),h=[];b(k,f.dx*f.dy/a.value);for(h.area=0;a=k.pop();)h.push(a),h.area+=a.area,null!=a.z&&(e(h,a.z?f.dx:f.dy,f,!k.length),h.length=h.area=0);g.forEach(d)}}function e(b,a,d,g){var f,k=-1,h=b.length,m=d.x,n=d.y,p=a?l(b.area/a):0;if(a==d.dx){for((g||p>d.dy)&&(p=d.dy);++k<h;)f=b[k],f.x=m,f.y=n,f.dy=p,m+=f.dx=Math.min(d.x+d.dx-m,p?l(f.area/p):0);f.z=!0;f.dx+=d.x+d.dx-m;d.y+=p;d.dy-=p}else{for((g||
p>d.dx)&&(p=d.dx);++k<h;)f=b[k],f.x=m,f.y=n,f.dx=p,n+=f.dy=Math.min(d.y+d.dy-n,p?l(f.area/p):0);f.z=!1;f.dy+=d.y+d.dy-n;d.x+=p;d.dx-=p}}function g(e){e=f||h(e);var l=e[0];return l.x=0,l.y=0,l.dx=m[0],l.dy=m[1],f&&h.revalue(l),b([l],l.dx*l.dy/l.value),(f?d:a)(l),q&&(f=e),e}var f,h=t.layout.hierarchy(),l=Math.round,m=[1,1],n=null,p=ud,q=!1,r="squarify",w=.5*(1+Math.sqrt(5));return g.size=function(b){return arguments.length?(m=b,g):m},g.padding=function(b){function a(d){var e=b.call(g,d,d.depth);return null==
e?ud(d):Ef(d,"number"==typeof e?[e,e,e,e]:e)}function d(a){return Ef(a,b)}if(!arguments.length)return n;var e;return p=null==(n=b)?ud:"function"==(e=typeof b)?a:"number"===e?(b=[b,b,b,b],d):d,g},g.round=function(b){return arguments.length?(l=b?Math.round:Number,g):l!=Number},g.sticky=function(b){return arguments.length?(q=b,f=null,g):q},g.ratio=function(b){return arguments.length?(w=b,g):w},g.mode=function(b){return arguments.length?(r=b+"",g):r},Cb(g,h)};t.random={normal:function(b,a){var d=arguments.length;
return 2>d&&(a=1),1>d&&(b=0),function(){var d,e;do d=2*Math.random()-1,e=2*Math.random()-1,e=d*d+e*e;while(!e||1<e);return b+a*d*Math.sqrt(-2*Math.log(e)/e)}},logNormal:function(){var b=t.random.normal.apply(t,arguments);return function(){return Math.exp(b())}},bates:function(b){var a=t.random.irwinHall(b);return function(){return a()/b}},irwinHall:function(b){return function(){for(var a=0,d=0;b>d;d++)a+=Math.random();return a}}};t.scale={};var Uh={floor:Y,ceil:Y};t.scale.linear=function(){return Gf([0,
1],[0,1],Za,!1)};var Xh={s:1,g:1,p:1,r:1,e:1};t.scale.log=function(){return Hf(t.scale.linear().domain([0,1]),10,!0,[1,10])};var If=t.format(".0e"),Yh={floor:function(b){return-Math.ceil(-b)},ceil:function(b){return-Math.floor(-b)}};t.scale.pow=function(){return Jf(t.scale.linear(),1,[0,1])};t.scale.sqrt=function(){return t.scale.pow().exponent(.5)};t.scale.ordinal=function(){return Kf([],{t:"range",a:[[]]})};t.scale.category10=function(){return t.scale.ordinal().range(Ai)};t.scale.category20=function(){return t.scale.ordinal().range(Bi)};
t.scale.category20b=function(){return t.scale.ordinal().range(Ci)};t.scale.category20c=function(){return t.scale.ordinal().range(Di)};var Ai=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Ib),Bi=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Ib),Ci=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,
12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Ib),Di=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Ib);t.scale.quantile=function(){return Lf([],[])};t.scale.quantize=function(){return Mf(0,1,[0,1])};t.scale.threshold=function(){return Nf([.5],[0,1])};t.scale.identity=function(){return Of([0,1])};t.svg={};t.svg.arc=
function(){function b(){var b=a.apply(this,arguments),f=d.apply(this,arguments),h=e.apply(this,arguments)+$a,l=g.apply(this,arguments)+$a,m=(h>l&&(m=h,h=l,l=m),l-h),n=H>m?"0":"1",p=Math.cos(h),h=Math.sin(h),q=Math.cos(l),l=Math.sin(l);return m>=Ei?b?"M0,"+f+"A"+f+","+f+" 0 1,1 0,"+-f+"A"+f+","+f+" 0 1,1 0,"+f+"M0,"+b+"A"+b+","+b+" 0 1,0 0,"+-b+"A"+b+","+b+" 0 1,0 0,"+b+"Z":"M0,"+f+"A"+f+","+f+" 0 1,1 0,"+-f+"A"+f+","+f+" 0 1,1 0,"+f+"Z":b?"M"+f*p+","+f*h+"A"+f+","+f+" 0 "+n+",1 "+f*q+","+f*l+"L"+
b*q+","+b*l+"A"+b+","+b+" 0 "+n+",0 "+b*p+","+b*h+"Z":"M"+f*p+","+f*h+"A"+f+","+f+" 0 "+n+",1 "+f*q+","+f*l+"L0,0Z"}var a=Zh,d=$h,e=Pf,g=Qf;return b.innerRadius=function(d){return arguments.length?(a=Q(d),b):a},b.outerRadius=function(a){return arguments.length?(d=Q(a),b):d},b.startAngle=function(a){return arguments.length?(e=Q(a),b):e},b.endAngle=function(a){return arguments.length?(g=Q(a),b):g},b.centroid=function(){var b=(a.apply(this,arguments)+d.apply(this,arguments))/2,f=(e.apply(this,arguments)+
g.apply(this,arguments))/2+$a;return[Math.cos(f)*b,Math.sin(f)*b]},b};var $a=-Z,Ei=ja-D;t.svg.line=function(){return Rf(Y)};var xd=t.map({linear:ka,"linear-closed":function(b){return ka(b)+"Z"},step:function(b){for(var a=0,d=b.length,e=b[0],g=[e[0],",",e[1]];++a<d;)g.push("H",(e[0]+(e=b[a])[0])/2,"V",e[1]);return 1<d&&g.push("H",e[0]),g.join("")},"step-before":yd,"step-after":zd,basis:Sf,"basis-open":function(b){if(4>b.length)return ka(b);for(var a,d=[],e=-1,g=b.length,f=[0],h=[0];3>++e;)a=b[e],f.push(a[0]),
h.push(a[1]);d.push(pa(Sa,f)+","+pa(Sa,h));for(--e;++e<g;)a=b[e],f.shift(),f.push(a[0]),h.shift(),h.push(a[1]),Bd(d,f,h);return d.join("")},"basis-closed":function(b){for(var a,d,e=-1,g=b.length,f=g+4,h=[],l=[];4>++e;)d=b[e%g],h.push(d[0]),l.push(d[1]);a=[pa(Sa,h),",",pa(Sa,l)];for(--e;++e<f;)d=b[e%g],h.shift(),h.push(d[0]),l.shift(),l.push(d[1]),Bd(a,h,l);return a.join("")},bundle:function(b,a){var d=b.length-1;if(d)for(var e,g,f=b[0][0],h=b[0][1],l=b[d][0]-f,m=b[d][1]-h,n=-1;++n<=d;)e=b[n],g=n/
d,e[0]=a*e[0]+(1-a)*(f+g*l),e[1]=a*e[1]+(1-a)*(h+g*m);return Sf(b)},cardinal:function(b,a){return 3>b.length?ka(b):b[0]+kc(b,Ad(b,a))},"cardinal-open":function(b,a){return 4>b.length?ka(b):b[1]+kc(b.slice(1,b.length-1),Ad(b,a))},"cardinal-closed":function(b,a){return 3>b.length?ka(b):b[0]+kc((b.push(b[0]),b),Ad([b[b.length-2]].concat(b,[b[1]]),a))},monotone:function(b){if(3>b.length)b=ka(b);else{var a=b[0],d,e,g,f,h=[],l;d=0;l=b.length-1;for(var m=[],n=b[1],p=m[0]=Cd(b[0],n);++d<l;)m[d]=(p+(p=Cd(n,
n=b[d+1])))/2;l=(m[d]=p,m);m=-1;for(n=b.length-1;++m<n;)d=Cd(b[m],b[m+1]),G(d)<D?l[m]=l[m+1]=0:(e=l[m]/d,g=l[m+1]/d,f=e*e+g*g,9<f&&(f=3*d/Math.sqrt(f),l[m]=f*e,l[m+1]=f*g));for(m=-1;++m<=n;)f=(b[Math.min(n,m+1)][0]-b[Math.max(0,m-1)][0])/(6*(1+l[m]*l[m])),h.push([f||0,l[m]*f||0]);b=a+kc(b,h)}return b}});xd.forEach(function(b,a){a.key=b;a.closed=/-closed$/.test(b)});var Tf=[0,2/3,1/3,0],Uf=[0,1/3,2/3,0],Sa=[0,1/6,2/3,1/6];t.svg.line.radial=function(){var b=Rf(Vf);return b.radius=b.x,delete b.x,b.angle=
b.y,delete b.y,b};yd.reverse=zd;zd.reverse=yd;t.svg.area=function(){return Wf(Y)};t.svg.area.radial=function(){var b=Wf(Vf);return b.radius=b.x,delete b.x,b.innerRadius=b.x0,delete b.x0,b.outerRadius=b.x1,delete b.x1,b.angle=b.y,delete b.y,b.startAngle=b.y0,delete b.y0,b.endAngle=b.y1,delete b.y1,b};t.svg.chord=function(){function b(b,f){var h=a(this,e,b,f),l=a(this,g,b,f);return"M"+h.p0+d(h.r,h.p1,h.a1-h.a0)+(h.a0==l.a0&&h.a1==l.a1?"Q 0,0 "+h.p0:"Q 0,0 "+l.p0+d(l.r,l.p1,l.a1-l.a0)+("Q 0,0 "+h.p0))+
"Z"}function a(b,d,e,g){var k=d.call(b,e,g);d=f.call(b,k,g);e=h.call(b,k,g)+$a;b=l.call(b,k,g)+$a;return{r:d,a0:e,a1:b,p0:[d*Math.cos(e),d*Math.sin(e)],p1:[d*Math.cos(b),d*Math.sin(b)]}}function d(b,a,e){return"A"+b+","+b+" 0 "+ +(e>H)+",1 "+a}var e=dd,g=ed,f=ai,h=Pf,l=Qf;return b.radius=function(a){return arguments.length?(f=Q(a),b):f},b.source=function(a){return arguments.length?(e=Q(a),b):e},b.target=function(a){return arguments.length?(g=Q(a),b):g},b.startAngle=function(a){return arguments.length?
(h=Q(a),b):h},b.endAngle=function(a){return arguments.length?(l=Q(a),b):l},b};t.svg.diagonal=function(){function b(b,g){var f=a.call(this,b,g),h=d.call(this,b,g),l=(f.y+h.y)/2,f=[f,{x:f.x,y:l},{x:h.x,y:l},h];return f=f.map(e),"M"+f[0]+"C"+f[1]+" "+f[2]+" "+f[3]}var a=dd,d=ed,e=Xf;return b.source=function(d){return arguments.length?(a=Q(d),b):a},b.target=function(a){return arguments.length?(d=Q(a),b):d},b.projection=function(a){return arguments.length?(e=a,b):e},b};t.svg.diagonal.radial=function(){var b=
t.svg.diagonal(),a=Xf,d=b.projection;return b.projection=function(b){return arguments.length?d(bi(a=b)):a},b};t.svg.symbol=function(){function b(b,e){return(ng.get(a.call(this,b,e))||Yf)(d.call(this,b,e))}var a=di,d=ci;return b.type=function(d){return arguments.length?(a=Q(d),b):a},b.size=function(a){return arguments.length?(d=Q(a),b):d},b};var ng=t.map({circle:Yf,cross:function(b){b=Math.sqrt(b/5)/2;return"M"+-3*b+","+-b+"H"+-b+"V"+-3*b+"H"+b+"V"+-b+"H"+3*b+"V"+b+"H"+b+"V"+3*b+"H"+-b+"V"+b+"H"+-3*
b+"Z"},diamond:function(b){b=Math.sqrt(b/(2*og));var a=b*og;return"M0,"+-b+"L"+a+",0 0,"+b+" "+-a+",0Z"},square:function(b){b=Math.sqrt(b)/2;return"M"+-b+","+-b+"L"+b+","+-b+" "+b+","+b+" "+-b+","+b+"Z"},"triangle-down":function(b){b=Math.sqrt(b/Cc);var a=b*Cc/2;return"M0,"+a+"L"+b+","+-a+" "+-b+","+-a+"Z"},"triangle-up":function(b){b=Math.sqrt(b/Cc);var a=b*Cc/2;return"M0,"+-a+"L"+b+","+a+" "+-b+","+a+"Z"}});t.svg.symbolTypes=ng.keys();var bb,oc,Cc=Math.sqrt(3),og=Math.tan(30*J),W=[],cg=0;W.call=
K.call;W.empty=K.empty;W.node=K.node;W.size=K.size;t.transition=function(b){return arguments.length?bb?b.transition():b:bg.transition()};t.transition.prototype=W;W.select=function(b){var a,d,e,g=this.id,f=[];b=Ec(b);for(var h=-1,l=this.length;++h<l;){f.push(a=[]);for(var m=this[h],n=-1,p=m.length;++n<p;)(e=m[n])&&(d=b.call(e,e.__data__,n,h))?("__data__"in e&&(d.__data__=e.__data__),lc(d,n,g,e.__transition__[g]),a.push(d)):a.push(null)}return Eb(f,g)};W.selectAll=function(b){var a,d,e,g,f=this.id,
h=[];b=Nd(b);for(var l=-1,m=this.length;++l<m;)for(var n=this[l],p=-1,q=n.length;++p<q;)if(a=n[p]){g=a.__transition__[f];d=b.call(a,a.__data__,p,l);h.push(a=[]);for(var r=-1,t=d.length;++r<t;)(e=d[r])&&lc(e,r,f,g),a.push(e)}return Eb(h,f)};W.filter=function(b){var a,d,e,g=[];"function"!=typeof b&&(b=Xd(b));for(var f=0,h=this.length;h>f;f++){g.push(a=[]);d=this[f];for(var l=0,m=d.length;m>l;l++)(e=d[l])&&b.call(e,e.__data__,l,f)&&a.push(e)}return Eb(g,this.id)};W.tween=function(b,a){var d=this.id;
return 2>arguments.length?this.node().__transition__[d].tween.get(b):Aa(this,null==a?function(a){a.__transition__[d].tween.remove(b)}:function(e){e.__transition__[d].tween.set(b,a)})};W.attr=function(b,a){function d(){this.removeAttribute(l)}function e(){this.removeAttributeNS(l.space,l.local)}function g(b){return null==b?d:(b+="",function(){var a,d=this.getAttribute(l);return d!==b&&(a=h(d,b),function(b){this.setAttribute(l,a(b))})})}function f(b){return null==b?e:(b+="",function(){var a,d=this.getAttributeNS(l.space,
l.local);return d!==b&&(a=h(d,b),function(b){this.setAttributeNS(l.space,l.local,a(b))})})}if(2>arguments.length){for(a in b)this.attr(a,b[a]);return this}var h="transform"==b?sf:Za,l=t.ns.qualify(b);return Dd(this,"attr."+b,a,l.local?f:g)};W.attrTween=function(b,a){function d(b,e){var f=a.call(this,b,e,this.getAttribute(g));return f&&function(b){this.setAttribute(g,f(b))}}function e(b,d){var f=a.call(this,b,d,this.getAttributeNS(g.space,g.local));return f&&function(b){this.setAttributeNS(g.space,
g.local,f(b))}}var g=t.ns.qualify(b);return this.tween("attr."+b,g.local?e:d)};W.style=function(b,a,d){function e(){this.style.removeProperty(b)}var g=arguments.length;if(3>g){if("string"!=typeof b){2>g&&(a="");for(d in b)this.style(d,b[d],a);return this}d=""}return Dd(this,"style."+b,a,function(a){return null==a?e:(a+="",function(){var e,g=ca.getComputedStyle(this,null).getPropertyValue(b);return g!==a&&(e=Za(g,a),function(a){this.style.setProperty(b,e(a),d)})})})};W.styleTween=function(b,a,d){return 3>
arguments.length&&(d=""),this.tween("style."+b,function(e,g){var f=a.call(this,e,g,ca.getComputedStyle(this,null).getPropertyValue(b));return f&&function(a){this.style.setProperty(b,f(a),d)}})};W.text=function(b){return Dd(this,"text",b,ei)};W.remove=function(){return this.each("end.transition",function(){var b;2>this.__transition__.count&&(b=this.parentNode)&&b.removeChild(this)})};W.ease=function(b){var a=this.id;return 1>arguments.length?this.node().__transition__[a].ease:("function"!=typeof b&&
(b=t.ease.apply(t,arguments)),Aa(this,function(d){d.__transition__[a].ease=b}))};W.delay=function(b){var a=this.id;return 1>arguments.length?this.node().__transition__[a].delay:Aa(this,"function"==typeof b?function(d,e,g){d.__transition__[a].delay=+b.call(d,d.__data__,e,g)}:(b=+b,function(d){d.__transition__[a].delay=b}))};W.duration=function(b){var a=this.id;return 1>arguments.length?this.node().__transition__[a].duration:Aa(this,"function"==typeof b?function(d,e,g){d.__transition__[a].duration=
Math.max(1,b.call(d,d.__data__,e,g))}:(b=Math.max(1,b),function(d){d.__transition__[a].duration=b}))};W.each=function(b,a){var d=this.id;if(2>arguments.length){var e=oc,g=bb;bb=d;Aa(this,function(a,e,g){oc=a.__transition__[d];b.call(a,a.__data__,e,g)});oc=e;bb=g}else Aa(this,function(e){e=e.__transition__[d];(e.event||(e.event=t.dispatch("start","end"))).on(b,a)});return this};W.transition=function(){for(var b,a,d,e,g=this.id,f=++cg,l=[],h=0,m=this.length;m>h;h++){l.push(b=[]);a=this[h];for(var n=
0,p=a.length;p>n;n++)(d=a[n])&&(e=Object.create(d.__transition__[g]),e.delay+=e.duration,lc(d,n,f,e)),b.push(d)}return Eb(l,f)};t.svg.axis=function(){function b(b){b.each(function(){var b,n=t.select(this),p=this.__chart__||d,q=this.__chart__=d.copy(),r=null==m?q.ticks?q.ticks.apply(q,h):q.domain():m,w=null==a?q.tickFormat?q.tickFormat.apply(q,h):Y:a,z=n.selectAll(".tick").data(r,q),r=z.enter().insert("g",".domain").attr("class","tick").style("opacity",D),x=t.transition(z.exit()).style("opacity",D).remove(),
A=t.transition(z.order()).style("opacity",1),B=Math.max(g,0)+l,E=gc(q),n=n.selectAll(".domain").data([0]),n=(n.enter().append("path").attr("class","domain"),t.transition(n));r.append("line");r.append("text");var C,L,N,T,J=r.select("line"),ga=A.select("line"),w=z.select("text").text(w),z=r.select("text"),H=A.select("text"),G="top"===e||"left"===e?-1:1;if("bottom"===e||"top"===e?(b=fi,C="x",N="y",L="x2",T="y2",w.attr("dy",0>G?"0em":".71em").style("text-anchor","middle"),n.attr("d","M"+E[0]+","+G*f+
"V0H"+E[1]+"V"+G*f)):(b=gi,C="y",N="x",L="y2",T="x2",w.attr("dy",".32em").style("text-anchor",0>G?"end":"start"),n.attr("d","M"+G*f+","+E[0]+"H0V"+E[1]+"H"+G*f)),J.attr(T,G*g),z.attr(N,G*B),ga.attr(L,0).attr(T,G*g),H.attr(C,0).attr(N,G*B),q.rangeBand)var ba=q,K=ba.rangeBand()/2,p=q=function(b){return ba(b)+K};else p.rangeBand?p=q:x.call(b,q,p);r.call(b,p,q);A.call(b,q,q)})}var a,d=t.scale.linear(),e=pg,g=6,f=6,l=3,h=[10],m=null;return b.scale=function(a){return arguments.length?(d=a,b):d},b.orient=
function(a){return arguments.length?(e=a in Fi?a+"":pg,b):e},b.ticks=function(){return arguments.length?(h=arguments,b):h},b.tickValues=function(a){return arguments.length?(m=a,b):m},b.tickFormat=function(d){return arguments.length?(a=d,b):a},b.tickSize=function(a){var d=arguments.length;return d?(g=+a,f=+arguments[d-1],b):g},b.innerTickSize=function(a){return arguments.length?(g=+a,b):g},b.outerTickSize=function(a){return arguments.length?(f=+a,b):f},b.tickPadding=function(a){return arguments.length?
(l=+a,b):l},b.tickSubdivide=function(){return arguments.length&&b},b};var pg="bottom",Fi={top:1,right:1,bottom:1,left:1};t.svg.brush=function(){function b(f){f.each(function(){var f=t.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",g).on("touchstart.brush",g),l=f.selectAll(".background").data([0]);l.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");f.selectAll(".extent").data([0]).enter().append("rect").attr("class",
"extent").style("cursor","move");var h=f.selectAll(".resize").data(z,Y);h.exit().remove();h.enter().append("g").attr("class",function(b){return"resize "+b}).style("cursor",function(b){return Gi[b]}).append("rect").attr("x",function(b){return/[ew]$/.test(b)?-3:null}).attr("y",function(b){return/^[ns]/.test(b)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden");h.style("display",b.empty()?"none":null);var p,f=t.transition(f),l=t.transition(l);m&&(p=gc(m),l.attr("x",p[0]).attr("width",
p[1]-p[0]),d(f));n&&(p=gc(n),l.attr("y",p[0]).attr("height",p[1]-p[0]),e(f));a(f)})}function a(b){b.selectAll(".resize").attr("transform",function(b){return"translate("+p[+/e$/.test(b)]+","+q[+/^s/.test(b)]+")"})}function d(b){b.select(".extent").attr("x",p[0]);b.selectAll(".extent,.n>rect,.s>rect").attr("width",p[1]-p[0])}function e(b){b.select(".extent").attr("y",q[0]);b.selectAll(".extent,.e>rect,.w>rect").attr("height",q[1]-q[0])}function g(){function z(){var b=t.mouse(C),g=!1;E&&(b[0]+=E[0],
b[1]+=E[1]);H||(t.event.altKey?(B||(B=[(p[0]+p[1])/2,(q[0]+q[1])/2]),K[0]=p[+(b[0]<B[0])],K[1]=q[+(b[1]<B[1])]):B=null);G&&x(b,m,0)&&(d(F),g=!0);J&&x(b,n,1)&&(e(F),g=!0);g&&(a(F),D({type:"brush",mode:H?"move":"resize"}))}function x(b,a,d){var e,g,h=gc(a);a=h[0];var h=h[1],k=K[d],m=d?q:p,n=m[1]-m[0];return H&&(a-=k,h-=n+k),e=(d?w:r)?Math.max(a,Math.min(h,b[d])):b[d],H?g=(e+=k)+n:(B&&(k=Math.max(a,Math.min(h,2*B[d]-e))),e>k?(g=e,e=k):g=k),m[0]!=e||m[1]!=g?(d?l=null:f=null,m[0]=e,m[1]=g,!0):void 0}function A(){z();
F.style("pointer-events","all").selectAll(".resize").style("display",b.empty()?"none":null);t.select("body").style("cursor",null);Q.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);ba();D({type:"brushend"})}var B,E,C=this,L=t.select(t.event.target),D=h.of(C,arguments),F=t.select(C),T=L.datum(),G=!/^(n|s)$/.test(T)&&m,J=!/^(e|w)$/.test(T)&&n,H=L.classed("extent"),ba=Hb(),K=t.mouse(C),Q=t.select(ca).on("keydown.brush",
function(){32==t.event.keyCode&&(H||(B=null,K[0]-=p[1],K[1]-=q[1],H=2),N())}).on("keyup.brush",function(){32==t.event.keyCode&&2==H&&(K[0]+=p[1],K[1]+=q[1],H=0,N())});if(t.event.changedTouches?Q.on("touchmove.brush",z).on("touchend.brush",A):Q.on("mousemove.brush",z).on("mouseup.brush",A),F.interrupt().selectAll("*").interrupt(),H)K[0]=p[0]-K[0],K[1]=q[0]-K[1];else if(T){var R=+/w$/.test(T),T=+/^n/.test(T);E=[p[1-R]-K[0],q[1-T]-K[1]];K[0]=p[R];K[1]=q[T]}else t.event.altKey&&(B=K.slice());F.style("pointer-events",
"none").selectAll(".resize").style("display",null);t.select("body").style("cursor",L.style("cursor"));D({type:"brushstart"});z()}var f,l,h=Dc(b,"brushstart","brush","brushend"),m=null,n=null,p=[0,0],q=[0,0],r=!0,w=!0,z=Kd[0];return b.event=function(b){b.each(function(){var b=h.of(this,arguments),a={x:p,y:q,i:f,j:l},d=this.__chart__||a;this.__chart__=a;bb?t.select(this).transition().each("start.brush",function(){f=d.i;l=d.j;p=d.x;q=d.y;b({type:"brushstart"})}).tween("brush:brush",function(){var d=
fc(p,a.x),e=fc(q,a.y);return f=l=null,function(g){p=a.x=d(g);q=a.y=e(g);b({type:"brush",mode:"resize"})}}).each("end.brush",function(){f=a.i;l=a.j;b({type:"brush",mode:"resize"});b({type:"brushend"})}):(b({type:"brushstart"}),b({type:"brush",mode:"resize"}),b({type:"brushend"}))})},b.x=function(a){return arguments.length?(m=a,z=Kd[!m<<1|!n],b):m},b.y=function(a){return arguments.length?(n=a,z=Kd[!m<<1|!n],b):n},b.clamp=function(a){return arguments.length?(m&&n?(r=!!a[0],w=!!a[1]):m?r=!!a:n&&(w=!!a),
b):m&&n?[r,w]:m?r:n?w:null},b.extent=function(a){var d,e,g,h,k;return arguments.length?(m&&(d=a[0],e=a[1],n&&(d=d[0],e=e[0]),f=[d,e],m.invert&&(d=m(d),e=m(e)),d>e&&(k=d,d=e,e=k),(d!=p[0]||e!=p[1])&&(p=[d,e])),n&&(g=a[0],h=a[1],m&&(g=g[1],h=h[1]),l=[g,h],n.invert&&(g=n(g),h=n(h)),g>h&&(k=g,g=h,h=k),(g!=q[0]||h!=q[1])&&(q=[g,h])),b):(m&&(f?(d=f[0],e=f[1]):(d=p[0],e=p[1],m.invert&&(d=m.invert(d),e=m.invert(e)),d>e&&(k=d,d=e,e=k))),n&&(l?(g=l[0],h=l[1]):(g=q[0],h=q[1],n.invert&&(g=n.invert(g),h=n.invert(h)),
g>h&&(k=g,g=h,h=k))),m&&n?[[d,g],[e,h]]:m?[d,e]:n&&[g,h])},b.clear=function(){return b.empty()||(p=[0,0],q=[0,0],f=l=null),b},b.empty=function(){return!!m&&p[0]==p[1]||!!n&&q[0]==q[1]},t.rebind(b,h,"on")};var Gi={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Kd=["n e s w nw ne se sw".split(" "),["e","w"],["n","s"],[]],Ld=C.format=eg.timeFormat,qg=Ld.utc,rg=qg("%Y-%m-%dT%H:%M:%S.%LZ");Ld.iso=Date.prototype.toISOString&&
+new Date("2000-01-01T00:00:00.000Z")?Ed:rg;Ed.parse=function(b){b=new Date(b);return isNaN(b)?null:b};Ed.toString=rg.toString;C.second=Ua(function(b){return new aa(1E3*Math.floor(b/1E3))},function(b,a){b.setTime(b.getTime()+1E3*Math.floor(a))},function(b){return b.getSeconds()});C.seconds=C.second.range;C.seconds.utc=C.second.utc.range;C.minute=Ua(function(b){return new aa(6E4*Math.floor(b/6E4))},function(b,a){b.setTime(b.getTime()+6E4*Math.floor(a))},function(b){return b.getMinutes()});C.minutes=
C.minute.range;C.minutes.utc=C.minute.utc.range;C.hour=Ua(function(b){var a=b.getTimezoneOffset()/60;return new aa(36E5*(Math.floor(b/36E5-a)+a))},function(b,a){b.setTime(b.getTime()+36E5*Math.floor(a))},function(b){return b.getHours()});C.hours=C.hour.range;C.hours.utc=C.hour.utc.range;C.month=Ua(function(b){return b=C.day(b),b.setDate(1),b},function(b,a){b.setMonth(b.getMonth()+a)},function(b){return b.getMonth()});C.months=C.month.range;C.months.utc=C.month.utc.range;var mc=[1E3,5E3,15E3,3E4,6E4,
3E5,9E5,18E5,36E5,108E5,216E5,432E5,864E5,1728E5,6048E5,2592E6,7776E6,31536E6],Md=[[C.second,1],[C.second,5],[C.second,15],[C.second,30],[C.minute,1],[C.minute,5],[C.minute,15],[C.minute,30],[C.hour,1],[C.hour,3],[C.hour,6],[C.hour,12],[C.day,1],[C.day,2],[C.week,1],[C.month,1],[C.month,3],[C.year,1]],Hi=Ld.multi([[".%L",function(b){return b.getMilliseconds()}],[":%S",function(b){return b.getSeconds()}],["%I:%M",function(b){return b.getMinutes()}],["%I %p",function(b){return b.getHours()}],["%a %d",
function(b){return b.getDay()&&1!=b.getDate()}],["%b %d",function(b){return 1!=b.getDate()}],["%B",function(b){return b.getMonth()}],["%Y",hb]]),hi={range:function(b,a,d){return t.range(Math.ceil(b/d)*d,+a,d).map(ab)},floor:Y,ceil:Y};Md.year=C.year;C.scale=function(){return Fd(t.scale.linear(),Md,Hi)};var sg=Md.map(function(b){return[b[0].utc,b[1]]}),Ii=qg.multi([[".%L",function(b){return b.getUTCMilliseconds()}],[":%S",function(b){return b.getUTCSeconds()}],["%I:%M",function(b){return b.getUTCMinutes()}],
["%I %p",function(b){return b.getUTCHours()}],["%a %d",function(b){return b.getUTCDay()&&1!=b.getUTCDate()}],["%b %d",function(b){return 1!=b.getUTCDate()}],["%B",function(b){return b.getUTCMonth()}],["%Y",hb]]);sg.year=C.year.utc;C.scale.utc=function(){return Fd(t.scale.linear(),sg,Ii)};t.text=Tc(function(b){return b.responseText});t.json=function(b,a){return Kb(b,"application/json",ii,a)};t.html=function(b,a){return Kb(b,"text/html",ji,a)};t.xml=Tc(function(b){return b.responseXML});"function"==
typeof define&&define.amd?define(t):"object"==typeof module&&module.exports&&(module.exports=t);this.d3=t}();this.j$=this.jStat=function(h,f){function e(a,d){var e=a>d?a:d;return h.pow(10,17-~~(h.log(0<e?e:-e)*h.LOG10E))}function d(a){return"[object Function]"===q.call(a)}function a(a){return"number"==typeof a&&a===a}function g(){return new g._init(arguments)}function l(){return 0}function m(){return 1}function n(a,d){return a===d?1:0}var p=Array.prototype.concat,r=Array.prototype.slice,q=Object.prototype.toString,w=Array.isArray||function(a){return"[object Array]"===q.call(a)};g.fn=g.prototype;g._init=
function(e){var f;if(w(e[0]))if(w(e[0][0])){d(e[1])&&(e[0]=g.map(e[0],e[1]));for(f=0;f<e[0].length;f++)this[f]=e[0][f];this.length=e[0].length}else this[0]=d(e[1])?g.map(e[0],e[1]):e[0],this.length=1;else{if(a(e[0]))this[0]=g.seq.apply(null,e);else{if(e[0]instanceof g)return g(e[0].toArray());this[0]=[]}this.length=1}return this};g._init.prototype=g.prototype;g._init.constructor=g;g.utils={calcRdx:e,isArray:w,isFunction:d,isNumber:a,toVector:function(a){return p.apply([],a)}};g.extend=function(a){var d,
e;if(1===arguments.length){for(e in a)g[e]=a[e];return this}for(d=1;d<arguments.length;d++)for(e in arguments[d])a[e]=arguments[d][e];return a};g.rows=function(a){return a.length||1};g.cols=function(a){return a[0].length||1};g.dimensions=function(a){return{rows:g.rows(a),cols:g.cols(a)}};g.row=function(a,d){return a[d]};g.col=function(a,d){for(var e=Array(a.length),g=0;g<a.length;g++)e[g]=[a[g][d]];return e};g.diag=function(a){for(var d=g.rows(a),e=Array(d),f=0;f<d;f++)e[f]=[a[f][f]];return e};g.antidiag=
function(a){for(var d=g.rows(a)-1,e=Array(d),f=0;0<=d;d--,f++)e[f]=[a[f][d]];return e};g.transpose=function(a){var d=[],e,g,f,h,l;w(a[0])||(a=[a]);g=a.length;f=a[0].length;for(l=0;l<f;l++){e=Array(g);for(h=0;h<g;h++)e[h]=a[h][l];d.push(e)}return 1===d.length?d[0]:d};g.map=function(a,d,e){var g,f,h,l;w(a[0])||(a=[a]);g=a.length;f=a[0].length;h=e?a:Array(g);for(e=0;e<g;e++)for(h[e]||(h[e]=Array(f)),l=0;l<f;l++)h[e][l]=d(a[e][l],e,l);return 1===h.length?h[0]:h};g.cumreduce=function(a,d,e){var g,f,h,
l;w(a[0])||(a=[a]);g=a.length;f=a[0].length;h=e?a:Array(g);for(e=0;e<g;e++)for(h[e]||(h[e]=Array(f)),0<f&&(h[e][0]=a[e][0]),l=1;l<f;l++)h[e][l]=d(h[e][l-1],a[e][l]);return 1===h.length?h[0]:h};g.alter=function(a,d){return g.map(a,d,!0)};g.create=function(a,e,g){var f=Array(a),h,l;d(e)&&(g=e,e=a);for(h=0;h<a;h++)for(f[h]=Array(e),l=0;l<e;l++)f[h][l]=g(h,l);return f};g.zeros=function(d,e){return a(e)||(e=d),g.create(d,e,l)};g.ones=function(d,e){return a(e)||(e=d),g.create(d,e,m)};g.rand=function(d,
e){return a(e)||(e=d),g.create(d,e,h.random)};g.identity=function(d,e){return a(e)||(e=d),g.create(d,e,n)};g.symmetric=function(a){var d=a.length,e,g;if(a.length!==a[0].length)return!1;for(e=0;e<d;e++)for(g=0;g<d;g++)if(a[g][e]!==a[e][g])return!1;return!0};g.clear=function(a){return g.alter(a,l)};g.seq=function(a,g,f,h){d(h)||(h=!1);var l=[],m=e(a,g);f=(g*m-a*m)/((f-1)*m);var n=a,p;for(p=0;n<=g;p++,n=(a*m+f*m*p)/m)l.push(h?h(n,p):n);return l};var x=g.prototype;return x.length=0,x.push=Array.prototype.push,
x.sort=Array.prototype.sort,x.splice=Array.prototype.splice,x.slice=Array.prototype.slice,x.toArray=function(){return 1<this.length?r.call(this):r.call(this)[0]},x.map=function(a,d){return g(g.map(this,a,d))},x.cumreduce=function(a,d){return g(g.cumreduce(this,a,d))},x.alter=function(a){return g.alter(this,a),this},function(a){for(var d=0;d<a.length;d++)(function(a){x[a]=function(d){var e=this,f;return d?(setTimeout(function(){d.call(e,x[a].call(e))}),this):(f=g[a](this),w(f)?g(f):f)}})(a[d])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),
function(a){for(var d=0;d<a.length;d++)(function(a){x[a]=function(d,e){var f=this;return e?(setTimeout(function(){e.call(f,x[a].call(f,d))}),this):g(g[a](this,d))}})(a[d])}(["row","col"]),function(a){for(var d=0;d<a.length;d++){var e=a[d];x[e]=new Function("return jStat(jStat."+e+".apply(null, arguments));")}}(["create","zeros","ones","rand","identity"]),g}(Math);
(function(h,f){function e(a,d){return a-d}var d=h.utils.isFunction;h.sum=function(a){for(var d=0,e=a.length;0<=--e;)d+=a[e];return d};h.sumsqrd=function(a){for(var d=0,e=a.length;0<=--e;)d+=a[e]*a[e];return d};h.sumsqerr=function(a){for(var d=h.mean(a),e=0,f=a.length,p;0<=--f;)p=a[f]-d,e+=p*p;return e};h.product=function(a){for(var d=1,e=a.length;0<=--e;)d*=a[e];return d};h.min=function(a){for(var d=a[0],e=0;++e<a.length;)a[e]<d&&(d=a[e]);return d};h.max=function(a){for(var d=a[0],e=0;++e<a.length;)a[e]>
d&&(d=a[e]);return d};h.mean=function(a){return h.sum(a)/a.length};h.meansqerr=function(a){return h.sumsqerr(a)/a.length};h.geomean=function(a){return f.pow(h.product(a),1/a.length)};h.median=function(a){var d=a.length;a=a.slice().sort(e);return d&1?a[d/2|0]:(a[d/2-1]+a[d/2])/2};h.cumsum=function(a){return h.cumreduce(a,function(a,d){return a+d})};h.cumprod=function(a){return h.cumreduce(a,function(a,d){return a*d})};h.diff=function(a){var d=[],e=a.length,f;for(f=1;f<e;f++)d.push(a[f]-a[f-1]);return d};
h.mode=function(a){var d=a.length;a=a.slice().sort(e);var f=1,h=0,p=0,r=[],q;for(q=0;q<d;q++)a[q]===a[q+1]?f++:(f>h?(r=[a[q]],h=f,p=0):f===h&&(r.push(a[q]),p++),f=1);return 0===p?r[0]:r};h.range=function(a){return h.max(a)-h.min(a)};h.variance=function(a,d){return h.sumsqerr(a)/(a.length-(d?1:0))};h.stdev=function(a,d){return f.sqrt(h.variance(a,d))};h.meandev=function(a){var d=0,e=h.mean(a),n;for(n=a.length-1;0<=n;n--)d+=f.abs(a[n]-e);return d/a.length};h.meddev=function(a){var d=0,e=h.median(a),
n;for(n=a.length-1;0<=n;n--)d+=f.abs(a[n]-e);return d/a.length};h.coeffvar=function(a){return h.stdev(a)/h.mean(a)};h.quartiles=function(a){var d=a.length;a=a.slice().sort(e);return[a[f.round(d/4)-1],a[f.round(d/2)-1],a[f.round(3*d/4)-1]]};h.quantiles=function(a,d,h,n){var p=a.slice().sort(e),r=[d.length];a=a.length;var q,w,x;"undefined"==typeof h&&(h=.375);"undefined"==typeof n&&(n=.375);for(q=0;q<d.length;q++)w=d[q],x=h+w*(1-h-n),x=a*w+x,w=f.floor(f.max(1,f.min(x,a-1))),x=f.max(0,f.min(x-w,1)),
r[q]=(1-x)*p[w-1]+x*p[w];return r};h.percentileOfScore=function(a,d,e){var f=0,h=a.length,r=!1,q;"strict"===e&&(r=!0);for(q=0;q<h;q++)e=a[q],(r&&e<d||!r&&e<=d)&&f++;return f/h};h.histogram=function(a,d){var e=h.min(a),n=d||4,p=(h.max(a)-e)/n,r=a.length;d=[];var q;for(q=0;q<n;q++)d[q]=0;for(q=0;q<r;q++)d[f.min(f.floor((a[q]-e)/p),n-1)]+=1;return d};h.covariance=function(a,d){var e=h.mean(a),f=h.mean(d),p=a.length,r=Array(p),q;for(q=0;q<p;q++)r[q]=(a[q]-e)*(d[q]-f);return h.sum(r)/(p-1)};h.corrcoeff=
function(a,d){return h.covariance(a,d)/h.stdev(a,1)/h.stdev(d,1)};h.stanMoment=function(a,d){var e=h.mean(a),n=h.stdev(a),p=a.length,r=0;for(i=0;i<p;i++)r+=f.pow((a[i]-e)/n,d);return r/a.length};h.skewness=function(a){return h.stanMoment(a,3)};h.kurtosis=function(a){return h.stanMoment(a,4)-3};var a=h.prototype;(function(e){for(var f=0;f<e.length;f++)(function(e){a[e]=function(g,f){var l=[],q=0,w=this;d(g)&&(f=g,g=!1);if(f)return setTimeout(function(){f.call(w,a[e].call(w,g))}),this;if(1<this.length){for(w=
!0===g?this:this.transpose();q<w.length;q++)l[q]=h[e](w[q]);return l}return h[e](this[0],g)}})(e[f])})(["cumsum","cumprod"]);(function(e){for(var f=0;f<e.length;f++)(function(e){a[e]=function(g,f){var l=[],q=0,w=this;d(g)&&(f=g,g=!1);if(f)return setTimeout(function(){f.call(w,a[e].call(w,g))}),this;if(1<this.length){for(w=!0===g?this:this.transpose();q<w.length;q++)l[q]=h[e](w[q]);return!0===g?h[e](h.utils.toVector(l)):l}return h[e](this[0],g)}})(e[f])})("sum sumsqrd sumsqerr product min max mean meansqerr geomean median diff mode range variance stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" "));
(function(e){for(var f=0;f<e.length;f++)(function(e){a[e]=function(){var g=[],f=0,l=this,q=Array.prototype.slice.call(arguments);if(d(q[q.length-1])){var w=q[q.length-1],x=q.slice(0,q.length-1);return setTimeout(function(){w.call(l,a[e].apply(l,x))}),this}w=void 0;if(1<this.length){for(l=l.transpose();f<l.length;f++)g[f]=h[e].apply(l,[l[f]].concat(q));return g}return h[e].apply(l,[this[0]].concat(q))}})(e[f])})(["quantiles","percentileOfScore"])})(this.jStat,Math);
(function(h,f){h.gammaln=function(e){var d=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5.395239384953E-6],g=1.000000000190015,h,m;m=(h=e)+5.5;for(m-=(e+.5)*f.log(m);6>d;d++)g+=a[d]/++h;return f.log(2.5066282746310007*g/e)-m};h.gammafn=function(e){var d=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,
-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],g=!1,h=0,m=0,n=0,p,r,q,w;if(0>=e)if(w=e%1+3.6E-16)g=(e&1?-1:1)*f.PI/f.sin(f.PI*w),e=1-e;else return Infinity;q=e;1>e?r=e++:r=(e-=h=(e|0)-1)-1;for(p=0;8>p;++p)n=(n+d[p])*r,m=m*r+a[p];w=n/m+1;if(q<e)w/=q;else if(q>e)for(p=0;p<h;++p)w*=e,e++;return g&&(w=g/w),w};h.gammap=function(e,d){var a=h.gammaln(e),g=e,l=1/e,m=l,n=d+1-e,p=1/1E-30,r=1/n,q=r,w=1,x=-~(8.5*f.log(1<=e?e:1/e)+.4*e+17);if(0>
d||0>=e)return NaN;if(d<e+1){for(;w<=x;w++)l+=m*=d/++g;return l*f.exp(-d+e*f.log(d)-a)}for(;w<=x;w++)g=-w*(w-e),n+=2,r=g*r+n,p=n+g/p,r=1/r,q=q*r*p;return 1-q*f.exp(-d+e*f.log(d)-a)};h.factorialln=function(e){return 0>e?NaN:h.gammaln(e+1)};h.factorial=function(e){return 0>e?NaN:h.gammafn(e+1)};h.combination=function(e,d){return 170<e||170<d?f.exp(h.combinationln(e,d)):h.factorial(e)/h.factorial(d)/h.factorial(e-d)};h.combinationln=function(e,d){return h.factorialln(e)-h.factorialln(d)-h.factorialln(e-
d)};h.permutation=function(e,d){return h.factorial(e)/h.factorial(e-d)};h.betafn=function(e,d){return 0>=e||0>=d?void 0:170<e+d?f.exp(h.betaln(e,d)):h.gammafn(e)*h.gammafn(d)/h.gammafn(e+d)};h.betaln=function(e,d){return h.gammaln(e)+h.gammaln(d)-h.gammaln(e+d)};h.betacf=function(e,d,a){var g=1,h=d+a,m=d+1,n=d-1,p=1,r=1-h*e/m,q,w,x;1E-30>f.abs(r)&&(r=1E-30);for(x=r=1/r;100>=g&&!(q=2*g,w=g*(a-g)*e/((n+q)*(d+q)),r=1+w*r,1E-30>f.abs(r)&&(r=1E-30),p=1+w/p,1E-30>f.abs(p)&&(p=1E-30),r=1/r,x=x*r*p,w=-(d+
g)*(h+g)*e/((d+q)*(m+q)),r=1+w*r,1E-30>f.abs(r)&&(r=1E-30),p=1+w/p,1E-30>f.abs(p)&&(p=1E-30),r=1/r,q=r*p,x*=q,3E-7>f.abs(q-1));g++);return x};h.gammapinv=function(e,d){var a=0,g=d-1,l=h.gammaln(d),m,n,p,r,q;if(1<=e)return f.max(100,d+100*f.sqrt(d));if(0>=e)return 0;for(1<d?(r=f.log(g),q=f.exp(g*(r-1)-l),n=.5>e?e:1-e,p=f.sqrt(-2*f.log(n)),m=(2.30753+.27061*p)/(1+p*(.99229+.04481*p))-p,.5>e&&(m=-m),m=f.max(.001,d*f.pow(1-1/(9*d)-m/(3*f.sqrt(d)),3))):(p=1-d*(.253+.12*d),e<p?m=f.pow(e/p,1/d):m=1-f.log(1-
(e-p)/(1-p)));12>a;a++){if(0>=m)return 0;n=h.gammap(d,m)-e;1<d?p=q*f.exp(-(m-g)+g*(f.log(m)-r)):p=f.exp(-m+g*f.log(m)-l);p=n/p;m-=p/=1-.5*f.min(1,p*((d-1)/m-1));0>=m&&(m=.5*(m+p));if(f.abs(p)<1E-8*m)break}return m};h.erf=function(e){var d=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-9.46595344482036E-4,3.66839497852761E-4,4.2523324806907E-5,-2.0278578112534E-5,-1.624290004647E-6,1.30365583558E-6,1.5626441722E-8,-8.5238095915E-8,6.529054439E-9,5.059343495E-9,-9.91364156E-10,
-2.27365122E-10,9.6467911E-11,2.394038E-12,-6.886027E-12,8.94487E-13,3.13092E-13,-1.12708E-13,3.81E-16,7.106E-15,-1.523E-15,-9.4E-17,1.21E-16,-2.8E-17],a=d.length-1,g=!1,h=0,m=0,n,p,r,q;0>e&&(e=-e,g=!0);n=2/(2+e);for(p=4*n-2;0<a;a--)r=h,h=p*h-m+d[a],m=r;return q=n*f.exp(-e*e+.5*(d[0]+p*h)-m),g?q-1:1-q};h.erfc=function(e){return 1-h.erf(e)};h.erfcinv=function(e){var d=0,a,g,l;if(2<=e)return-100;if(0>=e)return 100;l=1>e?e:2-e;a=f.sqrt(-2*f.log(l/2));for(a=-.70711*((2.30753+.27061*a)/(1+a*(.99229+.04481*
a))-a);2>d;d++)g=h.erfc(a)-l,a+=g/(1.1283791670955126*f.exp(-a*a)-a*g);return 1>e?a:-a};h.ibetainv=function(e,d,a){var g=d-1,l=a-1,m=0,n,p,r,q,w,x,z,B,A;if(0>=e)return 0;if(1<=e)return 1;1<=d&&1<=a?(r=.5>e?e:1-e,q=f.sqrt(-2*f.log(r)),x=(2.30753+.27061*q)/(1+q*(.99229+.04481*q))-q,.5>e&&(x=-x),z=(x*x-3)/6,B=2/(1/(2*d-1)+1/(2*a-1)),A=x*f.sqrt(z+B)/B-(1/(2*a-1)-1/(2*d-1))*(z+5/6-2/(3*B)),x=d/(d+a*f.exp(2*A))):(n=f.log(d/(d+a)),p=f.log(a/(d+a)),q=f.exp(d*n)/d,w=f.exp(a*p)/a,A=q+w,e<q/A?x=f.pow(d*A*e,
1/d):x=1-f.pow(a*A*(1-e),1/a));for(n=-h.gammaln(d)-h.gammaln(a)+h.gammaln(d+a);10>m&&0!==x&&1!==x&&!(w=h.ibeta(x,d,a)-e,q=f.exp(g*f.log(x)+l*f.log(1-x)+n),w/=q,x-=q=w/(1-.5*f.min(1,w*(g/x-l/(1-x)))),0>=x&&(x=.5*(x+q)),1<=x&&(x=.5*(x+q+1)),f.abs(q)<1E-8*x&&0<m);m++);return x};h.ibeta=function(e,d,a){var g=0===e||1===e?0:f.exp(h.gammaln(d+a)-h.gammaln(d)-h.gammaln(a)+d*f.log(e)+a*f.log(1-e));return 0>e||1<e?!1:e<(d+1)/(d+a+2)?g*h.betacf(e,d,a)/d:1-g*h.betacf(1-e,a,d)/a};h.randn=function(e,d){var a,
g,l,m;d||(d=e);if(e)return h.create(e,d,function(){return h.randn()});do a=f.random(),g=1.7156*(f.random()-.5),l=a-.449871,m=f.abs(g)+.386595,l=l*l+m*(.196*m-.25472*l);while(.27597<l&&(.27846<l||g*g>-4*f.log(a)*a*a));return g/a};h.randg=function(e,d,a){var g=e,l,m,n;a||(a=d);e||(e=1);if(d)return l=h.zeros(d,a),l.alter(function(){return h.randg(e)}),l;1>e&&(e+=1);d=e-1/3;a=1/f.sqrt(9*d);do{do n=h.randn(),m=1+a*n;while(0>=m);m*=m*m;l=f.random()}while(l>1-.331*f.pow(n,4)&&f.log(l)>.5*n*n+d*(1-m+f.log(m)));
if(e==g)return d*m;do l=f.random();while(0===l);return f.pow(l,1/g)*d*m};(function(e){for(var d=0;d<e.length;d++)(function(a){h.fn[a]=function(){return h(h.map(this,function(d){return h[a](d)}))}})(e[d])})(["gammaln","gammafn","factorial","factorialln"]);(function(e){for(var d=0;d<e.length;d++)(function(a){h.fn[a]=function(){return h(h[a].apply(null,arguments))}})(e[d])})(["randn"])})(this.jStat,Math);
(function(h,f){(function(e){for(var d=0;d<e.length;d++)(function(a){h[a]=function(a,d,e){return this instanceof arguments.callee?(this._a=a,this._b=d,this._c=e,this):new arguments.callee(a,d,e)};h.fn[a]=function(d,e,f){d=h[a](d,e,f);return d.data=this,d};h[a].prototype.sample=function(d){var e=this._a,f=this._b,n=this._c;return d?h.alter(d,function(){return h[a].sample(e,f,n)}):h[a].sample(e,f,n)};(function(d){for(var e=0;e<d.length;e++)(function(d){h[a].prototype[d]=function(e){var g=this._a,f=this._b,
l=this._c;return!e&&0!==e&&(e=this.data),"number"!=typeof e?h.fn.map.call(e,function(e){return h[a][d](e,g,f,l)}):h[a][d](e,g,f,l)}})(d[e])})(["pdf","cdf","inv"]);(function(d){for(var e=0;e<d.length;e++)(function(d){h[a].prototype[d]=function(){return h[a][d](this._a,this._b,this._c)}})(d[e])})(["mean","median","mode","variance"])})(e[d])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy lognormal normal pareto studentt weibull uniform  binomial negbin hypgeom poisson triangular".split(" "));
h.extend(h.beta,{pdf:function(e,d,a){return 1<e||0>e?0:1==d&&1==a?1:512>d||512>a?f.pow(e,d-1)*f.pow(1-e,a-1)/h.betafn(d,a):f.exp((d-1)*f.log(e)+(a-1)*f.log(1-e)-h.betaln(d,a))},cdf:function(e,d,a){return 1<e||0>e?1*(1<e):h.ibeta(e,d,a)},inv:function(e,d,a){return h.ibetainv(e,d,a)},mean:function(e,d){return e/(e+d)},median:function(e,d){throw Error("median not yet implemented");},mode:function(e,d){return e*d/(f.pow(e+d,2)*(e+d+1))},sample:function(e,d){var a=h.randg(e);return a/(a+h.randg(d))},variance:function(e,
d){return e*d/(f.pow(e+d,2)*(e+d+1))}});h.extend(h.centralF,{pdf:function(e,d,a){var g,l,m;return 0>e?void 0:2>=d?f.sqrt(f.pow(d*e,d)*f.pow(a,a)/f.pow(d*e+a,d+a))/(e*h.betafn(d/2,a/2)):(g=d*e/(a+e*d),l=a/(a+e*d),m=d*l/2,m*h.binomial.pdf((d-2)/2,(d+a-2)/2,g))},cdf:function(e,d,a){return h.ibeta(d*e/(d*e+a),d/2,a/2)},inv:function(e,d,a){return a/(d*(1/h.ibetainv(e,d/2,a/2)-1))},mean:function(e,d){return 2<d?d/(d-2):void 0},mode:function(e,d){return 2<e?d*(e-2)/(e*(d+2)):void 0},sample:function(e,d){var a=
2*h.randg(e/2),g=2*h.randg(d/2);return a/e/(g/d)},variance:function(e,d){return 4>=d?void 0:2*d*d*(e+d-2)/(e*(d-2)*(d-2)*(d-4))}});h.extend(h.cauchy,{pdf:function(e,d,a){return a/(f.pow(e-d,2)+f.pow(a,2))/f.PI},cdf:function(e,d,a){return f.atan((e-d)/a)/f.PI+.5},inv:function(e,d,a){return d+a*f.tan(f.PI*(e-.5))},median:function(e,d){return e},mode:function(e,d){return e},sample:function(e,d){return h.randn()*f.sqrt(1/(2*h.randg(.5)))*d+e}});h.extend(h.chisquare,{pdf:function(e,d){return 0===e?0:f.exp((d/
2-1)*f.log(e)-e/2-d/2*f.log(2)-h.gammaln(d/2))},cdf:function(e,d){return h.gammap(d/2,e/2)},inv:function(e,d){return 2*h.gammapinv(e,.5*d)},mean:function(e){return e},median:function(e){return e*f.pow(1-2/(9*e),3)},mode:function(e){return 0<e-2?e-2:0},sample:function(e){return 2*h.randg(e/2)},variance:function(e){return 2*e}});h.extend(h.exponential,{pdf:function(e,d){return 0>e?0:d*f.exp(-d*e)},cdf:function(e,d){return 0>e?0:1-f.exp(-d*e)},inv:function(e,d){return-f.log(1-e)/d},mean:function(e){return 1/
e},median:function(e){return 1/e*f.log(2)},mode:function(e){return 0},sample:function(e){return-1/e*f.log(f.random())},variance:function(e){return f.pow(e,-2)}});h.extend(h.gamma,{pdf:function(e,d,a){return f.exp((d-1)*f.log(e)-e/a-h.gammaln(d)-d*f.log(a))},cdf:function(e,d,a){return h.gammap(d,e/a)},inv:function(e,d,a){return h.gammapinv(e,d)*a},mean:function(e,d){return e*d},mode:function(e,d){return 1<e?(e-1)*d:void 0},sample:function(e,d){return h.randg(e)*d},variance:function(e,d){return e*d*
d}});h.extend(h.invgamma,{pdf:function(e,d,a){return f.exp(-(d+1)*f.log(e)-a/e-h.gammaln(d)+d*f.log(a))},cdf:function(e,d,a){return 1-h.gammap(d,a/e)},inv:function(e,d,a){return a/h.gammapinv(1-e,d)},mean:function(e,d){return 1<e?d/(e-1):void 0},mode:function(e,d){return d/(e+1)},sample:function(e,d){return d/h.randg(e)},variance:function(e,d){return 2>=e?void 0:d*d/((e-1)*(e-1)*(e-2))}});h.extend(h.kumaraswamy,{pdf:function(e,d,a){return f.exp(f.log(d)+f.log(a)+(d-1)*f.log(e)+(a-1)*f.log(1-f.pow(e,
d)))},cdf:function(e,d,a){return 1-f.pow(1-f.pow(e,d),a)},mean:function(e,d){return d*h.gammafn(1+1/e)*h.gammafn(d)/h.gammafn(1+1/e+d)},median:function(e,d){return f.pow(1-f.pow(2,-1/d),1/e)},mode:function(e,d){return 1<=e&&1<=d&&1!==e&&1!==d?f.pow((e-1)/(e*d-1),1/e):void 0},variance:function(e,d){throw Error("variance not yet implemented");}});h.extend(h.lognormal,{pdf:function(e,d,a){return f.exp(-f.log(e)-.5*f.log(2*f.PI)-f.log(a)-f.pow(f.log(e)-d,2)/(2*a*a))},cdf:function(e,d,a){return.5+.5*h.erf((f.log(e)-
d)/f.sqrt(2*a*a))},inv:function(e,d,a){return f.exp(-1.4142135623730951*a*h.erfcinv(2*e)+d)},mean:function(e,d){return f.exp(e+d*d/2)},median:function(e,d){return f.exp(e)},mode:function(e,d){return f.exp(e-d*d)},sample:function(e,d){return f.exp(h.randn()*d+e)},variance:function(e,d){return(f.exp(d*d)-1)*f.exp(2*e+d*d)}});h.extend(h.normal,{pdf:function(e,d,a){return f.exp(-.5*f.log(2*f.PI)-f.log(a)-f.pow(e-d,2)/(2*a*a))},cdf:function(e,d,a){return.5*(1+h.erf((e-d)/f.sqrt(2*a*a)))},inv:function(e,
d,a){return-1.4142135623730951*a*h.erfcinv(2*e)+d},mean:function(e,d){return e},median:function(e,d){return e},mode:function(e,d){return e},sample:function(e,d){return h.randn()*d+e},variance:function(e,d){return d*d}});h.extend(h.pareto,{pdf:function(e,d,a){return e<d?void 0:a*f.pow(d,a)/f.pow(e,a+1)},cdf:function(e,d,a){return 1-f.pow(d/e,a)},mean:function(e,d){return 1>=d?void 0:d*f.pow(e,d)/(d-1)},median:function(e,d){return e*d*f.SQRT2},mode:function(e,d){return e},variance:function(e,d){return 2>=
d?void 0:e*e*d/(f.pow(d-1,2)*(d-2))}});h.extend(h.studentt,{pdf:function(e,d){return h.gammafn((d+1)/2)/(f.sqrt(d*f.PI)*h.gammafn(d/2))*f.pow(1+e*e/d,-((d+1)/2))},cdf:function(e,d){var a=d/2;return h.ibeta((e+f.sqrt(e*e+d))/(2*f.sqrt(e*e+d)),a,a)},inv:function(e,d){var a=h.ibetainv(2*f.min(e,1-e),.5*d,.5);return a=f.sqrt(d*(1-a)/a),.5<e?a:-a},mean:function(e){return 1<e?0:void 0},median:function(e){return 0},mode:function(e){return 0},sample:function(e){return h.randn()*f.sqrt(e/(2*h.randg(e/2)))},
variance:function(e){return 2<e?e/(e-2):1<e?Infinity:void 0}});h.extend(h.weibull,{pdf:function(e,d,a){return 0>e?0:a/d*f.pow(e/d,a-1)*f.exp(-f.pow(e/d,a))},cdf:function(e,d,a){return 0>e?0:1-f.exp(-f.pow(e/d,a))},inv:function(e,d,a){return d*f.pow(-f.log(1-e),1/a)},mean:function(e,d){return e*h.gammafn(1+1/d)},median:function(e,d){return e*f.pow(f.log(2),1/d)},mode:function(e,d){return 1>=d?void 0:e*f.pow((d-1)/d,1/d)},sample:function(e,d){return e*f.pow(-f.log(f.random()),1/d)},variance:function(e,
d){return e*e*h.gammafn(1+2/d)-f.pow(this.mean(e,d),2)}});h.extend(h.uniform,{pdf:function(e,d,a){return e<d||e>a?0:1/(a-d)},cdf:function(e,d,a){return e<d?0:e<a?(e-d)/(a-d):1},inv:function(e,d,a){return d+e*(a-d)},mean:function(e,d){return.5*(e+d)},median:function(e,d){return h.mean(e,d)},mode:function(e,d){throw Error("mode is not yet implemented");},sample:function(e,d){return e/2+d/2+(d/2-e/2)*(2*f.random()-1)},variance:function(e,d){return f.pow(d-e,2)/12}});h.extend(h.binomial,{pdf:function(e,
d,a){return 0===a||1===a?d*a===e?1:0:h.combination(d,e)*f.pow(a,e)*f.pow(1-a,d-e)},cdf:function(e,d,a){var g=[],f=0;if(0>e)return 0;if(e<d){for(;f<=e;f++)g[f]=h.binomial.pdf(f,d,a);return h.sum(g)}return 1}});h.extend(h.negbin,{pdf:function(e,d,a){return e!==e|0?!1:0>e?0:h.combination(e+d-1,d-1)*f.pow(1-a,e)*f.pow(a,d)},cdf:function(e,d,a){var g=0,f=0;if(0>e)return 0;for(;f<=e;f++)g+=h.negbin.pdf(f,d,a);return g}});h.extend(h.hypgeom,{pdf:function(e,d,a,g){if(e!==e|0)return!1;if(0>e||e<a-(d-g)||e>
g||e>a)return 0;if(2*a>d)return 2*g>d?h.hypgeom.pdf(d-a-g+e,d,d-a,d-g):h.hypgeom.pdf(g-e,d,d-a,g);if(2*g>d)return h.hypgeom.pdf(a-e,d,a,d-g);if(a<g)return h.hypgeom.pdf(e,d,g,a);for(var l=1,m=0,n=0;n<e;n++){for(;1<l&&m<g;)l*=1-a/(d-m),m++;l*=(g-n)*(a-n)/((n+1)*(d-a-g+n+1))}for(;m<g;m++)l*=1-a/(d-m);return f.min(1,f.max(0,l))},cdf:function(e,d,a,g){if(0>e||e<a-(d-g))return 0;if(e>=g||e>=a)return 1;if(2*a>d)return 2*g>d?h.hypgeom.cdf(d-a-g+e,d,d-a,d-g):1-h.hypgeom.cdf(g-e-1,d,d-a,g);if(2*g>d)return 1-
h.hypgeom.cdf(a-e-1,d,a,d-g);if(a<g)return h.hypgeom.cdf(e,d,g,a);for(var l=1,m=1,n=0,p=0;p<e;p++){for(;1<l&&n<g;){var r=1-a/(d-n),m=m*r,l=l*r;n++}m*=(g-p)*(a-p)/((p+1)*(d-a-g+p+1));l+=m}for(;n<g;n++)l*=1-a/(d-n);return f.min(1,f.max(0,l))}});h.extend(h.poisson,{pdf:function(e,d){return f.pow(d,e)*f.exp(-d)/h.factorial(e)},cdf:function(e,d){var a=[],g=0;if(0>e)return 0;for(;g<=e;g++)a.push(h.poisson.pdf(g,d));return h.sum(a)},mean:function(e){return e},variance:function(e){return e},sample:function(e){var d=
1,a=0;e=f.exp(-e);do a++,d*=f.random();while(d>e);return a-1}});h.extend(h.triangular,{pdf:function(e,d,a,g){return a<=d||g<d||g>a?void 0:e<d||e>a?0:e<=g?2*(e-d)/((a-d)*(g-d)):2*(a-e)/((a-d)*(a-g))},cdf:function(e,d,a,g){return a<=d||g<d||g>a?void 0:e<d?0:e<=g?f.pow(e-d,2)/((a-d)*(g-d)):1-f.pow(a-e,2)/((a-d)*(a-g))},mean:function(e,d,a){return(e+d+a)/3},median:function(e,d,a){if(a<=(e+d)/2)return d-f.sqrt((d-e)*(d-a))/f.sqrt(2);if(a>(e+d)/2)return e+f.sqrt((d-e)*(a-e))/f.sqrt(2)},mode:function(e,
d,a){return a},sample:function(e,d,a){var g=f.random();return g<(a-e)/(d-e)?e+f.sqrt(g*(d-e)*(a-e)):d-f.sqrt((1-g)*(d-e)*(d-a))},variance:function(e,d,a){return(e*e+d*d+a*a-e*d-e*a-d*a)/18}})})(this.jStat,Math);
(function(h,f){var e=Array.prototype.push,d=h.utils.isArray;h.extend({add:function(a,e){return d(e)?(d(e[0])||(e=[e]),h.map(a,function(a,d,f){return a+e[d][f]})):h.map(a,function(a){return a+e})},subtract:function(a,e){return d(e)?(d(e[0])||(e=[e]),h.map(a,function(a,d,f){return a-e[d][f]||0})):h.map(a,function(a){return a-e})},divide:function(a,e){return d(e)?(d(e[0])||(e=[e]),h.multiply(a,h.inv(e))):h.map(a,function(a){return a/e})},multiply:function(a,e){var f,m,n,p,r=a.length,q=a[0].length,w=
h.zeros(r,n=d(e)?e[0].length:q),x=0;if(d(e)){for(;x<n;x++)for(f=0;f<r;f++){for(m=p=0;m<q;m++)p+=a[f][m]*e[m][x];w[f][x]=p}return 1===r&&1===x?w[0][0]:w}return h.map(a,function(a){return a*e})},dot:function(a,e){d(a[0])||(a=[a]);d(e[0])||(e=[e]);for(var f=1===a[0].length&&1!==a.length?h.transpose(a):a,m=1===e[0].length&&1!==e.length?h.transpose(e):e,n=[],p=0,r=f.length,q=f[0].length,w,x;p<r;p++){n[p]=[];for(x=w=0;x<q;x++)w+=f[p][x]*m[p][x];n[p]=w}return 1===n.length?n[0]:n},pow:function(a,d){return h.map(a,
function(a){return f.pow(a,d)})},exp:function(a){return h.map(a,function(a){return f.exp(a)})},log:function(a){return h.map(a,function(a){return f.log(a)})},abs:function(a){return h.map(a,function(a){return f.abs(a)})},norm:function(a,e){var h=0,m=0;isNaN(e)&&(e=2);for(d(a[0])&&(a=a[0]);m<a.length;m++)h+=f.pow(f.abs(a[m]),e);return f.pow(h,1/e)},angle:function(a,d){return f.acos(h.dot(a,d)/(h.norm(a)*h.norm(d)))},aug:function(a,d){for(var f=a.slice(),h=0;h<f.length;h++)e.apply(f[h],d[h]);return f},
inv:function(a){var d=a.length,e=a[0].length,f=h.identity(d,e);a=h.gauss_jordan(a,f);for(var f=[],n=0,p;n<d;n++)for(f[n]=[],p=e;p<a[0].length;p++)f[n][p-e]=a[n][p];return f},det:function(a){var d=a.length,e=2*d,f=Array(e),h=d-1,p=e-1,r=h-d+1,q=p,w=0,x=0,z;if(2===d)return a[0][0]*a[1][1]-a[0][1]*a[1][0];for(;w<e;w++)f[w]=1;for(w=0;w<d;w++){for(z=0;z<d;z++)f[0>r?r+d:r]*=a[w][z],f[q<d?q+d:q]*=a[w][z],r++,q--;r=--h-d+1;q=--p}for(w=0;w<d;w++)x+=f[w];for(;w<e;w++)x-=f[w];return x},gauss_elimination:function(a,
d){var e=0,m=0,n=a.length,p=a[0].length,r=1,q=0,w=[],x;a=h.aug(a,d);x=a[0].length;for(e=0;e<n;e++){r=a[e][e];m=e;for(q=e+1;q<p;q++)r<f.abs(a[q][e])&&(r=a[q][e],m=q);if(m!=e)for(q=0;q<x;q++)r=a[e][q],a[e][q]=a[m][q],a[m][q]=r;for(m=e+1;m<n;m++)for(r=a[m][e]/a[e][e],q=e;q<x;q++)a[m][q]-=r*a[e][q]}for(e=n-1;0<=e;e--){q=0;for(m=e+1;m<=n-1;m++)q+=w[m]*a[e][m];w[e]=(a[e][x-1]-q)/a[e][e]}return w},gauss_jordan:function(a,d){for(var e=h.aug(a,d),m=e.length,n=e[0].length,p=0;p<m;p++){for(var r=p,q=p+1;q<m;q++)f.abs(e[q][p])>
f.abs(e[r][p])&&(r=q);q=e[p];e[p]=e[r];e[r]=q;for(q=p+1;q<m;q++)for(c=e[q][p]/e[p][p],r=p;r<n;r++)e[q][r]-=e[p][r]*c}for(p=m-1;0<=p;p--){c=e[p][p];for(q=0;q<p;q++)for(r=n-1;r>p-1;r--)e[q][r]-=e[p][r]*e[q][p]/c;e[p][p]/=c;for(r=m;r<n;r++)e[p][r]/=c}return e},lu:function(a,d){throw Error("lu not yet implemented");},cholesky:function(a,d){throw Error("cholesky not yet implemented");},gauss_jacobi:function(a,d,e,m){for(var n=0,p=0,r=a.length,q=[],w=[],x=[];n<r;n++)for(q[n]=[],w[n]=[],x[n]=[],p=0;p<r;p++)n>
p?(q[n][p]=a[n][p],w[n][p]=x[n][p]=0):n<p?(w[n][p]=a[n][p],q[n][p]=x[n][p]=0):(x[n][p]=a[n][p],q[n][p]=w[n][p]=0);a=h.multiply(h.multiply(h.inv(x),h.add(q,w)),-1);x=h.multiply(h.inv(x),d);d=e;e=h.add(h.multiply(a,e),x);for(n=2;f.abs(h.norm(h.subtract(e,d)))>m;)d=e,e=h.add(h.multiply(a,d),x),n++;return e},gauss_seidel:function(a,d,e,m){for(var n=0,p=a.length,r=[],q=[],w=[],x;n<p;n++)for(r[n]=[],q[n]=[],w[n]=[],x=0;x<p;x++)n>x?(r[n][x]=a[n][x],q[n][x]=w[n][x]=0):n<x?(q[n][x]=a[n][x],r[n][x]=w[n][x]=
0):(w[n][x]=a[n][x],r[n][x]=q[n][x]=0);a=h.multiply(h.multiply(h.inv(h.add(w,r)),q),-1);r=h.multiply(h.inv(h.add(w,r)),d);d=e;e=h.add(h.multiply(a,e),r);for(n=2;f.abs(h.norm(h.subtract(e,d)))>m;)d=e,e=h.add(h.multiply(a,d),r),n+=1;return e},SOR:function(a,d,e,m,n){for(var p=0,r=a.length,q=[],w=[],x=[],z;p<r;p++)for(q[p]=[],w[p]=[],x[p]=[],z=0;z<r;z++)p>z?(q[p][z]=a[p][z],w[p][z]=x[p][z]=0):p<z?(w[p][z]=a[p][z],q[p][z]=x[p][z]=0):(x[p][z]=a[p][z],q[p][z]=w[p][z]=0);a=h.multiply(h.inv(h.add(x,h.multiply(q,
n))),h.subtract(h.multiply(x,1-n),h.multiply(w,n)));n=h.multiply(h.multiply(h.inv(h.add(x,h.multiply(q,n))),d),n);d=e;e=h.add(h.multiply(a,e),n);for(p=2;f.abs(h.norm(h.subtract(e,d)))>m;)d=e,e=h.add(h.multiply(a,d),n),p++;return e},householder:function(a){for(var d=a.length,e=a[0].length,m=0,n=[],p=[],r;m<d-1;m++){p=0;for(n=m+1;n<e;n++)p+=a[n][m]*a[n][m];n=0<a[m+1][m]?-1:1;p=n*f.sqrt(p);r=f.sqrt((p*p-a[m+1][m]*p)/2);n=h.zeros(d,1);n[m+1][0]=(a[m+1][m]-p)/(2*r);for(p=m+2;p<d;p++)n[p][0]=a[p][m]/(2*
r);p=h.subtract(h.identity(d,e),h.multiply(h.multiply(n,h.transpose(n)),2));a=h.multiply(p,h.multiply(a,p))}return a},QR:function(a,d){for(var e=a.length,m=a[0].length,n=0,p=[],r=[],q=[],w;n<e-1;n++){r=0;for(p=n+1;p<m;p++)r+=a[p][n]*a[p][n];p=0<a[n+1][n]?-1:1;r=p*f.sqrt(r);w=f.sqrt((r*r-a[n+1][n]*r)/2);p=h.zeros(e,1);p[n+1][0]=(a[n+1][n]-r)/(2*w);for(r=n+2;r<e;r++)p[r][0]=a[r][n]/(2*w);r=h.subtract(h.identity(e,m),h.multiply(h.multiply(p,h.transpose(p)),2));a=h.multiply(r,a);d=h.multiply(r,d)}for(n=
e-1;0<=n;n--){for(p=n+1;p<=m-1;p++);q[n]=d[n][0]/a[n][n]}return q},jacobi:function(a){for(var d=1,e=0,m=a.length,n=h.identity(m,m),p=[],r,q,w,x,z;1===d;){e++;x=a[0][1];d=0;w=1;for(r=0;r<m;r++)for(q=0;q<m;q++)r!=q&&x<f.abs(a[r][q])&&(x=f.abs(a[r][q]),d=r,w=q);a[d][d]===a[w][w]?z=0<a[d][w]?f.PI/4:-f.PI/4:z=f.atan(2*a[d][w]/(a[d][d]-a[w][w]))/2;r=h.identity(m,m);r[d][d]=f.cos(z);r[d][w]=-f.sin(z);r[w][d]=f.sin(z);r[w][w]=f.cos(z);n=h.multiply(n,r);a=h.multiply(h.multiply(h.inv(r),a),r);d=0;for(r=1;r<
m;r++)for(q=1;q<m;q++)r!=q&&.001<f.abs(a[r][q])&&(d=1)}for(r=0;r<m;r++)p.push(a[r][r]);return[n,p]},rungekutta:function(a,d,e,f,h,p){var r,q,w;if(2===p)for(;f<=e;)r=d*a(f,h),q=d*a(f+d,h+r),h+=(r+q)/2,f+=d;if(4===p)for(;f<=e;)r=d*a(f,h),q=d*a(f+d/2,h+r/2),p=d*a(f+d/2,h+q/2),w=d*a(f+d,h+p),h+=(r+2*q+2*p+w)/6,f+=d;return h},romberg:function(a,d,e,h){for(var n=0,p=(e-d)/2,r=[],q=[],w=[],x,z,B;n<h/2;){B=a(d);z=d;for(x=0;z<=e;z+=p,x++)r[x]=z;x=r.length;for(z=1;z<x-1;z++)B+=(0!==z%2?4:2)*a(r[z]);B=p/3*(B+
a(e));w[n]=B;p/=2;n++}a=w.length;for(x=1;1!==a;){for(z=0;z<a-1;z++)q[z]=(f.pow(4,x)*w[z+1]-w[z])/(f.pow(4,x)-1);a=q.length;w=q;q=[];x++}return w},richardson:function(a,d,e,h){function n(a,d){for(var e=0,f=a.length,g;e<f;e++)a[e]===d&&(g=e);return g}for(var p=f.abs(e-a[n(a,e)+1]),r=0,q=[],w=[],x,z;h>=p;)x=n(a,e+h),z=n(a,e),q[r]=(d[x]-2*d[z]+d[2*z-x])/(h*h),h/=2,r++;d=q.length;for(a=1;1!=d;){for(e=0;e<d-1;e++)w[e]=(f.pow(4,a)*q[e+1]-q[e])/(f.pow(4,a)-1);d=w.length;q=w;w=[];a++}return q},simpson:function(a,
d,e,f){f=(e-d)/f;var h=a(d),p=[],r=d,q=0;for(d=1;r<=e;r+=f,q++)p[q]=r;for(r=p.length;d<r-1;d++)h+=(0!==d%2?4:2)*a(p[d]);return f/3*(h+a(e))},hermite:function(a,d,e,f){for(var h=a.length,p=0,r=0,q=[],w=[],x=[],z=[],B;r<h;r++){q[r]=1;for(B=0;B<h;B++)r!=B&&(q[r]*=(f-a[B])/(a[r]-a[B]));for(B=w[r]=0;B<h;B++)r!=B&&(w[r]+=1/(a[r]-a[B]));x[r]=(1-2*(f-a[r])*w[r])*q[r]*q[r];z[r]=(f-a[r])*q[r]*q[r];p+=x[r]*d[r]+z[r]*e[r]}return p},lagrange:function(a,d,e){for(var f=0,h=0,p,r,q=a.length;h<q;h++){r=d[h];for(p=
0;p<q;p++)h!=p&&(r*=(e-a[p])/(a[h]-a[p]));f+=r}return f},cubic_spline:function(a,d,e){for(var f=a.length,n=0,p=[],r=[],q=[],w=[],x=[],z=[],B=[];n<f-1;n++)x[n]=a[n+1]-a[n];q[0]=0;for(n=1;n<f-1;n++)q[n]=3/x[n]*(d[n+1]-d[n])-3/x[n-1]*(d[n]-d[n-1]);for(n=1;n<f-1;n++)p[n]=[],r[n]=[],p[n][n-1]=x[n-1],p[n][n]=2*(x[n-1]+x[n]),p[n][n+1]=x[n],r[n][0]=q[n];w=h.multiply(h.inv(p),r);for(n=0;n<f-1;n++)z[n]=(d[n+1]-d[n])/x[n]-x[n]*(w[n+1][0]+2*w[n][0])/3,B[n]=(w[n+1][0]-w[n][0])/(3*x[n]);for(n=0;n<f&&!(a[n]>e);n++);
return--n,d[n]+(e-a[n])*z[n]+h.sq(e-a[n])*w[n]+(e-a[n])*h.sq(e-a[n])*B[n]},gauss_quadrature:function(){throw Error("gauss_quadrature not yet implemented");},PCA:function(a){var d=a.length,e=a[0].length,f=0,n,p,r=[],q=[];n=[];for(var w=[],x=[],z=[],z=[],q=[],f=[],B=[],f=0;f<d;f++)r[f]=h.sum(a[f])/e;for(f=0;f<e;f++)for(z[f]=[],n=0;n<d;n++)z[f][n]=a[n][f]-r[n];z=h.transpose(z);for(f=0;f<d;f++)for(q[f]=[],n=0;n<d;n++)q[f][n]=h.dot([z[f]],[z[n]])/(e-1);n=h.jacobi(q);f=n[0];q=n[1];B=h.transpose(f);for(f=
0;f<q.length;f++)for(n=f;n<q.length;n++)q[f]<q[n]&&(p=q[f],q[f]=q[n],q[n]=p,w=B[f],B[f]=B[n],B[n]=w);z=h.transpose(z);for(f=0;f<d;f++)for(x[f]=[],n=0;n<z.length;n++)x[f][n]=h.dot([B[f]],[z[n]]);return[a,q,B,x]}});(function(a){for(var d=0;d<a.length;d++)(function(a){h.fn[a]=function(d,e){var f=this;return e?(setTimeout(function(){e.call(f,h.fn[a].call(f,d))},15),this):"number"==typeof h[a](this,d)?h[a](this,d):h(h[a](this,d))}})(a[d])})("add divide multiply subtract dot pow exp log abs norm angle".split(" "))})(this.jStat,
Math);
(function(h,f){var e=[].slice,d=h.utils.isNumber;h.extend({zscore:function(){var a=e.call(arguments);return d(a[1])?(a[0]-a[1])/a[2]:(a[0]-h.mean(a[1]))/h.stdev(a[1],a[2])},ztest:function(){var a=e.call(arguments);if(4===a.length){if(d(a[1])){var g=h.zscore(a[0],a[1],a[2]);return 1===a[3]?h.normal.cdf(-f.abs(g),0,1):2*h.normal.cdf(-f.abs(g),0,1)}g=a[0];return 1===a[2]?h.normal.cdf(-f.abs(g),0,1):2*h.normal.cdf(-f.abs(g),0,1)}g=h.zscore(a[0],a[1],a[3]);return 1===a[1]?h.normal.cdf(-f.abs(g),0,1):2*
h.normal.cdf(-f.abs(g),0,1)}});h.extend(h.fn,{zscore:function(a,d){return(a-this.mean())/this.stdev(d)},ztest:function(a,d,e){a=f.abs(this.zscore(a,e));return 1===d?h.normal.cdf(-a,0,1):2*h.normal.cdf(-a,0,1)}});h.extend({tscore:function(){var a=e.call(arguments);return 4===a.length?(a[0]-a[1])/(a[2]/f.sqrt(a[3])):(a[0]-h.mean(a[1]))/(h.stdev(a[1],!0)/f.sqrt(a[1].length))},ttest:function(){var a=e.call(arguments),g;return 5===a.length?(g=f.abs(h.tscore(a[0],a[1],a[2],a[3])),1===a[4]?h.studentt.cdf(-g,
a[3]-1):2*h.studentt.cdf(-g,a[3]-1)):d(a[1])?(g=f.abs(a[0]),1==a[2]?h.studentt.cdf(-g,a[1]-1):2*h.studentt.cdf(-g,a[1]-1)):(g=f.abs(h.tscore(a[0],a[1])),1==a[2]?h.studentt.cdf(-g,a[1].length-1):2*h.studentt.cdf(-g,a[1].length-1))}});h.extend(h.fn,{tscore:function(a){return(a-this.mean())/(this.stdev(!0)/f.sqrt(this.cols()))},ttest:function(a,d){return 1===d?1-h.studentt.cdf(f.abs(this.tscore(a)),this.cols()-1):2*h.studentt.cdf(-f.abs(this.tscore(a)),this.cols()-1)}});h.extend({anovafscore:function(){var a=
e.call(arguments),d,l,m,n,p,r;if(1===a.length){d=Array(a[0].length);for(p=0;p<a[0].length;p++)d[p]=a[0][p];a=d}if(2===a.length)return h.variance(a[0])/h.variance(a[1]);l=[];for(p=0;p<a.length;p++)l=l.concat(a[p]);m=h.mean(l);for(p=d=0;p<a.length;p++)d+=a[p].length*f.pow(h.mean(a[p])-m,2);d/=a.length-1;for(p=n=0;p<a.length;p++)for(m=h.mean(a[p]),r=0;r<a[p].length;r++)n+=f.pow(a[p][r]-m,2);return n/=l.length-a.length,d/n},anovaftest:function(){var a=e.call(arguments),f,l,m,n;if(d(a[0]))return 1-h.centralF.cdf(a[0],
a[1],a[2]);anovafscore=h.anovafscore(a);f=a.length-1;for(n=m=0;n<a.length;n++)m+=a[n].length;return l=m-f-1,1-h.centralF.cdf(anovafscore,f,l)},ftest:function(a,d,e){return 1-h.centralF.cdf(a,d,e)}});h.extend(h.fn,{anovafscore:function(){return h.anovafscore(this.toArray())},anovaftes:function(){var a=0,d;for(d=0;d<this.length;d++)a+=this[d].length;return h.ftest(this.anovafscore(),this.length-1,a-this.length)}});h.extend({normalci:function(){var a=e.call(arguments),d=Array(2),l;return 4===a.length?
l=f.abs(h.normal.inv(a[1]/2,0,1)*a[2]/f.sqrt(a[3])):l=f.abs(h.normal.inv(a[1]/2,0,1)*h.stdev(a[2])/f.sqrt(a[2].length)),d[0]=a[0]-l,d[1]=a[0]+l,d},tci:function(){var a=e.call(arguments),d=Array(2),l;return 4===a.length?l=f.abs(h.studentt.inv(a[1]/2,a[3]-1)*a[2]/f.sqrt(a[3])):l=f.abs(h.studentt.inv(a[1]/2,a[2].length-1)*h.stdev(a[2],!0)/f.sqrt(a[2].length)),d[0]=a[0]-l,d[1]=a[0]+l,d},significant:function(a,d){return a<d}});h.extend(h.fn,{normalci:function(a,d){return h.normalci(a,d,this.toArray())},
tci:function(a,d){return h.tci(a,d,this.toArray())}})})(this.jStat,Math);var utils=utils||{};
(function(h){h.htmlNamespaceUri="http://www.w3.org/1999/xhtml";h.svgNamespaceUri="http://www.w3.org/2000/svg";h.xlinkUri="http://www.w3.org/1999/xlink";h.hasOwnProperty=function(f,e){var d=f.__proto__||f.constructor.prototype;return e in f&&(!(e in d)||d[e]!==f[e])};h.isObjInArray=function(f,e){var d=!1;0<=f.indexOf(e)&&(d=!0);return d};h.removeA=function(f){for(var e,d=arguments,a=d.length,g;1<a&&f.length;)for(e=d[--a];-1!==(g=f.indexOf(e));)f.splice(g,1);return f};h.getKeys=function(f){var e=[],
d;for(d in f)e.push(d);return e};h.eliminateDuplicates=function(f){for(var e=[],d=0;d<f.length;d++){var a=f[d];h.isObjInArray(e,a)||e.push(a)}return e};h.keepReplicates=function(f,e,d){for(var a={},g=0;g<f.length;g++){var h=f[g];h in a||(a[h]=0);a[h]++}e=null==e?2:e;f=[];for(h in a)null!=d&&d?a[h]<e&&f.push(h):a[h]>=e&&f.push(h);return f};h.beginsWith=function(f,e){return 0===f.indexOf(e)};h.endsWith=function(f,e){return-1!==f.indexOf(e,f.length-e.length)};h.lengthOfLongestString=function(f){var e=
[],d;for(d in f)e.push(f[d].length);return Math.max.apply(null,e)};h.isNumerical=function(f){return null==f||""===f||isNaN(f)?!1:!0};h.getListBoxSelectedValues=function(f){for(var e=[],d=0;d<f.length;d++){var a=f[d];a.selected&&e.push(a.value)}return e};h.linearInterpolation=function(f,e,d){return(d-e)*f+e};h.rangeLimit=function(f,e,d){"undefined"===typeof e&&(e=-1);"undefined"===typeof d&&(d=1);return f<e?e:f>d?d:f};h.extractFromJq=function(f){return f.get(0)};h.convertToJq=function(f){$(f);return f};
h.extractFromD3=function(f){return f.node()};h.convertToD3=function(f){return d3.select(f)};h.sort_by=function(f,e,d){var a=d?function(a){return d(a[f])}:function(a){return a[f]};e=[-1,1][+!!e];return function(d,f){return d=a(d),f=a(f),e*((d>f)-(f>d))}};h.compareAsNumeric=function(f,e){var d=parseFloat(f),a=parseFloat(e);if(utils.isNumerical(d)&&utils.isNumerical(a)){if(d<a)return-1;if(d>a)return 1}else if(d==d||a==a){if(d!=d)return-1;if(a!=a)return 1}return 0};h.compareAsString=function(f,e){var d=
new String(f),a=new String(e);return"null"==d&&"null"!=a?1:"null"!=d&&"null"==a?-1:d.localeCompare(a)};h.compareAsDate=function(f,e){var d=f,a=e;null==d?d="1000":""==d&&(d="1001");null==a?a="1000":""==a&&(a="1001");return new Date(d)-new Date(a)};h.rgbComponentToHex=function(f){f=f.toString(16);return 1==f.length?"0"+f:f};h.rgbToHex=function(f,e,d){return"#"+this.rgbComponentToHex(f)+this.rgbComponentToHex(e)+this.rgbComponentToHex(d)};h.centeredRgbaColorMapper=function(f,e,d,a){var g=null,h=null==
e?0:e,m=null==d?-1.96:d,n=null==a?1.96:a;return g=function(a){var d=1,e=169,g=169,x=169;a=parseFloat(a);null!=a&&a==a&&(a>h?(e=255,x=g=0,a>n?d=1:(d=(a-h)/(n-h),d=Math.abs(d),f&&(d=Math.log(d)))):a<h?(g=e=0,x=255,a<m?d=1:(d=(a-h)/(m-h),d=Math.abs(d),f&&(d=Math.log(d)))):(x=g=e=255,d=1));return"rgba("+e+","+g+","+x+","+d+")"}};h.setupQuantileColorMapper=function(f,e){var d=e;null==d&&(d="rgb(255,255,217) rgb(237,248,177) rgb(199,233,180) rgb(127,205,187) rgb(65,182,196) rgb(29,145,192) rgb(34,94,168) rgb(37,52,148) rgb(8,29,88)".split(" "));
var a=d.length;return d3.scale.quantile().domain([0,a-1,d3.max(f,function(a){return parseFloat(a)})]).range(d)};h.getXmlDom_url=function(f){xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");xmlhttp.open("GET",f,!1);xmlhttp.send();return xmlDoc=xmlhttp.responseXML};h.getXmlDom_string=function(f){window.DOMParser?(parser=new DOMParser,xmlDoc=parser.parseFromString(f,"text/xml")):(xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.async=!1,xmlDoc.loadXML(f));return xmlDoc};
h.getDateTime=function(){var f=new Date,e=f.getFullYear(),d=f.getMonth()+1,a=f.getDate(),g=f.getHours(),h=f.getMinutes(),f=f.getSeconds();1==d.toString().length&&(d="0"+d);1==a.toString().length&&(a="0"+a);1==g.toString().length&&(g="0"+g);1==h.toString().length&&(h="0"+h);1==f.toString().length&&(f="0"+f);return e+"/"+d+"/"+a+" "+g+":"+h+":"+f};h.todaysDate=function(){var f=new Date,e=f.getDate();f.getDay();var d=f.getMonth()+1,f=f.getYear();return[,"January","February","March","April","May","June",
"July","August","September","October","November","December"][d]+" "+e+", "+(1E3>f?f+1900:f)};h.removeElemById=function(f){f=document.getElementById(f);f.parentNode.removeChild(f)};h.removeChildElems=function(f){for(;f.firstChild;)f.removeChild(f.firstChild);return f};h.createDivElement=function(f,e){var d=document.createElement("div");null!=f&&(d.id=f);null!=e&&(d.className=e);return d};h.setElemAttributes=function(f,e,d){d="undefined"===typeof d?null:d;if(null!=e)for(var a in e)f.setAttributeNS(d,
a,e[a]);return f};h.swapContainingDivs=function(f,e){var d=e.parentNode;document.getElementById(f.parentNode.id).appendChild(e);document.getElementById(d.id).appendChild(f)};h.simpleAsyncGet=function(f,e){var d=new XMLHttpRequest,d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");d.onreadystatechange=function(){this.readyState===(this.DONE||4)&&(200==this.status?e(this.responseText):400==this.status?console.log("There was an error 400"):console.log("status was not 200",
this.status))};d.open("GET",f,!0);d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.send(null)};h.getResponse=function(f){var e=null,d=null,d=new XMLHttpRequest;d.open("GET",f,!1);d.onload=function(){e=d.status;200!=e&&console.log("xhr status: "+e+" for "+f)};d.send(null);var a=null;200==e&&(a=d.responseText);return a};h.loadNewSettings=function(f){f=window.location.pathname+"?query="+JSON.stringify(f);window.open(f,"_self")};h.getQueryObj=function(){var f={};location.search.slice(1).split("&").forEach(function(e){e=
e.split("=");f[e[0]]=decodeURIComponent(e[1])||""});return f};h.getQueryStringParameterByName=function(f){f=f.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");f=(new RegExp("[\\?&]"+f+"=([^&#]*)")).exec(location.search);return null==f?"":decodeURIComponent(f[1].replace(/\+/g," "))};h.parseJson=function(f){return JSON.parse(f)};h.serializeJson=function(f,e){return e?JSON.stringify(f,null,"\t"):JSON.stringify(f)};h.prettyJson=function(f){return this.serializeJson(f,!0)};h.bottomRoundedRectSvgPath=function(f,
e,d,a,g){f=""+("M"+f+","+e)+("h"+d);f+="v"+(a-g);f+="a"+g+","+g+" 0 0 1 "+-1*g+","+g;f+="h"+-1*(d-2*g);f+="a"+g+","+g+" 0 0 1 "+-1*g+","+-1*g;f+="v"+-1*(a-g);return f+="z"};h.allRoundedRectSvgPath=function(f,e,d,a,g){f=""+("M"+f+","+(e+g))+("a"+g+","+g+" 0 0 1 "+g+","+-1*g);f+="h"+(d-2*g);f+="a"+g+","+g+" 0 0 1 "+g+","+g;f+="v"+(a-2*g);f+="a"+g+","+g+" 0 0 1 "+-1*g+","+g;f+="h"+-1*(d-2*g);f+="a"+g+","+g+" 0 0 1 "+-1*g+","+-1*g;f+="v"+-1*(a-2*g);return f+="z"};h.allAngledRectSvgPath=function(f,e,d,
a){var g=d>a?d/8:a/8;f=""+("M"+(f+g)+","+e)+("h"+(d-2*g));f+="l"+g+","+g;f+="v"+(a-2*g);f+="l"+-1*g+","+g;f+="h"+-1*(d-2*g);f+="l"+-1*g+","+-1*g;f+="v"+-1*(a-2*g);return f+="z"};h.createSvgRingElement=function(f,e,d,a){function g(a,d,e,f){f=(f-90)*Math.PI/180;return{x:a+e*Math.cos(f),y:d+e*Math.sin(f)}}f=function(a,d,e,f,h){var l=g(a,d,e,h);a=g(a,d,e,f);return["M",l.x,l.y,"A",e,e,0,180>=h-f?"0":"1",0,a.x,a.y].join(" ")}(f,e,d,0,359.9);e=document.createElementNS(this.svgNamespaceUri,"path");e.setAttributeNS(null,
"d",f);if(null!=a)for(var h in a)e.setAttributeNS(null,h,a[h]);return e};h.createSvgCircleElement=function(f,e,d,a){var g=document.createElementNS(this.svgNamespaceUri,"circle");g.setAttributeNS(null,"cx",f);g.setAttributeNS(null,"cy",e);g.setAttributeNS(null,"r",d);if(null!=a)for(var h in a)g.setAttributeNS(null,h,a[h]);return g};h.createSvgRectElement=function(f,e,d,a,g,h,m){var n=document.createElementNS(this.svgNamespaceUri,"rect");n.setAttributeNS(null,"x",f);n.setAttributeNS(null,"y",e);n.setAttributeNS(null,
"rx",d);n.setAttributeNS(null,"ry",a);n.setAttributeNS(null,"width",g);n.setAttributeNS(null,"height",h);if(null!=m)for(var p in m)n.setAttributeNS(null,p,m[p]);return n};h.createSvgImageElement=function(f,e,d,a,g,h){var m=document.createElementNS(this.svgNamespaceUri,"image");m.setAttributeNS(this.xlinkUri,"href",f);m.setAttributeNS(null,"x",e);m.setAttributeNS(null,"y",d);m.setAttributeNS(null,"width",a);m.setAttributeNS(null,"height",g);if(null!=h)for(var n in h)m.setAttributeNS(null,n,h[n]);return m};
h.setCookie=function(f,e,d){if(d){var a=new Date;a.setTime(a.getTime()+864E5*d);d="; expires="+a.toGMTString()}else d="";document.cookie=f+"="+e+d+"; path=/"};h.getCookie=function(f){f+="=";for(var e=document.cookie.split(";"),d=0;d<e.length;d++){for(var a=e[d];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(f))return a.substring(f.length,a.length)}return null};h.deleteCookie=function(f){this.setCookie(f,"",-1)};h.getNormalizedVector=function(f){var e=[],d=jStat.min(f),a=jStat.max(f);
if(0>d||0==a){console.log("min:"+d+"\tmax:"+a);if(0>d)return null;if(0==a)return f}for(d=0;d<f.length;d++)e.push(f[d]/a);return e};h.computeMarginalEntropy=function(f,e){for(var d=0,a=[],g=e(f),h=0;h<g.length;h++)a.push({bin:h,count:g[h].length});for(h=0;h<a.length;h++)g=a[h],g.probability=g.count/f.length,g.prod=0==g.probability?0:g.probability*Math.log2(g.probability),d+=g.prod;return-1*d};h.computeJointEntropy=function(f,e,d){if(f.length!=e.length)return null;var a=function(a,d){for(var e=null,
f=0;f<a.length;f++){var g=a[f];d>=g.x&&d<g.x+g.dx&&(e=f)}null==e&&(g=a[a.length-1],d-g.x-g.dx<g.dx&&(e=a.length-1));return e},g=d(f),l=d(e);d={};for(var m=0;m<g.length;m++)for(var n=0;n<l.length;n++){var p=m+"_"+n;d[p]=0}for(m=0;m<f.length;m++)p=a(g,f[m]),n=a(l,e[m]),p=p+"_"+n,d[p]++;e=0;a=h.getKeys(d);for(m=0;m<a.length;m++)p=a[m],g=d[p]/f.length,g=0==g?0:g*Math.log2(g),e+=g;return-1*e};h.mutualInformation=function(f,e,d){d="undefined"===typeof d?f.length:d;var a=d3.layout.histogram().bins(d).frequency(!1);
d=h.computeMarginalEntropy(f,a);var g=h.computeMarginalEntropy(e,a);f=h.computeJointEntropy(f,e,a);return d+g-f}})(utils);var eventData=eventData||{};
(function(h){h.eventHierarchyUrl="observation_deck/data/eventHierarchy.xml";h.getEventElems=function(f,e){var d=[];f.find("event").each(function(a,f){var h=f.getAttribute("type");void 0===e||null===e?d.push(f):h===e&&d.push(f)});return d};h.getEventParentChildren=function(f,e){var d={parent:null,children:[]},a=h.getEventElems(f,e);$(a).each(function(a,e){if("event"!==e.tagName)return"continue";d.parent=e.parentNode.getAttribute("type");$(e.children).each(function(a,e){"event"===e.tagName&&d.children.push(e.getAttribute("type"))})});
return d};h.tracebackToRoot=function(f,e){for(var d=[],a=h.getEventElems(f,e),g=0;g<a.length;g++){var l=a[g],m=[];d.push(m);l=l.getAttribute("type");for(l=h.getEventParentChildren(f,l).parent;void 0!==l&&null!==l;)m.push(l),l=h.getEventParentChildren(f,l).parent}return d};h.OD_eventAlbum=function(){this.album={};this.datatypeSuffixMapping={};this.addEvent=function(f,e){var d=new h.OD_event(f);this.album[f.id]=d;"datatype"in f&&"geneSuffix"in f&&(this.datatypeSuffixMapping[f.datatype]=f.geneSuffix);
d.data.setData(e,"numeric"==f.allowedValues||"expression"==f.allowedValues);return this};this.deleteEvent=function(f){delete this.album[f]};this.getEventIdsByType=function(){for(var f={},e=utils.getKeys(this.album),d=0;d<e.length;d++){var a=e[d],g=this.getEvent(a).metadata.datatype;utils.hasOwnProperty(f,g)||(f[g]=[]);f[g].push(a)}return f};this.getEventData=function(f){for(var e={},d=utils.getKeys(this.album),a=0;a<d.length;a++){var g=d[a],h=this.getEvent(g).data.getData(f);e[g]=h}return e};this.getAllDataAsList=
function(){for(var f=[],e=this.getEventData(),d=utils.getKeys(e),a=0;a<d.length;a++){for(var g=d[a],h=e[g].slice(),m=0;m<h.length;m++)h[m].eventId=g;f=f.concat(h)}return f};this.getAllSampleIds=function(){for(var f=[],e=utils.getKeys(this.album),d=0;d<e.length;d++)var a=this.getEvent(e[d]).data.getAllSampleIds(),f=f.concat(a);return utils.eliminateDuplicates(f)};this.selectSamples=function(f){var e=this.getAllSampleIds();if(0==f.length)return e;for(var d in f)var a=f[d].value,e=this.getEvent(f[d].eventId).data.selectIds(a,
e);return e};this.getEvent=function(f){return this.album[f]};this.getAllChildren=function(f,e){for(var d="undefined"===typeof e?[]:e,a=[],g=0;g<f.length;g++)var h=this.getEvent(f[g]).metadata,a=a.concat(getKeys(h.children));if(0==a.length)return d;d=d.concat(a);return this.getAllChildren(a,d)};this.getAllPivotScores=function(f,e){var d={},a=this.getEventIdsByType();if(!utils.hasOwnProperty(a,f))return d;for(var a=a[f],g=0;g<a.length;g++){var h=a[g],m=this.pivotSort(h,e);d[h]=m}return d};this.pivotSort_2=
function(f,e){for(var d=this.pivotSort(f,jStat.corrcoeff),a={},g=0;g<d.length;g++){var h=d[g],m=h.event;a[m]=0>h.score?-1:1}for(var d=this.pivotSort(f,e),n=[],p=[],g=0;g<d.length;g++)h=d[g],m=h.event,0>a[m]?p.push(h):n.push(h);n.sort(utils.sort_by("score"));p.sort(utils.sort_by("score"),!0);return n.concat(p)};this.pivotSort=function(f,e){console.log("eventAlbum.pivotSort:",f);"undefined"===typeof e&&(console.log("using default scoringAlgorithm, jStat.corrcoeff"),e=jStat.corrcoeff);var d=this.getEvent(f);
if(null==d)return console.log("eventObj not found for",f),null;for(var a=d.data.getAllSampleIds(),g=d.data.getNullSamples(),a=utils.keepReplicates(a.concat(g),2,!0),g=this.getEventIdsByType()[d.metadata.datatype],h=[],m=0;m<g.length;m++){var n=g[m],p=this.getEvent(n),r=p.data.getAllSampleIds(),q=p.data.getNullSamples(),r=utils.keepReplicates(r.concat(q),2,!0),r=utils.keepReplicates(r.concat(a)),q=d.data.getData(r),p=p.data.getData(r);if(0<p.length){var w=[],x=[],z=null;null==z&&(z=utils.hasOwnProperty(q[0],
"val_orig")?"val_orig":"val");for(var B=null,A=0;A<r.length;A++)null==B&&(B=utils.hasOwnProperty(p[A],"val_orig")?"val_orig":"val"),w.push(q[A][z]),x.push(p[A][B]);r=e(w,x);h.push({event:n,score:r})}else console.log("eventData2 is empty")}h.sort(utils.sort_by("score"));return h};this.multisortEvents=function(f,e){console.log("multisortEvents");console.log("rowSortSteps",f);console.log("colSortSteps",e);var d=this.getEventIdsByType(),a=[],g;for(g in d)var h=d[g],a=a.concat(h);h=[];if(null!=e){for(var m=
e.getSteps(),n=0;n<m.length;n++){g=m[n];var p=g.name;h.push(p)}h.reverse()}var r=h.slice(0);for(g=0;g<a.length;g++)p=a[g],utils.isObjInArray(r,p)||r.push(p);if(null!=f)for(m=f.getSteps().reverse(),n=0;n<m.length;n++){g=m[n];var p=g.name,q=g.reverse,a=this.getEvent(p);g=a.metadata.datatype;var w=a.metadata.scoredDatatype,p=this.datatypeSuffixMapping[w];if(null==w)console.log("no scored datatype to sort");else if(a=a.metadata.sortSignatureVector(),q&&a.reverse(),utils.hasOwnProperty(d,w)){m=d[w].slice(0);
r=[];n=[];for(q=0;q<a.length;q++){var x=a[q]+p,z=m.indexOf(x);0<=z&&n.push(x);0<=z&&!utils.isObjInArray(h,x)&&(r.push(x),delete m[z]);utils.isObjInArray(h,x)&&delete m[z]}console.log("scoredEventSigWeightOverlap",n.length,n);for(var B in m)r.push(m[B]);a=h.slice(0);for(g in d)if(g===w)a=a.concat(r);else{var h=d[g],A;for(A in h)p=h[A],utils.isObjInArray(a,p)||a.push(p)}r=a;console.log("rowNames.length",r.length,r);break}else console.log(w+" group has no events")}return r};this.multisortSamples=function(f){var e=
this.getAllSampleIds();if(null==f)return e;var d=f.getSteps().slice();d.reverse();var a=this;e.sort(function(e,f){for(var h=0,n=0;n<d.length;n++){var p=d[n].name,r=d[n].reverse,q=a.getEvent(p);if(void 0==q||null==q)console.log("no event found for sorting: "+p);else{var h=q.metadata.allowedValues,p=q.data.getData([e,f]),q=p[0].val,w=p[1].val,p=null,p="numeric"==h?utils.compareAsNumeric:"categoric"==h?utils.compareAsString:"expression"==h?utils.compareAsNumeric:"date"==h?utils.compareAsDate:utils.compareAsString,
h=p(q,w);p==utils.compareAsNumeric&&(h*=-1);r&&(h*=-1);if(0!=h)break}}return h});return e};this.zScoreExpressionRescaling=function(){console.log("zScoreExpressionRescaling");var f=this.getEventIdsByType();if(!utils.hasOwnProperty(f,"expression data"))return console.log("no expression"),null;for(var f=f["expression data"],e={},d={stats:e},a=[],g=0;g<f.length;g++){var h=f[g],m=this.getEvent(h).data.getStats();e[h]={};e[h]=m;for(var m=this.getEvent(h).data.getData(),n=0;n<m.length;n++){var p=m[n];utils.hasOwnProperty(p,
"val_orig")&&(p.val=p.val_orig);var r=p.val;p.val_orig=r;utils.isNumerical(r)&&(p.val=(r-e[h].mean)/e[h].sd,a.push(p.val))}}d.maxVal=jStat.max(a);d.minVal=jStat.min(a);return d};this.betweenMeansExpressionRescaling=function(f,e,d){console.log("betweenMeansExpressionRescaling",f,e,d);e=this.getEvent(f).data.selectIds(e);var a=null;null==d?(a=this.getEvent(f).data.selectIds(d),a=a.concat(e),a=utils.eliminateDuplicates(a)):a=this.getEvent(f).data.selectIds(d);f=this.getEventIdsByType();if(!utils.hasOwnProperty(f,
"expression data"))return console.log("no expression"),null;f=f["expression data"];d={};for(var g={meanVals:d},h=[],m=0;m<f.length;m++){var n=f[m];d[n]={};d[n].group1=this.getEvent(n).data.getStats(e).mean;d[n].group2=this.getEvent(n).data.getStats(a).mean;for(var p=(d[n].group2-d[n].group1)/2,n=this.getEvent(n).data.getData(),r=0;r<n.length;r++){var q=n[r];utils.hasOwnProperty(q,"val_orig")&&(q.val=q.val_orig);var w=q.val;q.val_orig=w;utils.isNumerical(w)&&(q.val=w-p,h.push(q.val))}}g.maxVal=jStat.max(h);
g.minVal=jStat.min(h);return g};this.yuliaExpressionRescaling=function(f,e){console.log("yuliaExpressionRescaling",f,e);var d=this.getEvent(f).data.selectIds(e),a=this.getEventIdsByType();if(!utils.hasOwnProperty(a,"expression data"))return console.log("no expression"),null;for(var a=a["expression data"],g={},h={meanVals:g},m=[],n=0;n<a.length;n++){var p=a[n];g[p]=this.getEvent(p).data.getStats(d).mean;for(var r=this.getEvent(p).data.getData(),q=0;q<r.length;q++){var w=r[q];utils.hasOwnProperty(w,
"val_orig")&&(w.val=w.val_orig);var x=w.val;w.val_orig=x;utils.isNumerical(x)&&(w.val=x-g[p],m.push(w.val))}}h.maxVal=jStat.max(m);h.minVal=jStat.min(m);return h};this.eventwiseMedianRescaling=function(){console.log("eventwiseMedianRescaling");var f=this.getEventIdsByType();if(!utils.hasOwnProperty(f,"expression data"))return console.log("no expression"),null;for(var f=f["expression data"],e={},d={stats:e},a=[],g=0;g<f.length;g++){var h=f[g],m=this.getEvent(h).data.getStats();e[h]={};e[h]=m;for(var m=
this.getEvent(h).data.getData(),n=0;n<m.length;n++){var p=m[n];utils.hasOwnProperty(p,"val_orig")&&(p.val=p.val_orig);var r=p.val;p.val_orig=r;utils.isNumerical(r)&&(p.val=r-e[h].median,a.push(p.val))}}d.maxVal=jStat.max(a);d.minVal=jStat.min(a);return d};this.samplewiseMedianRescaling=function(){console.log("samplewiseMedianRescaling");var f=this.getEventIdsByType();if(!utils.hasOwnProperty(f,"expression data"))return console.log("no expression"),null;for(var f=f["expression data"],e={},d={stats:e},
a=[],g=this.getAllSampleIds(),h=0;h<g.length;h++){var m=g[h];e[m]={};for(var n=this.getEventData([m]),p=[],r=0;r<f.length;r++){var q=f[r];if(utils.hasOwnProperty(n,q)){if(q=n[q][0],q.id===m){utils.hasOwnProperty(q,"val_orig")&&(q.val=q.val_orig);var w=q.val;q.val_orig=w;utils.isNumerical(w)&&p.push(w)}}else console.log(q+" was not found for "+m)}p=jStat.median(p);e[m]["samplewise median"]=p;if(isNaN(p))console.log("sample median for "+m+" is NaN.");else for(r=0;r<f.length;r++)q=f[r],utils.hasOwnProperty(n,
q)?(q=n[q][0],q.id===m&&(utils.hasOwnProperty(q,"val_orig")&&(q.val=q.val_orig),w=q.val,q.val_orig=w,utils.isNumerical(w)&&(q.val=w-e[m]["samplewise median"],a.push(w)))):console.log(q+" was not found for "+m)}d.maxVal=jStat.max(a);d.minVal=jStat.min(a);return d};this.bivariateNormalization=function(){};this.fillInMissingSamples=function(f){for(var e=this.getAllSampleIds(),d=this.getEventIdsByType(),a=0;a<utils.getKeys(d).length;a++)for(var g=utils.getKeys(d)[a],h=0;h<d[g].length;h++){var m=d[g][h],
n=this.getEvent(m).data.getAllSampleIds();if(0!=e.length-n.length){for(var n=utils.keepReplicates(e.concat(n),2,!0),p={},r=0;r<n.length;r++)p[n[r]]=f;this.getEvent(m).data.setData(p)}}return this}};h.OD_event=function(f){this.metadata=new h.OD_eventMetadata(f);this.data=new h.OD_eventDataCollection};h.OD_eventMetadata=function(f){this.id=f.id;this.name=f.name;this.displayName=f.displayName;this.description=f.description;this.datatype=f.datatype;this.allowedValues=f.allowedValues;this.minAllowedVal=
f.minAllowedVal;this.maxAllowedVal=f.maxAllowedVal;this.parents={};this.children={};this.weightedGeneVector=[];utils.hasOwnProperty(f,"weightedGeneVector")&&(null!=f.weightedGeneVector&&(this.weightedGeneVector=f.weightedGeneVector),this.scoredDatatype=f.scoredDatatype);this.addParent=function(e){this.parents[e]=e;return this};this.addChild=function(e){this.children[e]=e;return this};this.computeCompositeScore=function(e){return null};this.sortSignatureVector=function(e){var d=this.weightedGeneVector.slice(0);
d.sort(function(a,d){return utils.compareAsNumeric(a.weight,d.weight)});for(var a=[],f=0;f<d.length;f++)a.push(d[f].gene);e||a.reverse();return a}};h.OD_eventDataCollection=function(){function f(e,d){this.id=e;this.val=d}this.dataCollection=[];this.getValueCounts=function(e){var d={};e=this.getData(e);for(var a=0;a<e.length;a++){var f=e[a].val;utils.hasOwnProperty(d,f)||(d[f]=0);d[f]+=1}return d};this.getValues=function(e){var d=this.getValueCounts(),d=utils.getKeys(d);null!=e&&1==e&&(d=utils.eliminateDuplicates(d));
return d};this.setData=function(e,d){for(var a in e){var g=e[a];"NaN"!=g&&"null"!=g&&""!=g&&"N/A"!=g&&(null!=d&&1==d&&(g=parseFloat(g)),this.dataCollection.push(new f(a,g)))}return this};this.getData=function(e){var d=this.getAllSampleIds(!0);null==e&&(e=utils.getKeys(d));for(var a=[],g=0;g<e.length;g++){var h=e[g];h in d?a.push(this.dataCollection[d[h]]):a.push(new f(h,null))}return a};this.getAllSampleIds=function(e){for(var d={},a=0;a<this.dataCollection.length;a++)d[this.dataCollection[a].id]=
a;return e?d:utils.getKeys(d)};this.getNullSamples=function(e){var d=[];e=this.getData(e);for(var a=0;a<e.length;a++){var f=e[a];null==f.val&&d.push(f.id)}return d};this.sortSamples=function(e,d){var a=this.getData(e),f=compareSamplesAsStrings;d=null==d?"categoric":d.toLowerCase();"numeric"==d||"expression"==d?f=compareSamplesAsNumeric:"date"==d&&(f=compareSamplesAsDate);a.sort(f);for(var f=[],h=0;h<a.length;h++)f.push(a[h].id);return f};this.selectIds=function(e,d){for(var a=[],f=null==d?this.getData():
this.getData(d),h=0;h<f.length;h++){var m=f[h];m.val==e&&a.push(m.id)}return a};this.getStats=function(e,d){"undefined"===typeof d&&(d=3);var a={min:0,max:0,mean:0,median:0,sd:0,meddev:0,meandev:0},f=this.getAllSampleIds(!0);null==e&&(e=utils.getKeys(f));for(var h=[],m=0;m<e.length;m++){var n=e[m];if(n in f){var n=this.dataCollection[f[n]],p=null,p=utils.hasOwnProperty(n,"val_orig")?n.val_orig:n.val;utils.isNumerical(p)&&h.push(p)}}a.mean=jStat.mean(h).toPrecision(d);a.sd=jStat.stdev(h).toPrecision(d);
a.median=jStat.median(h).toPrecision(d);a.meddev=jStat.meddev(h).toPrecision(d);a.meandev=jStat.meandev(h).toPrecision(d);a.min=jStat.min(h).toPrecision(d);a.max=jStat.max(h).toPrecision(d);return a}};h.sortingSteps=function(f){this.steps=[];null!=f&&(this.steps=f);this.getSteps=function(){return this.steps};this.getIndex=function(e){for(var d=0;d<this.steps.length;d++)if(this.steps[d].name==e)return d;return-1};this.addStep=function(e,d){var a=this.getIndex(e);0<=a?(a=this.steps.splice(a,1)[0],d||
(a.reverse=!a.reverse),this.steps.push(a)):this.steps.push({name:e,reverse:!1})};this.removeStep=function(e){e=this.getIndex(e);0<=e&&this.steps.splice(e,1)};this.clearSteps=function(){this.steps.splice(0,this.steps.length)}};h.sampleSelectionCriteria=function(){this.criteria=[];this.getCriteria=function(){return this.criteria};this.addCriteria=function(f,e){var d={eventId:f,value:e},a;for(a in this.criteria)if(JSON.stringify(this.criteria[a])==JSON.stringify(d))return;this.criteria.push(d)};this.removeCriteria=
function(f,e){for(var d=0;d<this.criteria.length;d++)if(this.criteria[d].eventId==f&&this.criteria[d].value==e){this.criteria.splice(d,1);break}};this.clearCriteria=function(){this.criteria.splice(0,this.criteria.length)}}})(eventData);var medbookDataLoader=medbookDataLoader||{};
(function(h){h.transposeClinicalData=function(f,e){for(var d={},a=0;a<f.length;a++){var g=f[a],h=g[e],m;for(m in g)m in d||(d[m]={}),d[m][h]=g[m]}return d};h.getClinicalData=function(f,e){for(var d=utils.getResponse(f).split("\n"),a=[],g=[],h=[],m=0;m<d.length;m++){var n=d[m];utils.beginsWith(n,"#")?g.push(n):utils.beginsWith(n,"STRING")?h=n.split("\t"):a.push(n)}d=d3.tsv.parse(a.join("\n"));a=this.transposeClinicalData(d,"SAMPLE_ID");delete a.SAMPLE_ID;g=utils.getKeys(a);for(m=0;m<g.length;m++){var n=
g[m],p=a[n],r=h[m+1],q="categoric";"number"==r.toLowerCase()?q="numeric":"date"==r.toLowerCase()&&(q="date");e.addEvent({id:n,name:null,displayName:null,description:null,datatype:"clinical data",allowedValues:q},p)}return d};h.getMutationData=function(f,e){for(var d=utils.getResponse(f),a=d3.tsv.parse(d),d={},g=0;g<a.length;g++){var h=a[g],m=h.Hugo_Symbol,h=h.Tumor_Sample_Barcode,h=h.replace(/_/g,"-"),h=h.replace(/[A-Z]$/,"");utils.hasOwnProperty(d,m)||(d[m]={},d[m].metadata={id:m+"_mut",name:null,
displayName:null,description:null,datatype:"mutation data",allowedValues:"categoric"},d[m].data={});d[m].data[h]=!0}a=utils.getKeys(d);for(g=0;g<a.length;g++)m=d[a[g]],e.addEvent(m.metadata,m.data);return d};h.getExpressionData=function(f,e){h.getSampleByGeneData(f,e,"_mRNA","expression data","numeric")};h.getViperData=function(f,e){h.getSampleByGeneData(f,e,"_viper","viper data","numeric")};h.getSampleByGeneData=function(f,e,d,a,g){f=utils.getResponse(f);f=d3.tsv.parse(f);for(var h in f){var m=f[h],
n=m[""];delete m[""];e.addEvent({geneSuffix:d,id:n+d,name:null,displayName:null,description:null,datatype:a,allowedValues:g},m)}};h.mongoClinicalData=function(f,e){for(var d=0;d<f.length;d++){var a=f[d],g=null;if(utils.hasOwnProperty(a,"sample"))g=a.sample;else if(hasOwnProperty(a,"Sample"))g=a.Sample;else if(hasOwnProperty(a,"Patient ID"))g=a["Patient ID"];else if(hasOwnProperty(a,"Patient ID "))g=a["Patient ID "];else{console.log("no sample ID found in clinical doc: "+prettyJson(a));continue}g=
g.trim();if("Patient ID"!==g&&"Patient ID "!==g)for(var h=utils.getKeys(a),m=0;m<h.length;m++){var n=h[m];if(!utils.isObjInArray(["_id","sample","Sample"],n)){var p=e.getEvent(n);null==p&&(e.addEvent({id:n,name:null,displayName:null,description:null,datatype:"clinical data",allowedValues:"categoric"},[]),p=e.getEvent(n));var r={};r[g]=a[n];p.data.setData(r)}}}return p};h.mongoExpressionData=function(f,e){for(var d=0;d<f.length;d++){var a=f[d],g=null;if(utils.hasOwnProperty(a,"gene"))g=a.gene;else if(utils.hasOwnProperty(a,
"id"))g=a.id;else{console.log("no gene identifier found in expression doc: "+utils.prettyJson(a));continue}for(var g=g.trim(),g=g+"_mRNA",h=utils.getKeys(a),m=0;m<h.length;m++){var n=h[m];if(!utils.isObjInArray(["_id","gene","id"],n)){var p=e.getEvent(g);null==p&&(e.addEvent({geneSuffix:"_mRNA",id:g,name:null,displayName:null,description:null,datatype:"expression data",allowedValues:"numeric"},[]),p=e.getEvent(g));var r={};r[n]=parseFloat(a[n]);p.data.setData(r)}}}return p};h.getSignature=function(f,
e){var d=utils.getResponse(f),d=d3.tsv.parse(d),a=f.split("/").pop(),g=e.getEvent(a);null==g&&(e.addEvent({id:a,name:null,displayName:null,description:null,datatype:"expression signature",allowedValues:"numeric",weightedGeneVector:d},[]),g=e.getEvent(a));return g};h.loadSignatureObj_old=function(f,e){for(var d=f.data,a={},g=0;g<d.length;g++){var h=d[g];a[h.id]=h.val}e.addEvent(f.metadata,a);eventObj=e.getEvent(f.metadata.id)};h.loadSignatureObj=function(f,e){for(var d={},a=0;a<f.length;a++){var g=
f[a],h=g.id,m=g.name,g=g.val;utils.hasOwnProperty(d,m)||(d[m]={});d[m][h]=g}h=utils.getKeys(d);for(a=0;a<h.length;a++){var m=h[a],g=d[m],n=e.getEvent(m);null==n&&(e.addEvent({id:m,name:null,displayName:null,description:null,datatype:"expression signature",allowedValues:"numeric",weightedGeneVector:null,scoredDatatype:"expression data"},{}),n=e.getEvent(m));n.data.setData(g)}};h.loadSignatureWeightsObj=function(f,e){for(var d=f.name+"_v"+f.version,a=e.getEvent(d),g=[],h=f.signature,m=utils.getKeys(h),
n=0;n<m.length;n++){var p=m[n];g.push({gene:p,weight:h[p].weight})}null==a?(console.log("adding weightedGeneVector to new eventObj"),e.addEvent({id:d,name:null,displayName:null,description:null,datatype:"expression signature",allowedValues:"numeric",weightedGeneVector:g,scoredDatatype:"expression data"},[]),a=e.getEvent(d)):(console.log("adding weightedGeneVector to existing eventObj"),a.metadata.weightedGeneVector=g);console.log("weightedGeneVector for",d,"has",a.metadata.weightedGeneVector.length,
"genes");return a};h.loadBmegSignatureWeightsAsSamples=function(f,e){var d=utils.getKeys(f.query.weights),a=f.features,g=[],h=[],m;for(m in a)g.push({gene:m,weight:a[m]}),h.push(m);var h=utils.eliminateDuplicates(h),n=f.signatures,a={},p={},r;for(r in n){m=n[r];p[r]=m.score;var q=m.weights;m=d.slice(0);m=m.concat(utils.getKeys(q));m=utils.eliminateDuplicates(m);for(var w=0,x=m.length;w<x;w++){var z=m[w];if(utils.isObjInArray(d,z)||utils.isObjInArray(h,z)){var B=q[z];"undefined"!==typeof B&&(utils.hasOwnProperty(a,
z)||(a[z]={}),a[z][r]=B)}}}console.log("num genes:"+utils.getKeys(a).length);e.addEvent({id:"query_score",name:null,displayName:null,description:null,datatype:"signature query score",allowedValues:"numeric",weightedGeneVector:g,scoredDatatype:"signature weight"},p);m=utils.getKeys(a);for(d=0;d<m.length;d++)z=m[d],g=z+"_weight",null==e.getEvent(g)?(e.addEvent({id:g,name:null,displayName:null,description:null,datatype:"signature weight",allowedValues:"numeric",maxAllowedVal:1,minAllowedVal:-1},a[z]),
e.getEvent(g)):console.log("loadBmegSignatureWeightsAsSamples:","existing event for: "+g)}})(medbookDataLoader);u=utils;buildObservationDeck=function(h,f){f=getConfiguration(f);f.containerDivId=h.id;drawMatrix(h,f);setupContextMenus(f);return f};
getConfiguration=function(h){console.log("cookie",utils.getCookie("od_config"));var f=utils.parseJson(utils.getCookie("od_config"))||{};h.querySettings=f;f=null;"eventAlbum"in h?f=h.eventAlbum:(f=new eventData.OD_eventAlbum,h.eventAlbum=f);var e=medbookDataLoader;if("dataUrl"in h){var d=h.dataUrl;"clinicalUrl"in d&&e.getClinicalData(d.clinicalUrl,f);"expressionUrl"in d&&e.getExpressionData(d.expressionUrl,f);"mutationUrl"in d&&e.getMutationData(d.mutationUrl,f)}"mongoData"in h&&(d=h.mongoData,"clinical"in
d&&e.mongoClinicalData(d.clinical,f),"expression"in d&&e.mongoExpressionData(d.expression,f));if("signature"in h&&(d=h.signature,"expression"in d)){var a=d.expression;if("file"in a)for(var g=a.file,d=0;d<g.length;d++){var l=g[d];console.log(l);e.getSignature(l,f)}if("object"in a)for(a=a.object,d=0;d<a.length;d++)g=a[d],e.loadSignatureObj(g,f)}if("signature_index"in h&&(d=h.signature_index,"expression"in d&&(d=d.expression,"object"in d)))for(a=d.object,d=0;d<a.length;d++)g=a[d],e.loadSignatureWeightsObj(g,
f);"bmegSigServiceData"in h&&(console.log("bmegSigServiceData in config"),e.loadBmegSignatureWeightsAsSamples(h.bmegSigServiceData,f));"displayedSamples"in h||(h.displayedSamples=[]);var f=h.eventAlbum.getEventIdsByType(),m;for(m in f);if("deleteEvents"in h)for(m=h.deleteEvents,d=0;d<m.length;d++)h.eventAlbum.deleteEvent(m[d]);return h};
getCookieEvents=function(){var h=[],f=utils.parseJson(utils.getCookie("od_config"));if("undefined"===typeof f||null==f||0==utils.getKeys(f).length)return[];utils.hasOwnProperty(f,"pivot_sort")&&h.push(f.pivot_sort.pivot_event);if(utils.hasOwnProperty(f,"colSort"))for(var e=f.colSort.steps,d=0;d<e.length;d++)h.push(e[d].name);utils.hasOwnProperty(f,"required events")&&(h=h.concat(f["required events"]));f=[];for(d=0;d<h.length;d++)e=h[d],utils.endsWith(e,"_mRNA")&&f.push(e.replace("_mRNA",""));return utils.eliminateDuplicates(f)};
setupContextMenus=function(h){for(var f=[".colLabel",".rowLabel",".mrna_exp",".categoric"],e=0;e<f.length;e++)$.contextMenu("destroy",f[e]);setupColLabelContextMenu(h);setupRowLabelContextMenu(h);setupCategoricCellContextMenu(h);setupExpressionCellContextMenu(h)};
resetConfig=function(h){var f="dataUrl eventAlbum mongoData containerDivId signature rowTitleCallback columnTitleCallback".split(" ");utils.deleteCookie("od_config");for(var e=utils.getKeys(h),d=0;d<e.length;d++){var a=e[d];utils.isObjInArray(f,a)||delete h[a]}};createResetContextMenuItem=function(h){return{name:"reset",icon:null,disabled:!1,callback:function(f,e){resetConfig(h);var d=document.getElementById(h.containerDivId);buildObservationDeck(d,h)}}};
setupColLabelContextMenu=function(h){var f=h.columnTitleCallback;$.contextMenu({selector:".colLabel",trigger:"left",build:function(e,d){var a=e[0].innerHTML.split("<")[0];return{items:{title:{name:a,icon:null,disabled:null==f,callback:function(d,e){null==f?console.log("default titleCallback for column",a):f(a,h)}},reset:createResetContextMenuItem(h)}}}})};
setupRowLabelContextMenu=function(h){var f=h.rowTitleCallback;$.contextMenu({selector:".rowLabel",trigger:"left",callback:function(e,d){console.log("elem",this[0])},build:function(e,d){var a=e[0].innerHTML.split("<")[0],g=h.eventAlbum.getEvent(a),l=g.metadata.datatype,m=g.metadata.scoredDatatype,n=g.metadata.allowedValues;return{items:{title:{name:a,icon:null,disabled:function(){var a=!0;null!=f&&utils.isObjInArray(["expression data","clinical data"],l)&&(a=!1);return a},callback:function(d,e){null==
f?console.log("default titleCallback for row",a):f(a,h)}},sep1:"---------",sort_fold:{name:"sort...",items:{pivot_sort:{name:function(){return l+" events by this pivot"},icon:null,disabled:function(){return"numeric"===n?!1:!0},callback:function(d,e){var f=h.querySettings;f.pivot_sort={pivot_event:a};utils.setCookie("od_config",JSON.stringify(f));f=document.getElementById(h.containerDivId);buildObservationDeck(f,h)}},sort:{name:"samples by this event",icon:null,disabled:!1,callback:function(d,e){var f=
null,g=h.querySettings,f="colSort"in g?new eventData.sortingSteps(g.colSort.steps):new eventData.sortingSteps;f.addStep(a);g.colSort=f;utils.setCookie("od_config",JSON.stringify(g));f=document.getElementById(h.containerDivId);buildObservationDeck(f,h)}},sig_sort:{name:function(d,e){return null==m?"---":m+" events by "+a+" weight"},icon:null,disabled:function(a,d){return null==m?!0:!1},callback:function(d,e){var f=null,g=h.querySettings,f="rowSort"in g?new eventData.sortingSteps(g.rowSort.steps):new eventData.sortingSteps;
f.addStep(a);g.rowSort=f;utils.setCookie("od_config",JSON.stringify(g));f=document.getElementById(h.containerDivId);buildObservationDeck(f,h)}}}},hide_fold:{name:"hide...",items:{hide_null_samples:{name:"null samples in this row",icon:null,disabled:!1,callback:function(d,e){var f=h.querySettings;f["required events"]=[a];utils.setCookie("od_config",JSON.stringify(f));f=document.getElementById(h.containerDivId);buildObservationDeck(f,h)}},hide_datatype:{name:"this datatype",icon:null,disabled:!1,callback:function(a,
d){var e=h.querySettings;"hiddenDatatypes"in e||(e.hiddenDatatypes=[]);e.hiddenDatatypes.push(l);e.hiddenDatatypes=utils.eliminateDuplicates(e.hiddenDatatypes);utils.setCookie("od_config",JSON.stringify(e));e=document.getElementById(h.containerDivId);buildObservationDeck(e,h)}}}},sep1:"---------",reset:createResetContextMenuItem(h)}}}})};
setupExpressionCellContextMenu=function(h){$.contextMenu({selector:".mrna_exp",trigger:"left",callback:function(f,e){},build:function(f,e){var d=f[0],a=d.getAttribute("eventId"),d=d.getAttribute("sampleId");return{items:{title:{name:a+" for "+d,icon:null,disabled:!0},sep1:"---------",rescaling_fold:{name:"normalize coloring...",items:{"samplewise median rescaling":{name:"over each column",icon:null,disabled:!1,callback:function(a,d){var e=h.querySettings;e["expression rescaling"]={method:"samplewiseMedianRescaling"};
utils.setCookie("od_config",JSON.stringify(e));e=document.getElementById(h.containerDivId);buildObservationDeck(e,h)}},"eventwise median rescaling":{name:"over each row",icon:null,disabled:!1,callback:function(a,d){var e=h.querySettings;e["expression rescaling"]={method:"eventwiseMedianRescaling"};utils.setCookie("od_config",JSON.stringify(e));e=document.getElementById(h.containerDivId);buildObservationDeck(e,h)}}}},sep1:"---------",reset:createResetContextMenuItem(h)}}}})};
setupCategoricCellContextMenu=function(h){$.contextMenu({selector:".categoric",trigger:"left",callback:function(f,e){},build:function(f,e){var d=f[0],a=d.getAttribute("eventId"),d=d.getAttribute("sampleId");return{items:{title:{name:a+" for "+d,icon:null,disabled:!0},sep1:"---------","yulia expression rescaling":{name:"rescale mRNA values using this category",icon:null,disabled:!1,callback:function(a,d){var e=this[0],f=e.getAttribute("eventId");e.getAttribute("sampleId");e=e.getAttribute("val");console.log("key:",
a,"eventId:",f,"val:",e);console.log("href",window.location.href);console.log("host",window.location.host);console.log("pathname",window.location.pathname);console.log("search",window.location.search);var p=h.querySettings;p["expression rescaling"]={method:"yulia_rescaling",eventId:f,val:e};utils.setCookie("od_config",JSON.stringify(p));f=document.getElementById(h.containerDivId);buildObservationDeck(f,h)}},sep1:"---------",reset:createResetContextMenuItem(h)}}}})};
drawMatrix=function(h,f){var e=utils.removeChildElems(h),d=f.eventAlbum;d.fillInMissingSamples(null);var a=d.getEventIdsByType(),g=d3.scale.category10(),l=[],m;for(m in a)g(m),l=l.concat(a[m]);m=f.querySettings;var n=null;utils.hasOwnProperty(a,"expression data")&&utils.hasOwnProperty(m,"expression rescaling")?(a=m["expression rescaling"],"yulia_rescaling"===a.method?n=d.yuliaExpressionRescaling(a.eventId,a.val):"eventwiseMedianRescaling"===a.method?n=d.eventwiseMedianRescaling():"zScoreExpressionRescaling"===
a.method?n=d.zScoreExpressionRescaling():"samplewiseMedianRescaling"===a.method&&(n=d.samplewiseMedianRescaling())):utils.hasOwnProperty(a,"expression data")?n=d.eventwiseMedianRescaling():console.log("no expression data rescaling");var p=utils.centeredRgbaColorMapper(!1);null!=n&&(p=utils.centeredRgbaColorMapper(!1,0,n.minVal,n.maxVal));for(var r={},a=0;a<l.length;a++){var q=l[a],w=d.getEvent(q).metadata.allowedValues;if("categoric"==w)r[q]=d3.scale.category10();else if("numeric"==w){var x=d.getEvent(q),
w=x.metadata.minAllowedVal,x=x.metadata.maxAllowedVal;if("undefined"!=typeof w&&"undefined"!=typeof x)r[q]=utils.centeredRgbaColorMapper(!1,0,w,x);else{for(var x=d.getEvent(q).data.getValues(),w=[],z=0;z<x.length;z++){var B=x[z];utils.isNumerical(B)&&w.push(B)}x=Math.min.apply(null,w);w=Math.max.apply(null,w);r[q]=utils.centeredRgbaColorMapper(!1,0,x,w)}}else r[q]="expression"==w?p:d3.scale.category10()}q=l=null;if("colSort"in m)for(q=new eventData.sortingSteps(m.colSort.steps),a=q.getSteps().length-
1;0<=a;a--)p=q.steps[a],p=p.name,d.getEvent(p)||(console.log(p,"not found, skip sorting by that event"),q.removeStep(p));utils.hasOwnProperty(m,"pivot_sort")&&(p=m.pivot_sort,p=p.pivot_event,null==q&&(q=new eventData.sortingSteps),d.getEvent(p)&&q.addStep(p,!0));l=d.multisortSamples(q);p=[];if("required events"in m){w=m["required events"][0];console.log("requiredEventId",w);try{var A=d.getEvent(w).data.getNullSamples(),p=p.concat(A)}catch(L){console.log("ERROR while getting samples to hide in eventID:",
w,"error.message ->",L.message)}finally{console.log("samplesToHide",p)}}p=utils.eliminateDuplicates(p);A=[];for(w=0;w<l.length;w++)x=l[w],utils.isObjInArray(f.displayedSamples,x)?A.push(x):utils.isObjInArray(p,x)||0==f.displayedSamples.length&&A.push(x);var l=A,ba={};for(a in l)p=l[a],ba[p]=a;A=null;if("rowSort"in m)for(A=new eventData.sortingSteps(m.rowSort.steps),a=A.getSteps().length-1;0<=a;a--)p=A.steps[a],p=p.name,d.getEvent(p)||(console.log(p,"not found, skip sorting by that event"),A.removeStep(p));
A=d.multisortEvents(A,q);p=null;if(utils.hasOwnProperty(m,"pivot_sort")){p=m.pivot_sort;p=p.pivot_event;p=d.pivotSort(p);"undefined"===typeof n&&(n={stats:{}});w=[];for(a=0;a<p.length;a++)q=p[a].event,x=p[a].score,w.push(q),n.stats[q]={pivotScore:x};A=utils.eliminateDuplicates(w.concat(A))}q=m.hiddenDatatypes||[];p=[];for(a=0;a<A.length;a++)w=A[a],m=d.getEvent(w).metadata.datatype,utils.isObjInArray(q,m)||p.push(w);var A=p,E={};for(a in A)p=A[a],E[p]=a;a=utils.lengthOfLongestString(l);m=utils.lengthOfLongestString(A);
a=3<a?9*a:30;p=1<m?8*m:15;m=document.documentElement.clientWidth;var N=Math.floor((m-p-0)/(l.length>A.length?l.length:A.length)),N=9<N?N:9;console.log("gridSize",N);q=a+0+N*A.length;e=d3.select(e).append("svg").attr({width:m,height:q,viewBox:"0 0 "+m+" "+q,perserveAspectRatio:"xMinYMin meet"}).append("g").attr({transform:"translate("+p+","+a+")"});utils.createSvgRectElement(0,0,0,0,m,q,{fill:"white","class":"primer"});e.append("rect").attr({x:0,y:0,rx:0,ry:0,width:N*l.length,height:N*A.length,fill:"white",
"class":"primer"});a=-6;m=N/1.5;e.selectAll(".rowLabel").data(A).enter().append("text").text(function(a){return a}).attr({x:0,y:function(a,d){return d*N},transform:"translate("+a+", "+m+")","class":function(a,d){return"rowLabel mono axis unselectable"},eventId:function(a,d){return a},datatype:function(a,e){return d.getEvent(a).metadata.datatype}}).style("text-anchor","end").style("fill",function(a){a=d.getEvent(a).metadata.datatype;return g(a)}).append("title").text(function(a){var e=d.getEvent(a),
f="event: "+a+"\ndatatype: "+e.metadata.datatype;"numeric"===e.metadata.allowedValues&&null!=n&&utils.hasOwnProperty(n,"stats")&&"undefined"!==typeof n.stats[a]&&(f=f+"\nraw data stats: "+utils.prettyJson(n.stats[a]));return f});a=Math.floor(N/5);m=-1*Math.floor(N/3);e.selectAll(".colLabel").data(l).enter().append("text").text(function(a){return a}).attr({y:function(a,d){return(d+1)*N},x:0,transform:"rotate(-90) translate("+a+", "+m+")","class":function(a,d){return"colLabel mono axis unselectable"}}).style("text-anchor",
"start").append("title").text(function(a){return"sample: "+a});m=d.getAllDataAsList();l=[];for(a=0;a<m.length;a++)p=m[a],q=p.eventId,utils.isObjInArray(A,q)&&l.push(p);e.selectAll(".cell").data(l).enter().append(function(a){var e=document.createElementNS(utils.svgNamespaceUri,"g");e.setAttributeNS(null,"class","cell");if(!utils.hasOwnProperty(ba,a.id))return e;var f=ba[a.id]*N,g=E[a.eventId]*N,h=4,l=4,m=N,n=N,p={"class":"bordered"},q=a.eventId;if(null==q||null==a.val)p.fill="lightgrey",e.appendChild(utils.createSvgRectElement(f,
g,h,l,m,n,p));if(null==q||null==a.val)return e;p=a.val;f=ba[a.id]*N;g=E[a.eventId]*N;l=h=4;n=m=N;p={stroke:"#E6E6E6","stroke-width":"2px",fill:(0,r[a.eventId])(p)};"categoric"===d.getEvent(a.eventId).metadata.allowedValues?(p["class"]="categoric",p.eventId=a.eventId,p.sampleId=a.id,p.val=a.val):"expression data"===d.getEvent(a.eventId).metadata.datatype&&(p["class"]="mrna_exp",p.eventId=a.eventId,p.sampleId=a.id,p.val=a.val);e.appendChild(utils.createSvgRectElement(f,g,h,l,m,n,p));return e}).append("title").text(function(a){return"event: "+
a.eventId+"\nsample: "+a.id+"\nvalue: "+a.val});return f};
